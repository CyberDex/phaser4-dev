(()=>{var jc=Object.defineProperty,v=(t,e)=>{for(var n in e)jc(t,n,{get:e[n],enumerable:!0})},$c={};v($c,{Camera:()=>os,StaticCamera:()=>wn});var as,cs=0,us=0,rt={get:()=>as,set:t=>{as=t},getFrame:()=>cs,setFrame:t=>{cs=t},getElapsed:()=>us,setElapsed:t=>{us=t}},hs={};v(hs,{GetMat4Determinant:()=>Zc,GetMat4Frobenius:()=>Jc,Mat4Add:()=>tu,Mat4AddTranslationFromFloats:()=>eu,Mat4Adjoint:()=>nu,Mat4Clone:()=>ru,Mat4CopyFrom:()=>su,Mat4CopyPosition:()=>iu,Mat4Equals:()=>ou,Mat4FromQuat:()=>au,Mat4FromRotation:()=>cu,Mat4FromRotationTranslation:()=>uu,Mat4FromRotationTranslationScale:()=>ls,Mat4FromRotationTranslationScaleOrigin:()=>hu,Mat4FromRotationXYTranslation:()=>fs,Mat4FromScaling:()=>lu,Mat4FromTranslation:()=>fu,Mat4FromXRotation:()=>du,Mat4FromYRotation:()=>xu,Mat4FromZRotation:()=>yu,Mat4Frustum:()=>mu,Mat4GetRotation:()=>pu,Mat4GetScaling:()=>ds,Mat4GetTranslation:()=>wu,Mat4Identity:()=>Se,Mat4Invert:()=>ve,Mat4LookAt:()=>xs,Mat4Multiply:()=>It,Mat4MultiplyScalar:()=>gu,Mat4MultiplyScalarAndAdd:()=>Mu,Mat4Ortho:()=>ys,Mat4Perspective:()=>Ee,Mat4PerspectiveFromFieldOfView:()=>Cu,Mat4Rotate:()=>bu,Mat4RotateX:()=>Ru,Mat4RotateY:()=>Tu,Mat4RotateZ:()=>Su,Mat4Scale:()=>vu,Mat4SetTranslation:()=>Eu,Mat4SetTranslationFromFloats:()=>Au,Mat4Subtract:()=>zu,Mat4TargetTo:()=>Du,Mat4Translate:()=>Fu,Mat4TranslateFromFloats:()=>ms,Mat4Transpose:()=>ps,Mat4Zero:()=>Vu,Matrix4:()=>_});function Zc(t){let[e,n,r,s,i,o,a,c,u,h,l,d,f,x,p,m]=t.data,w=l*m-p*d,g=h*m-x*d,M=h*p-x*l,C=u*m-f*d,b=u*p-l*f,R=u*x-f*h,z=+(o*w-a*g+c*M),D=-(i*w-a*C+c*b),V=+(i*g-o*C+c*R),A=-(i*M-o*b+a*R);return e*z+n*D+r*V+s*A}function Jc(t){let[e,n,r,s,i,o,a,c,u,h,l,d,f,x,p,m]=t.data;return Math.hypot(e,n,r,s,i,o,a,c,u,h,l,d,f,x,p,m)}function Gu(t){return t>0?Math.ceil(t):Math.floor(t)}var ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Lu=new Uint8Array(256);for(let t=0;t<ws.length;t++)Lu[ws.charCodeAt(t)]=t;function Et(){}var _=class{constructor(t){let e=new Float32Array(16);this.data=e,this.onChange=Et,t?Array.isArray(t)?this.fromArray(t):this.fromArray(t.data):(e[0]=1,e[5]=1,e[10]=1,e[15]=1)}set(t,e,n,r,s,i,o,a,c,u,h,l,d,f,x,p){let m=this.data;return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=s,m[5]=i,m[6]=o,m[7]=a,m[8]=c,m[9]=u,m[10]=h,m[11]=l,m[12]=d,m[13]=f,m[14]=x,m[15]=p,this.onChange(this),this}toArray(t=[],e=0){let n=this.data;for(let r=0;r<16;r++)t[e+r]=n[r];return t}fromArray(t,e=0){let n=this.data;for(let r=0;r<16;r++)n[r]=t[e+r];return this.onChange(this),this}toString(){return"[ mat4="+this.data.join(", ")+" ]"}destroy(){this.onChange=Et,this.data=null}};function tu(t,e,n=new _){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=t.data,[M,C,b,R,z,D,V,A,S,L,F,P,B,H,W,j]=e.data;return n.set(r+M,s+C,i+b,o+R,a+z,c+D,u+V,h+A,l+S,d+L,f+F,x+P,p+B,m+H,w+W,g+j)}function eu(t,e,n,r){let s=t.data;return s[12]+=e,s[13]+=n,s[14]+=r,t.onChange(t),t}function nu(t,e=new _){let[n,r,s,i,o,a,c,u,h,l,d,f,x,p,m,w]=t.data,g=n*a-r*o,M=n*c-s*o,C=n*u-i*o,b=r*c-s*a,R=r*u-i*a,z=s*u-i*c,D=h*p-l*x,V=h*m-d*x,A=h*w-f*x,S=l*m-d*p,L=l*w-f*p,F=d*w-f*m;return e.set(a*F-c*L+u*S,s*L-r*F-i*S,p*z-m*R+w*b,d*R-l*z-f*b,c*A-o*F-u*V,n*F-s*A+i*V,m*C-x*z-w*M,h*z-d*C+f*M,o*L-a*A+u*D,r*A-n*L-i*D,x*R-p*C+w*g,l*C-h*R-f*g,a*V-o*S-c*D,n*S-r*V+s*D,p*M-x*b-m*g,h*b-l*M+d*g)}function ru(t){return new _(t)}function su(t,e){return e.fromArray(t.data)}function iu(t,e){let n=t.data,r=e.data;return r[12]=n[12],r[13]=n[13],r[14]=n[14],e.onChange(e),e}function ou(t,e){let[n,r,s,i,o,a,c,u,h,l,d,f,x,p,m,w]=t.data,[g,M,C,b,R,z,D,V,A,S,L,F,P,B,H,W]=e.data;return n===g&&r===M&&s===C&&i===b&&o===R&&a===z&&c===D&&u===V&&h===A&&l===S&&d===L&&f===F&&x===P&&p===B&&m===H&&w===W}function au(t,e=new _){let{x:n,y:r,z:s,w:i}=t,o=n+n,a=r+r,c=s+s,u=n*o,h=r*o,l=r*a,d=s*o,f=s*a,x=s*c,p=i*o,m=i*a,w=i*c;return e.set(1-l-x,h+w,d-m,0,h-w,1-u-x,f+p,0,d+m,f-p,1-u-l,0,0,0,0,1)}function cu(t,e,n=new _){let{x:r,y:s,z:i}=e,o=Math.hypot(r,s,i);if(o<1e-5)return null;o=1/o,r*=o,s*=o,i*=o;let a=Math.sin(t),c=Math.cos(t),u=1-c;return n.set(r*r*u+c,s*r*u+i*a,i*r*u-s*a,0,r*s*u-i*a,s*s*u+c,i*s*u+r*a,0,r*i*u+s*a,s*i*u-r*a,i*i*u+c,0,0,0,0,1)}function uu(t,e,n=new _){let{x:r,y:s,z:i,w:o}=t,a=r+r,c=s+s,u=i+i,h=r*a,l=r*c,d=r*u,f=s*c,x=s*u,p=i*u,m=o*a,w=o*c,g=o*u,{x:M,y:C,z:b}=e;return n.set(1-(f+p),l+g,d-w,0,l-g,1-(h+p),x+m,0,d+w,x-m,1-(h+f),0,M,C,b,1)}function ls(t,e,n,r=new _){let{x:s,y:i,z:o,w:a}=t,c=s+s,u=i+i,h=o+o,l=s*c,d=s*u,f=s*h,x=i*u,p=i*h,m=o*h,w=a*c,g=a*u,M=a*h,{x:C,y:b,z:R}=n,{x:z,y:D,z:V}=e;return r.set((1-(x+m))*C,(d+M)*C,(f-g)*C,0,(d-M)*b,(1-(l+m))*b,(p+w)*b,0,(f+g)*R,(p-w)*R,(1-(l+x))*R,0,z,D,V,1)}function hu(t,e,n,r,s=new _){let{x:i,y:o,z:a,w:c}=t,u=i+i,h=o+o,l=a+a,d=i*u,f=i*h,x=i*l,p=o*h,m=o*l,w=a*l,g=c*u,M=c*h,C=c*l,{x:b,y:R,z}=n,{x:D,y:V,z:A}=r,{x:S,y:L,z:F}=e,P=(1-(p+w))*b,B=(f+C)*b,H=(x-M)*b,W=(f-C)*R,j=(1-(d+w))*R,ot=(m+g)*R,te=(x+M)*z,ee=(m-g)*z,ne=(1-(d+p))*z;return s.set(P,B,H,0,W,j,ot,0,te,ee,ne,0,S+D-(P*D+W*V+te*A),L+V-(B*D+j*V+ee*A),F+A-(H*D+ot*V+ne*A),1)}function fs(t,e,n=!0,r=new _){let{x:s,y:i,z:o}=e,a=Math.sin(t.x),c=Math.cos(t.x),u=Math.sin(t.y),h=Math.cos(t.y),l=s,d=i,f=o,x=-a,p=0-x*u,m=0-c*u,w=x*h,g=c*h;return n||(l=h*s+u*o,d=p*s+c*i+w*o,f=m*s+a*i+g*o),r.set(h,p,m,0,0,c,a,0,u,w,g,0,l,d,f,1)}function lu(t,e=new _){let{x:n,y:r,z:s}=t;return e.set(n,0,0,0,0,r,0,0,0,0,s,0,0,0,0,1)}function fu(t,e=new _){let{x:n,y:r,z:s}=t;return e.set(1,0,0,0,0,1,0,0,0,0,1,0,n,r,s,1)}function du(t,e=new _){let n=Math.cos(t),r=Math.sin(t);return e.set(1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1)}function xu(t,e=new _){let n=Math.cos(t),r=Math.sin(t);return e.set(n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1)}function yu(t,e=new _){let n=Math.cos(t),r=Math.sin(t);return e.set(n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1)}function mu(t,e,n,r,s,i,o=new _){let a=1/(e-t),c=1/(r-n),u=1/(s-i);return o.set(s*2*a,0,0,0,0,s*2*c,0,0,(e+t)*a,(r+n)*c,(i+s)*u,-1,0,0,i*s*2*u,0)}var E=class{constructor(t=0,e=0,n=0){this.set(t,e,n)}set(t=0,e=0,n=0){return this.x=t,this.y=e,this.z=n,this}toArray(t=[],e=0){let{x:n,y:r,z:s}=this;return t[e]=n,t[e+1]=r,t[e+2]=s,t}fromArray(t,e=0){return this.set(t[e],t[e+1],t[e+2])}toString(){let{x:t,y:e,z:n}=this;return`{ x=${t}, y=${e}, z=${n} }`}};function ds(t,e=new E){let[n,r,s,i,o,a,c,u,h,l,d]=t.data;return e.set(Math.hypot(n,r,s),Math.hypot(o,a,c),Math.hypot(h,l,d))}var k=class{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r,this.onChange=Et}set(t=0,e=0,n=0,r=1){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChange(this),this}set x(t){let e=this._x;this._x=t,t!==e&&this.onChange(this)}get x(){return this._x}set y(t){let e=this._y;this._y=t,t!==e&&this.onChange(this)}get y(){return this._y}set z(t){let e=this._z;this._z=t,t!==e&&this.onChange(this)}get z(){return this._z}set w(t){let e=this._w;this._w=t,t!==e&&this.onChange(this)}get w(){return this._w}toArray(t=[],e=0){let{x:n,y:r,z:s,w:i}=this;return t[e]=n,t[e+1]=r,t[e+2]=s,t[e+3]=i,t}fromArray(t,e=0){return this.set(t[e],t[e+1],t[e+2],t[e+3])}destroy(){this.onChange=Et}toString(){let{x:t,y:e,z:n,w:r}=this;return`{ x=${t}, y=${e}, z=${n}, w=${r} }`}};function pu(t,e=new k){let n=ds(t),r=1/n.x,s=1/n.y,i=1/n.z,[o,a,c,u,h,l,d,f,x,p,m]=t.data,w=o*r,g=a*s,M=c*i,C=h*r,b=l*s,R=d*i,z=x*r,D=p*s,V=m*i,A=w+b+V,S=0;return A>0?(S=Math.sqrt(A+1)*2,e.set((R-D)/S,(z-M)/S,(g-C)/S,.25*S)):w>b&&w>V?(S=Math.sqrt(1+w-b-V)*2,e.set(.25*S,(g+C)/S,(z+M)/S,(R-D)/S)):b>V?(S=Math.sqrt(1+b-w-V)*2,e.set((g+C)/S,.25*S,(R+D)/S,(z-M)/S)):(S=Math.sqrt(1+V-w-b)*2,e.set((z+M)/S,(R+D)/S,.25*S,(g-C)/S))}function wu(t,e=new E){let n=t.data;return e.set(n[12],n[13],n[14])}function Se(t=new _){return t.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}function ve(t,e=new _){let[n,r,s,i,o,a,c,u,h,l,d,f,x,p,m,w]=t.data,g=d*w-m*f,M=l*w-p*f,C=l*m-p*d,b=h*w-x*f,R=h*m-d*x,z=h*p-x*l,D=+(a*g-c*M+u*C),V=-(o*g-c*b+u*R),A=+(o*M-a*b+u*z),S=-(o*C-a*R+c*z),L=n*D+r*V+s*A+i*S;if(L===0)return e;let F=1/L,P=c*w-m*u,B=a*w-p*u,H=a*m-p*c,W=o*w-x*u,j=o*m-x*c,ot=o*p-x*a,te=c*f-d*u,ee=a*f-l*u,ne=a*d-l*c,rs=o*f-h*u,ss=o*d-h*c,is=o*l-h*a,Oc=-(r*g-s*M+i*C),Bc=+(n*g-s*b+i*R),Nc=-(n*M-r*b+i*z),kc=+(n*C-r*R+s*z),Uc=+(r*P-s*B+i*H),Wc=-(n*P-s*W+i*j),Hc=+(n*B-r*W+i*ot),qc=-(n*H-r*j+s*ot),Kc=-(r*te-s*ee+i*ne),Qc=+(n*te-s*rs+i*ss),Xc=-(n*ee-r*rs+i*is),Yc=+(n*ne-r*ss+s*is);return e.set(D*F,Oc*F,Uc*F,Kc*F,V*F,Bc*F,Wc*F,Qc*F,A*F,Nc*F,Hc*F,Xc*F,S*F,kc*F,qc*F,Yc*F)}function xs(t,e,n,r=new _){let{x:s,y:i,z:o}=t,{x:a,y:c,z:u}=n,{x:h,y:l,z:d}=e;if(Math.abs(s-h)<1e-5&&Math.abs(i-l)<1e-5&&Math.abs(o-d)<1e-5)return Se(r);let f=s-h,x=i-l,p=o-d,m=1/Math.hypot(f,x,p);f*=m,x*=m,p*=m;let w=c*p-u*x,g=u*f-a*p,M=a*x-c*f;m=Math.hypot(w,g,M),m?(m=1/m,w*=m,g*=m,M*=m):(w=0,g=0,M=0);let C=x*M-p*g,b=p*w-f*M,R=f*g-x*w;return m=Math.hypot(C,b,R),m?(m=1/m,C*=m,b*=m,R*=m):(C=0,b=0,R=0),r.set(w,C,f,0,g,b,x,0,M,R,p,0,-(w*s+g*i+M*o),-(C*s+b*i+R*o),-(f*s+x*i+p*o),1)}function It(t,e,n=new _){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=t.data,[M,C,b,R,z,D,V,A,S,L,F,P,B,H,W,j]=e.data;return n.set(M*r+C*a+b*l+R*p,C*s+C*c+b*d+R*m,b*i+C*u+b*f+R*w,R*o+C*h+b*x+R*g,z*r+D*a+V*l+A*p,z*s+D*c+V*d+A*m,z*i+D*u+V*f+A*w,z*o+D*h+V*x+A*g,S*r+L*a+F*l+P*p,S*s+L*c+F*d+P*m,S*i+L*u+F*f+P*w,S*o+L*h+F*x+P*g,B*r+H*a+W*l+j*p,B*s+H*c+W*d+j*m,B*i+H*u+W*f+j*w,B*o+H*h+W*x+j*g)}function gu(t,e,n=new _){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=t.data;return n.set(r*e,s*e,i*e,o*e,a*e,c*e,u*e,h*e,l*e,d*e,f*e,x*e,p*e,m*e,w*e,g*e)}function Mu(t,e,n,r=new _){let[s,i,o,a,c,u,h,l,d,f,x,p,m,w,g,M]=t.data,[C,b,R,z,D,V,A,S,L,F,P,B,H,W,j,ot]=e.data;return r.set(s+C*n,i+b*n,o+R*n,a+z*n,c+D*n,u+V*n,h+A*n,l+S*n,d+L*n,f+F*n,x+P*n,p+B*n,m+H*n,w+W*n,g+j*n,M+ot*n)}function ys(t,e,n,r,s,i,o=new _){let a=1/(t-e),c=1/(n-r),u=1/(s-i);return o.set(-2*a,0,0,0,0,-2*c,0,0,0,0,2*u,0,(t+e)*a,(r+n)*c,(i+s)*u,1)}function Ee(t,e,n,r,s=new _){let i=1/Math.tan(t/2),o=-1,a=-2*n;if(r!==null&&r!==Infinity){let c=1/(n-r);o=(r+n)*c,a=2*r*n*c}return s.set(i/e,0,0,0,0,i,0,0,0,0,o,-1,0,0,a,0)}function Cu(t,e,n,r=new _){let s=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+a),u=2/(s+i);return r.set(c,0,0,0,0,u,0,0,-((o-a)*c*.5),(s-i)*u*.5,n/(e-n),-1,0,0,n*e/(e-n),0)}function bu(t,e,n,r=new _){let{x:s,y:i,z:o}=n,a=Math.hypot(s,i,o);if(a<1e-5)return null;a=1/a,s*=a,i*=a,o*=a;let c=Math.sin(e),u=Math.cos(e),h=1-u,[l,d,f,x,p,m,w,g,M,C,b,R,z,D,V,A]=t.data,S=s*s*h+u,L=i*s*h+o*c,F=o*s*h-i*c,P=s*i*h-o*c,B=i*i*h+u,H=o*i*h+s*c,W=s*o*h+i*c,j=i*o*h-s*c,ot=o*o*h+u;return r.set(l*S+p*L+M*F,d*S+m*L+C*F,f*S+w*L+b*F,x*S+g*L+R*F,l*P+p*B+M*H,d*P+m*B+C*H,f*P+w*B+b*H,x*P+g*B+R*H,l*W+p*j+M*ot,d*W+m*j+C*ot,f*W+w*j+b*ot,x*W+g*j+R*ot,z,D,V,A)}function Ru(t,e,n=new _){let r=Math.sin(e),s=Math.cos(e),[i,o,a,c,u,h,l,d,f,x,p,m,w,g,M,C]=t.data;return n.set(i,o,a,c,u*s+f*r,h*s+x*r,l*s+p*r,d*s+m*r,f*s-u*r,x*s-h*r,p*s-l*r,m*s-d*r,w,g,M,C)}function Tu(t,e,n=new _){let r=Math.sin(e),s=Math.cos(e),[i,o,a,c,u,h,l,d,f,x,p,m,w,g,M,C]=t.data;return n.set(i*s-f*r,o*s-x*r,a*s-p*r,c*s-m*r,u,h,l,d,i*r+f*s,o*r+x*s,a*r+p*s,c*r+m*s,w,g,M,C)}function Su(t,e,n=new _){let r=Math.sin(e),s=Math.cos(e),[i,o,a,c,u,h,l,d,f,x,p,m,w,g,M,C]=t.data;return n.set(i*s+u*r,o*s+h*r,a*s+l*r,c*s+d*r,u*s-i*r,h*s-o*r,l*s-a*r,d*s-c*r,f,x,p,m,w,g,M,C)}function vu(t,e,n=new _){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=t.data,{x:M,y:C,z:b}=e;return n.set(r*M,s*M,i*M,o*M,a*C,c*C,u*C,h*C,l*b,d*b,f*b,x*b,p,m,w,g)}function Eu(t,e){let n=t.data,{x:r,y:s,z:i}=e;return n[12]=r,n[13]=s,n[14]=i,t.onChange(t),t}function Au(t,e,n,r){let s=t.data;return s[12]=e,s[13]=n,s[14]=r,t.onChange(t),t}function zu(t,e,n=new _){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=t.data,[M,C,b,R,z,D,V,A,S,L,F,P,B,H,W,j]=e.data;return n.set(r-M,s-C,i-b,o-R,a-z,c-D,u-V,h-A,l-S,d-L,f-F,x-P,p-B,m-H,w-W,g-j)}function Du(t,e,n,r=new _){let{x:s,y:i,z:o}=t,{x:a,y:c,z:u}=n,{x:h,y:l,z:d}=e,f=s-h,x=i-l,p=o-d,m=f*f+x*x+p*p;m>0&&(m=1/Math.sqrt(m),f*=m,x*=m,p*=m);let w=c*p-u*x,g=u*f-a*p,M=a*x-c*f;return m=w*w+g*g+M*M,m>0&&(m=1/Math.sqrt(m),w*=m,g*=m,M*=m),r.set(w,g,M,0,x*M-p*g,p*w-f*M,f*g-x*w,0,f,x,p,0,s,i,o,1)}function Fu(t,e,n=new _){let{x:r,y:s,z:i}=e,o=t.data,[a,c,u,h,l,d,f,x,p,m,w,g,M,C,b,R]=o;return t===n?(o[12]=a*r+l*s+p*i+M,o[13]=c*r+d*s+m*i+C,o[14]=u*r+f*s+w*i+b,o[15]=h*r+x*s+g*i+R):n.set(a,c,u,h,l,d,f,x,p,m,w,g,a*r+l*s+p*i+M,c*r+d*s+m*i+C,u*r+f*s+w*i+b,h*r+x*s+g*i+R),n}function ms(t,e,n,r,s=new _){let i=t.data,[o,a,c,u,h,l,d,f,x,p,m,w,g,M,C,b]=i;return t===s?(i[12]=o*e+h*n+x*r+g,i[13]=a*e+l*n+p*r+M,i[14]=c*e+d*n+m*r+C,i[15]=u*e+f*n+w*r+b):s.set(o,a,c,u,h,l,d,f,x,p,m,w,o*e+h*n+x*r+g,a*e+l*n+p*r+M,c*e+d*n+m*r+C,u*e+f*n+w*r+b),s}function ps(t,e=new _){let[n,r,s,i,o,a,c,u,h,l,d,f,x,p,m,w]=t.data;return e.set(n,o,h,x,r,a,l,p,s,c,d,m,i,u,f,w)}function Vu(t){return t.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}var $=class{constructor(t=1,e=0,n=0,r=1,s=0,i=0){this.set(t,e,n,r,s,i)}set(t=1,e=0,n=0,r=1,s=0,i=0){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=s,this.ty=i,this}identity(){return this.set()}toArray(){let{a:t,b:e,c:n,d:r,tx:s,ty:i}=this;return[t,e,n,r,s,i]}fromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5])}};function yt(t,e,n){return t.width<=0||t.height<=0?!1:t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}var J=class{constructor(t=0,e=0,n=0,r=0){this.set(t,e,n,r)}set(t=0,e=0,n=0,r=0){return this.x=t,this.y=e,this.width=n,this.height=r,this}contains(t,e){return yt(this,t,e)}set right(t){t<=this.x?this.width=0:this.width=t-this.x}get right(){return this.x+this.width}set bottom(t){t<=this.y?this.height=0:this.height=t-this.y}get bottom(){return this.y+this.height}},gt=class{constructor(t,e=0,n=0){this._x=e,this._y=n,this.onChange=t}destroy(){this.onChange=Et}set(t=0,e=0){return this._x=t,this._y=e,this.onChange&&this.onChange(this),this}get x(){return this._x}set x(t){let e=this._x;this._x=t,e!==t&&this.onChange(this)}get y(){return this._y}set y(t){let e=this._y;this._y=t,e!==t&&this.onChange(this)}toArray(t=[],e=0){let{x:n,y:r}=this;return t[e]=n,t[e+1]=r,t}fromArray(t,e=0){return this.set(t[e],t[e+1])}toString(){let{x:t,y:e}=this;return`{ x=${t}, y=${e} }`}},gs={};v(gs,{AngleBetween:()=>_u,AngleBetweenY:()=>Iu,CounterClockwise:()=>Pu,NormalizeAngle:()=>Ms,ReverseAngle:()=>Ou,RotateAngleTo:()=>Bu,ShortestAngleBetween:()=>Nu,WrapAngle:()=>Cs,WrapAngleDegrees:()=>ku});function _u(t,e,n,r){return Math.atan2(r-e,n-t)}function Iu(t,e,n,r){return Math.atan2(n-t,r-e)}var Y={PI2:Math.PI*2,HALF_PI:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};function Pu(t){return t>Math.PI&&(t-=Y.PI2),Math.abs(((t+Y.HALF_PI)%Y.PI2-Y.PI2)%Y.PI2)}function Ms(t){return t=t%Y.PI2,t>=0?t:t+Y.PI2}function Ou(t){return Ms(t+Math.PI)}function Bu(t,e,n=.05){return t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=Y.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=Y.PI2:e-=Y.PI2),e>t?t+=n:e<t&&(t-=n))),t}function Nu(t,e){let n=e-t;if(n===0)return 0;let r=Math.floor((n- -180)/360);return n-r*360}function Ae(t,e,n){let r=n-e;return e+((t-e)%r+r)%r}function Cs(t){return Ae(t,-Math.PI,Math.PI)}function ku(t){return Ae(t,-180,180)}var os=class{constructor(){this._rotation=0,this.type="Camera",this.dirtyRender=!0;let t=rt.get();this.renderer=t.renderer,this.matrix=Se(),this.bounds=new J,this.worldTransform=new $,this.position=new gt(()=>this.updateTransform(),0,0),this.scale=new gt(()=>this.updateTransform(),1,1),this.origin=new gt(()=>this.updateTransform(),.5,.5),this.reset()}updateTransform(){let t=this.matrix.data,e=this.position.x,n=this.position.y,r=this.scale.x,s=this.scale.y,i=-e+this.width*this.origin.x,o=-n+this.height*this.origin.y,a=Math.sin(this.rotation),c=Math.cos(this.rotation),u=a+a,h=a*u,l=c*u,d=(1-h)*r,f=l*r,x=-l*s,p=(1-h)*s;t[0]=d,t[1]=f,t[4]=x,t[5]=p,t[12]=e+i-(d*i+x*o),t[13]=n+o-(f*i+p*o),this.worldTransform.set(c*r,a*r,-a*s,c*s,-e,-n);let m=this.width*(1/r),w=this.height*(1/s);this.bounds.set(i-m/2,o-w/2,m,w),this.dirtyRender=!0}reset(){let t=this.renderer.width,e=this.renderer.height;this.width=t,this.height=e,this.bounds.set(0,0,t,e)}set rotation(t){t!==this._rotation&&(this._rotation=Cs(t),this.updateTransform())}get rotation(){return this._rotation}destroy(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null}},wn=class{constructor(){this.type="StaticCamera",this.dirtyRender=!0;let t=rt.get();this.renderer=t.renderer,this.matrix=Se(),this.bounds=new J,this.worldTransform=new $,this.reset()}reset(){let t=this.renderer;if(t){let e=t.width,n=t.height;this.width=e,this.height=n}this.bounds.set(0,0,this.width,this.height)}destroy(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null}},Uu={};v(Uu,{Camera3D:()=>Wu});var bs={};v(bs,{GetQuatAngle:()=>Rs,GetQuatAngleTo:()=>Hu,GetQuatAreClose:()=>qu,GetQuatAxisAngle:()=>Ku,GetQuatLength:()=>Ts,GetQuatLengthSquared:()=>Qu,QuatAdd:()=>Xu,QuatAddScalar:()=>Yu,QuatClone:()=>ju,QuatConjugate:()=>$u,QuatCopyFrom:()=>re,QuatDot:()=>ze,QuatEquals:()=>Zu,QuatFromEulerAngles:()=>Ju,QuatFromEulerVector:()=>th,QuatFromRotationAxis:()=>eh,QuatFromRotationMatrix:()=>nh,QuatFuzzyEquals:()=>rh,QuatHermite:()=>sh,QuatInvert:()=>ih,QuatMultiply:()=>oh,QuatMultiplyByFloats:()=>ah,QuatNormalize:()=>vs,QuatRotateTowards:()=>ch,QuatRotateX:()=>As,QuatRotateY:()=>zs,QuatRotateZ:()=>Ds,QuatRotationAlphaBetaGamma:()=>uh,QuatRotationYawPitchRoll:()=>Pt,QuatScale:()=>Ss,QuatScaleAndAdd:()=>hh,QuatSetAxisAngle:()=>Fs,QuatSetFromUnitVectors:()=>lh,QuatSlerp:()=>Es,QuatSubtract:()=>fh,QuatSubtractScalar:()=>dh,QuatToEulerAngles:()=>xh,QuatZero:()=>yh,Quaternion:()=>k});function ze(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}function Rs(t,e){let n=ze(t,e);return Math.acos(2*n*n-1)}function q(t,e,n){return Math.max(e,Math.min(n,t))}function Hu(t,e){return 2*Math.acos(Math.abs(q(ze(t,e),-1,1)))}function qu(t,e){return ze(t,e)>=0}function Ku(t,e=new k){let n=Math.acos(t.w)*2,r=Math.sin(n/2);return r>1e-6?e.set(t.x/r,t.y/r,t.z/r):e.set(1,0,0),n}function Ts(t){let{x:e,y:n,z:r,w:s}=t;return Math.sqrt(e*e+n*n+r*r+s*s)}function Qu(t){let{x:e,y:n,z:r,w:s}=t;return e*e+n*n+r*r+s*s}function Xu(t,e,n=new k){return n.set(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}function Yu(t,e,n=new k){return n.set(t.x+e,t.y+e,t.z+e,t.w+e)}function ju(t){let{x:e,y:n,z:r,w:s}=t;return new k(e,n,r,s)}function $u(t,e=new k){let{x:n,y:r,z:s,w:i}=t;return e.set(n*-1,r*-1,s*-1,i)}function re(t,e){let{x:n,y:r,z:s,w:i}=t;return e.set(n,r,s,i)}function Zu(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}function Pt(t,e,n,r=new k){let s=n*.5,i=e*.5,o=t*.5,a=Math.sin(s),c=Math.cos(s),u=Math.sin(i),h=Math.cos(i),l=Math.sin(o),d=Math.cos(o);return r.set(d*u*c+l*h*a,l*h*c-d*u*a,d*h*a-l*u*c,d*h*c+l*u*a)}function Ju(t,e,n,r=new k){return Pt(e,t,n,r)}function th(t,e=new k){return Pt(t.y,t.x,t.z,e)}var Vs={};v(Vs,{BACKWARD:()=>wh,DOWN:()=>mh,FORWARD:()=>Ps,GetVec3Angle:()=>Mh,GetVec3Distance:()=>Ch,GetVec3DistanceSquared:()=>Os,GetVec3Length:()=>Bs,GetVec3LengthSquared:()=>bh,GetVec3ManhattanDistance:()=>Rh,GetVec3ManhattanLength:()=>Th,LEFT:()=>ph,RGBCallback:()=>At,RIGHT:()=>Is,UP:()=>Mn,Vec3:()=>E,Vec3Abs:()=>Sh,Vec3Add:()=>Cn,Vec3AddScalar:()=>vh,Vec3Backward:()=>Gs,Vec3Bezier:()=>Eh,Vec3Callback:()=>mt,Vec3CatmullRom:()=>Ah,Vec3Ceil:()=>zh,Vec3Center:()=>Dh,Vec3Clamp:()=>Fh,Vec3ClampLength:()=>Vh,Vec3ClampScalar:()=>Gh,Vec3Clone:()=>Lh,Vec3CopyFrom:()=>_h,Vec3Cross:()=>Ih,Vec3CrossNormalize:()=>bn,Vec3Divide:()=>Ph,Vec3DivideScalar:()=>Ns,Vec3Dot:()=>Ve,Vec3Down:()=>Ls,Vec3Equals:()=>Oh,Vec3Floor:()=>Bh,Vec3Forward:()=>De,Vec3Fract:()=>Nh,Vec3FromCylindricalCoords:()=>kh,Vec3FromSphericalCoords:()=>Uh,Vec3FuzzyEquals:()=>Wh,Vec3Hermite:()=>Hh,Vec3Inverse:()=>qh,Vec3IsNonUniform:()=>Kh,Vec3Left:()=>gn,Vec3Lerp:()=>Qh,Vec3Max:()=>Xh,Vec3Min:()=>Yh,Vec3Multiply:()=>jh,Vec3MultiplyByFloats:()=>$h,Vec3Negate:()=>Zh,Vec3Normalize:()=>lt,Vec3One:()=>Jh,Vec3Project:()=>tl,Vec3Random:()=>el,Vec3Reflect:()=>nl,Vec3Right:()=>Fe,Vec3RotateX:()=>rl,Vec3RotateY:()=>sl,Vec3RotateZ:()=>il,Vec3Round:()=>ol,Vec3RoundToZero:()=>al,Vec3Scale:()=>Ot,Vec3ScaleAndAdd:()=>Le,Vec3SetLength:()=>cl,Vec3Subtract:()=>Ge,Vec3SubtractScalar:()=>ul,Vec3TransformMat4:()=>Rn,Vec3TransformMat4Zero:()=>_e,Vec3TransformQuat:()=>Ie,Vec3Unproject:()=>hl,Vec3Up:()=>se,Vec3Zero:()=>_s,ZERO:()=>gh});function Gs(){return new E(0,0,-1)}function Ls(){return new E(0,-1,0)}function De(){return new E(0,0,1)}function gn(){return new E(-1,0,0)}function Fe(){return new E(1,0,0)}function se(){return new E(0,1,0)}function _s(){return new E(0,0,0)}var Mn=se(),mh=Ls(),ph=gn(),Is=Fe(),Ps=De(),wh=Gs(),gh=_s();function Ve(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function Mh(t,e){let{x:n,y:r,z:s}=t,{x:i,y:o,z:a}=e,c=Math.sqrt(n*n+r*r+s*s),u=Math.sqrt(i*i+o*o+a*a),h=c*u,l=h&&Ve(t,e)/h;return Math.acos(Math.min(Math.max(l,-1),1))}function Os(t,e){let n=t.x-e.x,r=t.y-e.y,s=t.z-e.z;return n*n+r*r+s*s}function Ch(t,e){return Math.sqrt(Os(t,e))}function Bs(t){let{x:e,y:n,z:r}=t;return Math.sqrt(e*e+n*n+r*r)}function bh(t){let{x:e,y:n,z:r}=t;return e*e+n*n+r*r}function Rh(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)+Math.abs(t.z-e.z)}function Th(t){return Math.abs(t.x)+Math.abs(t.y)+Math.abs(t.z)}var mt=class{constructor(t,e=0,n=0,r=0){this._x=e,this._y=n,this._z=r,this.onChange=t}destroy(){this.onChange=Et}set(t=0,e=0,n=0){return this._x=t,this._y=e,this._z=n,this.onChange&&this.onChange(this),this}get x(){return this._x}set x(t){let e=this._x;this._x=t,e!==t&&this.onChange(this)}get y(){return this._y}set y(t){let e=this._y;this._y=t,e!==t&&this.onChange(this)}get z(){return this._z}set z(t){let e=this._z;this._z=t,e!==t&&this.onChange(this)}toArray(t=[],e=0){let{x:n,y:r,z:s}=this;return t[e]=n,t[e+1]=r,t[e+2]=s,t}fromArray(t,e=0){return this.set(t[e],t[e+1],t[e+2])}toString(){let{x:t,y:e,z:n}=this;return`{ x=${t}, y=${e}, z=${n} }`}},At=class extends mt{constructor(t,e=0,n=0,r=0){super(t,e,n,r)}set r(t){this.x=t}get r(){return this.x}set g(t){this.y=t}get g(){return this.y}set b(t){this.z=t}get b(){return this.z}toString(){let{x:t,y:e,z:n}=this;return`[ r=${t}, g=${e}, b=${n} ]`}};function Sh(t,e=new E){return e.set(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))}function Cn(t,e,n=new E){return n.set(t.x+e.x,t.y+e.y,t.z+e.z)}function vh(t,e,n=new E){return n.set(t.x+e,t.y+e,t.z+e)}function ft(t,e,n,r,s){let i=1-s,o=i*i,a=s*s,c=o*i,u=3*s*o,h=3*a*i,l=a*s;return t*c+e*u+n*h+r*l}function Eh(t,e,n,r,s,i=new E){return i.set(ft(s,t.x,e.x,n.x,r.x),ft(s,t.y,e.y,n.y,r.y),ft(s,t.z,e.z,n.z,r.z))}function tt(t,e,n,r,s){let i=(r-e)*.5,o=(s-n)*.5,a=t*t,c=t*a;return(2*n-2*r+i+o)*c+(-3*n+3*r-2*i-o)*a+i*t+n}function Ah(t,e,n,r,s,i=new E){return i.set(tt(s,t.x,e.x,n.x,r.x),tt(s,t.y,e.y,n.y,r.y),tt(s,t.z,e.z,n.z,r.z))}function zh(t,e=new E){return e.set(Math.ceil(t.x),Math.ceil(t.y),Math.ceil(t.z))}function Ot(t,e,n=new E){return n.set(t.x*e,t.y*e,t.z*e)}function Dh(t,e,n=new E){return Cn(t,e,n),Ot(n,.5,n)}function Fh(t,e,n,r=new E){return r.set(q(t.x,e.x,n.x),q(t.y,e.y,n.y),q(t.z,e.z,n.z))}function Ns(t,e,n=new E){let{x:r,y:s,z:i}=t;return n.set(r/e,s/e,i/e)}function Vh(t,e,n,r=new E){let s=Bs(t);return Ns(t,s||1,r),Ot(r,q(e,n,s),r)}function Gh(t,e,n,r=new E){return r.set(q(t.x,e,n),q(t.y,e,n),q(t.z,e,n))}function Lh(t){let{x:e,y:n,z:r}=t;return new E(e,n,r)}function _h(t,e){let{x:n,y:r,z:s}=t;return e.set(n,r,s)}function Ih(t,e,n=new E){let{x:r,y:s,z:i}=t,{x:o,y:a,z:c}=e;return n.set(s*c-i*a,i*o-r*c,r*a-s*o)}function bn(t,e,n=new E){let{x:r,y:s,z:i}=t,{x:o,y:a,z:c}=e,u=s*c-i*a,h=i*o-r*c,l=r*a-s*o,d=u*u+h*h+l*l;return d>0&&(d=1/Math.sqrt(d)),n.set(u*d,h*d,l*d)}function Ph(t,e,n=new E){return n.set(t.x/e.x,t.y/e.y,t.z/e.z)}function Oh(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}function Bh(t,e=new E){return e.set(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}function Nh(t,e=new E){return e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y),t.z-Math.floor(t.z))}function kh(t,e,n,r=new E){return r.set(t*Math.sin(e),n,t*Math.cos(e))}function Uh(t,e,n,r=new E){let s=Math.sin(e)*t;return r.set(s*Math.sin(n),Math.cos(e)*t,s*Math.cos(n))}function et(t,e,n=1e-4){return Math.abs(t-e)<n}function Wh(t,e,n=1e-4){return et(t.x,e.x,n)&&et(t.y,e.y,n)&&et(t.z,e.z,n)}function nt(t,e,n,r,s){let i=s*s,o=i*(2*s-3)+1,a=i*(s-2)+s,c=i*(s-1),u=i*(3-2*s);return t*o+e*a+n*c+r*u}function Hh(t,e,n,r,s,i=new E){return i.set(nt(s,t.x,e.x,n.x,r.x),nt(s,t.y,e.y,n.y,r.y),nt(s,t.z,e.z,n.z,r.z))}function qh(t,e=new E){return e.set(1/t.x,1/t.y,1/t.z)}function Kh(t){let e=Math.abs(t.x),n=Math.abs(t.y),r=Math.abs(t.z);return e!==n||e!==r||n!==r}function Qh(t,e,n,r=new E){let{x:s,y:i,z:o}=t;return r.set(s+n*(e.x-s),i+n*(e.y-i),o+n*(e.z-o))}function Xh(t,e,n=new E){let{x:r,y:s,z:i}=t,{x:o,y:a,z:c}=e;return n.set(Math.max(r,o),Math.max(s,a),Math.max(i,c))}function Yh(t,e,n=new E){let{x:r,y:s,z:i}=t,{x:o,y:a,z:c}=e;return n.set(Math.min(r,o),Math.min(s,a),Math.min(i,c))}function jh(t,e,n=new E){return n.set(t.x*e.x,t.y*e.y,t.z*e.z)}function $h(t,e,n,r,s=new E){return s.set(t.x*e,t.y*n,t.z*r)}function Zh(t,e=new E){return e.set(-t.x,-t.y,-t.z)}function lt(t,e=new E){let{x:n,y:r,z:s}=t,i=n*n+r*r+s*s;return i>0&&(i=1/Math.sqrt(i)),e.set(n*i,r*i,s*i)}function Jh(){return new E(1,1,1)}function Rn(t,e,n=new E){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=e.data,{x:M,y:C,z:b}=t,R=o*M+h*C+x*b+g;return R=R||1,n.set((r*M+a*C+l*b+p)/R,(s*M+c*C+d*b+m)/R,(i*M+u*C+f*b+w)/R)}var ks=new _,Pe=new _;function tl(t,e,n,r,s=new E){let{x:i,y:o,width:a,height:c}=r;return ks.set(a/2,0,0,0,0,-c/2,0,0,0,0,.5,0,i+a/2,c/2+o,.5,1),It(e,n,Pe),It(Pe,ks,Pe),Rn(t,Pe,s)}function el(t,e=1,n=new E){let r=Math.random()*2*Math.PI,s=Math.random()*2-1,i=Math.sqrt(1-s*s)*e;return n.set(Math.cos(r)*i,Math.sin(r)*i,s*e)}function Ge(t,e,n=new E){return n.set(t.x-e.x,t.y-e.y,t.z-e.z)}function nl(t,e,n=new E){return Ot(e,2*Ve(t,e),n),Ge(t,n,n)}function rl(t,e,n,r=new E){let{x:s,y:i,z:o}=t,{x:a,y:c,z:u}=e,h=s-a,l=i-c,d=o-u,f=h,x=l*Math.cos(n)-d*Math.sin(n),p=l*Math.sin(n)+d*Math.cos(n);return r.set(f+a,x+c,p+u)}function sl(t,e,n,r=new E){let{x:s,y:i,z:o}=t,{x:a,y:c,z:u}=e,h=s-a,l=i-c,d=o-u,f=d*Math.sin(n)+h*Math.cos(n),x=l,p=d*Math.cos(n)-h*Math.sin(n);return r.set(f+a,x+c,p+u)}function il(t,e,n,r=new E){let{x:s,y:i,z:o}=t,{x:a,y:c,z:u}=e,h=s-a,l=i-c,d=o-u,f=h*Math.cos(n)-l*Math.sin(n),x=h*Math.sin(n)+l*Math.cos(n),p=d;return r.set(f+a,x+c,p+u)}function ol(t,e=new E){return e.set(Math.round(t.x),Math.round(t.y),Math.round(t.z))}function al(t,e=new E){return e.set(t.x<0?Math.ceil(t.x):Math.floor(t.x),t.y<0?Math.ceil(t.y):Math.floor(t.y),t.z<0?Math.ceil(t.z):Math.floor(t.z))}function Le(t,e,n,r=new E){return r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n)}function cl(t,e,n=new E){return lt(t,n),Ot(n,e,n)}function ul(t,e,n=new E){return n.set(t.x-e,t.y-e,t.z-e)}function _e(t,e,n=new E){let[r,s,i,o,a,c,u,h,l,d,f]=e.data,{x,y:p,z:m}=t;return n.set(r*x+a*p+l*m,s*x+c*p+d*m,i*x+u*p+f*m)}function Ie(t,e,n=new E){let{x:r,y:s,z:i,w:o}=e,{x:a,y:c,z:u}=t,h=s*u-i*c,l=i*a-r*u,d=r*c-s*a,f=s*d-i*l,x=i*h-r*d,p=r*l-s*h,m=o*2;return h*=m,l*=m,d*=m,f*=2,x*=2,p*=2,n.set(a+h+f,c+l+x,u+d+p)}var zt=new _,ie=new E;function hl(t,e,n,r,s,i,o=new E){It(r,s,zt),It(zt,i,zt),ve(zt,zt);let{x:a,y:c,z:u}=t;ie.set(a/e*2-1,-(c/n*2-1),2*u-1),Rn(ie,zt,o);let h=zt.data,l=ie.x*h[3]+ie.y*h[7]+ie.z*h[11]+h[15];return Ot(o,1/l,o)}function eh(t,e,n=new k){let r=Math.sin(e/2);lt(t,t);let{x:s,y:i,z:o}=t;return n.set(s*r,i*r,o*r,Math.cos(e/2))}function nh(t,e=new k){let[n,r,s,i,o,a,c,u,h,l,d]=t.data,f=n+a+d,x;return f>0?(x=.5/Math.sqrt(f+1),e.set((c-l)*x,(h-s)*x,(r-o)*x,.25/x)):n>a&&n>d?(x=2*Math.sqrt(1+n-a-d),e.set(.25*x,(o+r)/x,(h+s)/x,(c-l)/x)):a>d?(x=2*Math.sqrt(1+a-n-d),e.set((o+r)/x,.25*x,(l+c)/x,(h-s)/x)):(x=2*Math.sqrt(1+d-n-a),e.set((h+s)/x,(l+c)/x,.25*x,(r-o)/x))}function rh(t,e,n=1e-4){return et(t.x,e.x,n)&&et(t.y,e.y,n)&&et(t.z,e.z,n)&&et(t.w,e.w,n)}function sh(t,e,n,r,s,i=new k){return i.set(nt(s,t.x,e.x,n.x,r.x),nt(s,t.y,e.y,n.y,r.y),nt(s,t.z,e.z,n.z,r.z),nt(s,t.w,e.w,n.w,r.w))}function ih(t,e=new k){let{x:n,y:r,z:s,w:i}=t,o=n*n+r*r+s*s+i*i,a=o?1/o:0;return e.set(-n*a,-r*a,-s*a,i*a)}function oh(t,e,n=new k){let{x:r,y:s,z:i,w:o}=t,{x:a,y:c,z:u,w:h}=e;return n.set(r*h+o*a+s*u-i*c,s*h+o*c+i*a-r*u,i*h+o*u+r*c-s*a,o*h-r*a-s*c-i*u)}function ah(t,e,n,r,s,i=new k){return i.set(t.x*e,t.y*n,t.z*r,t.w*s)}function Ss(t,e,n=new k){let{x:r,y:s,z:i,w:o}=t;return n.set(r*e,s*e,i*e,o*e)}function vs(t,e=new k){let n=Ts(t);return n===0?e.set(0,0,0,1):Ss(t,n,e)}function Es(t,e,n,r=new k){if(n===0)return re(t,r);if(n===1)return re(e,r);let{x:s,y:i,z:o,w:a}=t,{x:c,y:u,z:h,w:l}=e,d=a*l+s*c+i*u+o*h;if(d<0?(r.set(-c,-u,-h,-l),d=-d):re(e,r),d>=1)return r.set(s,i,o,a);let f=1-d*d;if(f<=Number.EPSILON){let g=1-n;return r.set(g*s+n*r.x,g*i+n*r.y,g*o+n*r.z,g*a+n*r.w),vs(r,r)}let x=Math.sqrt(f),p=Math.atan2(x,d),m=Math.sin((1-n)*p)/x,w=Math.sin(n*p)/x;return r.set(s*m+r.x*w,i*m+r.y*w,o*m+r.z*w,a*m+r.w*w)}function ch(t,e,n,r=new k){let s=Rs(t,e);if(s===0)return re(t,r);let i=Math.min(1,n/s);return Es(t,e,i,r)}function As(t,e,n=new k){e*=.5;let{x:r,y:s,z:i,w:o}=t,a=Math.sin(e),c=Math.cos(e);return n.set(r*c+o*a,s*c+i*a,i*c-s*a,o*c-r*a)}function zs(t,e,n=new k){e*=.5;let{x:r,y:s,z:i,w:o}=t,a=Math.sin(e),c=Math.cos(e);return n.set(r*c-i*a,s*c+o*a,i*c+r*a,o*c-s*a)}function Ds(t,e,n=new k){e*=.5;let{x:r,y:s,z:i,w:o}=t,a=Math.sin(e),c=Math.cos(e);return n.set(r*c+s*a,s*c-r*a,i*c+o*a,o*c-i*a)}function uh(t,e,n,r=new k){let s=(n+t)*.5,i=(n-t)*.5,o=e*.5;return r.set(Math.cos(i)*Math.sin(o),Math.sin(i)*Math.sin(o),Math.sin(s)*Math.cos(o),Math.cos(s)*Math.cos(o))}function hh(t,e,n,r=new k){return r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n,t.w+e.w*n)}function Fs(t,e,n=new k){let{x:r,y:s,z:i}=t;e*=.5;let o=Math.sin(e);return n.set(r*o,s*o,i*o,Math.cos(e))}function lh(t,e,n,r=new k){let{x:s,y:i,z:o}=e,{x:a,y:c,z:u}=n,h=1e-6,l=Ve(e,n)+1;return l<h?(l=0,Math.abs(s)>Math.abs(o)?r.set(-i,s,0,l):r.set(0,-o,i,l)):r.set(i*u-o*c,o*a-s*u,s*c-i*a,l)}function fh(t,e,n=new k){return n.set(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)}function dh(t,e,n=new k){let{x:r,y:s,z:i,w:o}=t;return n.set(r-e,s-e,i-e,o-e)}function xh(t,e=new E){let{x:n,y:r,z:s,w:i}=t,o=i*i,a=s*s,c=n*n,u=r*r,h=r*s-n*i,l=.4999999;return h<-l?e.set(Math.PI/2,2*Math.atan2(r,i),0):h>l?e.set(-Math.PI/2,2*Math.atan2(r,i),0):e.set(Math.asin(-2*(s*r-n*i)),Math.atan2(2*(s*n+r*i),a-c-u+o),Math.atan2(2*(n*r+s*i),-a-c+u+o))}function yh(){return new k(0,0,0,0)}var ll={};v(ll,{Angle:()=>gs,Average:()=>fl,Bernstein:()=>qs,Between:()=>Js,Bezier:()=>ft,CatmullRom:()=>tt,CeilTo:()=>dl,Clamp:()=>q,DegToRad:()=>oe,Difference:()=>xl,Easing:()=>Us,Factorial:()=>Oe,FloatBetween:()=>yl,FloorTo:()=>ml,FromPercent:()=>ae,Fuzzy:()=>Ws,GetSpeed:()=>pl,Hermite:()=>nt,Interpolation:()=>Hs,Linear:()=>Be,MATH_CONST:()=>Y,Matrix2D:()=>Xs,Matrix4:()=>hs,MaxAdd:()=>wl,MinSub:()=>gl,Percent:()=>Ml,Pow2:()=>Ys,Quaternion:()=>bs,RadToDeg:()=>Cl,RoundAwayFromZero:()=>Gu,RoundTo:()=>bl,SinCosTableGenerator:()=>Rl,SmoothStep:()=>Ks,SmootherStep:()=>Qs,Snap:()=>js,Vec2:()=>$s,Vec3:()=>Vs,Vec4:()=>Zs,Within:()=>Tl,Wrap:()=>Ae});var Us={};v(Us,{Back:()=>ti,Bounce:()=>ei,Circular:()=>ni,Cubic:()=>ri,Elastic:()=>si,Expo:()=>ii,GetEase:()=>oi,Linear:()=>li,Quadratic:()=>ai,Quartic:()=>ci,Quintic:()=>ui,Sine:()=>hi,Stepped:()=>fi});var ti={};v(ti,{In:()=>di,InOut:()=>xi,Out:()=>Tn});function di(t,e=1.70158){return t*t*((e+1)*t-e)}function xi(t,e=1.70158){let n=e*1.525;return(t*=2)<1?.5*(t*t*((n+1)*t-n)):.5*((t-=2)*t*((n+1)*t+n)+2)}function Tn(t,e=1.70158){return--t*t*((e+1)*t+e)+1}var ei={};v(ei,{In:()=>yi,InOut:()=>mi,Out:()=>Sn});function yi(t){return t=1-t,t<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}function mi(t){let e=!1;return t<.5?(t=1-t*2,e=!0):t=t*2-1,t<1/2.75?t=7.5625*t*t:t<2/2.75?t=7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?t=7.5625*(t-=2.25/2.75)*t+.9375:t=7.5625*(t-=2.625/2.75)*t+.984375,e?(1-t)*.5:t*.5+.5}function Sn(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}var ni={};v(ni,{In:()=>pi,InOut:()=>wi,Out:()=>vn});function pi(t){return 1-Math.sqrt(1-t*t)}function wi(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}function vn(t){return Math.sqrt(1- --t*t)}var ri={};v(ri,{In:()=>gi,InOut:()=>Mi,Out:()=>Ne});function gi(t){return t*t*t}function Mi(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}function Ne(t){return--t*t*t+1}var si={};v(si,{In:()=>Ci,InOut:()=>bi,Out:()=>En});function Ci(t,e=.1,n=.1){if(t===0)return 0;if(t===1)return 1;{let r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),-(e*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n))}}function bi(t,e=.1,n=.1){if(t===0)return 0;if(t===1)return 1;{let r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?-.5*(e*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)):e*Math.pow(2,-10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)*.5+1}}function En(t,e=.1,n=.1){if(t===0)return 0;if(t===1)return 1;{let r=n/4;return e<1?e=1:r=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-r)*(2*Math.PI)/n)+1}}var ii={};v(ii,{In:()=>Ri,InOut:()=>Ti,Out:()=>An});function Ri(t){return Math.pow(2,10*(t-1))-.001}function Ti(t){return t==0?0:t==1?1:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}function An(t){return 1-Math.pow(2,-10*t)}var oi={};v(oi,{GetEase:()=>Sl});var ai={};v(ai,{In:()=>Si,InOut:()=>vi,Out:()=>ke});function Si(t){return t*t}function vi(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}function ke(t){return t*(2-t)}var ci={};v(ci,{In:()=>Ei,InOut:()=>Ai,Out:()=>Ue});function Ei(t){return t*t*t*t}function Ai(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}function Ue(t){return-(--t*t*t*t-1)}var ui={};v(ui,{In:()=>zi,InOut:()=>Di,Out:()=>We});function zi(t){return t*t*t*t*t}function Di(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}function We(t){return(t=t-1)*t*t*t*t+1}var hi={};v(hi,{In:()=>Fi,InOut:()=>Vi,Out:()=>zn});function Fi(t){return t===0?0:t===1?1:1-Math.cos(t*Math.PI/2)}function Vi(t){return t===0?0:t===1?1:.5*(1-Math.cos(Math.PI*t))}function zn(t){return t===0?0:t===1?1:Math.sin(t*Math.PI/2)}var li={};v(li,{Linear:()=>He});function He(t){return t}var fi={};v(fi,{Stepped:()=>Gi});function Gi(t,e=1){return t<=0?0:t>=1?1:((e*t|0)+1)*(1/e)}var Li=new Map([["power0",He],["power1",ke],["power2",Ne],["power3",Ue],["power4",We],["linear",He],["quad",ke],["cubic",Ne],["quart",Ue],["quint",We],["sine",zn],["expo",An],["circ",vn],["elastic",En],["back",Tn],["bounce",Sn],["stepped",Gi],["quad.in",Si],["cubic.in",gi],["quart.in",Ei],["quint.in",zi],["sine.in",Fi],["expo.in",Ri],["circ.in",pi],["elastic.in",Ci],["back.in",di],["bounce.in",yi],["quad.out",ke],["cubic.out",Ne],["quart.out",Ue],["quint.out",We],["sine.out",zn],["expo.out",An],["circ.out",vn],["elastic.out",En],["back.out",Tn],["bounce.out",Sn],["quad.inout",vi],["cubic.inout",Mi],["quart.inout",Ai],["quint.inout",Di],["sine.inout",Vi],["expo.inout",Ti],["circ.inout",wi],["elastic.inout",bi],["back.inout",xi],["bounce.inout",mi]]);function Sl(t){return t=t.toLowerCase(),t=t.replace("ease",""),Li.has(t)?Li.get(t):He}var Ws={};v(Ws,{FuzzyCeil:()=>vl,FuzzyEqual:()=>et,FuzzyFloor:()=>El,FuzzyGreaterThan:()=>Al,FuzzyLessThan:()=>zl});function vl(t,e=1e-4){return Math.ceil(t-e)}function El(t,e=1e-4){return Math.floor(t+e)}function Al(t,e,n=1e-4){return t>e-n}function zl(t,e,n=1e-4){return t<e+n}var Hs={};v(Hs,{BezierInterpolation:()=>Dl,CatmullRomInterpolation:()=>Fl,CubicBezierInterpolation:()=>Vl,LinearInterpolation:()=>Gl,QuadraticBezierInterpolation:()=>Ll,SmoothStepInterpolation:()=>_l,SmootherStepInterpolation:()=>Il});function Oe(t){if(t===0)return 1;let e=t;for(;--t;)e*=t;return e}function qs(t,e){return Oe(t)/Oe(e)/Oe(t-e)}function Dl(t,e){let n=0,r=t.length-1;for(let s=0;s<=r;s++)n+=Math.pow(1-e,r-s)*Math.pow(e,s)*t[s]*qs(r,s);return n}function Fl(t,e){let n=t.length-1,r=n*e,s=Math.floor(r);return t[0]===t[n]?(e<0&&(s=Math.floor(r=n*(1+e))),tt(r-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(tt(-r,t[0],t[0],t[1],t[1])-t[0]):e>1?t[n]-(tt(r-n,t[n],t[n],t[n-1],t[n-1])-t[n]):tt(r-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}function Pl(t,e){let n=1-t;return n*n*n*e}function Ol(t,e){let n=1-t;return 3*n*n*t*e}function Bl(t,e){return 3*(1-t)*t*t*e}function Nl(t,e){return t*t*t*e}function Vl(t,e,n,r,s){return Pl(t,e)+Ol(t,n)+Bl(t,r)+Nl(t,s)}function Be(t,e,n){return(e-t)*n+t}function Gl(t,e){let n=t.length-1,r=n*e,s=Math.floor(r);return e<0?Be(t[0],t[1],r):e>1?Be(t[n],t[n-1],n-r):Be(t[s],t[s+1>n?n:s+1],r-s)}function kl(t,e){let n=1-t;return n*n*e}function Ul(t,e){return 2*(1-t)*t*e}function Wl(t,e){return t*t*e}function Ll(t,e,n,r){return kl(t,e)+Ul(t,n)+Wl(t,r)}function Ks(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function _l(t,e,n){return e+(n-e)*Ks(t,0,1)}function Qs(t,e,n){return t=Math.max(0,Math.min(1,(t-e)/(n-e))),t*t*t*(t*(t*6-15)+10)}function Il(t,e,n){return e+(n-e)*Qs(t,0,1)}var Xs={};v(Xs,{GetMat2dDeterminant:()=>Hl,GetMat2dFrobenius:()=>ql,Mat2dAdd:()=>Kl,Mat2dAppend:()=>_i,Mat2dClone:()=>Ql,Mat2dCopyFrom:()=>Dn,Mat2dCopyToContext:()=>Xl,Mat2dEquals:()=>Ii,Mat2dFromRotation:()=>Yl,Mat2dFromScaling:()=>jl,Mat2dFromTranslation:()=>$l,Mat2dFuzzyEquals:()=>Zl,Mat2dGlobalToLocal:()=>Ni,Mat2dITRS:()=>Jl,Mat2dITRSS:()=>tf,Mat2dIdentity:()=>ef,Mat2dInvert:()=>nf,Mat2dLocalToGlobal:()=>rf,Mat2dMultiply:()=>sf,Mat2dMultiplyScalar:()=>of,Mat2dMultiplyScalarAndAdd:()=>af,Mat2dRotate:()=>Pi,Mat2dScale:()=>Oi,Mat2dSetToContext:()=>cf,Mat2dSkew:()=>uf,Mat2dSubtract:()=>hf,Mat2dTranslate:()=>Bi,Mat2dZero:()=>lf,Matrix2D:()=>$});function Hl(t){let{a:e,b:n,c:r,d:s}=t;return e*s-n*r}function ql(t){return Math.hypot(t.a,t.b,t.c,t.d,t.tx,t.ty,1)}function Kl(t,e,n=new $){return n.set(t.a+e.a,t.b+e.b,t.c+e.c,t.d+e.d,t.tx+e.tx,t.ty+e.ty)}function _i(t,e,n=new $){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=t,{a:u,b:h,c:l,d,tx:f,ty:x}=e;return n.set(u*r+h*i,u*s+h*o,l*r+d*i,l*s+d*o,f*r+x*i+a,f*s+x*o+c)}function Ql(t){return new $(t.a,t.b,t.c,t.d,t.tx,t.ty)}function Dn(t,e){let{a:n,b:r,c:s,d:i,tx:o,ty:a}=t;return e.set(n,r,s,i,o,a)}function Xl(t,e){let{a:n,b:r,c:s,d:i,tx:o,ty:a}=t;return e.transform(n,r,s,i,o,a),e}function Ii(t,e){return t.a===e.a&&t.b===e.b&&t.c===e.c&&t.d===e.d&&t.tx===e.tx&&t.ty===e.ty}function Pi(t,e,n=new $){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=t,u=Math.sin(e),h=Math.cos(e);return n.set(r*h+i*u,s*h+o*u,r*-u+i*h,s*-u+o*h,a,c)}function Yl(t){let e=new $;return Pi(e,t,e)}function Oi(t,e,n,r=new $){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=t;return r.set(s*e,i*e,o*n,a*n,c,u)}function jl(t,e=t){let n=new $;return Oi(n,t,e,n)}function Bi(t,e,n,r=new $){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=t;return r.tx=s*e+o*n+c,r.ty=i*e+a*n+u,r}function $l(t,e){let n=new $;return Bi(n,t,e,n)}function Zl(t,e,n=1e-6){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=t,{a:u,b:h,c:l,d,tx:f,ty:x}=e;return Math.abs(r-u)<=n*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-h)<=n*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(i-l)<=n*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-d)<=n*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=n*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(c-x)<=n*Math.max(1,Math.abs(c),Math.abs(x))}var T=class{constructor(t=0,e=0){this.set(t,e)}set(t=0,e=0){return this.x=t,this.y=e,this}toArray(t=[],e=0){let{x:n,y:r}=this;return t[e]=n,t[e+1]=r,t}fromArray(t,e=0){return this.set(t[e],t[e+1])}toString(){let{x:t,y:e}=this;return`{ x=${t}, y=${e} }`}};function Ni(t,e,n,r=new T){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=t,h=1/(s*a+o*-i);return r.set(a*h*e+-o*h*n+(u*o-c*a)*h,s*h*n+-i*h*e+(-u*s+c*i)*h)}function Jl(t,e,n,r,s,i){if(r===0)return t.set(1,0,0,1,e,n);{let o=Math.sin(r),a=Math.cos(r);return t.set(a*s,o*s,-o*i,a*i,e,n)}}function tf(t,e,n,r=0,s=1,i=1,o=0,a=0){return r===0?t.set(1,0,0,1,e,n):t.set(Math.cos(r+a)*s,Math.sin(r+a)*s,-Math.sin(r-o)*i,Math.cos(r-o)*i,e,n)}function ef(){return new $}function nf(t,e=new $){let{a:n,b:r,c:s,d:i,tx:o,ty:a}=t,c=n*i-r*s;return c&&(c=1/c,e.set(i*c,-r*c,-s*c,n*c,(s*a-i*o)*c,(r*o-n*a)*c)),e}function rf(t,e,n,r=new T){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=t;return r.set(s*e+o*n+c,i*e+a*n+u)}function sf(t,e,n=new $){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=t,{a:u,b:h,c:l,d,tx:f,ty:x}=e;return n.set(r*u+i*h,s*u+o*h,r*l+i*d,s*l+o*d,r*f+i*x+a,s*f+o*x+c)}function of(t,e,n=new $){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=t;return n.set(r*e,s*e,i*e,o*e,a*e,c*e)}function af(t,e,n,r=new $){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=e,{a:h,b:l,c:d,d:f,tx:x,ty:p}=t;return r.set(h+s*n,l+i*n,d+o*n,f+a*n,x+c*n,p+u*n)}function cf(t,e){let{a:n,b:r,c:s,d:i,tx:o,ty:a}=t;return e.setTransform(n,r,s,i,o,a),e}function uf(t,e,n,r=new $){let{a:s,b:i,c:o,d:a,tx:c,ty:u}=t;return r.set(s,i+Math.tan(e),o+Math.tan(n),a,c,u)}function hf(t,e,n=new $){return n.set(t.a-e.a,t.b-e.b,t.c-e.c,t.d-e.d,t.tx-e.tx,t.ty-e.ty)}function lf(t){return t.set(0,0,0,0,0,0)}var Ys={};v(Ys,{GetPowerOfTwo:()=>ff,IsSizePowerOfTwo:()=>ki,IsValuePowerOfTwo:()=>df});function ff(t){let e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}function ki(t,e){return t<1||e<1?!1:(t&t-1)==0&&(e&e-1)==0}function df(t){return t>0&&(t&t-1)==0}var js={};v(js,{SnapCeil:()=>xf,SnapFloor:()=>yf,SnapTo:()=>mf});function xf(t,e,n=0,r=!1){return e===0?t:(t-=n,t=e*Math.ceil(t/e),r?(n+t)/e:n+t)}function yf(t,e,n=0,r=!1){return e===0?t:(t-=n,t=e*Math.floor(t/e),r?(n+t)/e:n+t)}function mf(t,e,n=0,r=!1){return e===0?t:(t-=n,t=e*Math.round(t/e),r?(n+t)/e:n+t)}var $s={};v($s,{GetChebyshevDistance:()=>pf,GetDistanceFromSegment:()=>wf,GetVec2Angle:()=>gf,GetVec2AngleY:()=>Mf,GetVec2Distance:()=>Bt,GetVec2DistancePower:()=>Cf,GetVec2DistanceSquared:()=>Fn,GetVec2Length:()=>Hi,GetVec2LengthSquared:()=>bf,GetVec2ManhattanDistance:()=>Rf,GetVec2ManhattanLength:()=>Tf,Vec2:()=>T,Vec2Abs:()=>Sf,Vec2Add:()=>Vn,Vec2AddScalar:()=>vf,Vec2Bezier:()=>Ef,Vec2Callback:()=>gt,Vec2CatmullRom:()=>Af,Vec2Ceil:()=>zf,Vec2Center:()=>Df,Vec2Clamp:()=>Ff,Vec2ClampScalar:()=>Vf,Vec2Clone:()=>Gf,Vec2CopyFrom:()=>Lf,Vec2Cross:()=>_f,Vec2Divide:()=>If,Vec2DivideScalar:()=>qi,Vec2Dot:()=>Ui,Vec2Equals:()=>Pf,Vec2Floor:()=>Of,Vec2Fract:()=>Bf,Vec2FromGridIndex:()=>Nf,Vec2FromTransform:()=>Ki,Vec2FuzzyEquals:()=>kf,Vec2Hermite:()=>Uf,Vec2Inverse:()=>Wf,Vec2Lerp:()=>Hf,Vec2Max:()=>qf,Vec2Min:()=>Kf,Vec2Multiply:()=>Qf,Vec2MultiplyByFloats:()=>Wi,Vec2Negate:()=>Xf,Vec2Normalize:()=>Qi,Vec2One:()=>Yf,Vec2PerpDot:()=>jf,Vec2Random:()=>$f,Vec2Rotate:()=>Zf,Vec2Round:()=>Jf,Vec2RoundToZero:()=>td,Vec2Scale:()=>Ln,Vec2ScaleAndAdd:()=>ed,Vec2SetLength:()=>nd,Vec2Subtract:()=>Gn,Vec2SubtractScalar:()=>rd,Vec2Transform:()=>sd,Vec2TransformMat2d:()=>id,Vec2TransformMat4:()=>od,Vec2Zero:()=>ad});function pf(t,e){return Math.max(Math.abs(t.x-e.x),Math.abs(t.y-e.y))}function Fn(t,e){let n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function Bt(t,e){return Math.sqrt(Fn(t,e))}function Vn(t,e,n=new T){return n.set(t.x+e.x,t.y+e.y)}function Ui(t,e){return t.x*e.x+t.y*e.y}function Wi(t,e,n,r=new T){return r.set(t.x*e,t.y*n)}function Gn(t,e,n=new T){return n.set(t.x-e.x,t.y-e.y)}function wf(t,e,n){if(Fn(e,n)===0)return Bt(t,e);let s=Gn(n,e);Gn(t,e,t);let i=Math.max(0,Math.min(1,Ui(t,s)/12)),o=Vn(e,Wi(s,i,i,s));return Bt(t,o)}function gf(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function Mf(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}function Cf(t,e,n=2){return Math.sqrt(Math.pow(e.x-t.x,n)+Math.pow(e.y-t.y,n))}function Hi(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function bf(t){return t.x*t.x+t.y*t.y}function Rf(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function Tf(t){return Math.abs(t.x)+Math.abs(t.y)}function Sf(t,e=new T){return e.set(Math.abs(t.x),Math.abs(t.y))}function vf(t,e,n=new T){return n.set(t.x+e,t.y+e)}function Ef(t,e,n,r,s,i=new T){return i.set(ft(s,t.x,e.x,n.x,r.x),ft(s,t.y,e.y,n.y,r.y))}function Af(t,e,n,r,s,i=new T){return i.set(tt(s,t.x,e.x,n.x,r.x),tt(s,t.y,e.y,n.y,r.y))}function zf(t,e=new T){return e.set(Math.ceil(t.x),Math.ceil(t.y))}function Ln(t,e,n=new T){return n.set(t.x*e,t.y*e)}function Df(t,e,n=new T){return Vn(t,e,n),Ln(n,.5,n)}function Ff(t,e,n,r=new T){return r.set(q(t.x,e.x,n.x),q(t.y,e.y,n.y))}function Vf(t,e,n,r=new T){return r.set(q(t.x,e,n),q(t.y,e,n))}function Gf(t){return new T(t.x,t.y)}function Lf(t,e){return e.set(t.x,t.y)}function _f(t,e){return t.x*e.y-t.y*e.x}function If(t,e,n=new T){return n.set(t.x/e.x,t.y/e.y)}function qi(t,e,n=new T){return n.set(t.x/e,t.y/e)}function Pf(t,e){return t.x===e.x&&t.y===e.y}function Of(t,e=new T){return e.set(Math.floor(t.x),Math.floor(t.y))}function Bf(t,e=new T){return e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y))}function Nf(t,e,n,r=new T){let s=0,i=0,o=e*n;return t>0&&t<=o&&(t>e-1?(i=Math.floor(t/e),s=t-i*e):s=t,r.set(s,i)),r}function Ki(t,e,n,r,s,i,o,a=new T){let c=Math.sin(s),u=Math.cos(s),h=u*i,l=c*i,d=-c*o,f=u*o,x=1/(h*f+d*-l);return a.set(f*x*t+-d*x*e+(r*d-n*f)*x,h*x*e+-l*x*t+(-r*h+n*l)*x)}function kf(t,e,n=1e-4){return et(t.x,e.x,n)&&et(t.y,e.y,n)}function Uf(t,e,n,r,s,i=new T){return i.set(nt(s,t.x,e.x,n.x,r.x),nt(s,t.y,e.y,n.y,r.y))}function Wf(t,e=new T){return e.set(1/t.x,1/t.y)}function Hf(t,e,n,r=new T){let s=t.x,i=t.y;return r.set(s+n*(e.x-s),i+n*(e.y-i))}function qf(t,e,n=new T){let{x:r,y:s}=t,{x:i,y:o}=e;return n.set(Math.max(r,i),Math.max(s,o))}function Kf(t,e,n=new T){let{x:r,y:s}=t,{x:i,y:o}=e;return n.set(Math.min(r,i),Math.min(s,o))}function Qf(t,e,n=new T){return n.set(t.x*e.x,t.y*e.y)}function Xf(t,e=new T){return e.set(-t.x,-t.y)}function Qi(t,e=new T){return qi(t,Hi(t)||1,e)}function Yf(){return new T(1,1)}function jf(t,e){return t.x*e.y-t.y*e.x}function $f(t,e=1,n=new T){let r=Math.random()*2*Math.PI;return n.set(Math.cos(r)*e,Math.sin(r)*e)}function Zf(t,e,n,r=new T){let s=Math.sin(n),i=Math.cos(n),o=t.x-e.x,a=t.y-e.y;return r.set(o*i-a*s+e.x,o*s+a*i+e.y)}function Jf(t,e=new T){return e.set(Math.round(t.x),Math.round(t.y))}function td(t,e=new T){return e.set(t.x<0?Math.ceil(t.x):Math.floor(t.x),t.y<0?Math.ceil(t.y):Math.floor(t.y))}function ed(t,e,n,r=new T){return r.set(t.x+e.x*n,t.y+e.y*n)}function nd(t,e,n=new T){return Qi(t,n),Ln(n,e,n)}function rd(t,e,n=new T){return n.set(t.x-e,t.y-e)}function sd(t,e,n,r,s,i,o=new T){return Ki(t.x,t.y,e,n,r,s,i,o)}function id(t,e,n=new T){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=e;return n.set(r*t.x+i*t.y+a,s*t.x+o*t.y+c)}function od(t,e,n=new T){let r=e.data;return n.set(r[0]*t.x+r[4]*t.y+r[12],r[1]*t.x+r[5]*t.y+r[13])}function ad(){return new T(0,0)}var Zs={};v(Zs,{GetVec4Distance:()=>cd,GetVec4DistanceSquared:()=>Xi,GetVec4Length:()=>_n,GetVec4LengthSquared:()=>ud,GetVec4ManhattanDistance:()=>hd,GetVec4ManhattanLength:()=>ld,RGBACallback:()=>fd,Vec4:()=>N,Vec4Abs:()=>dd,Vec4Add:()=>ji,Vec4AddScalar:()=>xd,Vec4Bezier:()=>yd,Vec4Callback:()=>Yi,Vec4CatmullRom:()=>md,Vec4Ceil:()=>pd,Vec4Center:()=>wd,Vec4Clamp:()=>gd,Vec4ClampLength:()=>Md,Vec4ClampScalar:()=>Cd,Vec4Clone:()=>bd,Vec4CopyFrom:()=>Rd,Vec4Cross:()=>Td,Vec4Divide:()=>Sd,Vec4DivideScalar:()=>In,Vec4Dot:()=>vd,Vec4Equals:()=>Ed,Vec4Floor:()=>Ad,Vec4Fract:()=>zd,Vec4FuzzyEquals:()=>Dd,Vec4Hermite:()=>Fd,Vec4Lerp:()=>Vd,Vec4Max:()=>Gd,Vec4Min:()=>Ld,Vec4Multiply:()=>_d,Vec4MultiplyByFloats:()=>Id,Vec4Negate:()=>Pd,Vec4Normalize:()=>$i,Vec4One:()=>Od,Vec4Random:()=>Bd,Vec4Round:()=>Nd,Vec4RoundToZero:()=>kd,Vec4Scale:()=>qe,Vec4ScaleAndAdd:()=>Ud,Vec4SetLength:()=>Wd,Vec4Subtract:()=>Hd,Vec4SubtractScalar:()=>qd,Vec4TransformMat4:()=>Kd,Vec4Zero:()=>Qd});function Xi(t,e){let n=t.x-e.x,r=t.y-e.y,s=t.z-e.z,i=t.w-e.w;return n*n+r*r+s*s+i*i}function cd(t,e){return Math.sqrt(Xi(t,e))}function _n(t){let{x:e,y:n,z:r,w:s}=t;return Math.sqrt(e*e+n*n+r*r+s*s)}function ud(t){let{x:e,y:n,z:r,w:s}=t;return e*e+n*n+r*r+s*s}function hd(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)+Math.abs(t.z-e.z)+Math.abs(t.w-e.w)}function ld(t){let{x:e,y:n,z:r,w:s}=t;return Math.abs(e)+Math.abs(n)+Math.abs(r)+Math.abs(s)}var Yi=class{constructor(t,e=0,n=0,r=0,s=0){this._x=e,this._y=n,this._z=r,this._w=s,this.onChange=t}destroy(){this.onChange=Et}set(t=0,e=0,n=0,r=0){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChange&&this.onChange(this),this}get x(){return this._x}set x(t){let e=this._x;this._x=t,e!==t&&this.onChange(this)}get y(){return this._y}set y(t){let e=this._y;this._y=t,e!==t&&this.onChange(this)}get z(){return this._z}set z(t){let e=this._z;this._z=t,e!==t&&this.onChange(this)}get w(){return this._w}set w(t){let e=this._w;this._w=t,e!==t&&this.onChange(this)}toArray(t=[],e=0){let{x:n,y:r,z:s,w:i}=this;return t[e]=n,t[e+1]=r,t[e+2]=s,t[e+3]=i,t}fromArray(t,e=0){return this.set(t[e],t[e+1],t[e+2],t[e+3])}toString(){let{x:t,y:e,z:n,w:r}=this;return`{ x=${t}, y=${e}, z=${n}, w=${r} }`}},fd=class extends Yi{constructor(t,e=0,n=0,r=0,s=1){super(t,e,n,r,s)}set r(t){this.x=t}get r(){return this.x}set g(t){this.y=t}get g(){return this.y}set b(t){this.z=t}get b(){return this.z}set a(t){this.w=t}get a(){return this.w}toString(){let{x:t,y:e,z:n,w:r}=this;return`[ r=${t}, g=${e}, b=${n}, a=${r} ]`}},N=class{constructor(t=0,e=0,n=0,r=1){this.set(t,e,n,r)}set(t=0,e=0,n=0,r=1){return this.x=t,this.y=e,this.z=n,this.w=r,this}toArray(t=[],e=0){let{x:n,y:r,z:s,w:i}=this;return t[e]=n,t[e+1]=r,t[e+2]=s,t[e+3]=i,t}fromArray(t,e=0){return this.set(t[e],t[e+1],t[e+2],t[e+3])}toString(){let{x:t,y:e,z:n,w:r}=this;return`{ x=${t}, y=${e}, z=${n}, w=${r} }`}};function dd(t,e=new N){return e.set(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z),Math.abs(t.w))}function ji(t,e,n=new N){return n.set(t.x+e.x,t.y+e.y,t.z+e.z,t.w+e.w)}function xd(t,e,n=new N){return n.set(t.x+e,t.y+e,t.z+e,t.w+e)}function yd(t,e,n,r,s,i=new N){return i.set(ft(s,t.x,e.x,n.x,r.x),ft(s,t.y,e.y,n.y,r.y),ft(s,t.z,e.z,n.z,r.z),ft(s,t.w,e.w,n.w,r.w))}function md(t,e,n,r,s,i=new N){return i.set(tt(s,t.x,e.x,n.x,r.x),tt(s,t.y,e.y,n.y,r.y),tt(s,t.z,e.z,n.z,r.z),tt(s,t.w,e.w,n.w,r.w))}function pd(t,e=new N){let{x:n,y:r,z:s,w:i}=t;return e.set(Math.ceil(n),Math.ceil(r),Math.ceil(s),Math.ceil(i))}function qe(t,e,n=new N){let{x:r,y:s,z:i,w:o}=t;return n.set(r*e,s*e,i*e,o*e)}function wd(t,e,n=new N){return ji(t,e,n),qe(n,.5,n)}function gd(t,e,n,r=new N){return r.set(q(t.x,e.x,n.x),q(t.y,e.y,n.y),q(t.z,e.z,n.z),q(t.w,e.w,n.w))}function In(t,e,n=new N){let{x:r,y:s,z:i,w:o}=t;return n.set(r/e,s/e,i/e,o/e)}function Md(t,e,n,r=new N){let s=_n(t);return In(t,s||1,r),qe(r,q(e,n,s),r)}function Cd(t,e,n,r=new N){return r.set(q(t.x,e,n),q(t.y,e,n),q(t.z,e,n),q(t.w,e,n))}function bd(t){let{x:e,y:n,z:r,w:s}=t;return new N(e,n,r,s)}function Rd(t,e){let{x:n,y:r,z:s,w:i}=t;return e.set(n,r,s,i)}function Td(t,e,n,r=new N){let{x:s,y:i,z:o,w:a}=t,{x:c,y:u,z:h,w:l}=e,{x:d,y:f,z:x,w:p}=n,m=c*f-u*d,w=c*x-h*d,g=c*p-l*d,M=u*x-h*f,C=u*p-l*f,b=h*p-l*x,R=s,z=i,D=o,V=a;return r.set(z*b-D*C+V*M,-(R*b)+D*g-V*w,R*C-z*g+V*m,-(R*M)+z*w-D*m)}function Sd(t,e,n=new N){return n.set(t.x/e.x,t.y/e.y,t.z/e.z,t.w/e.w)}function vd(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}function Ed(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}function Ad(t,e=new N){let{x:n,y:r,z:s,w:i}=t;return e.set(Math.floor(n),Math.floor(r),Math.floor(s),Math.floor(i))}function zd(t,e=new N){return e.set(t.x-Math.floor(t.x),t.y-Math.floor(t.y),t.z-Math.floor(t.z),t.w-Math.floor(t.w))}function Dd(t,e,n=1e-4){return et(t.x,e.x,n)&&et(t.y,e.y,n)&&et(t.z,e.z,n)&&et(t.w,e.w,n)}function Fd(t,e,n,r,s,i=new N){return i.set(nt(s,t.x,e.x,n.x,r.x),nt(s,t.y,e.y,n.y,r.y),nt(s,t.z,e.z,n.z,r.z),nt(s,t.w,e.w,n.w,r.w))}function Vd(t,e,n,r=new N){let{x:s,y:i,z:o,w:a}=t;return r.set(s+n*(e.x-s),i+n*(e.y-i),o+n*(e.z-o),a+n*(e.w-a))}function Gd(t,e,n=new N){let{x:r,y:s,z:i,w:o}=t,{x:a,y:c,z:u,w:h}=e;return n.set(Math.max(r,a),Math.max(s,c),Math.max(i,u),Math.max(o,h))}function Ld(t,e,n=new N){let{x:r,y:s,z:i,w:o}=t,{x:a,y:c,z:u,w:h}=e;return n.set(Math.min(r,a),Math.min(s,c),Math.min(i,u),Math.min(o,h))}function _d(t,e,n=new N){return n.set(t.x*e.x,t.y*e.y,t.z*e.z,t.w*e.w)}function Id(t,e,n,r,s,i=new N){return i.set(t.x*e,t.y*n,t.z*r,t.w*s)}function Pd(t,e=new N){return e.set(-t.x,-t.y,-t.z,-t.w)}function $i(t,e=new N){return In(t,_n(t)||1,e)}function Od(){return new N(1,1,1,1)}function Bd(t,e=1,n=new N){let r,s,i,o,a,c;do r=Math.random()*2-1,s=Math.random()*2-1,a=r*r+s*s;while(a>=1);do i=Math.random()*2-1,o=Math.random()*2-1,c=i*i+o*o;while(c>=1);let u=Math.sqrt((1-a)/c);return n.set(e*r,e*s,e*i*u,e*o*u)}function Nd(t,e=new N){let{x:n,y:r,z:s,w:i}=t;return e.set(Math.round(n),Math.round(r),Math.round(s),Math.round(i))}function kd(t,e=new N){let{x:n,y:r,z:s,w:i}=t;return e.set(n<0?Math.ceil(n):Math.floor(n),r<0?Math.ceil(r):Math.floor(r),s<0?Math.ceil(s):Math.floor(s),i<0?Math.ceil(i):Math.floor(i))}function Ud(t,e,n,r=new N){return r.set(t.x+e.x*n,t.y+e.y*n,t.z+e.z*n,t.w+e.w*n)}function Wd(t,e,n=new N){return $i(t,n),qe(n,e,n)}function Hd(t,e,n=new N){return n.set(t.x-e.x,t.y-e.y,t.z-e.z,t.w-e.w)}function qd(t,e,n=new N){let{x:r,y:s,z:i,w:o}=t;return n.set(r-e,s-e,i-e,o-e)}function Kd(t,e,n=new N){let[r,s,i,o,a,c,u,h,l,d,f,x,p,m,w,g]=e.data,{x:M,y:C,z:b,w:R}=t;return n.set(r*M+a*C+l*b+p*R,s*M+c*C+d*b+m*R,i*M+u*C+f*b+w*R,o*M+h*C+x*b+g*R)}function Qd(){return new N(0,0,0,0)}function fl(t){let e=0;for(let n=0;n<t.length;n++)e+=+t[n];return e/t.length}function Js(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function dl(t,e=0,n=10){let r=Math.pow(n,-e);return Math.ceil(t*r)/r}function oe(t){return t*Y.DEG_TO_RAD}function xl(t,e){return Math.abs(t-e)}function yl(t,e){return Math.random()*(e-t)+t}function ml(t,e=0,n=10){let r=Math.pow(n,-e);return Math.floor(t*r)/r}function ae(t,e,n){return t=q(t,0,1),(n-e)*t}function pl(t,e){return t/e/1e3}function wl(t,e,n){return Math.min(t+e,n)}function gl(t,e,n){return Math.max(t-e,n)}function Ml(t,e,n,r){n===void 0&&(n=e+1);let s=(t-e)/(n-e);return s>1?r!==void 0?(s=(r-t)/(r-n),s<0&&(s=0)):s=1:s<0&&(s=0),s}function Cl(t){return t*Y.RAD_TO_DEG}function bl(t,e=0,n=10){let r=Math.pow(n,-e);return Math.round(t*r)/r}function Rl(t,e=1,n=1,r=1){r*=Math.PI/t;let s=[],i=[];for(let o=0;o<t;o++)n-=e*r,e+=n*r,s[o]=n,i[o]=e;return{sin:i,cos:s,length:t}}function Tl(t,e,n){return Math.abs(t-e)<=n}var Wu=class{constructor(t=0,e=0,n=0,r=45,s=.1,i=1e3){this.dirtyRender=!0,this.type="Camera3D";let o=rt.get();this.renderer=o.renderer,this.position=new mt(()=>this.update(),t,e,n),this.direction=new mt(()=>this.update(),0,1,0),this._lookAtPosition=new E,this._lookAtView=new _,this._axis=new k,this.up=se(),this.left=gn(),this._fov=r,this._near=s,this._far=i,this.aspectRatio=this.renderer.width/this.renderer.height,this.viewMatrix=new _,this.projectionMatrix=Ee(oe(r),this.aspectRatio,s,i),this.lookAt(new E)}updateProjectionMatrix(){return Ee(oe(this._fov),this.aspectRatio,this._near,this._far,this.projectionMatrix),this}lookAt(t){let e=this.position,n=this.direction,r=this.left;return Ge(t,e,n),lt(n,n),bn(Mn,n,r),bn(n,r,this.up),this.update()}rotateOnAxis(t,e){let n=this.direction,r=this.left,s=this.up,i=Fs(t,e,this._axis);return Ie(n,i,n),Ie(r,i,r),Ie(s,i,s),lt(s,s),lt(r,r),lt(n,n),this.update()}yaw(t){return this.rotateOnAxis(this.up,t)}pitch(t){return this.rotateOnAxis(this.left,t)}roll(t){return this.rotateOnAxis(this.direction,t)}forward(t){let e=this.position,{x:n,y:r,z:s}=e,{x:i,y:o,z:a}=this.direction;return e.set(n-t*i,r-t*o,s-t*a),this.update()}update(){let t=this._lookAtPosition,e=this._lookAtView,n=this.position;return Cn(n,this.direction,t),xs(n,t,this.up,e),ms(e,-n.x,-n.y,-n.z,this.viewMatrix),this}reset(){}destroy(){this.position.destroy(),this.direction.destroy(),this.up=null,this.left=null,this.viewMatrix=null,this.projectionMatrix=null,this._lookAtPosition=null,this._lookAtView=null,this._axis=null}get fov(){return this._fov}set fov(t){t>0&&t<180&&(this._fov=t,this.updateProjectionMatrix())}get near(){return this._near}set near(t){t>0&&(this._near=t,this.updateProjectionMatrix())}get far(){return this._far}set far(t){t>0&&(this._far=t,this.updateProjectionMatrix())}},Nt={};v(Nt,{BackgroundColor:()=>Xd,Banner:()=>Yd,BatchSize:()=>jd,Canvas:()=>Zd,CanvasContext:()=>Jd,DefaultOrigin:()=>t0,MaxTextures:()=>e0,Parent:()=>n0,Scenes:()=>r0,Size:()=>$d,WebGL:()=>s0,WebGLContext:()=>i0});var Q={BACKGROUND_COLOR:"BackgroundColor",BATCH_SIZE:"BatchSize",DEFAULT_ORIGIN:"DefaultOrigin",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",SIZE:"Size",SCENES:"Scenes",RENDERER:"Renderer",AUTO:"Auto",WEBGL:"WebGL",CANVAS:"Canvas",WEBGL_CONTEXT:"WebGLContext",CANVAS_CONTEXT:"CanvasContext",BANNER:"Banner"},X=new Map;function Zi(t){X.set(Q.BACKGROUND_COLOR,t)}function Xd(t){return()=>{Zi(t)}}function Ji(t="",e="",n="",r="#fff",s="linear-gradient(#3e0081 40%, #00bcc3)"){X.set(Q.BANNER,{title:t,version:e,url:n,color:r,background:s})}function Yd(t,e,n,r,s){return()=>{Ji(t,e,n,r,s)}}function to(t){X.set(Q.BATCH_SIZE,t)}function jd(t){return()=>{to(t)}}function ce(){return X.get(Q.SIZE).height}function ue(){return X.get(Q.SIZE).resolution}function he(){return X.get(Q.SIZE).width}function eo(t=800,e=600,n=1){n===0&&(n=window.devicePixelRatio),X.set(Q.SIZE,{width:t,height:e,resolution:n})}function $d(t=800,e=600,n=1){return()=>{eo(t,e,n)}}var Pn=[],Ke={add:(t,e)=>{Pn.push({texture:t,glConfig:e})},get:()=>Pn,clear:()=>{Pn.length=0}};function no(){return X.get(Q.BACKGROUND_COLOR)}function o0(){return X.get(Q.CANVAS_CONTEXT)}var a0=class{constructor(){this.clearBeforeRender=!0,this.optimizeRedraw=!0,this.autoResize=!0,this.width=he(),this.height=ce(),this.resolution=ue(),this.setBackgroundColor(no());let t=document.createElement("canvas");this.canvas=t,this.initContext()}initContext(){let t=this.canvas.getContext("2d",o0());this.ctx=t,this.resize(this.width,this.height,this.resolution)}resize(t,e,n=1){this.width=t*n,this.height=e*n,this.resolution=n;let r=this.canvas;r.width=this.width,r.height=this.height,this.autoResize&&(r.style.width=(this.width/n).toString()+"px",r.style.height=(this.height/n).toString()+"px")}setBackgroundColor(t){let e=t>>16&255,n=t>>8&255,r=t&255,s=t>16777215?t>>>24:255;return this.clearColor=`rgba(${e}, ${n}, ${r}, ${s})`,this}reset(){let t=this.ctx;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0)}render(t){Ke.clear();let e=this.ctx;this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0||(this.reset(),this.clearBeforeRender&&(e.clearRect(0,0,this.width,this.height),e.fillStyle=this.clearColor,e.fillRect(0,0,this.width,this.height)))}destroy(){}};function ro(t){X.set(Q.RENDERER,t)}function Zd(){return()=>{ro(a0)}}function c0(t){X.set(Q.CANVAS_CONTEXT,t)}function Jd(t){return()=>{c0(t)}}function so(t=.5,e=t){X.set(Q.DEFAULT_ORIGIN,{x:t,y:e})}function t0(t=.5,e=t){return()=>{so(t,e)}}function On(t){X.set(Q.MAX_TEXTURES,t)}function e0(t=0){return()=>{On(t)}}function Bn(t){let e;return t&&(typeof t=="string"?e=document.getElementById(t):typeof t=="object"&&t.nodeType===1&&(e=t)),e||(e=document.body),e}function u0(t){t&&X.set(Q.PARENT,Bn(t))}function n0(t){return()=>{u0(t)}}function h0(t){X.set(Q.SCENES,[].concat(t))}function r0(t){return()=>{h0(t)}}function l0(t,e=0,n=0,r=0,s=0){let i=new J(e,n,r,s);return t.viewportStack.push(i),i}var y,io={get:()=>y,set:t=>{y=t}};function Nn(t,e){if(!e&&(e=t.currentViewport,!e))return;let n=y.getParameter(y.VIEWPORT);(n[0]!==e.x||n[1]!==e.y||n[2]!==e.width||n[3]!==e.height)&&y.viewport(e.x,e.y,e.width,e.height)}function f0(t,e=0,n=0,r=0,s=0){let i=l0(t,e,n,r,s);Nn(t,i),t.currentViewport=i}function kn(t,e=!0,n){n||(n=t.currentFramebuffer);let{framebuffer:r,viewport:s}=n;y.bindFramebuffer(y.FRAMEBUFFER,r),e&&(y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT)),s&&f0(t,s.x,s.y,s.width,s.height)}function d0(t){let e=t.viewportStack;e.length>1&&e.pop(),t.currentViewport=e[e.length-1],Nn(t)}function Qe(t){let e=t.framebufferStack;e.length>1&&(t.currentFramebuffer.viewport&&d0(t),e.pop()),t.currentFramebuffer=e[e.length-1],kn(t,!1)}function x0(t,e,n){let r={framebuffer:e,viewport:n};return t.framebufferStack.push(r),r}function le(t,e,n=!0,r){let s=x0(t,e,r);kn(t,n,s),t.currentFramebuffer=s}function y0(t){let e=t.count;if(e===0)return;let n=t.currentVertexBuffer,r=t.currentShader,s=r.shader.renderToFramebuffer;if(s&&le(t,r.shader.framebuffer,!0),e===n.batchSize){let i=n.isDynamic?y.DYNAMIC_DRAW:y.STATIC_DRAW;y.bufferData(y.ARRAY_BUFFER,n.data,i)}else{let i=n.indexed?e*n.entryElementSize:e*n.vertexElementSize,o=n.vertexViewF32.subarray(0,i);y.bufferSubData(y.ARRAY_BUFFER,0,o)}n.indexed?y.drawElements(y.TRIANGLES,e*n.entryIndexSize,y.UNSIGNED_SHORT,0):y.drawArrays(y.TRIANGLES,0,e),s&&Qe(t)}function at(t,e){e&&(t.count=e);let n=t.count;return n===0?!1:(y0(t),t.prevCount=n,t.count=0,t.flushTotal++,!0)}function m0(t){at(t)}function p0(t,e=[]){let n=t>>16&255,r=t>>8&255,s=t&255,i=t>16777215?t>>>24:255;return e[0]=n/255,e[1]=r/255,e[2]=s/255,e[3]=i/255,e}function w0(){return X.get(Q.WEBGL_CONTEXT)}function Xe(t){let{parent:e,flipY:n,unpackPremultiplyAlpha:r,minFilter:s,magFilter:i,wrapS:o,wrapT:a,generateMipmap:c,isPOT:u}=t,h=e.image,l=e.width,d=e.height,f=y.createTexture();return y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,f),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,n),y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),h?(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,h),l=h.width,d=h.height):y.texImage2D(y.TEXTURE_2D,0,y.RGBA,l,d,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,i),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,o),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,a),c&&u&&y.generateMipmap(y.TEXTURE_2D),t.texture=f,f}function Dt(t){y&&y.isFramebuffer(t)&&y.deleteFramebuffer(t)}function Ye(t){y.isTexture(t)&&y.deleteTexture(t)}function oo(t,e=!0){y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,t);let n=e?y.LINEAR:y.NEAREST;y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,n),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,n)}function ao(t){let e=t.parent.image,n=e.width,r=e.height;return n>0&&r>0&&(y.activeTexture(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,t.texture),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,t.flipY),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,e)),t.texture}var je=class{constructor(t,e={}){this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=t,this.isPOT=ki(t.width,t.height);let{texture:n=null,framebuffer:r=null,depthbuffer:s=null,unpackPremultiplyAlpha:i=!0,minFilter:o=this.isPOT?y.LINEAR_MIPMAP_LINEAR:y.LINEAR,magFilter:a=y.LINEAR,wrapS:c=y.CLAMP_TO_EDGE,wrapT:u=y.CLAMP_TO_EDGE,generateMipmap:h=this.isPOT,flipY:l=!1}=e;this.minFilter=o,this.magFilter=a,this.wrapS=c,this.wrapT=u,this.generateMipmap=h,this.flipY=l,this.unpackPremultiplyAlpha=i,r&&(this.framebuffer=r),s&&(this.depthbuffer=s),n?this.texture=n:Xe(this)}setFilter(t){this.texture&&oo(this.texture,t)}create(){let t=this.texture;return t&&Ye(t),Xe(this)}update(){return this.texture?ao(this):Xe(this)}setIndex(t){this.dirtyIndex=t!==this.index,this.index=t}destroy(){Ye(this.texture),Dt(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null}};function g0(){Ke.get().forEach(e=>{let{texture:n,glConfig:r}=e;n.binding||(n.binding=new je(n,r))}),Ke.clear()}function co(){return X.get(Q.MAX_TEXTURES)}var M0=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function C0(t){let e="";for(let n=0;n<t;++n)n>0&&(e+=`
else `),n<t-1&&(e+=`if(test == ${n}.0){}`);return e}function b0(t){let e=y.createShader(y.FRAGMENT_SHADER);for(;;){let n=M0.replace(/%forloop%/gi,C0(t));if(y.shaderSource(e,n),y.compileShader(e),!y.getShaderParameter(e,y.COMPILE_STATUS))t=t/2|0;else break}return t}function R0(t){let e=b0(y.getParameter(y.MAX_TEXTURE_IMAGE_UNITS)),n=co();n===0||n>0&&n>e?On(e):n>0&&n<e&&(e=Math.max(8,n));let r=t.tempTextures;r.length&&r.forEach(i=>{y.deleteTexture(i)});let s=[];for(let i=0;i<e;i++){let o=y.createTexture();y.activeTexture(y.TEXTURE0+i),y.bindTexture(y.TEXTURE_2D,o),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),r[i]=o,s.push(i)}t.maxTextures=e,t.textureIndex=s,t.currentActiveTexture=1}function T0(){return X.get(Q.BATCH_SIZE)}function $e(t){y.isBuffer(t)&&y.deleteBuffer(t)}var Ze=class{constructor(t={}){this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;let{batchSize:e=1,dataSize:n=4,isDynamic:r=!0,elementsPerEntry:s=4,vertexElementSize:i=6}=t;this.batchSize=e,this.dataSize=n,this.vertexElementSize=i,this.isDynamic=r,this.elementsPerEntry=s,this.vertexByteSize=i*n,this.entryByteSize=this.vertexByteSize*s,this.bufferByteSize=e*this.entryByteSize,this.create()}resize(t){this.batchSize=t,this.bufferByteSize=t*this.entryByteSize,this.vertexBuffer&&$e(this.vertexBuffer),this.create()}create(){let t=new ArrayBuffer(this.bufferByteSize);this.data=t,this.vertexViewF32=new Float32Array(t),this.vertexViewU32=new Uint32Array(t),this.vertexBuffer=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,this.vertexBuffer);let e=this.isDynamic?y.DYNAMIC_DRAW:y.STATIC_DRAW;y.bufferData(y.ARRAY_BUFFER,t,e),y.bindBuffer(y.ARRAY_BUFFER,null)}add(t){this.count+=t,this.offset+=this.vertexElementSize*t}reset(){this.count=0,this.offset=0}canContain(t){return this.count+t<=this.batchSize}free(){return Math.max(0,1-this.count/this.batchSize)}bind(){y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,null),y.bindBuffer(y.ARRAY_BUFFER,this.vertexBuffer)}destroy(){$e(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null}},uo=class extends Ze{constructor(t={}){super(t);let{indexSize:e=4,entryIndexSize:n=6,indexLayout:r=null}=t;this.indexed=!0,this.indexSize=e,this.entryIndexSize=n,this.entryElementSize=this.vertexElementSize*this.elementsPerEntry;let s=[];if(r){this.indexLayout=r;for(let i=0;i<this.batchSize*e;i+=e)for(let o=0;o<r.length;o++)s.push(i+r[o])}this.create(),this.createIndexBuffer(s)}createIndexBuffer(t){this.index=new Uint16Array(t),this.indexBuffer=y.createBuffer(),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,this.indexBuffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,this.index,y.STATIC_DRAW),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,null),t=[]}bind(){y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,this.indexBuffer),y.bindBuffer(y.ARRAY_BUFFER,this.vertexBuffer)}destroy(){super.destroy(),$e(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null}};function S0(t,e){let n=new Map,r={size:1,type:y.FLOAT,normalized:!1,stride:0,offset:0},s=y.getProgramParameter(t,y.ACTIVE_ATTRIBUTES);for(let i=0;i<s;i++){let o=y.getActiveAttrib(t,i);if(!o)break;let a=o.name,c=y.getAttribLocation(t,a);y.enableVertexAttribArray(c);let u=e.hasOwnProperty(a)?e[a]:{},{size:h=r.size,type:l=r.type,normalized:d=r.normalized,stride:f=r.stride,offset:x=r.offset}=u;n.set(a,{index:c,size:h,type:l,normalized:d,stride:f,offset:x})}return n}function ho(...t){t.forEach(e=>{y.deleteShader(e)})}function v0(...t){let e=y.createProgram();if(t.forEach(r=>{y.attachShader(e,r)}),y.linkProgram(e),!y.getProgramParameter(e,y.LINK_STATUS)){let r=y.getProgramInfoLog(e);return console.error(`Error linking program: ${r}`),y.deleteProgram(e),ho(...t),null}return e}function lo(t,e){let n=y.createShader(e);if(y.shaderSource(n,t),y.compileShader(n),!y.getShaderParameter(n,y.COMPILE_STATUS)){let s=y.getShaderInfoLog(n),i=t.split(`
`).map((o,a)=>`${a}: ${o}`);return console.error(`Error compiling shader: ${s}`,i.join(`
`)),y.deleteShader(n),null}return n}function E0(t,e,n=!1){switch(t.type){case y.INT:case y.BOOL:return n?r=>{y.uniform1iv(e,r)}:r=>{y.uniform1i(e,r)};case y.INT_VEC2:case y.BOOL_VEC2:return r=>{y.uniform2iv(e,r)};case y.INT_VEC3:case y.BOOL_VEC3:return r=>{y.uniform3iv(e,r)};case y.INT_VEC4:case y.BOOL_VEC4:return r=>{y.uniform4iv(e,r)};case y.FLOAT:return n?r=>{y.uniform1fv(e,r)}:r=>{y.uniform1f(e,r)};case y.FLOAT_VEC2:return r=>{y.uniform2fv(e,r)};case y.FLOAT_VEC3:return r=>{y.uniform3fv(e,r)};case y.FLOAT_VEC4:return r=>{y.uniform4fv(e,r)};case y.FLOAT_MAT2:return r=>{y.uniformMatrix2fv(e,!1,r)};case y.FLOAT_MAT3:return r=>{y.uniformMatrix3fv(e,!1,r)};case y.FLOAT_MAT4:return r=>{y.uniformMatrix4fv(e,!1,r)};case y.SAMPLER_2D:case y.SAMPLER_CUBE:return t.size>1?r=>{y.uniform1iv(e,r)}:r=>{y.uniform1i(e,r)}}}function A0(t){let e=new Map,n=y.getProgramParameter(t,y.ACTIVE_UNIFORMS);for(let r=0;r<n;r++){let s=y.getActiveUniform(t,r),i=s.name;if(i.startsWith("gl_")||i.startsWith("webgl_"))continue;let o=y.getUniformLocation(t,s.name);if(o){let a=!1;i.substr(-3)==="[0]"&&(i=i.substr(0,i.length-3),a=s.size>1),e.set(i,E0(s,o,a))}}return e}var z0=5121,kt=5126,fo={aVertexPosition:{size:2,type:kt,normalized:!1,offset:0},aTextureCoord:{size:2,type:kt,normalized:!1,offset:8},aTextureId:{size:1,type:kt,normalized:!1,offset:16},aTintColor:{size:4,type:z0,normalized:!0,offset:20}},D0={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function xo(t,e,n){y.bindFramebuffer(y.FRAMEBUFFER,t);let r=y.createRenderbuffer();return y.bindRenderbuffer(y.RENDERBUFFER,r),y.renderbufferStorage(y.RENDERBUFFER,y.DEPTH_COMPONENT16,e,n),y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.RENDERBUFFER,r),y.bindFramebuffer(y.FRAMEBUFFER,null),r}function Je(t,e){e||(e=y.COLOR_ATTACHMENT0);let n=y.createFramebuffer();return y.bindFramebuffer(y.FRAMEBUFFER,n),y.framebufferTexture2D(y.FRAMEBUFFER,e,y.TEXTURE_2D,t,0),y.bindFramebuffer(y.FRAMEBUFFER,null),n}var F0=`#define SHADER_NAME SINGLE_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`,V0=`#define SHADER_NAME SINGLE_QUAD_VERT

precision highp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute float aTextureId;
attribute vec4 aTintColor;

uniform mat4 uProjectionMatrix;
uniform mat4 uCameraMatrix;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

void main (void)
{
    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vTintColor = aTintColor;

    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);
}`,Un=class{constructor(t,e,n,r,s,i){this.trimmed=!1,this.texture=t,this.key=e,this.x=n,this.y=r,this.width=s,this.height=i,this.sourceSizeWidth=s,this.sourceSizeHeight=i,this.updateUVs()}setPivot(t,e){this.pivot={x:t,y:e}}setSize(t,e){this.width=t,this.height=e,this.sourceSizeWidth=t,this.sourceSizeHeight=e,this.updateUVs()}setSourceSize(t,e){this.sourceSizeWidth=t,this.sourceSizeHeight=e}setTrim(t,e,n,r,s,i){this.trimmed=!0,this.sourceSizeWidth=t,this.sourceSizeHeight=e,this.spriteSourceSizeX=n,this.spriteSourceSizeY=r,this.spriteSourceSizeWidth=s,this.spriteSourceSizeHeight=i}getExtent(t,e){let n=this.sourceSizeWidth,r=this.sourceSizeHeight,s,i,o,a;return this.trimmed?(s=this.spriteSourceSizeX-t*n,i=s+this.spriteSourceSizeWidth,o=this.spriteSourceSizeY-e*r,a=o+this.spriteSourceSizeHeight):(s=-t*n,i=s+n,o=-e*r,a=o+r),{left:s,right:i,top:o,bottom:a}}setExtent(t){let e=t.transform,n=e.origin.x,r=e.origin.y,s=this.sourceSizeWidth,i=this.sourceSizeHeight,o,a,c,u;this.trimmed?(o=this.spriteSourceSizeX-n*s,a=this.spriteSourceSizeY-r*i,c=this.spriteSourceSizeWidth,u=this.spriteSourceSizeHeight):(o=-n*s,a=-r*i,c=s,u=i),e.setExtent(o,a,c,u)}updateUVs(){let{x:t,y:e,width:n,height:r}=this,s=this.texture.width,i=this.texture.height;this.u0=t/s,this.v0=e/i,this.u1=(t+n)/s,this.v1=(e+r)/i}},Z=class{constructor(t,e,n,r){this.key="",t&&(e=t.width,n=t.height),this.image=t,this.width=e,this.height=n,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,e,n),Ke.add(this,r)}addFrame(t,e,n,r,s){if(this.frames.has(t))return null;let i=new Un(this,t,e,n,r,s);return this.frames.set(t,i),(!this.firstFrame||this.firstFrame.key==="__BASE")&&(this.firstFrame=i),i}getFrame(t){if(!t)return this.firstFrame;t instanceof Un&&(t=t.key);let e=this.frames.get(t);return e||(console.warn(`Frame missing: ${t}`),e=this.firstFrame),e}setSize(t,e){this.width=t,this.height=e,this.frames.get("__BASE").setSize(t,e)}destroy(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null}},yo=class{constructor(t){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,t&&this.fromConfig(t)}fromConfig(t){let{attributes:e=fo,fragmentShader:n=F0,height:r=ce(),renderToFramebuffer:s=!1,renderToDepthbuffer:i=!1,resolution:o=ue(),vertexShader:a=V0,width:c=he(),uniforms:u=D0}=t;if(this.create(n,a,u,e),s){this.renderToFramebuffer=!0;let h=new Z(null,c*o,r*o),l=new je(h);h.binding=l,l.framebuffer=Je(l.texture),i&&(this.renderToDepthbuffer=!0,l.depthbuffer=xo(l.framebuffer,h.width,h.height)),this.texture=h,this.framebuffer=l.framebuffer}}create(t,e,n,r){let s=lo(t,y.FRAGMENT_SHADER),i=lo(e,y.VERTEX_SHADER);if(!s||!i)return;let o=v0(s,i);if(!o)return;let a=y.getParameter(y.CURRENT_PROGRAM);y.useProgram(o),this.program=o,this.uniformSetters=A0(o),this.uniforms=new Map;for(let[c,u]of Object.entries(n))this.uniforms.set(c,u);this.attributes=S0(o,r),y.useProgram(a)}updateUniforms(t){}bind(t){return this.updateUniforms(t),this.setUniforms(t)}setUniform(t,e){let n=this.uniforms;n.has(t)&&(n.set(t,e),this.uniformSetters.get(t)(e))}setUniforms(t){if(!this.program)return!1;y.useProgram(this.program);let e=this.uniforms;for(let[n,r]of this.uniformSetters.entries())r(e.get(n));return!0}setAttributes(t){if(this.program){let e=t.currentVertexBuffer.vertexByteSize;this.attributes.forEach(n=>{y.vertexAttribPointer(n.index,n.size,n.type,n.normalized,e,n.offset)})}}destroy(){ho(this.program),Ye(this.texture),Dt(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null}},mo=class extends yo{constructor(t={}){let e=t;e.attributes=e.attributes?e.attributes:fo,super(e)}bind(t){let e=this.uniforms;return e.set("uProjectionMatrix",t.projectionMatrix.data),e.set("uCameraMatrix",t.cameraMatrix.data),super.bind(t)}},G0=`#define SHADER_NAME MULTI_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture[%count%];

void main (void)
{
    vec4 color;

    %forloop%

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`,L0=class extends mo{constructor(t={}){t.fragmentShader||(t.fragmentShader=G0),super(t)}create(t,e,n,r){let s=co(),i="";for(let o=1;o<s;o++)o>1&&(i+=`
	else `),o<s-1&&(i+=`if (vTextureId < ${o}.5)`),i+=`
	{`,i+=`
		color = texture2D(uTexture[${o}], vTextureCoord);`,i+=`
	}`;t=t.replace(/%count%/gi,`${s}`),t=t.replace(/%forloop%/gi,i),super.create(t,e,n,r)}bind(t){return this.uniforms.set("uTexture",t.textureIndex),super.bind(t)}};function _0(t,e,n,r){let s={enable:e,sfactor:n,dfactor:r};t.blendModeStack[0]=s,t.currentBlendMode=s,t.defaultBlendMode=s}function I0(t,e=null,n){let r={framebuffer:e,viewport:n};t.framebufferStack[0]=r,t.currentFramebuffer=r,t.defaultFramebuffer=r}function P0(t,e,n){let r={shader:e,textureID:n};t.shaderStack[0]=r,t.currentShader=r,t.defaultShader=r}function O0(t,e){t.vertexBufferStack[0]=e,t.currentVertexBuffer=e,t.defaultVertexBuffer=e}function B0(t,e=0,n=0,r=0,s=0){let i=new J(e,n,r,s);t.viewportStack[0]=i,t.currentViewport=i,t.defaultViewport=i}var N0=class{constructor(t){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=t,this.projectionMatrix=new _,this.reset()}reset(){let t=this.renderer.gl,e=[0,1,2,2,3,0];this.quadShader=new mo,this.quadBuffer=new uo({isDynamic:!1,indexLayout:e}),this.quadCamera=new wn,R0(this),I0(this),_0(this,!0,t.ONE,t.ONE_MINUS_SRC_ALPHA),O0(this,new uo({batchSize:T0(),indexLayout:e})),P0(this,new L0)}resize(t,e){ys(0,t,e,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),B0(this,0,0,t,e)}};function k0(t,e,n){let r={shader:e,textureID:n};return t.shaderStack.push(r),r}function U0(t,e){return t.vertexBufferStack.push(e),e}function Wn(t,e){e||(e=t.currentShader),e.shader.bind(t,e.textureID)&&e.shader.setAttributes(t)}function W0(t,e){t.current2DCamera=e,t.cameraMatrix=e.matrix,Wn(t)}function H0(t,e){e||(e=t.currentBlendMode),e.enable?(y.enable(y.BLEND),y.blendFunc(e.sfactor,e.dfactor)):y.disable(y.BLEND)}function q0(t,e=0){let n=t.binding;n.setIndex(e),y.activeTexture(y.TEXTURE0+e),y.bindTexture(y.TEXTURE_2D,n.texture)}function Hn(t,e){e||(e=t.currentVertexBuffer);let n=e.indexed?e.indexBuffer:null;y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,n),y.bindBuffer(y.ARRAY_BUFFER,e.vertexBuffer)}function po(t){let e=t.vertexBufferStack;e.length>1&&e.pop(),t.currentVertexBuffer=e[e.length-1],Hn(t)}function wo(t,e){let n=U0(t,e);Hn(t,n),t.currentVertexBuffer=n}function K0(t,e){wo(t,e),t.currentShader.shader.setAttributes(t);let n=at(t,e.count);return po(t),n}function go(t,e=0){let n=t.currentVertexBuffer;t.count+e>=n.batchSize&&at(t);let r=n.indexed?t.count*n.entryElementSize:t.count*n.vertexElementSize;return t.count+=e,{buffer:n,F32:n.vertexViewF32,U32:n.vertexViewU32,offset:r}}function Mo(t){let e=t.shaderStack;e.length>1&&e.pop(),t.currentShader=e[e.length-1],Wn(t)}function Co(t,e,n){let r=k0(t,e,n);Wn(t,r),t.currentShader=r}function bo(t,e){let n=e.binding,r=t.currentActiveTexture;return n.indexCounter<t.startActiveTexture&&(n.indexCounter=t.startActiveTexture,r<t.maxTextures?(n.setIndex(r),y.activeTexture(y.TEXTURE0+r),y.bindTexture(y.TEXTURE_2D,n.texture),t.currentActiveTexture++):(at(t),t.startActiveTexture++,n.indexCounter=t.startActiveTexture,n.setIndex(1),y.activeTexture(y.TEXTURE1),y.bindTexture(y.TEXTURE_2D,n.texture),t.currentActiveTexture=2)),n.index}function Q0(t){t.current2DCamera=t.quadCamera,t.cameraMatrix=t.quadCamera.matrix,t.count=0,t.flushTotal=0,kn(t,!1,t.defaultFramebuffer),H0(t,t.defaultBlendMode),Nn(t,t.defaultViewport),Hn(t,t.defaultVertexBuffer)}function X0(t,e=0){y.activeTexture(y.TEXTURE0+e),y.bindTexture(y.TEXTURE_2D,t.tempTextures[e]),e>0&&t.startActiveTexture++}var Ro,To={get:()=>Ro,set:t=>{Ro=t}},So=class{constructor(){this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=he(),this.height=ce(),this.resolution=ue(),this.setBackgroundColor(no());let t=document.createElement("canvas");t.addEventListener("webglcontextlost",e=>this.onContextLost(e),!1),t.addEventListener("webglcontextrestored",()=>this.onContextRestored(),!1),this.canvas=t,this.initContext(),To.set(this),this.renderPass=new N0(this),this.resize(this.width,this.height,this.resolution)}initContext(){let t=this.canvas.getContext("webgl",w0());io.set(t),this.gl=t,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)}resize(t,e,n=1){let r=t*n,s=e*n;this.width=r,this.height=s,this.resolution=n;let i=this.canvas;i.width=r,i.height=s,this.autoResize&&(i.style.width=t.toString()+"px",i.style.height=e.toString()+"px"),this.renderPass.resize(r,s)}onContextLost(t){t.preventDefault(),this.contextLost=!0}onContextRestored(){this.contextLost=!1,this.initContext()}setBackgroundColor(t){return p0(t,this.clearColor),this}reset(){}render(t){if(this.contextLost)return;let e=this.gl,n=this.renderPass;if(g0(),this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0)return;if(this.clearBeforeRender){let s=this.clearColor;e.clearColor(s[0],s[1],s[2],s[3]),e.clear(e.COLOR_BUFFER_BIT)}let r=t.worldData;Q0(n);for(let s=0;s<r.length;s++){let{world:i}=r[s];i.renderGL(n),i.postRenderGL(n)}m0(n)}destroy(){To.set(void 0)}};function s0(){return()=>{ro(So)}}function Y0(t){X.set(Q.WEBGL_CONTEXT,t)}function i0(t){return()=>{Y0(t)}}var j0={};v(j0,{AddToDOM:()=>vo,DOMContentLoaded:()=>Eo,GetElement:()=>Bn,ParseXML:()=>Ao,RemoveFromDOM:()=>$0});function vo(t,e){return Bn(e).appendChild(t),t}function Eo(t){let e=document.readyState;if(e==="complete"||e==="interactive"){t();return}let n=()=>{document.removeEventListener("deviceready",n,!0),document.removeEventListener("DOMContentLoaded",n,!0),window.removeEventListener("load",n,!0),t()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",n,!0):(document.addEventListener("DOMContentLoaded",n,!0),window.addEventListener("load",n,!0)):window.setTimeout(n,20)}function Ao(t){let e;try{return e=new DOMParser().parseFromString(t,"text/xml"),!e||!e.documentElement||e.getElementsByTagName("parsererror").length?null:e}catch(n){return null}}function $0(t){t.parentNode&&t.parentNode.removeChild(t)}var Z0={};v(Z0,{Audio:()=>zo,Browser:()=>Fo,CanPlayAudioType:()=>dt,CanPlayH264Video:()=>gr,CanPlayHLSVideo:()=>Mr,CanPlayM4A:()=>qn,CanPlayMP3:()=>Kn,CanPlayOGG:()=>Qn,CanPlayOGGVideo:()=>Cr,CanPlayOpus:()=>Xn,CanPlayVP9Video:()=>br,CanPlayVideoType:()=>Ft,CanPlayWAV:()=>Yn,CanPlayWebM:()=>jn,CanPlayWebMVideo:()=>Rr,GetAudio:()=>Do,GetBrowser:()=>Vo,GetOS:()=>Lo,GetVideo:()=>Io,HasAudio:()=>$n,HasWebAudio:()=>Zn,IsAndroid:()=>cr,IsChrome:()=>Jn,IsChromeOS:()=>ur,IsCordova:()=>hr,IsCrosswalk:()=>lr,IsEdge:()=>tr,IsEjecta:()=>fr,IsFirefox:()=>er,IsKindle:()=>dr,IsLinux:()=>xr,IsMSIE:()=>nr,IsMacOS:()=>yr,IsMobileSafari:()=>rr,IsNode:()=>nn,IsNodeWebkit:()=>mr,IsOpera:()=>sr,IsSafari:()=>ir,IsSilk:()=>or,IsTrident:()=>ar,IsWebApp:()=>pr,IsWindows:()=>wr,IsWindowsPhone:()=>en,IsiOS:()=>tn,OS:()=>Go,Video:()=>_o});var zo={};v(zo,{CanPlayAudioType:()=>dt,CanPlayM4A:()=>qn,CanPlayMP3:()=>Kn,CanPlayOGG:()=>Qn,CanPlayOpus:()=>Xn,CanPlayWAV:()=>Yn,CanPlayWebM:()=>jn,GetAudio:()=>Do,HasAudio:()=>$n,HasWebAudio:()=>Zn});var Tr;function dt(t,e){return e||(Tr||(Tr=document.createElement("audio")),e=Tr),e&&e.canPlayType(t)!==""}function qn(t){return dt("audio/x-m4a",t)||dt("audio/aac",t)}function Kn(t){return dt('audio/mpeg; codecs="mp3"',t)}function Qn(t){return dt('audio/ogg; codecs="vorbis"',t)}function Xn(t){return dt('audio/ogg; codecs="opus"',t)||dt('audio/webm; codecs="opus"',t)}function Yn(t){return dt('audio/wav; codecs="1"',t)}function jn(t){return dt('audio/webm; codecs="vorbis"',t)}function $n(){return window&&window.hasOwnProperty("Audio")}function Zn(){return window&&(window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"))}function Do(){let t={audioData:$n(),m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:Zn(),webm:!1};return t.audioData&&(t.m4a=qn(),t.mp3=Kn(),t.ogg=Qn(),t.opus=Xn(),t.wav=Yn(),t.webm=jn()),t}var Fo={};v(Fo,{GetBrowser:()=>Vo,IsChrome:()=>Jn,IsEdge:()=>tr,IsFirefox:()=>er,IsMSIE:()=>nr,IsMobileSafari:()=>rr,IsOpera:()=>sr,IsSafari:()=>ir,IsSilk:()=>or,IsTrident:()=>ar});function Jn(){let t=/Chrome\/(\d+)/.test(navigator.userAgent),e=t?parseInt(RegExp.$1,10):0;return{chrome:t,chromeVersion:e}}function tr(){return{edge:/Edge\/\d+/.test(navigator.userAgent)}}function er(){let t=/Firefox\D+(\d+)/.test(navigator.userAgent),e=t?parseInt(RegExp.$1,10):0;return{firefox:t,firefoxVersion:e}}function nr(){let t=/MSIE (\d+\.\d+);/.test(navigator.userAgent),e=t?parseInt(RegExp.$1,10):0;return{ie:t,ieVersion:e}}function tn(){let t=navigator.userAgent,e={iOS:!1,iOSVersion:0,iPhone:!1,iPad:!1};if(/iP[ao]d|iPhone/i.test(t)){let n=/OS (\d+)/.exec(navigator.appVersion);e.iOS=!0,e.iOSVersion=parseInt(n[0],10),e.iPhone=t.toLowerCase().includes("iphone"),e.iPad=t.toLowerCase().includes("ipad")}return e}function rr(){let{iOS:t}=tn();return{mobileSafari:navigator.userAgent.includes("AppleWebKit")&&t}}function sr(){return{opera:navigator.userAgent.includes("Opera")}}function en(){let t=navigator.userAgent;return/Windows Phone/i.test(t)||/IEMobile/i.test(t)}function ir(){let t=navigator.userAgent,e=t.includes("Safari")&&!en(),n=/Version\/(\d+)\./.test(t)?parseInt(RegExp.$1,10):0;return{safari:e,safariVersion:n}}function or(){return{silk:navigator.userAgent.includes("Silk")}}function ar(){let t=/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(navigator.userAgent),e=t?parseInt(RegExp.$1,10):0,n=t?parseInt(RegExp.$3,10):0;return{trident:t,tridentVersion:e,tridentIEVersion:n}}function Vo(){let{chrome:t,chromeVersion:e}=Jn(),{edge:n}=tr(),{firefox:r,firefoxVersion:s}=er(),{ie:i,ieVersion:o}=nr(),{mobileSafari:a}=rr(),{opera:c}=sr(),{safari:u,safariVersion:h}=ir(),{silk:l}=or(),{trident:d,tridentVersion:f,tridentIEVersion:x}=ar();return d&&(i=!0,o=x),{chrome:t,chromeVersion:e,edge:n,firefox:r,firefoxVersion:s,ie:i,ieVersion:o,mobileSafari:a,opera:c,safari:u,safariVersion:h,silk:l,trident:d,tridentVersion:f}}var Go={};v(Go,{GetOS:()=>Lo,IsAndroid:()=>cr,IsChromeOS:()=>ur,IsCordova:()=>hr,IsCrosswalk:()=>lr,IsEjecta:()=>fr,IsKindle:()=>dr,IsLinux:()=>xr,IsMacOS:()=>yr,IsNode:()=>nn,IsNodeWebkit:()=>mr,IsWebApp:()=>pr,IsWindows:()=>wr,IsWindowsPhone:()=>en,IsiOS:()=>tn});function cr(){return navigator.userAgent.includes("Android")}function ur(){return navigator.userAgent.includes("CrOS")}function hr(){return window.hasOwnProperty("cordova")}function lr(){return navigator.userAgent.includes("Crosswalk")}function fr(){return window.hasOwnProperty("ejecta")}function dr(){let t=navigator.userAgent;return t.includes("Kindle")||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)}function xr(){return navigator.userAgent.includes("Linux")}function yr(){let t=navigator.userAgent;return t.includes("Mac OS")&&!t.includes("like Mac OS")}function nn(){return typeof process!="undefined"&&typeof process.versions=="object"&&process.versions.hasOwnProperty("node")}function mr(){return nn()&&!!process.versions.hasOwnProperty("node-webkit")}function pr(){return navigator.hasOwnProperty("standalone")}function wr(){return navigator.userAgent.includes("Windows")}function Lo(){let t=navigator.userAgent,{iOS:e,iOSVersion:n,iPad:r,iPhone:s}=tn(),i={android:cr(),chromeOS:ur(),cordova:hr(),crosswalk:lr(),desktop:!1,ejecta:fr(),iOS:e,iOSVersion:n,iPad:r,iPhone:s,kindle:dr(),linux:xr(),macOS:yr(),node:nn(),nodeWebkit:mr(),pixelRatio:1,webApp:pr(),windows:wr(),windowsPhone:en()};i.windowsPhone&&(i.android=!1,i.iOS=!1,i.macOS=!1,i.windows=!0);let o=t.includes("Silk");return(i.windows||i.macOS||i.linux&&!o||i.chromeOS)&&(i.desktop=!0),(i.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(i.desktop=!1),i}var _o={};v(_o,{CanPlayH264Video:()=>gr,CanPlayHLSVideo:()=>Mr,CanPlayOGGVideo:()=>Cr,CanPlayVP9Video:()=>br,CanPlayVideoType:()=>Ft,CanPlayWebMVideo:()=>Rr,GetVideo:()=>Io});var Sr;function Ft(t,e){return e||(Sr||(Sr=document.createElement("video")),e=Sr),e&&e.canPlayType(t)!==""}function gr(t){return Ft('video/mp4; codecs="avc1.42E01E"',t)}function Mr(t){return Ft('application/x-mpegURL; codecs="avc1.42E01E"',t)}function Cr(t){return Ft('video/ogg; codecs="theora"',t)}function br(t){return Ft('video/webm; codecs="vp9"',t)}function Rr(t){return Ft('video/webm; codecs="vp8, vorbis"',t)}function Io(){return{h264Video:gr(),hlsVideo:Mr(),oggVideo:Cr(),vp9Video:br(),webmVideo:Rr()}}var vr={};v(vr,{AddChild:()=>Oo,AddChildAt:()=>J0,AddChildren:()=>tx,AddChildrenAt:()=>ex,AddPosition:()=>nx,AddRotation:()=>rx,AddScale:()=>sx,AddSkew:()=>ix,BringChildToTop:()=>ox,ConsoleTreeChildren:()=>ax,CountMatchingChildren:()=>cx,DepthFirstSearch:()=>Ut,DepthFirstSearchRecursive:()=>Bo,DepthFirstSearchRecursiveNested:()=>zr,DestroyChildren:()=>No,FindChildByName:()=>ux,FindChildrenByName:()=>hx,GetAllChildren:()=>lx,GetChildAt:()=>fx,GetChildIndex:()=>pt,GetChildren:()=>dx,GetClosestChild:()=>xx,GetFirstChild:()=>yx,GetFurthestChild:()=>mx,GetLastChild:()=>px,GetParents:()=>wx,GetRandomChild:()=>gx,MoveChildDown:()=>Mx,MoveChildTo:()=>Cx,MoveChildUp:()=>bx,Overlap:()=>Rx,RemoveChild:()=>Ar,RemoveChildAt:()=>Er,RemoveChildren:()=>ko,RemoveChildrenAt:()=>Tx,RemoveChildrenBetween:()=>Dr,ReparentChildren:()=>Uo,RotateChildrenLeft:()=>Sx,RotateChildrenRight:()=>vx,SendChildToBack:()=>Ex,SetBounds:()=>Ax,SetChildrenValue:()=>zx,SetName:()=>Dx,SetOrigin:()=>Fx,SetParent:()=>fe,SetPosition:()=>Vx,SetRotation:()=>Gx,SetScale:()=>Lx,SetSize:()=>_x,SetSkew:()=>Ix,SetType:()=>Px,SetValue:()=>Ox,SetVisible:()=>Bx,SetWorld:()=>Po,ShuffleChildren:()=>Nx,SwapChildren:()=>kx});function Ut(t){let e=[t],n=[];for(;e.length>0;){let r=e.shift();n.push(r);let s=r.numChildren;if(s>0)for(let i=s-1;i>=0;i--)e.unshift(r.children[i])}return n.shift(),n}function pt(t,e){return t.children.indexOf(e)}function Er(t,e){let n=t.children,r;if(e>=0&&e<n.length){let s=n.splice(e,1);s[0]&&(r=s[0],r.parent=null)}return r}function Ar(t,e){let n=pt(t,e);return n>-1&&Er(t,n),e}var rn="addedtoworld",sn="destroy",Wo="postupdate",on="removedfromworld",Ho="update";function I(t,e,...n){if(t.events.size===0||!t.events.has(e))return!1;let r=t.events.get(e);for(let s of r)s.callback.apply(s.context,n),s.once&&r.delete(s);return r.size===0&&t.events.delete(e),!0}function Po(t,...e){return e.forEach(n=>{n.world&&(I(n.world,on,n,n.world),I(n,on,n,n.world)),n.world=t,I(t,rn,n,t),I(n,rn,n,t)}),e}function fe(t,...e){e.forEach(r=>{r.parent&&Ar(r.parent,r),r.parent=t});let n=t.world;return n&&Po(n,...Ut(t)),e}function Oo(t,e){return t.children.push(e),fe(t,e),e.transform.updateWorld(),e}function J0(t,e,n){let r=t.children;return e>=0&&e<=r.length&&(fe(t,n),r.splice(e,0,n),n.transform.updateWorld()),n}function tx(t,...e){return e.forEach(n=>{Oo(t,n)}),e}function ex(t,e,...n){let r=t.children;return e>=0&&e<=r.length&&n.reverse().forEach(s=>{n.splice(e,0,s),fe(t,s),s.transform.updateWorld()}),n}function nx(t,e,...n){return n.forEach(r=>{r.x+=t,r.y+=e}),n}function rx(t,...e){return e.forEach(n=>{n.rotation+=t}),e}function sx(t,e,...n){return n.forEach(r=>{r.scaleX+=t,r.scaleY+=e}),n}function ix(t,e,...n){return n.forEach(r=>{r.skewX+=t,r.skewY+=e}),n}var G={CLEAR:0,TRANSFORM:1,UPDATE:2,CHILD_CACHE:4,POST_RENDER:8,COLORS:16,BOUNDS:32,TEXTURE:64,FRAME:128,ALPHA:256,CHILD:512,DEFAULT:1+2+16+32,USER1:536870912,USER2:1073741824,USER3:2147483648,USER4:4294967296};function ox(t,e){let n=t.children,r=pt(t,e);return r!==-1&&r<n.length&&(n.splice(r,1),n.push(e),e.setDirty(G.TRANSFORM)),e}function zr(t,e=[]){for(let n=0;n<t.numChildren;n++){let r=t.children[n],s=[];e.push({node:r,children:s}),r.numChildren>0&&zr(r,s)}return e}function an(t){return`${t.numChildren>0?"Parent":"Child"} [ type=${t.type}, name=${t.name} ]`}function qo(t){console.group(an(t.node)),t.children.forEach(e=>{e.children.length>0?qo(e):console.log(an(e.node))}),console.groupEnd()}function ax(t){let e=zr(t);t.world===t?console.group("World"):console.group(an(t)),e.forEach(n=>{n.children.length?qo(n):console.log(an(n.node))}),console.groupEnd()}function cx(t,e,n){let r=t.children,s=0;return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s++}),s}function Bo(t,e=[]){for(let n=0;n<t.numChildren;n++){let r=t.children[n];e.push(r),r.numChildren>0&&Bo(r,e)}return e}function Dr(t,e=0,n){let r=t.children;n===void 0&&(n=r.length);let s=n-e;if(s>0&&s<=n){let i=r.splice(e,s);return i.forEach(o=>{o.parent=null}),i}else return[]}function No(t,e=0,n){Dr(t,e,n).forEach(s=>{s.destroy()})}function ux(t,e){let n=Ut(t),r=RegExp(e);for(let s=0;s<n.length;s++){let i=n[s];if(r.test(i.name))return i}}function hx(t,e){let n=Ut(t),r=RegExp(e),s=[];return n.forEach(i=>{r.test(i.name)&&s.push(i)}),s}function lx(t,e,n){let r=Ut(t);if(!e)return r;let s=[];return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s.push(i)}),s}function fx(t,e){let n=t.children;if(e<0||e>n.length)throw new Error(`Index out of bounds: ${e}`);return n[e]}function dx(t,e,n){let r=t.children;if(!e)return[...r];let s=[];return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s.push(i)}),s}function xx(t,e){let n=t.children,r=null,s=0;return n.forEach(i=>{let o=Bt(e,i.transform.position);(!r||o<s)&&(r=i,s=o)}),r}function yx(t,e,n){let r=t.children;for(let s=0;s<r.length;s++){let i=r[s],o=Object.getOwnPropertyDescriptor(i,e);if(o&&(n===void 0||n===o.value))return i}}function mx(t,e){let n=t.children,r=null,s=0;return n.forEach(i=>{let o=Bt(e,i.transform.position);(!r||o>s)&&(r=i,s=o)}),r}function px(t,e,n){let r=t.children;for(let s=r.length-1;s>=0;s--){let i=r[s],o=Object.getOwnPropertyDescriptor(i,e);if(o&&(n===void 0||n===o.value))return i}}function wx(t){let e=[];for(;t.parent;)e.push(t.parent),t=t.parent;return e}function gx(t,e=0,n){let r=t.children;n||(n=r.length);let s=e+Math.floor(Math.random()*n);return r[s]}function Mx(t,e){let n=t.children,r=pt(t,e);if(r>0){let s=n[r-1],i=n.indexOf(s);n[r]=s,n[i]=e,e.setDirty(G.TRANSFORM),s.setDirty(G.TRANSFORM)}return e}function Cx(t,e,n){let r=t.children,s=pt(t,e);if(s===-1||n<0||n>=r.length)throw new Error("Index out of bounds");return s!==n&&(r.splice(s,1),r.splice(n,0,e),e.setDirty(G.TRANSFORM)),e}function bx(t,e){let n=t.children,r=pt(t,e);if(r!==-1&&r>0){let s=n[r+1],i=n.indexOf(s);n[r]=s,n[i]=e,e.setDirty(G.TRANSFORM),s.setDirty(G.TRANSFORM)}return e}function de(t,e){return t.width<=0||t.height<=0||e.width<=0||e.height<=0?!1:!(t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}function Rx(t,...e){let n=t.bounds.get();for(let r=0;r<e.length;r++){let i=e[r].bounds.get();if(de(n,i))return!0}return!1}function ko(t,...e){return e.forEach(n=>{Ar(t,n)}),e}function Tx(t,...e){let n=[];return e.sort((r,s)=>r-s),e.reverse().forEach(r=>{let s=Er(t,r);s&&n.push(s)}),n}function Uo(t,e,n=0,r){let s=Dr(t,n,r);return fe(e,...s),s.forEach(i=>{i.transform.updateWorld()}),s}function Sx(t,e=1){let n=t.children,r=null;for(let s=0;s<e;s++)r=n.shift(),n.push(r),r.setDirty(G.TRANSFORM);return r}function vx(t,e=1){let n=t.children,r=null;for(let s=0;s<e;s++)r=n.pop(),n.unshift(r),r.setDirty(G.TRANSFORM);return r}function Ex(t,e){let n=t.children,r=pt(t,e);return r!==-1&&r>0&&(n.splice(r,1),n.unshift(e),e.setDirty(G.TRANSFORM)),e}function Ax(t,e,n,r,...s){return s.forEach(i=>{i.bounds.set(t,e,n,r)}),s}function zx(t,e,n){let r=Ut(t);return r.forEach(s=>{let i=Object.getOwnPropertyDescriptor(s,e);i&&i.set(n)}),r}function Dx(t,...e){return e.forEach(n=>{n.name=t}),e}function Fx(t,e,...n){return n.forEach(r=>{r.setOrigin(t,e)}),n}function Vx(t,e,...n){return n.forEach(r=>{r.setPosition(t,e)}),n}function Gx(t,...e){return e.forEach(n=>{n.rotation=t}),e}function Lx(t,e,...n){return n.forEach(r=>{r.setScale(t,e)}),n}function _x(t,e,...n){return n.forEach(r=>{r.setSize(t,e)}),n}function Ix(t,e,...n){return n.forEach(r=>{r.setSkew(t,e)}),n}function Px(t,...e){return e.forEach(n=>{n.type=t}),e}function Ox(t,e,...n){return n.forEach(r=>{let s=Object.getOwnPropertyDescriptor(r,t);s&&s.set(e)}),n}function Bx(t,...e){return e.forEach(n=>{n.visible=t}),e}function Nx(t){let e=t.children;for(let n=e.length-1;n>0;n--){let r=Math.floor(Math.random()*(n+1)),s=e[n];e[n]=e[r],e[r]=s,s.setDirty(G.TRANSFORM)}return e}function kx(t,e){if(t.parent===e.parent){let n=t.parent.children,r=pt(t.parent,t),s=pt(e.parent,e);r!==s&&(n[r]=e,n[s]=t)}}var Ux={};v(Ux,{AddChild3D:()=>Qo,AddChild3DAt:()=>Xo,AddChildren3D:()=>Wx,AddChildren3DAt:()=>Hx,ConsoleTreeChildren3D:()=>qx,CountMatchingChildren3D:()=>Kx,DepthFirstSearch3D:()=>Wt,DepthFirstSearchRecursive3D:()=>Yo,DepthFirstSearchRecursiveNested3D:()=>Vr,DestroyChildren3D:()=>Qx,FindChild3DByName:()=>Xx,FindChildren3DByName:()=>Yx,GetAllChildren3D:()=>jx,GetChild3DAt:()=>$x,GetChild3DIndex:()=>Ht,GetChildren3D:()=>Zx,GetFirstChild3D:()=>Jx,GetLastChild3D:()=>ty,GetParents3D:()=>ey,GetRandomChild3D:()=>ny,MoveChild3DTo:()=>jo,RemoveChild3D:()=>qt,RemoveChild3DAt:()=>Fr,RemoveChildren3D:()=>$o,RemoveChildren3DAt:()=>ry,RemoveChildren3DBetween:()=>Gr,ReparentChildren3D:()=>sy,ReplaceChild3D:()=>iy,SetChildren3DValue:()=>oy,SetParent3D:()=>xe,SetWorld3D:()=>Ko,SwapChildren3D:()=>ay});function Wt(t){let e=[t],n=[];for(;e.length>0;){let r=e.shift();n.push(r);let s=r.numChildren;if(s>0)for(let i=s-1;i>=0;i--)e.unshift(r.children[i])}return n.shift(),n}function Ht(t,e){return t.children.indexOf(e)}function Fr(t,e){let n=t.children,r;if(e>=0&&e<n.length){let s=n.splice(e,1);s[0]&&(r=s[0],r.parent=null)}return r}function qt(t,e){let n=Ht(t,e);return n>-1&&Fr(t,n),e}function Ko(t,...e){return e.forEach(n=>{n.world&&(I(n.world,on,n,n.world),I(n,on,n,n.world)),n.world=t,I(t,rn,n,t),I(n,rn,n,t)}),e}function xe(t,...e){e.forEach(r=>{r.parent&&qt(r.parent,r),r.parent=t});let n=t.world;return n&&Ko(n,...Wt(t)),e}function Qo(t,e){return t.children.push(e),xe(t,e),e}function Xo(t,e,n){let r=t.children;return e>=0&&e<=r.length&&(xe(t,n),r.splice(e,0,n)),n}function Wx(t,...e){return e.forEach(n=>{Qo(t,n)}),e}function Hx(t,e,...n){let r=t.children;return e>=0&&e<=r.length&&n.reverse().forEach(s=>{n.splice(e,0,s),xe(t,s)}),n}function Vr(t,e=[]){for(let n=0;n<t.numChildren;n++){let r=t.children[n],s=[];e.push({node:r,children:s}),r.numChildren>0&&Vr(r,s)}return e}function cn(t){return`${t.numChildren>0?"Parent":"Child"} [ type=${t.type}, name=${t.name} ]`}function Zo(t){console.group(cn(t.node)),t.children.forEach(e=>{e.children.length>0?Zo(e):console.log(cn(e.node))}),console.groupEnd()}function qx(t){let e=Vr(t);t.world===t?console.group("World"):console.group(cn(t)),e.forEach(n=>{n.children.length?Zo(n):console.log(cn(n.node))}),console.groupEnd()}function Kx(t,e,n){let r=t.children,s=0;return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s++}),s}function Yo(t,e=[]){for(let n=0;n<t.numChildren;n++){let r=t.children[n];e.push(r),r.numChildren>0&&Yo(r,e)}return e}function Gr(t,e=0,n){let r=t.children;n===void 0&&(n=r.length);let s=n-e;if(s>0&&s<=n){let i=r.splice(e,s);return i.forEach(o=>{o.parent=null}),i}else return[]}function Qx(t,e=0,n){Gr(t,e,n).forEach(s=>{s.destroy()})}function Xx(t,e){let n=Wt(t),r=RegExp(e);for(let s=0;s<n.length;s++){let i=n[s];if(r.test(i.name))return i}}function Yx(t,e){let n=Wt(t),r=RegExp(e),s=[];return n.forEach(i=>{r.test(i.name)&&s.push(i)}),s}function jx(t,e,n){let r=Wt(t);if(!e)return r;let s=[];return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s.push(i)}),s}function $x(t,e){let n=t.children;if(e<0||e>n.length)throw new Error(`Index out of bounds: ${e}`);return n[e]}function Zx(t,e,n){let r=t.children;if(!e)return[...r];let s=[];return r.forEach(i=>{let o=Object.getOwnPropertyDescriptor(i,e);o&&(n===void 0||n===o.value)&&s.push(i)}),s}function Jx(t,e,n){let r=t.children;for(let s=0;s<r.length;s++){let i=r[s],o=Object.getOwnPropertyDescriptor(i,e);if(o&&(n===void 0||n===o.value))return i}}function ty(t,e,n){let r=t.children;for(let s=r.length-1;s>=0;s--){let i=r[s],o=Object.getOwnPropertyDescriptor(i,e);if(o&&(n===void 0||n===o.value))return i}}function ey(t){let e=[];for(;t.parent;)e.push(t.parent),t=t.parent;return e}function ny(t,e=0,n){let r=t.children;n||(n=r.length);let s=e+Math.floor(Math.random()*n);return r[s]}function jo(t,e,n){let r=t.children,s=Ht(t,e);if(s===-1||n<0||n>=r.length)throw new Error("Index out of bounds");return s!==n&&(r.splice(s,1),r.splice(n,0,e),e.setDirty(G.TRANSFORM)),e}function $o(t,...e){return e.forEach(n=>{qt(t,n)}),e}function ry(t,...e){let n=[];return e.sort((r,s)=>r-s),e.reverse().forEach(r=>{let s=Fr(t,r);s&&n.push(s)}),n}function sy(t,e,n=0,r){let s=Gr(t,n,r);return xe(e,...s),s.forEach(i=>{}),s}function iy(t,e){let n=t.parent,r=e.parent,s=Ht(n,t);return n===r?(jo(n,e,s),qt(n,t)):(qt(n,t),qt(r,e),Xo(n,s,e)),t}function oy(t,e,n){let r=Wt(t);return r.forEach(s=>{let i=Object.getOwnPropertyDescriptor(s,e);i&&i.set(n)}),r}function ay(t,e){if(t.parent===e.parent){let n=t.parent.children,r=Ht(t.parent,t),s=Ht(e.parent,e);r!==s&&(n[r]=e,n[s]=t)}}var cy={};v(cy,{ClearEvent:()=>uy,Emit:()=>I,EventEmitter:()=>ye,EventInstance:()=>Lr,GetEventNames:()=>hy,GetListenerCount:()=>ly,GetListeners:()=>fy,Off:()=>Vt,On:()=>Mt,Once:()=>un,RemoveAllListeners:()=>dy});function uy(t,e){return t.events.delete(e),t}var ye=class{constructor(){this.events=new Map}},Lr=class{constructor(t,e,n=!1){this.callback=t,this.context=e,this.once=n}};function hy(t){return[...t.events.keys()]}function ly(t,e){let n=t.events.get(e);return n?n.size:0}function fy(t,e){let n=[];return t.events.get(e).forEach(s=>{n.push(s.callback)}),n}function Vt(t,e,n,r,s){let i=t.events,o=i.get(e);if(!n)i.delete(e);else if(n instanceof Lr)o.delete(n);else{let a=!r,c=s!==void 0;for(let u of o)u.callback===n&&a&&u.context===r&&c&&u.once===s&&o.delete(u)}return o.size===0&&i.delete(e),t}function Mt(t,e,n,r=t,s=!1){if(typeof n!="function")throw new TypeError("Listener not a function");let i=new Lr(n,r,s),o=t.events.get(e);return o?o.add(i):t.events.set(e,new Set([i])),i}function un(t,e,n,r=t){return Mt(t,e,n,r,!0)}function dy(t,e){e?t.events.delete(e):t.events.clear()}var _r={};v(_r,{AnimatedSprite:()=>xy,Components:()=>Jo,Container:()=>ta,EffectLayer:()=>yy,GameObject:()=>hn,Layer:()=>ln,RenderLayer:()=>ea,Sprite:()=>Ir,SpriteBatch:()=>my,Text:()=>py});var Jo={};v(Jo,{Bounds:()=>na,Input:()=>ra,Transform:()=>sa,Vertex:()=>Ct});var na={};v(na,{BoundsComponent:()=>ia});function Pr(t){let{a:e,b:n,c:r,d:s,tx:i,ty:o}=t.world,{x:a,y:c,right:u,bottom:h}=t.extent,l=a*e+c*r+i,d=a*n+c*s+o,f=a*e+h*r+i,x=a*n+h*s+o,p=u*e+h*r+i,m=u*n+h*s+o,w=u*e+c*r+i,g=u*n+c*s+o;return{x0:l,y0:d,x1:f,y1:x,x2:p,y2:m,x3:w,y3:g}}var ia=class{constructor(t){this.fixed=!1,this.includeChildren=!0,this.visibleOnly=!0,this.entity=t,this.area=new J}set(t,e,n,r){this.area.set(t,e,n,r)}get(){return this.entity.isDirty(G.BOUNDS)&&!this.fixed&&this.update(),this.area}updateLocal(){let{x0:t,y0:e,x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=Pr(this.entity.transform),c=Math.min(t,n,s,o),u=Math.min(e,r,i,a),h=Math.max(t,n,s,o),l=Math.max(e,r,i,a);return this.area.set(c,u,h-c,l-u)}update(){let t=this.updateLocal();if(this.entity.clearDirty(G.BOUNDS),!this.includeChildren||!this.entity.numChildren)return t;let e=this.visibleOnly,n=this.entity.children,r=t.x,s=t.y,i=t.right,o=t.bottom;for(let a=0;a<n.length;a++){let c=n[a];if(!c||e&&!c.visible)continue;let u=c.bounds.get();u.x<r&&(r=u.x),u.y<s&&(s=u.y),u.right>i&&(i=u.right),u.bottom>o&&(o=u.bottom)}return t.set(r,s,i-r,o-s)}destroy(){this.entity=null,this.area=null}},ra={};v(ra,{InputComponent:()=>oa});var oa=class{constructor(t){this.enabled=!1,this.enabledChildren=!0,this.entity=t}destroy(){this.entity=null,this.hitArea=null}},sa={};v(sa,{GetVertices:()=>Pr,TransformComponent:()=>ua,UpdateLocalTransform:()=>aa,UpdateWorldTransform:()=>ca});function wy(){return X.get(Q.DEFAULT_ORIGIN).x}function gy(){return X.get(Q.DEFAULT_ORIGIN).y}var ha={};v(ha,{CeilRectangle:()=>My,CeilRectanglePosition:()=>Cy,CenterRectangleOn:()=>la,CloneRectangle:()=>by,CopyRectangleFrom:()=>Ry,DecomposeRectangle:()=>fa,FitRectangleInside:()=>Ty,FitRectangleOutside:()=>Sy,FitRectangleToPoint:()=>vy,FitRectangleToPoints:()=>Ey,FloorRectangle:()=>Ay,FloorRectanglePosition:()=>zy,GetRectangleArea:()=>Dy,GetRectangleAspectRatio:()=>me,GetRectangleCenter:()=>Fy,GetRectangleCenterX:()=>Kt,GetRectangleCenterY:()=>Qt,GetRectangleEdges:()=>pe,GetRectangleIntersection:()=>Vy,GetRectangleMarchingAnts:()=>Gy,GetRectangleOverlap:()=>Ly,GetRectanglePerimeter:()=>we,GetRectanglePerimeterPoint:()=>_y,GetRectanglePoint:()=>da,GetRectanglePoints:()=>Iy,GetRectangleRandomPoint:()=>Py,GetRectangleRandomPointOutside:()=>Oy,GetRectangleSize:()=>By,GetRectangleUnion:()=>Ny,InflateRectangle:()=>ky,MergeRectangle:()=>Uy,Rectangle:()=>J,RectangleContains:()=>yt,RectangleContainsPoint:()=>Wy,RectangleContainsRectangle:()=>xa,RectangleEquals:()=>Hy,RectangleFromPoints:()=>qy,RectangleSizeEquals:()=>Ky,ScaleRectangle:()=>Qy,TranslateRectangle:()=>Xy,TranslateRectanglePoint:()=>Yy});function My(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}function Cy(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}function la(t,e,n){return t.x=e-t.width/2,t.y=n-t.height/2,t}function by(t){return new J(t.x,t.y,t.width,t.height)}function Ry(t,e){return e.set(t.x,t.y,t.width,t.height)}function fa(t,e=[]){return e.push(new T(t.x,t.y),new T(t.right,t.y),new T(t.right,t.bottom),new T(t.x,t.bottom)),e}function me(t){return t.height===0?NaN:t.width/t.height}function Kt(t){return t.x+t.width/2}function Qt(t){return t.y+t.height/2}function Ty(t,e){let n=me(t),r=e.width,s=e.height;return n<me(e)?r=e.height*n:s=e.width/n,t.set(Kt(e)-t.width/2,Qt(e)-t.height/2,r,s)}function Sy(t,e){let n=me(t),r=e.width,s=e.height;return n>me(e)?r=e.height*n:s=e.width/n,t.set(Kt(e)-t.width/2,Qt(e)-t.height/2,r,s)}function vy(t,e,n){let r=Math.min(t.x,e),s=Math.max(t.right,e),i=Math.min(t.y,n),o=Math.max(t.bottom,n);return t.set(r,i,s-r,o-i)}function Ey(t,e){let n=t.x,r=t.right,s=t.y,i=t.bottom;for(let o=0;o<e.length;o++)n=Math.min(n,e[o].x),r=Math.max(r,e[o].x),s=Math.min(s,e[o].y),i=Math.max(i,e[o].y);return t.set(n,s,r-n,i-s)}function Ay(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}function zy(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}function Dy(t){return t.width*t.height}function Fy(t,e=new T){return e.set(Kt(t),Qt(t))}var wt=class{constructor(t=0,e=0,n=0,r=0){this.set(t,e,n,r)}set(t=0,e=0,n=0,r=0){return this.x1=t,this.y1=e,this.x2=n,this.y2=r,this}get left(){return Math.min(this.x1,this.x2)}set left(t){this.x1<=this.x2?this.x1=t:this.x2=t}get right(){return Math.max(this.x1,this.x2)}set right(t){this.x1>this.x2?this.x1=t:this.x2=t}get top(){return Math.min(this.y1,this.y2)}set top(t){this.y1<=this.y2?this.y1=t:this.y2=t}get bottom(){return Math.max(this.y1,this.y2)}set bottom(t){this.y1>this.y2?this.y1=t:this.y2=t}};function pe(t){let{x:e,y:n,right:r,bottom:s}=t,i=new wt(e,n,r,n),o=new wt(r,n,r,s),a=new wt(r,s,e,s),c=new wt(e,s,e,n);return[i,o,a,c]}function Vy(t,e,n=new J){return de(t,e)?n.set(Math.max(t.x,e.x),Math.max(t.y,e.y),Math.min(t.right,e.right)-n.x,Math.min(t.bottom,e.bottom)-n.y):n.set(),n}function we(t){return 2*(t.width+t.height)}function Gy(t,e,n,r=[]){if(!e&&!n)return r;e?n=Math.round(we(t)/e):e=we(t)/n;let s=t.x,i=t.y,o=0;for(let a=0;a<n;a++)switch(r.push(new T(s,i)),o){case 0:s+=e,s>=t.right&&(o=1,i+=s-t.right,s=t.right);break;case 1:i+=e,i>=t.bottom&&(o=2,s-=i-t.bottom,i=t.bottom);break;case 2:s-=e,s<=t.x&&(o=3,i-=t.x-s,s=t.x);break;case 3:i-=e,i<=t.y&&(o=0,i=t.y);break}return r}function Ly(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}function _y(t,e,n=new T){e=oe(e);let r=Math.sin(e),s=Math.cos(e),i=s>0?t.width/2:t.width/-2,o=r>0?t.height/2:t.height/-2;return Math.abs(i*r)<Math.abs(o*s)?o=i*r/s:i=o*s/r,n.set(i+Kt(t),o+Qt(t))}function da(t,e,n=new T){if(e<=0||e>=1)return n.set(t.x,t.y);let r=we(t)*e;return e>.5?(r-=t.width+t.height,r<=t.width?n.set(t.right-r,t.bottom):n.set(t.x,t.bottom-(r-t.width))):r<=t.width?n.set(t.x+r,t.y):n.set(t.right,t.y+(r-t.width))}function Iy(t,e,n=0,r=[]){n||(n=we(t)/e);for(let s=0;s<n;s++)r.push(da(t,s/n));return r}function Py(t,e=new T){return e.set(t.x+Math.random()*t.width,t.y+Math.random()*t.height)}function xa(t,e){return e.width*e.height>t.width*t.height?!1:e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom}function Oy(t,e,n=new T){if(xa(t,e))switch(Js(0,3)){case 0:n.x=t.x+Math.random()*(e.right-t.x),n.y=t.y+Math.random()*(e.y-t.y);break;case 1:n.x=e.x+Math.random()*(t.right-e.x),n.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:n.x=t.x+Math.random()*(e.x-t.x),n.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:n.x=e.right+Math.random()*(t.right-e.right),n.y=t.y+Math.random()*(e.bottom-t.y);break}return n}function By(t,e=new T){return e.set(t.width,t.height)}function Ny(t,e,n=new J){let r=Math.min(t.x,e.x),s=Math.min(t.y,e.y),i=Math.max(t.right,e.right)-r,o=Math.max(t.bottom,e.bottom)-s;return n.set(r,s,i,o)}function ky(t,e,n){let r=Kt(t),s=Qt(t);return t.width=t.width+e*2,t.height=t.height+n*2,la(t,r,s)}function Uy(t,e){let n=Math.min(t.x,e.x),r=Math.max(t.right,e.right),s=Math.min(t.y,e.y),i=Math.max(t.bottom,e.bottom);return t.set(n,s,r-n,i-s)}function Wy(t,e){return yt(t,e.x,e.y)}function Hy(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function qy(t,e=new J){if(t.length===0)return e;let n=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Y.MIN_SAFE_INTEGER,i=Y.MIN_SAFE_INTEGER;for(let o=0;o<t.length;o++){let a=t[o].x,c=t[o].y;n=Math.min(n,a),r=Math.min(r,c),s=Math.max(s,a),i=Math.max(i,c)}return e.set(n,r,s-n,i-r)}function Ky(t,e){return t.width===e.width&&t.height===e.height}function Qy(t,e,n=e){return t.width*=e,t.height*=n,t}function Xy(t,e,n){return t.x+=e,t.y+=n,t}function Yy(t,e){return t.x+=e.x,t.y+=e.y,t}function aa(t){let e=t.local,n=t.position.x,r=t.position.y,s=t.rotation,i=t.scale.x,o=t.scale.y,a=t.skew.x,c=t.skew.y;e.set(Math.cos(s+c)*i,Math.sin(s+c)*i,-Math.sin(s-a)*o,Math.cos(s-a)*o,n,r)}function ca(t){let e=t.parent,n=t.transform,r=n.local,s=n.world;if(!e)Dn(r,s);else if(n.passthru)Dn(e.transform.world,s);else{let{a:i,b:o,c:a,d:c,tx:u,ty:h}=r,{a:l,b:d,c:f,d:x,tx:p,ty:m}=e.transform.world;s.set(i*l+o*f,i*d+o*x,a*l+c*f,a*d+c*x,u*l+h*f+p,u*d+h*x+m)}}var ua=class{constructor(t,e=0,n=0){this.passthru=!1,this._rotation=0,this.entity=t,this.local=new $,this.world=new $;let r=()=>this.update(),s=()=>this.updateExtent();this.position=new gt(r,e,n),this.scale=new gt(r,1,1),this.skew=new gt(r),this.origin=new gt(s,wy(),gy()),this.extent=new J}update(){this.updateLocal(),this.updateWorld()}updateLocal(){this.entity.setDirty(G.TRANSFORM,G.BOUNDS),aa(this)}updateWorld(){let t=this.entity;t.setDirty(G.TRANSFORM,G.BOUNDS),ca(t),t.numChildren&&this.updateChildren()}updateChildren(){let t=this.entity.children;for(let e=0;e<t.length;e++)t[e].transform.updateWorld()}globalToLocal(t,e,n=new T){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=this.world,u=1/(r*o+i*-s);return n.x=o*u*t+-i*u*e+(c*i-a*o)*u,n.y=r*u*e+-s*u*t+(-c*r+a*s)*u,n}localToGlobal(t,e,n=new T){let{a:r,b:s,c:i,d:o,tx:a,ty:c}=this.world;return n.x=r*t+i*e+a,n.y=s*t+o*e+c,n}setExtent(t,e,n,r){this.extent.set(t,e,n,r),this.entity.setDirty(G.TRANSFORM,G.BOUNDS)}updateExtent(t,e){let n=this.extent,r=this.entity;t!==void 0&&(n.width=t),e!==void 0&&(n.height=e),n.x=-this.origin.x*n.width,n.y=-this.origin.y*n.height,r.setDirty(G.TRANSFORM,G.BOUNDS)}set rotation(t){t!==this._rotation&&(this._rotation=t,this.update())}get rotation(){return this._rotation}destroy(){this.position.destroy(),this.scale.destroy(),this.skew.destroy(),this.origin.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.skew=null,this.origin=null,this.extent=null}};function ge(t,e){return(((e*255|0)&255)<<24|t)>>>0}var Ct=class{constructor(t=0,e=0,n=0){this.x=0,this.y=0,this.z=0,this.u=0,this.v=0,this.texture=0,this.tint=16777215,this.alpha=1,this.color=4294967295,this.x=t,this.y=e,this.z=n}setPosition(t,e,n=0){return this.x=t,this.y=e,this.z=n,this}setUV(t,e){return this.u=t,this.v=e,this}setColor(t,e=1){return this.tint=t,this.alpha=e,this.packColor(),this}setAlpha(t){return this.alpha=t,this}setTint(t){return this.tint=t,this}packColor(){this.color=ge(this.tint,this.alpha)}};function jy(t,e){let{F32:n,U32:r,offset:s}=go(e,1),i=bo(e,t.texture),o=s;t.vertices.forEach(a=>{n[o+0]=a.x,n[o+1]=a.y,n[o+2]=a.u,n[o+3]=a.v,n[o+4]=i,r[o+5]=a.color,o+=6})}var hn=class{constructor(t=0,e=0){this.type="GameObject",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new ua(this,t,e),this.bounds=new ia(this),this.input=new oa(this),this.dirty=G.DEFAULT,this.transform.update()}isRenderable(){return this.visible&&this.willRender}isDirty(t){return(this.dirty&t)!=0}clearDirty(t){return this.isDirty(t)&&(this.dirty^=t),this}setDirty(t,e){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=rt.getFrame()),this.isDirty(e)||(this.dirty^=e),this}update(t,e){if(this.willUpdateChildren){let n=this.children;for(let r=0;r<n.length;r++){let s=n[r];s&&s.willUpdate&&s.update(t,e)}}this.postUpdate(t,e)}postUpdate(t,e){}renderGL(t){}renderCanvas(t){}postRenderGL(t){}postRenderCanvas(t){}get numChildren(){return this.children.length}destroy(t){t?Uo(this,t):No(this),I(this,sn,this),this.transform.destroy(),this.bounds.destroy(),this.input.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null}},ta=class extends hn{constructor(t=0,e=0){super(t,e);this._alpha=1,this.type="Container"}setSize(t,e=t){return this.transform.updateExtent(t,e),this}setPosition(t,e){return this.transform.position.set(t,e),this}setOrigin(t,e=t){return this.transform.origin.set(t,e),this}setSkew(t,e=t){return this.transform.skew.set(t,e),this}setScale(t,e=t){return this.transform.scale.set(t,e),this}setRotation(t){return this.transform.rotation=t,this}set width(t){this.transform.updateExtent(t)}get width(){return this.transform.extent.width}set height(t){this.transform.updateExtent(void 0,t)}get height(){return this.transform.extent.height}set x(t){this.transform.position.x=t}get x(){return this.transform.position.x}set y(t){this.transform.position.y=t}get y(){return this.transform.position.y}set originX(t){this.transform.origin.x=t}get originX(){return this.transform.origin.x}set originY(t){this.transform.origin.y=t}get originY(){return this.transform.origin.y}set skewX(t){this.transform.skew.x=t}get skewX(){return this.transform.skew.x}set skewY(t){this.transform.skew.y=t}get skewY(){return this.transform.skew.y}set scaleX(t){this.transform.scale.x=t}get scaleX(){return this.transform.scale.x}set scaleY(t){this.transform.scale.y=t}get scaleY(){return this.transform.scale.y}set rotation(t){this.transform.rotation=t}get rotation(){return this.transform.rotation}get alpha(){return this._alpha}set alpha(t){t!==this._alpha&&(this._alpha=t,this.setDirty(G.TRANSFORM))}};function $y(t,e){let n=t.frame;if(!n)return;let r=e.ctx,s=t.transform,{a:i,b:o,c:a,d:c,tx:u,ty:h}=s.world,{x:l,y:d}=s.extent;r.save(),r.setTransform(i,o,a,c,u,h),r.globalAlpha=t.alpha,r.drawImage(n.texture.image,n.x,n.y,n.width,n.height,l,d,n.width,n.height),r.restore()}function ya(t){return t.vertices.forEach(e=>{e.packColor()}),t}function ma(t,e,...n){let r=t.getFrame(e),{u0:s,u1:i,v0:o,v1:a,pivot:c}=r;return n.forEach(u=>{if(!u||r===u.frame)return;u.frame=r,c&&u.setOrigin(c.x,c.y),u.frame.setExtent(u),u.hasTexture=!0;let h=u.vertices;h[0].setUV(s,o),h[1].setUV(s,a),h[2].setUV(i,a),h[3].setUV(i,o)}),n}var pa,bt={get:()=>pa,set:t=>{pa=t}};function Zy(t,e,...n){if(!t)n.forEach(r=>{r.texture=null,r.frame=null,r.hasTexture=!1});else{let r;t instanceof Z?r=t:r=bt.get().get(t),r?(n.forEach(s=>{s.texture=r}),ma(r,e,...n)):console.warn(`Invalid Texture key: ${t}`)}return n}function Jy(t){let e=t.vertices,{x0:n,y0:r,x1:s,y1:i,x2:o,y2:a,x3:c,y3:u}=Pr(t.transform);return e[0].setPosition(n,r),e[1].setPosition(s,i),e[2].setPosition(o,a),e[3].setPosition(c,u),t}var Ir=class extends ta{constructor(t,e,n,r){super(t,e);this.hasTexture=!1,this._tint=16777215,this.type="Sprite",this.vertices=[new Ct,new Ct,new Ct,new Ct],this.setTexture(n,r)}setTexture(t,e){return Zy(t,e,this),this}setFrame(t){return ma(this.texture,t,this),this}isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0}preRender(){this.isDirty(G.COLORS)&&(ya(this),this.clearDirty(G.COLORS)),this.isDirty(G.TRANSFORM)&&(Jy(this),this.clearDirty(G.TRANSFORM))}renderGL(t){this.preRender(),jy(this,t)}renderCanvas(t){this.preRender(),$y(this,t)}get alpha(){return this._alpha}set alpha(t){t!==this._alpha&&(this._alpha=t,this.vertices.forEach(e=>{e.setAlpha(t)}),this.setDirty(G.COLORS))}get tint(){return this._tint}set tint(t){t!==this._tint&&(this._tint=t,this.vertices.forEach(e=>{e.setTint(t)}),this.setDirty(G.COLORS))}destroy(t){super.destroy(t),this.texture=null,this.frame=null,this.hasTexture=!1,this.vertices=[]}},xy=class extends Ir{constructor(t,e,n,r){super(t,e,n,r);this.type="AnimatedSprite",this.anims=new Map,this.animData={currentAnim:"",currentFrames:[],frameIndex:0,animSpeed:0,nextFrameTime:0,repeatCount:0,isPlaying:!1,yoyo:!1,pendingStart:!1,playingForward:!0,delay:0,repeatDelay:0,onStart:null,onRepeat:null,onComplete:null}}stop(){let t=this.animData;t.isPlaying=!1,t.currentAnim="",t.onComplete&&t.onComplete(this,t.currentAnim)}nextFrame(){let t=this.animData;if(t.frameIndex++,t.frameIndex===t.currentFrames.length)if(t.yoyo)t.frameIndex--,t.playingForward=!1;else if(t.repeatCount===-1||t.repeatCount>0)t.frameIndex=0,t.repeatCount!==-1&&t.repeatCount--,t.onRepeat&&t.onRepeat(this,t.currentAnim),t.nextFrameTime+=t.repeatDelay;else return t.frameIndex--,this.stop();this.setFrame(t.currentFrames[t.frameIndex]),t.nextFrameTime+=t.animSpeed}prevFrame(){let t=this.animData;if(t.frameIndex--,t.frameIndex===-1)if(t.repeatCount===-1||t.repeatCount>0)t.frameIndex=0,t.playingForward=!0,t.repeatCount!==-1&&t.repeatCount--,t.onRepeat&&t.onRepeat(this,t.currentAnim),t.nextFrameTime+=t.repeatDelay;else return t.frameIndex=0,this.stop();this.setFrame(t.currentFrames[t.frameIndex]),t.nextFrameTime+=t.animSpeed}update(t,e){super.update(t,e);let n=this.animData;!n.isPlaying||(n.nextFrameTime-=t*1e3,n.nextFrameTime=Math.max(n.nextFrameTime,0),n.nextFrameTime===0&&(n.pendingStart?(n.onStart&&n.onStart(this,n.currentAnim),n.pendingStart=!1,n.nextFrameTime=n.animSpeed):n.playingForward?this.nextFrame():this.prevFrame()))}get isPlaying(){return this.animData.isPlaying}get isPlayingForward(){return this.animData.isPlaying&&this.animData.playingForward}get currentAnimation(){return this.animData.currentAnim}destroy(t){super.destroy(t),this.anims.clear(),this.animData=null}};function tm(t,e,n,r,s,i,o,a,c,u=0,h=4294967295){let{F32:l,U32:d,offset:f}=go(t,1);l[f+0]=e,l[f+1]=n,l[f+2]=i,l[f+3]=c,l[f+4]=u,d[f+5]=h,l[f+6]=e,l[f+7]=n+s,l[f+8]=i,l[f+9]=o,l[f+10]=u,d[f+11]=h,l[f+12]=e+r,l[f+13]=n+s,l[f+14]=a,l[f+15]=o,l[f+16]=u,d[f+17]=h,l[f+18]=e+r,l[f+19]=n,l[f+20]=a,l[f+21]=c,l[f+22]=u,d[f+23]=h}function Me(t,e,n){n||(n=t.quadShader);let{u0:r,v0:s,u1:i,v1:o}=e.firstFrame;q0(e,0),wo(t,t.quadBuffer),Co(t,n,0),tm(t,0,0,e.width,e.height,r,s,i,o,0),at(t),po(t),Mo(t),X0(t)}var ln=class extends hn{constructor(){super();this.type="Layer",this.transform.passthru=!0,this.willRender=!1}},ea=class extends ln{constructor(){super();this.type="RenderLayer",this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!0,this.setDirty(G.CHILD_CACHE);let t=he(),e=ce(),n=ue(),r=new Z(null,t*n,e*n),s=new je(r);r.binding=s,s.framebuffer=Je(s.texture),this.texture=r,this.framebuffer=s.framebuffer}renderGL(t){this.numChildren>0&&(at(t),!this.willCacheChildren||this.isDirty(G.CHILD_CACHE)?(le(t,this.framebuffer,!0),this.clearDirty(G.CHILD_CACHE)):(le(t,this.framebuffer,!1),this.postRenderGL(t)))}postRenderGL(t){at(t),Qe(t),Me(t,this.texture),this.clearDirty(G.TRANSFORM)}},yy=class extends ea{constructor(...t){super();this.shaders=[],this.type="EffectLayer",Array.isArray(t)&&(this.shaders=t)}postRenderGL(t){let e=this.shaders,n=this.texture;if(at(t),Qe(t),e.length===0)Me(t,n);else{let r=n;for(let s=0;s<e.length;s++){let i=e[s];Me(t,r,i),r=i.texture}Me(t,r)}this.clearDirty(G.TRANSFORM)}};function em(t,e){}function wa(t,e,n,r,s,i,o=0,a=1,c=1,u=0,h=0){let l=Math.cos(o+h)*a,d=Math.sin(o+h)*a,f=-Math.sin(o-u)*c,x=Math.cos(o-u)*c,p=t*l+n*f+s,m=t*d+n*x+i,w=t*l+r*f+s,g=t*d+r*x+i,M=e*l+r*f+s,C=e*d+r*x+i,b=e*l+n*f+s,R=e*d+n*x+i;return{x0:p,y0:m,x1:w,y1:g,x2:M,y2:C,x3:b,y3:R}}var my=class extends ln{constructor(t,e){super();this.glTextureIndex=0,this.hasTexture=!1,this.type="SpriteBatch",this.willRender=!0,this.setTexture(e),this.setMaxSize(t)}resetBuffers(){let t=[];for(let e=0;e<this.maxSize*4;e+=4)t.push(e+0,e+1,e+2,e+2,e+3,e+0);this.data=new ArrayBuffer(this.maxSize*96),this.index=new Uint16Array(t),this.vertexViewF32=new Float32Array(this.data),this.vertexViewU32=new Uint32Array(this.data),y&&(Dt(this.vertexBuffer),Dt(this.indexBuffer),this.vertexBuffer=y.createBuffer(),this.indexBuffer=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,this.vertexBuffer),y.bufferData(y.ARRAY_BUFFER,this.data,y.STATIC_DRAW),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,this.indexBuffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,this.index,y.STATIC_DRAW),y.bindBuffer(y.ARRAY_BUFFER,null)),t=[],this.count=0}setMaxSize(t){return this.maxSize=q(t,0,65535),this.resetBuffers(),this}setTexture(t){let e;return t instanceof Z?e=t:e=bt.get().get(t),e?(this.texture=e,this.hasTexture=!0,this.glTextureIndex=-1):console.warn(`Invalid Texture key: ${t}`),this}isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.count>0}clear(){return this.count=0,this}addToBatch(t,e,n,r,s,i,o,a,c,u){if(this.count>=this.maxSize)return console.warn("SpriteBatch full"),this;let{u0:h,u1:l,v0:d,v1:f}=t,x=this.vertexViewF32,p=this.vertexViewU32,m=this.count*24,w=this.texture.binding?this.texture.binding.index:0;return x[m+0]=n,x[m+1]=r,x[m+2]=h,x[m+3]=d,x[m+4]=w,p[m+5]=e,x[m+6]=s,x[m+7]=i,x[m+8]=h,x[m+9]=f,x[m+10]=w,p[m+11]=e,x[m+12]=o,x[m+13]=a,x[m+14]=l,x[m+15]=f,x[m+16]=w,p[m+17]=e,x[m+18]=c,x[m+19]=u,x[m+20]=l,x[m+21]=d,x[m+22]=w,p[m+23]=e,this.setDirty(G.TRANSFORM),this.count++,this}add(t){let{frame:e=null,x:n=0,y:r=0,rotation:s=0,scaleX:i=1,scaleY:o=1,skewX:a=0,skewY:c=0,originX:u=0,originY:h=0,alpha:l=1,tint:d=16777215}=t,f=this.texture.getFrame(e),{left:x,right:p,top:m,bottom:w}=f.getExtent(u,h),{x0:g,y0:M,x1:C,y1:b,x2:R,y2:z,x3:D,y3:V}=wa(x,p,m,w,n,r,s,i,o,a,c),A=ge(d,l);return this.addToBatch(f,A,g,M,C,b,R,z,D,V)}addXY(t,e,n){let r=this.texture.getFrame(n),{left:s,right:i,top:o,bottom:a}=r.getExtent(0,0),{x0:c,y0:u,x1:h,y1:l,x2:d,y2:f,x3:x,y3:p}=wa(s,i,o,a,t,e);return this.addToBatch(r,4294967295,c,u,h,l,d,f,x,p)}updateTextureIndex(){let t=this.texture.binding.index;if(t===this.glTextureIndex)return;let e=this.vertexViewF32;this.glTextureIndex=t;for(let n=0;n<this.count;n++)e[n*24+4]=t,e[n*24+10]=t,e[n*24+16]=t,e[n*24+22]=t}renderGL(t){em(this,t)}destroy(){super.destroy(),Dt(this.vertexBuffer),Dt(this.indexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.index=null,this.texture=null,this.hasTexture=!1}};function Rt(t,e){let n=document.createElement("canvas");return n.width=t,n.height=e,n.getContext("2d")}function ga(t=32,e=32){let n=Rt(t,e);return new Z(n.canvas)}var py=class extends Ir{constructor(t,e,n="",r,s){super(t,e,ga());this.splitRegExp=/(?:\r\n|\r|\n)/,this.padding={left:0,right:0,top:0,bottom:0},this.verticalAlign="ascent",this.lineSpacing=0,this.font="16px monospace",this.fillStyle="#fff",this.strokeStyle="",this.backgroundStyle="",this.cornerRadius=0,this.textAlign="left",this.textBaseline="alphabetic",this.lineWidth=0,this.lineDash=[],this.antialias=!1,this.type="Text";let i=rt.get();this.resolution=i.renderer.resolution,this.canvas=this.texture.image,this.context=this.canvas.getContext("2d"),r&&(this.font=r),s&&(this.fillStyle=s),this.setText(n)}syncContext(t,e){this.preRenderCallback&&this.preRenderCallback(t,e),e.font=this.font,e.textBaseline=this.textBaseline,e.textAlign=this.textAlign,e.fillStyle=this.fillStyle,e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.lineCap="round",e.lineJoin="round",e.setLineDash(this.lineDash),e.imageSmoothingEnabled=this.antialias}updateText(){let t=this.canvas,e=this.context,n=this.resolution,r=this._text.split(this.splitRegExp),s=this.padding,i=this.fillStyle,o=this.strokeStyle,a=this.lineWidth,c=this.lineSpacing,u=a>0?a/2:0;e.clearRect(0,0,t.width,t.height),this.syncContext(t,e),e.textAlign="start";let h=0,l=0,d=0,f=[],x=this.verticalAlign==="ascent",p=e.measureText("|M\xC9q"),m=Math.ceil(Math.abs(p.actualBoundingBoxAscent)+Math.abs(p.actualBoundingBoxDescent))+a;for(let A=0;A<r.length;A++){let S=e.measureText(r[A]),L=S.actualBoundingBoxLeft,F=S.actualBoundingBoxRight,P=S.actualBoundingBoxAscent,B=S.actualBoundingBoxDescent;(!P&&!B||r[A]==="")&&(P=m,B=0);let H=Math.ceil(Math.abs(L)+Math.abs(F))+a,W=Math.ceil(Math.abs(P)+Math.abs(B))+a;x?(d+=P+u,A>0&&(d+=c+u),l=d+B+u):(d=l+(W-B-u),l+=W,A<r.length-1&&(l+=c)),h=Math.max(h,H),f.push({lineWidth:H,lineHeight:W,ascent:P,descent:B,left:L,right:F,y:d})}h+=s.left+s.right,l+=s.top+s.bottom;let w=this.fixedWidth?this.fixedWidth:h,g=this.fixedHeight?this.fixedHeight:l,M=Math.ceil(w*n),C=Math.ceil(g*n);(t.width!==M||t.height!==C)&&(t.width=M,t.height=C,this.texture.setSize(w,g),this.setSize(w,g)),e.save(),e.scale(n,n),this.syncContext(t,e);let b=this.backgroundStyle;if(b){e.save(),e.fillStyle=b,e.strokeStyle=b;let A=this.cornerRadius,S=A>0?A/2:0;A&&(e.lineWidth=A,e.strokeRect(S,S,w-A,g-A)),e.fillRect(S,S,w-A,g-A),e.restore()}let R=this.textAlign,z=R==="center",D=R==="right"||R==="end",V=(g-l)/2+s.top;for(let A=0;A<r.length;A++){let S=r[A],L=f[A],F=s.left+L.left+u,P=V+L.y;z?F=w/2:D&&(F=w-u),o&&e.strokeText(S,F,P),i&&e.fillText(S,F,P)}return e.restore(),this.texture.binding&&this.texture.binding.update(),this.setDirty(G.TEXTURE),this}get text(){return this._text}set text(t){this.setText(t)}setText(t=""){return Array.isArray(t)&&(t=t.join(`
`)),t!==this._text&&(this._text=t.toString(),this.updateText()),this}destroy(t){this.texture.destroy(),this.fillStyle=null,this.strokeStyle=null,this.backgroundStyle=null,this.canvas=null,this.context=null,super.destroy(t)}},nm={};v(nm,{Box:()=>rm,Components:()=>Ma,Cone:()=>sm,GameObject3D:()=>Or,Geometry:()=>Ca,Light:()=>ba,Material:()=>K,Mesh:()=>Ce,Plane:()=>im,RenderLayer3D:()=>om,Sphere:()=>am});var Ma={};v(Ma,{Transform3DComponent:()=>Ra});var Ra=class{constructor(t,e=0,n=0,r=0){this.passthru=!1,this.entity=t,this.local=new _,this.world=new _,this.normal=new _,this.position=new mt(()=>this.update(),e,n,r),this.scale=new mt(()=>this.update(),1,1,1),this.origin=new mt(()=>this.update()),this.rotation=new k,this.rotation.onChange=()=>this.update(),this.forward=De(),this.up=se(),this.right=Fe(),this.update()}rotateX(t){As(this.rotation,t,this.rotation)}rotateY(t){zs(this.rotation,t,this.rotation)}rotateZ(t){Ds(this.rotation,t,this.rotation)}update(){let t=this.local,e=this.normal;ls(this.rotation,this.position,this.scale,t),ve(t,e),ps(e,e)}updateLocal(){this.entity.setDirty(G.TRANSFORM,G.BOUNDS)}updateWorld(){let t=this.entity;t.setDirty(G.TRANSFORM,G.BOUNDS),t.numChildren&&this.updateChildren()}updateChildren(){let t=this.entity.children;for(let e=0;e<t.length;e++){let n=t[e]}}destroy(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.rotation.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.origin=null,this.rotation=null}},Ca={};v(Ca,{CreateVertexSet:()=>Xt,FaceUVNormalTexture:()=>Ta,Geometry:()=>Gt,GetBufferFromObj:()=>Ea,GetBufferFromVertexSet:()=>Sa,GetFacesFromVertexSet:()=>cm,ParseObj:()=>va});function Xt(){return{vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0}}var um={};v(um,{CreateFramebuffer:()=>Je,CreateGLTexture:()=>Xe,DeleteFramebuffer:()=>Dt,DeleteGLBuffer:()=>$e,DeleteGLTexture:()=>Ye,GL:()=>io,PackColor:()=>ge,PackColors:()=>ya,SetGLTextureFilterMode:()=>oo,UpdateGLTexture:()=>ao,WebGLRenderer:()=>So});var Ta=class{constructor(t,e,n,r,s,i,o,a,c,u=1){this.color=16777215,this.alpha=1,this.size=30,this.vertex1=new Ct(t.x*u,t.y*u,t.z*u),this.vertex2=new Ct(e.x*u,e.y*u,e.z*u),this.vertex3=new Ct(n.x*u,n.y*u,n.z*u),this.vertex1.setUV(o.x,o.y),this.vertex2.setUV(a.x,a.y),this.vertex3.setUV(c.x,c.y),this.normal1=r,this.normal2=s,this.normal3=i,this._packedColor=ge(this.color,this.alpha)}setColor(t,e=1){this.color=t,this.alpha=e,this._packedColor=ge(t,e)}addToBuffer(t,e,n,r){let s=this.vertex1,i=this.vertex2,o=this.vertex3,a=this.normal1,c=this.normal2,u=this.normal3,h=this._packedColor;return t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=a.x,t[r++]=a.y,t[r++]=a.z,t[r++]=s.u,t[r++]=s.v,t[r++]=n,e[r++]=h,t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r++]=c.x,t[r++]=c.y,t[r++]=c.z,t[r++]=i.u,t[r++]=i.v,t[r++]=n,e[r++]=h,t[r++]=o.x,t[r++]=o.y,t[r++]=o.z,t[r++]=u.x,t[r++]=u.y,t[r++]=u.z,t[r++]=o.u,t[r++]=o.v,t[r++]=n,e[r++]=h,r}};function Yt(t,e){let n=t[e*3+0],r=t[e*3+1],s=t[e*3+2];return[n,r,s]}function Br(t,e){let n=t[e*2+0],r=t[e*2+1];return[n,r]}function hm(t){let{vertices:e,normals:n,uvs:r}=t,s=e.length,i=s/3,o=i/3,a=new Ze({batchSize:o,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),c=a.vertexViewF32,u=0,h=0;for(let l=0;l<s;l+=3)c[u++]=e[l+0],c[u++]=e[l+1],c[u++]=e[l+2],c[u++]=n[l+0],c[u++]=n[l+1],c[u++]=n[l+2],c[u++]=r[h+0],c[u++]=r[h+1],h+=2;return a.count=i,a}function lm(t){let{vertices:e,normals:n,uvs:r,indices:s}=t,i=new Ze({batchSize:s.length/3,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),o=i.vertexViewF32,a=0;for(let c=0;c<s.length;c+=3){let u=s[c+0],h=s[c+1],l=s[c+2],d=Yt(e,u),f=Yt(e,h),x=Yt(e,l),p=Yt(n,u),m=Yt(n,h),w=Yt(n,l),g=Br(r,u),M=Br(r,h),C=Br(r,l);o[a++]=d[0],o[a++]=d[1],o[a++]=d[2],o[a++]=p[0],o[a++]=p[1],o[a++]=p[2],o[a++]=g[0],o[a++]=g[1],o[a++]=f[0],o[a++]=f[1],o[a++]=f[2],o[a++]=m[0],o[a++]=m[1],o[a++]=m[2],o[a++]=M[0],o[a++]=M[1],o[a++]=x[0],o[a++]=x[1],o[a++]=x[2],o[a++]=w[0],o[a++]=w[1],o[a++]=w[2],o[a++]=C[0],o[a++]=C[1]}return i.count=s.length,i}function Sa(t){return t.indices&&t.indices.length>0?lm(t):hm(t)}var Gt=class{constructor(t){t&&(t.hasOwnProperty("vertices")?this.buffer=Sa(t):this.buffer=t)}destroy(){this.buffer.destroy()}},va=class{constructor(t,e=!0,n="untitled"){this.currentMaterial="",this.currentGroup="",this.smoothingGroup=0,this.result={materialLibraries:[],models:[]},this.fileContents=t,this.defaultModelName=n,this.flipUVs=e}parseAsync(){return new Promise((t,e)=>{try{t(this.parse())}catch(n){e(n)}})}parse(){let t=n=>{let r=n.indexOf("#");return r>-1?n.substring(0,r):n},e=this.fileContents.split(`
`);for(let n of e){let s=t(n).replace(/\s\s+/g," ").trim().split(" ");switch(s[0].toLowerCase()){case"o":this.parseObject(s);break;case"g":this.parseGroup(s);break;case"v":this.parseVertexCoords(s);break;case"vt":this.parseTextureCoords(s);break;case"vn":this.parseVertexNormal(s);break;case"s":this.parseSmoothShadingStatement(s);break;case"f":this.parsePolygon(s);break;case"mtllib":this.parseMtlLib(s);break;case"usemtl":this.parseUseMtl(s);break}}return this.fileContents="",this.result}currentModel(){return this.result.models.length===0&&(this.result.models.push({faces:[],name:this.defaultModelName,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0),this.result.models[this.result.models.length-1]}parseObject(t){let e=t.length>=2?t[1]:this.defaultModelName;this.result.models.push({faces:[],name:e,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0}parseGroup(t){if(t.length!==2)throw"Group statements must have exactly 1 argument (eg. g group_1)";this.currentGroup=t[1]}parseVertexCoords(t){let e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,s=e>=4?parseFloat(t[3]):0;this.currentModel().vertices.push({x:n,y:r,z:s})}parseTextureCoords(t){let e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,s=e>=4?parseFloat(t[3]):0;isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(s)&&(s=0),this.flipUVs&&(r=1-r),this.currentModel().textureCoords.push({u:n,v:r,w:s})}parseVertexNormal(t){let e=t.length,n=e>=2?parseFloat(t[1]):0,r=e>=3?parseFloat(t[2]):0,s=e>=4?parseFloat(t[3]):0;this.currentModel().vertexNormals.push({x:n,y:r,z:s})}parsePolygon(t){let e=t.length-1;if(e<3)throw"Face < 3 vertices";let n={group:this.currentGroup,material:this.currentMaterial,smoothingGroup:this.smoothingGroup,vertices:[]};for(let r=0;r<e;r++){let i=t[r+1].split("/"),o=i.length;if(o<1||o>3)throw"Too many / values for single vertex";let a=0,c=0,u=0;if(a=parseInt(i[0],10),o>1&&i[1]!==""&&(c=parseInt(i[1],10)),o>2&&(u=parseInt(i[2],10)),a===0)throw"Faces uses invalid vertex index of 0";a<0&&(a=this.currentModel().vertices.length+1+a),c-=1,a-=1,u-=1,n.vertices.push({textureCoordsIndex:c,vertexIndex:a,vertexNormalIndex:u})}this.currentModel().faces.push(n)}parseMtlLib(t){t.length>=2&&this.result.materialLibraries.push(t[1])}parseUseMtl(t){t.length>=2&&(this.currentMaterial=t[1])}parseSmoothShadingStatement(t){if(t.length!==2)throw"Smoothing group statements must have exactly 1 argument (eg. s <number|off>)";let e=t[1].toLowerCase()==="off"?0:parseInt(t[1],10);this.smoothingGroup=e}};function Ea(t,e=!0){let r=new va(t,e).parse(),s=[];return r.models.forEach(i=>{let{faces:o,textureCoords:a,vertexNormals:c,vertices:u}=i,h=0;for(let x=0;x<o.length;x++)h+=o[x].vertices.length===4?6:3;let l=new Ze({batchSize:h,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),d=l.vertexViewF32,f=0;for(let x=0;x<o.length;x++){let p=o[x],m=p.vertices[0],w=p.vertices[1],g=p.vertices[2],M=u[m.vertexIndex],C=u[w.vertexIndex],b=u[g.vertexIndex],R=c[m.vertexNormalIndex],z=c[w.vertexNormalIndex],D=c[g.vertexNormalIndex],V=a[m.textureCoordsIndex],A=a[w.textureCoordsIndex],S=a[g.textureCoordsIndex];if(d[f++]=M.x,d[f++]=M.y,d[f++]=M.z,d[f++]=R.x,d[f++]=R.y,d[f++]=R.z,d[f++]=V.u,d[f++]=V.v,d[f++]=C.x,d[f++]=C.y,d[f++]=C.z,d[f++]=z.x,d[f++]=z.y,d[f++]=z.z,d[f++]=A.u,d[f++]=A.v,d[f++]=b.x,d[f++]=b.y,d[f++]=b.z,d[f++]=D.x,d[f++]=D.y,d[f++]=D.z,d[f++]=S.u,d[f++]=S.v,l.count+=3,p.vertices.length===4){let L=p.vertices[3],F=u[L.vertexIndex],P=c[L.vertexNormalIndex],B=a[L.textureCoordsIndex];d[f++]=M.x,d[f++]=M.y,d[f++]=M.z,d[f++]=R.x,d[f++]=R.y,d[f++]=R.z,d[f++]=V.u,d[f++]=V.v,d[f++]=b.x,d[f++]=b.y,d[f++]=b.z,d[f++]=D.x,d[f++]=D.y,d[f++]=D.z,d[f++]=S.u,d[f++]=S.v,d[f++]=F.x,d[f++]=F.y,d[f++]=F.z,d[f++]=P.x,d[f++]=P.y,d[f++]=P.z,d[f++]=B.u,d[f++]=B.v,l.count+=3}}s.push({name:i.name,buffer:l})}),s}function jt(t,e){let n=t[e*3+0],r=t[e*3+1],s=t[e*3+2];return[n,r,s]}function Nr(t,e){let n=t[e*2+0],r=t[e*2+1];return[n,r]}function cm(t){let{vertices:e,normals:n,uvs:r,indices:s}=t,i=[];for(let o=0;o<s.length;o+=3){let a=s[o+0],c=s[o+1],u=s[o+2],h=jt(e,a),l=jt(e,c),d=jt(e,u),f=jt(n,a),x=jt(n,c),p=jt(n,u),m=Nr(r,a),w=Nr(r,c),g=Nr(r,u),M=new Ta({x:h[0],y:h[1],z:h[2]},{x:l[0],y:l[1],z:l[2]},{x:d[0],y:d[1],z:d[2]},{x:f[0],y:f[1],z:f[2]},{x:x[0],y:x[1],z:x[2]},{x:p[0],y:p[1],z:p[2]},{x:m[0],y:m[1]},{x:w[0],y:w[1]},{x:g[0],y:g[1]},1);i.push(M)}return i}function Tt(t,e=0,n=0,r=0,s=0,i=1,o=2,a=1,c=-1,u=1,h=1,l=1,d=1,f=1){t||(t=Xt());let{vertices:x,normals:p,uvs:m,indices:w,numberOfVertices:g}=t,M=u/d,C=h/f,b=u/2,R=h/2,z=l/2,D=d+1,V=f+1,A=0,S=[];for(let L=0;L<V;L++){let F=L*C-R;for(let P=0;P<D;P++){let B=P*M-b;S[s]=B*a,S[i]=F*c,S[o]=z,x.push(e+S[0],n+S[1],r+S[2]),S[s]=0,S[i]=0,S[o]=l>0?1:-1,p.push(S[0],S[1],S[2]),m.push(P/d),m.push(1-L/f),A+=1}}for(let L=0;L<f;L++)for(let F=0;F<d;F++){let P=g+F+D*L,B=g+F+D*(L+1),H=g+(F+1)+D*(L+1),W=g+(F+1)+D*L;w.push(P,B,W),w.push(B,H,W)}return t.numberOfVertices+=A,t}function Aa(t=0,e=0,n=0,r=1,s=1,i=1,o=1,a=1,c=1){let u=Xt();return Tt(u,t,e,n,2,1,0,-1,-1,i,s,r,c,a),Tt(u,t,e,n,2,1,0,1,-1,i,s,-r,c,a),Tt(u,t,e,n,0,2,1,1,1,r,i,s,o,c),Tt(u,t,e,n,0,2,1,1,-1,r,i,-s,o,c),Tt(u,t,e,n,0,1,2,1,-1,r,s,i,o,a),Tt(u,t,e,n,0,1,2,-1,-1,r,s,-i,o,a),u}var Or=class{constructor(t=0,e=0,n=0){this.type="GameObject3D",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new Ra(this,t,e,n),this.dirty=G.DEFAULT}isRenderable(){return this.visible&&this.willRender}isDirty(t){return(this.dirty&t)!=0}clearDirty(t){return this.isDirty(t)&&(this.dirty^=t),this}setDirty(t,e){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=rt.getFrame()),this.isDirty(e)||(this.dirty^=e),this}update(t,e){if(this.willUpdateChildren){let n=this.children;for(let r=0;r<n.length;r++){let s=n[r];s&&s.willUpdate&&s.update(t,e)}}this.postUpdate(t,e)}postUpdate(t,e){}renderGL(t){}postRenderGL(t){}get numChildren(){return this.children.length}destroy(t){I(this,sn,this),this.transform.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null}},K=class{constructor(t={}){this.isDirty=!1;let{ambient:e=[1,1,1],diffuse:n=[1,1,1],specular:r=[1,1,1],shine:s=.25}=t,i=()=>this.update();this.ambient=new At(i).fromArray(e),this.diffuse=new At(i).fromArray(n),this.specular=new At(i).fromArray(r),this._shine=s}get shine(){return this._shine}set shine(t){this._shine=q(t,0,1),this.isDirty=!0}update(){this.isDirty=!0}setUniforms(t){t.setUniform("uMaterialAmbient",this.ambient.toArray()),t.setUniform("uMaterialDiffuse",this.diffuse.toArray()),t.setUniform("uMaterialSpecular",this.specular.toArray()),t.setUniform("uMaterialShine",this._shine*256)}destroy(){this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()}};function za(t,e,...n){let r=t.getFrame(e);return n.forEach(s=>{!s||r===s.frame||(s.frame=r,s.hasTexture=!0)}),n}function fm(t,e,...n){if(!t)n.forEach(r=>{r.texture=null,r.frame=null,r.hasTexture=!1});else{let r;t instanceof Z?r=t:r=bt.get().get(t),r?(n.forEach(s=>{s.texture=r}),za(r,e,...n)):console.warn(`Invalid Texture key: ${t}`)}return n}var Ce=class extends Or{constructor(t=0,e=0,n=0,r,s=new K){super(t,e,n);this.hasTexture=!1,this.cullFaces=!0,this.geometry=r,this.material=s,this.setTexture("__WHITE")}setTexture(t,e){return fm(t,e,this),this}setFrame(t){return za(this.texture,t,this),this}setMaterial(t){return this.material=t,this}renderGL(t){let e=t.currentShader.shader;if(e.setUniform("uModelMatrix",this.transform.local.data),e.setUniform("uNormalMatrix",this.transform.normal.data),this.hasTexture){let n=bo(t,this.texture);e.setUniform("uTexture",n)}this.material.setUniforms(e),K0(t,this.geometry.buffer)}destroy(t){super.destroy(t),this.geometry=null,this.material=null,this.texture=null,this.frame=null,this.hasTexture=!1}},rm=class extends Ce{constructor(t=0,e=0,n=0,r=1,s=1,i=1,o=1,a=1,c=1){let u=Aa(0,0,0,r,s,i,o,a,c),h=new Gt(u);super(t,e,n,h)}};function Da(t,e,n,r,s,i,o,a,c){let{vertices:u,normals:h,uvs:l,indices:d}=e,f=new T,x=new E,p=t===!0?s:i,m=t===!0?1:-1,w=n;for(let M=1;M<=o;M++)u.push(0,r*m,0),h.push(0,m,0),l.push(.5,.5),n++;let g=n;for(let M=0;M<=o;M++){let b=M/o*c+a,R=Math.cos(b),z=Math.sin(b);x.x=p*z,x.y=r*m,x.z=p*R,u.push(x.x,x.y,x.z),h.push(0,m,0),f.x=R*.5+.5,f.y=z*.5*m+.5,l.push(f.x,f.y),n++}for(let M=0;M<o;M++){let C=w+M,b=g+M;t?d.push(b,b+1,C):d.push(b+1,b,C)}return n}function Fa(t=1,e=1,n=1,r=8,s=1,i=!1,o=0,a=Math.PI*2){let c=Xt(),{vertices:u,normals:h,uvs:l,indices:d}=c,f=0,x=[],p=n/2,m=new E,w=new E,g=(e-t)/n;for(let M=0;M<=s;M++){let C=[],b=M/s,R=b*(e-t)+t;for(let z=0;z<=r;z++){let D=z/r,V=D*a+o,A=Math.sin(V),S=Math.cos(V);w.x=R*A,w.y=-b*n+p,w.z=R*S,u.push(w.x,w.y,w.z),m.set(A,g,S),lt(m,m),h.push(m.x,m.y,m.z),l.push(D,1-b),C.push(f++)}x.push(C)}for(let M=0;M<r;M++)for(let C=0;C<s;C++){let b=x[C][M],R=x[C+1][M],z=x[C+1][M+1],D=x[C][M+1];d.push(b,R,D),d.push(R,z,D)}return i||(t>0&&(f=Da(!0,c,f,p,t,e,r,o,a)),e>0&&Da(!1,c,f,p,t,e,r,o,a)),c.numberOfVertices=u.length,c}function Va(t=1,e=1,n=8,r=1,s=!1,i=0,o=Math.PI*2){return Fa(0,t,e,n,r,s,i,o)}var sm=class extends Ce{constructor(t=0,e=0,n=0,r=1,s=1,i=8,o=1,a=!1,c=0,u=Math.PI*2){let h=Va(r,s,i,o,a,c,u),l=new Gt(h);super(t,e,n,l)}},ba=class{constructor(t={}){this.isDirty=!1;let{x:e=0,y:n=0,z:r=.1,ambient:s=[1,1,1],diffuse:i=[1,1,1],specular:o=[1,1,1]}=t,a=()=>this.update();this.position=new mt(a,e,n,r),this.ambient=new At(a).fromArray(s),this.diffuse=new At(a).fromArray(i),this.specular=new At(a).fromArray(o)}setUniforms(t){t.setUniform("uLightPosition",this.position.toArray()),t.setUniform("uLightAmbient",this.ambient.toArray()),t.setUniform("uLightDiffuse",this.diffuse.toArray()),t.setUniform("uLightSpecular",this.specular.toArray())}update(){this.isDirty=!0}destroy(){this.position.destroy(),this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()}},im=class extends Ce{constructor(t=0,e=0,n=0,r=1,s=1,i=1,o=1){let a=Tt(null,0,0,0,0,1,2,1,-1,r,s,1,i,o),c=new Gt(a);super(t,e,n,c)}},om=class extends ln{constructor(){super();this.type="RenderLayer",this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!0,this.setDirty(G.CHILD_CACHE);let t=he(),e=ce(),n=ue(),r=new Z(null,t*n,e*n),s=new je(r);r.binding=s,s.framebuffer=Je(s.texture),s.depthbuffer=xo(s.framebuffer,r.width,r.height),this.texture=r,this.framebuffer=s.framebuffer}renderGL(t){this.numChildren>0&&(at(t),!this.willCacheChildren||this.isDirty(G.CHILD_CACHE)?(le(t,this.framebuffer,!0),this.clearDirty(G.CHILD_CACHE)):(le(t,this.framebuffer,!1),this.postRenderGL(t)))}postRenderGL(t){at(t),Qe(t),Me(t,this.texture),this.clearDirty(G.TRANSFORM)}};function Ga(t=1,e=3,n=3,r=0,s=Math.PI*2,i=0,o=Math.PI){e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6);let a=Math.min(i+o,Math.PI),c=Xt(),{vertices:u,normals:h,uvs:l,indices:d}=c,f=0,x=[],p=new E,m=new E;for(let w=0;w<=n;w++){let g=[],M=w/n,C=0;w===0&&i===0?C=.5/e:w===n&&a==Math.PI&&(C=-.5/e);for(let b=0;b<=e;b++){let R=b/e;p.x=-t*Math.cos(r+R*s)*Math.sin(i+M*o),p.y=t*Math.cos(i+M*o),p.z=t*Math.sin(r+R*s)*Math.sin(i+M*o),u.push(p.x,p.y,p.z),lt(p,m),h.push(m.x,m.y,m.z),l.push(R+C,1-M),g.push(f++)}x.push(g)}for(let w=0;w<n;w++)for(let g=0;g<e;g++){let M=x[w][g+1],C=x[w][g],b=x[w+1][g],R=x[w+1][g+1];(w!==0||i>0)&&d.push(M,C,R),(w!==n-1||a<Math.PI)&&d.push(C,b,R)}return c.numberOfVertices=u.length,c}var am=class extends Ce{constructor(t=0,e=0,n=0,r=1,s=3,i=3,o=0,a=Math.PI*2,c=0,u=Math.PI){let h=Ga(r,s,i,o,a,c,u),l=new Gt(h);super(t,e,n,l)}},dm={};v(dm,{Circle:()=>La,Ellipse:()=>_a,Intersects:()=>Ia,Line:()=>Pa,Rectangle:()=>ha,Triangle:()=>Oa});var La={};v(La,{Circle:()=>kr,CircleContains:()=>xt,CircleContainsPoint:()=>xm,CircleContainsRect:()=>ym,CircleEquals:()=>mm,CloneCircle:()=>pm,CopyCircleFrom:()=>wm,GetCircleArea:()=>gm,GetCircleBounds:()=>Mm,GetCircleCircumference:()=>Ba,GetCircleCircumferencePoint:()=>Ur,GetCirclePoint:()=>Cm,GetCirclePoints:()=>bm,GetCircleRandomPoint:()=>Rm,TranslateCircle:()=>Tm,TranslateCirclePoint:()=>Sm});function xt(t,e,n){if(t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom){let r=(t.x-e)*(t.x-e),s=(t.y-n)*(t.y-n);return r+s<=t.radius*t.radius}else return!1}var kr=class{constructor(t=0,e=0,n=0){this.set(t,e,n)}set(t=0,e=0,n=0){return this.x=t,this.y=e,this.radius=n,this}contains(t,e){return xt(this,t,e)}get radius(){return this._radius}set radius(t){this._radius=t,this._diameter=t*2}get diameter(){return this._diameter}set diameter(t){this._diameter=t,this._radius=t*.5}get left(){return this.x-this._radius}set left(t){this.x=t+this._radius}get right(){return this.x+this._radius}set right(t){this.x=t-this._radius}get top(){return this.y-this._radius}set top(t){this.y=t+this._radius}get bottom(){return this.y+this._radius}set bottom(t){this.y=t-this._radius}};function xm(t,e){return xt(t,e.x,e.y)}function ym(t,e){return xt(t,e.x,e.y)&&xt(t,e.right,e.y)&&xt(t,e.x,e.bottom)&&xt(t,e.right,e.bottom)}function mm(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}function pm(t){return new kr(t.x,t.y,t.radius)}function wm(t,e){return e.set(t.x,t.y,t.radius)}function gm(t){return t.radius>0?Math.PI*t.radius*t.radius:0}function Mm(t,e=new J){return e.set(t.left,t.top,t.diameter,t.diameter)}function Ba(t){return 2*(Math.PI*t.radius)}function Ur(t,e,n=new T){return n.set(t.x+t.radius*Math.cos(e),t.y+t.radius*Math.sin(e))}function Cm(t,e,n=new T){let r=ae(e,0,Y.PI2);return Ur(t,r,n)}function bm(t,e,n=0,r=[]){n||(n=Ba(t)/e);for(let s=0;s<n;s++){let i=ae(s/n,0,Y.PI2);r.push(Ur(t,i))}return r}function Rm(t,e=new T){let n=2*Math.PI*Math.random(),r=Math.random()+Math.random(),s=r>1?2-r:r,i=s*Math.cos(n),o=s*Math.sin(n);return e.set(t.x+i*t.radius,t.y+o*t.radius)}function Tm(t,e,n){return t.x+=e,t.y+=n,t}function Sm(t,e){return t.x+=e.x,t.y+=e.y,t}var _a={};v(_a,{CloneEllipse:()=>vm,CopyEllipseFrom:()=>Em,Ellipse:()=>Na,EllipseContains:()=>Lt,EllipseContainsPoint:()=>Am,EllipseContainsRect:()=>zm,EllipseEquals:()=>Dm,GetEllipseArea:()=>Fm,GetEllipseBounds:()=>Vm,GetEllipseCircumference:()=>ka,GetEllipseCircumferencePoint:()=>Wr,GetEllipsePoint:()=>Gm,GetEllipsePoints:()=>Lm,GetEllipseRandomPoint:()=>_m,TranslateEllipse:()=>Im,TranslateEllipsePoint:()=>Pm});function Lt(t,e,n){if(t.width<=0||t.height<=0)return!1;let r=(e-t.x)/t.width,s=(n-t.y)/t.height;return r*=r,s*=s,r+s<.25}var Na=class{constructor(t=0,e=0,n=0,r=0){this.set(t,e,n,r)}set(t=0,e=0,n=0,r=0){return this.x=t,this.y=e,this.width=n,this.height=r,this}contains(t,e){return Lt(this,t,e)}getMinorRadius(){return Math.min(this.width,this.height)/2}getMajorRadius(){return Math.max(this.width,this.height)/2}get left(){return this.x-this.width/2}set left(t){this.x=t+this.width/2}get right(){return this.x+this.width/2}set right(t){this.x=t-this.width/2}get top(){return this.y-this.height/2}set top(t){this.y=t+this.height/2}get bottom(){return this.y+this.height/2}set bottom(t){this.y=t-this.height/2}};function vm(t){return new Na(t.x,t.y,t.width,t.height)}function Em(t,e){return e.set(t.x,t.y,t.width,t.height)}function Am(t,e){return Lt(t,e.x,e.y)}function zm(t,e){return Lt(t,e.x,e.y)&&Lt(t,e.right,e.y)&&Lt(t,e.x,e.bottom)&&Lt(t,e.right,e.bottom)}function Dm(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Fm(t){return t.width<=0||t.height<=0?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}function Vm(t,e=new J){return e.set(t.left,t.top,t.width,t.height)}function ka(t){let e=t.width/2,n=t.height/2,r=Math.pow(e-n,2)/Math.pow(e+n,2);return Math.PI*(e+n)*(1+3*r/(10+Math.sqrt(4-3*r)))}function Wr(t,e,n=new T){let r=t.width/2,s=t.height/2;return n.set(t.x+r*Math.cos(e),t.y+s*Math.sin(e))}function Gm(t,e,n=new T){let r=ae(e,0,Y.PI2);return Wr(t,r,n)}function Lm(t,e,n=0,r=[]){n||(n=ka(t)/e);for(let s=0;s<n;s++){let i=ae(s/n,0,Y.PI2);r.push(Wr(t,i))}return r}function _m(t,e=new T){let n=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());return e.x=t.x+r*Math.cos(n)*t.width/2,e.y=t.y+r*Math.sin(n)*t.height/2,e}function Im(t,e,n){return t.x+=e,t.y+=n,t}function Pm(t,e){return t.x+=e.x,t.y+=e.y,t}var Ia={};v(Ia,{CircleToCircle:()=>Ua,CircleToRectangle:()=>Wa,GetCircleToCircle:()=>Om,GetCircleToRectangle:()=>Bm,GetLineToCircle:()=>St,GetLineToRectangle:()=>vt,GetRectangleIntersection:()=>Nm,GetRectangleToRectangle:()=>km,GetRectangleToTriangle:()=>Um,GetTriangleToCircle:()=>Wm,GetTriangleToLine:()=>fn,GetTriangleToTriangle:()=>Hm,LineToCircle:()=>be,LineToLine:()=>U,LineToRectangle:()=>Ha,PointToLine:()=>Ya,PointToLineSegment:()=>qm,RectangleToRectangle:()=>de,RectangleToTriangle:()=>qa,TriangleToCircle:()=>Ka,TriangleToLine:()=>Qa,TriangleToTriangle:()=>Xa});function Ua(t,e){return Bt(t,e)<=t.radius+e.radius}function Wa(t,e){let n=e.width/2,r=e.height/2,s=Math.abs(t.x-e.x-n),i=Math.abs(t.y-e.y-r),o=n+t.radius,a=r+t.radius;if(s>o||i>a)return!1;if(s<=n||i<=r)return!0;{let c=s-n,u=i-r,h=c*c,l=u*u,d=t.radius*t.radius;return h+l<=d}}function Om(t,e,n=[]){if(Ua(t,e)){let r=t.x,s=t.y,i=t.radius,o=e.x,a=e.y,c=e.radius,u,h,l,d,f;if(s===a)f=(c*c-i*i-o*o+r*r)/(2*(r-o)),u=1,h=-2*a,l=o*o+f*f-2*o*f+a*a-c*c,d=h*h-4*u*l,d===0?n.push(new T(f,-h/(2*u))):d>0&&(n.push(new T(f,(-h+Math.sqrt(d))/(2*u))),n.push(new T(f,(-h-Math.sqrt(d))/(2*u))));else{let x=(r-o)/(s-a),p=(c*c-i*i-o*o+r*r-a*a+s*s)/(2*(s-a));u=x*x+1,h=2*s*x-2*p*x-2*r,l=r*r+s*s+p*p-i*i-2*s*p,d=h*h-4*u*l,d===0?(f=-h/(2*u),n.push(new T(f,p-f*x))):d>0&&(f=(-h+Math.sqrt(d))/(2*u),n.push(new T(f,p-f*x)),f=(-h-Math.sqrt(d))/(2*u),n.push(new T(f,p-f*x)))}}return n}var Km=new T;function be(t,e,n){n||(n=Km);let{x1:r,y1:s,x2:i,y2:o}=t;if(xt(e,r,s))return n.set(r,s),!0;if(xt(e,i,o))return n.set(i,o),!0;let a=i-r,c=o-s,u=e.x-r,h=e.y-s,l=a*a+c*c,d=a,f=c;if(l>0){let p=(u*a+h*c)/l;d*=p,f*=p}return n.set(r+d,s+f),d*d+f*f<=l&&d*a+f*c>=0&&xt(e,n.x,n.y)}function St(t,e,n=[]){if(be(t,e)){let{x1:r,y1:s,x2:i,y2:o}=t,a=e.radius,c=i-r,u=o-s,h=r-e.x,l=s-e.y,d=c*c+u*u,f=2*(c*h+u*l),x=h*h+l*l-a*a,p=f*f-4*d*x,m,w;if(p===0){let g=-f/(2*d);m=r+g*c,w=s+g*u,g>=0&&g<=1&&n.push(new T(m,w))}else if(p>0){let g=(-f-Math.sqrt(p))/(2*d);m=r+g*c,w=s+g*u,g>=0&&g<=1&&n.push(new T(m,w));let M=(-f+Math.sqrt(p))/(2*d);m=r+M*c,w=s+M*u,M>=0&&M<=1&&n.push(new T(m,w))}}return n}function Bm(t,e,n=[]){if(Wa(t,e)){let[r,s,i,o]=pe(e);St(r,t,n),St(s,t,n),St(i,t,n),St(o,t,n)}return n}function U(t,e,n){let{x1:r,y1:s,x2:i,y2:o}=t,{x1:a,y1:c,x2:u,y2:h}=e,l=(u-a)*(s-c)-(h-c)*(r-a),d=(i-r)*(s-c)-(o-s)*(r-a),f=(h-c)*(i-r)-(u-a)*(o-s);if(f===0)return!1;let x=l/f,p=d/f;return x>=0&&x<=1&&p>=0&&p<=1?(n&&n.set(r+x*(i-r),s+x*(o-s)),!0):!1}function Ha(t,e){let{x1:n,y1:r,x2:s,y2:i}=t,{x:o,y:a,right:c,bottom:u}=e,h=0;if(n>=o&&n<=c&&r>=a&&r<=u||s>=o&&s<=c&&i>=a&&i<=u)return!0;if(n<o&&s>=o){if(h=r+(i-r)*(o-n)/(s-n),h>a&&h<=u)return!0}else if(n>c&&s<=c&&(h=r+(i-r)*(c-n)/(s-n),h>=a&&h<=u))return!0;if(r<a&&i>=a){if(h=n+(s-n)*(a-r)/(i-r),h>=o&&h<=c)return!0}else if(r>u&&i<=u&&(h=n+(s-n)*(u-r)/(i-r),h>=o&&h<=c))return!0;return!1}function vt(t,e,n=[]){if(Ha(t,e)){let[r,s,i,o]=pe(e),a=[new T,new T,new T,new T],c=[U(r,t,a[0]),U(s,t,a[1]),U(i,t,a[2]),U(o,t,a[3])];for(let u=0;u<c.length;u++)c[u]&&n.push(a[u])}return n}function Nm(t,e,n=new J){if(de(t,e)){let r=Math.max(t.x,e.x),s=Math.max(t.y,e.y);return n.set(r,s,Math.min(t.right,e.right)-r,Math.min(t.bottom,e.bottom)-s)}}function km(t,e,n=[]){if(de(t,e)){let[r,s,i,o]=pe(t);vt(r,e,n),vt(s,e,n),vt(i,e,n),vt(o,e,n)}return n}function st(t){let{x1:e,y1:n,x2:r,y2:s,x3:i,y3:o}=t,a=new wt(e,n,r,s),c=new wt(r,s,i,o),u=new wt(i,o,e,n);return[a,c,u]}function _t(t,e,n){let{x1:r,y1:s,x2:i,y2:o,x3:a,y3:c}=t,u=a-r,h=c-s,l=i-r,d=o-s,f=e-r,x=n-s,p=u*u+h*h,m=u*l+h*d,w=u*f+h*x,g=l*l+d*d,M=l*f+d*x,C=p*g-m*m,b=C===0?0:1/C,R=(g*w-m*M)*b,z=(p*M-m*w)*b;return R>=0&&z>=0&&R+z<1}function dn(t,e,n=!1,r=[]){let s=!1;return e.forEach(i=>{if(s)return;let{x:o,y:a}=i;_t(t,o,a)&&(r.push(new T(o,a)),n&&(s=!0))}),r}function qa(t,e){if(e.left>t.right||e.right<t.x||e.top>t.bottom||e.bottom<t.y)return!1;let[n,r,s]=st(e);if(yt(t,n.x1,n.y1)||yt(t,n.x2,n.y2)||yt(t,r.x1,r.y1)||yt(t,r.x2,r.y2)||yt(t,s.x1,s.y1)||yt(t,s.x2,s.y2))return!0;let[i,o,a,c]=pe(t);return U(n,i)||U(n,o)||U(n,a)||U(n,c)||U(r,i)||U(r,o)||U(r,a)||U(r,c)||U(s,i)||U(s,o)||U(s,a)||U(s,c)?!0:dn(e,fa(t),!0).length>0}function Um(t,e,n=[]){if(qa(t,e)){let[r,s,i]=st(e);vt(r,t,n),vt(s,t,n),vt(i,t,n)}return n}function Ka(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;if(_t(t,e.x,e.y))return!0;let[n,r,s]=st(t);return be(n,e)||be(r,e)||be(s,e)}function Wm(t,e,n=[]){if(Ka(t,e)){let[r,s,i]=st(t);St(r,e,n),St(s,e,n),St(i,e,n)}return n}function Qa(t,e){let{x1:n,y1:r,x2:s,y2:i}=e;if(_t(t,n,r)||_t(t,s,i))return!0;let[o,a,c]=st(t);return U(o,e)||U(a,e)||U(c,e)}function fn(t,e,n=[]){if(Qa(t,e)){let[r,s,i]=st(t),o=[new T,new T,new T],a=[U(r,e,o[0]),U(s,e,o[1]),U(i,e,o[2])];for(let c=0;c<a.length;c++)a[c]&&n.push(o[c])}return n}function Hr(t,e=[]){let{x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=t;return e.push(new T(n,r),new T(s,i),new T(o,a)),e}function Xa(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;let[n,r,s]=st(t),[i,o,a]=st(e);return U(n,i)||U(n,o)||U(n,a)||U(r,i)||U(r,o)||U(r,a)||U(s,i)||U(s,o)||U(s,a)||dn(e,Hr(t),!0).length>0?!0:dn(t,Hr(e),!0).length>0}function Hm(t,e,n=[]){if(Xa(t,e)){let[r,s,i]=st(e);fn(t,r,n),fn(t,s,n),fn(t,i,n)}return n}function Ya(t,e,n=1){let{x1:r,y1:s,x2:i,y2:o}=e,{x:a,y:c}=t,u=(i-r)*(i-r)+(o-s)*(o-s);if(u===0)return!1;let h=((a-r)*(i-r)+(c-s)*(o-s))/u;if(h<0)return Math.sqrt((r-a)*(r-a)+(s-c)*(s-c))<=n;if(h>=0&&h<=1){let l=((s-c)*(i-r)-(r-a)*(o-s))/u;return Math.abs(l)*Math.sqrt(u)<=n}else return Math.sqrt((i-a)*(i-a)+(o-c)*(o-c))<=n}function qm(t,e){if(!Ya(t,e))return!1;let{x1:n,y1:r,x2:s,y2:i}=e,{x:o,y:a}=t,c=Math.min(n,s),u=Math.max(n,s),h=Math.min(r,i),l=Math.max(r,i);return o>=c&&o<=u&&a>=h&&a<=l}var Pa={};v(Pa,{CenterLineOn:()=>Qm,CloneLine:()=>Xm,CopyLineFrom:()=>Ym,ExtendLine:()=>jm,GetLineAngle:()=>$t,GetLineBresenhamPoints:()=>$m,GetLineHeight:()=>Zm,GetLineLength:()=>ct,GetLineMidPoint:()=>Jm,GetLineNearestPoint:()=>tp,GetLineNormal:()=>ep,GetLineNormalAngle:()=>ja,GetLineNormalX:()=>np,GetLineNormalY:()=>rp,GetLinePerpSlope:()=>sp,GetLinePoint:()=>ip,GetLinePoints:()=>op,GetLineRandomPoint:()=>ap,GetLineReflectAngle:()=>cp,GetLineSlope:()=>up,GetLineWidth:()=>hp,GetShortestLineDistance:()=>lp,Line:()=>wt,LineEquals:()=>fp,LineSetToAngle:()=>dp,RotateLine:()=>xp,RotateLineAround:()=>qr,RotateLineAroundPoint:()=>yp,TranslateLine:()=>$a,TranslateLinePoint:()=>mp});function Qm(t,e,n){let r=e-(t.x1+t.x2)/2,s=n-(t.y1+t.y2)/2;return t.x1+=r,t.y1+=s,t.x2+=r,t.y2+=s,t}function Xm(t){return new wt(t.x1,t.y1,t.x2,t.y2)}function Ym(t,e){return e.set(t.x1,t.y1,t.x2,t.y2)}function ct(t){let{x1:e,y1:n,x2:r,y2:s}=t;return Math.sqrt((r-e)*(r-e)+(s-n)*(s-n))}function jm(t,e,n=e){let r=ct(t),s=t.x2-t.x1,i=t.y2-t.y1;return e&&(t.x1=t.x1-s/r*e,t.y1=t.y1-i/r*e),n&&(t.x2=t.x2+s/r*n,t.y2=t.y2+i/r*n),t}function $t(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}function $m(t,e=1,n=[]){let r=Math.round(t.x1),s=Math.round(t.y1),i=Math.round(t.x2),o=Math.round(t.y2),a=Math.abs(i-r),c=Math.abs(o-s),u=r<i?1:-1,h=s<o?1:-1,l=a-c;n.push(new T(r,s));let d=1;for(;!(r===i&&s===o);){let f=l<<1;f>-c&&(l-=c,r+=u),f<a&&(l+=a,s+=h),d%e==0&&n.push(new T(r,s)),d++}return n}function Zm(t){return Math.abs(t.y1-t.y2)}function Jm(t,e=new T){return e.x=(t.x1+t.x2)/2,e.y=(t.y1+t.y2)/2,e}function tp(t,e,n=new T){let{x1:r,y1:s,x2:i,y2:o}=t,a=(i-r)*(i-r)+(o-s)*(o-s);if(a===0)return n;let c=((e.x-r)*(i-r)+(e.y-s)*(o-s))/a;return n.x=r+c*(i-r),n.y=s+c*(o-s),n}function ep(t,e=new T){let n=$t(t)-Y.HALF_PI;return e.x=Math.cos(n),e.y=Math.sin(n),e}function ja(t){let e=$t(t)-Y.HALF_PI;return Ae(e,-Math.PI,Math.PI)}function np(t){return Math.cos($t(t)-Y.HALF_PI)}function rp(t){return Math.sin($t(t)-Y.HALF_PI)}function sp(t){let{x1:e,y1:n,x2:r,y2:s}=t;return-((r-e)/(s-n))}function ip(t,e,n=new T){return n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}function op(t,e,n=0,r=[]){e||(e=ct(t)/n);let{x1:s,y1:i,x2:o,y2:a}=t;for(let c=0;c<e;c++){let u=c/e,h=s+(o-s)*u,l=i+(a-i)*u;r.push(new T(h,l))}return r}function ap(t,e=new T){let n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}function cp(t,e){return 2*ja(e)-Math.PI-$t(t)}function up(t){let{x1:e,y1:n,x2:r,y2:s}=t;return(s-n)/(r-e)}function hp(t){return Math.abs(t.x1-t.x2)}function lp(t,e){let{x1:n,y1:r,x2:s,y2:i}=t,o=(s-n)*(s-n)+(i-r)*(i-r);if(o===0)return 0;let a=((r-e.y)*(s-n)-(n-e.x)*(i-r))/o;return Math.abs(a)*Math.sqrt(o)}function fp(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}function dp(t,e,n,r,s){return t.x1=e,t.y1=n,t.x2=e+Math.cos(r)*s,t.y2=n+Math.sin(r)*s,t}function qr(t,e,n,r){let s=Math.cos(r),i=Math.sin(r),o=t.x1-e,a=t.y1-n;return t.x1=o*s-a*i+e,t.y1=o*i+a*s+n,o=t.x2-e,a=t.y2-n,t.x2=o*s-a*i+e,t.y2=o*i+a*s+n,t}function xp(t,e){let n=(t.x1+t.x2)/2,r=(t.y1+t.y2)/2;return qr(t,n,r,e)}function yp(t,e,n){return qr(t,e.x,e.y,n)}function $a(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t}function mp(t,e){return $a(t,e.x,e.y)}var Oa={};v(Oa,{BuildEquilateralTriangle:()=>pp,BuildRightTriangle:()=>wp,CenterTriangleOn:()=>gp,CloneTriangle:()=>Mp,CopyTriangleFrom:()=>Cp,DecomposeTriangle:()=>Hr,GetTriangleArea:()=>bp,GetTriangleCentroid:()=>Za,GetTriangleCircumCenter:()=>Rp,GetTriangleCircumCircle:()=>Tp,GetTriangleEdges:()=>st,GetTriangleInCenter:()=>tc,GetTrianglePerimeter:()=>Sp,GetTrianglePoint:()=>vp,GetTrianglePoints:()=>Ep,GetTriangleRandomPoint:()=>Ap,RotateTriangle:()=>zp,RotateTriangleAround:()=>Kr,RotateTriangleAroundPoint:()=>Dp,TranslateTriangle:()=>Ja,Triangle:()=>xn,TriangleContains:()=>_t,TriangleContainsPoint:()=>Fp,TriangleContainsPoints:()=>dn,TriangleEquals:()=>Vp});var xn=class{constructor(t=0,e=0,n=0,r=0,s=0,i=0){this.set(t,e,n,r,s,i)}set(t=0,e=0,n=0,r=0,s=0,i=0){return this.x1=t,this.y1=e,this.x2=n,this.y2=r,this.x3=s,this.y3=i,this}contains(t,e){return _t(this,t,e)}get left(){return Math.min(this.x1,this.x2,this.x3)}set left(t){let e=0;this.x1<=this.x2&&this.x1<=this.x3?e=this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?e=this.x2-t:e=this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}get right(){return Math.max(this.x1,this.x2,this.x3)}set right(t){let e=0;this.x1>=this.x2&&this.x1>=this.x3?e=this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?e=this.x2-t:e=this.x3-t,this.x1-=e,this.x2-=e,this.x3-=e}get top(){return Math.min(this.y1,this.y2,this.y3)}set top(t){let e=0;this.y1<=this.y2&&this.y1<=this.y3?e=this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?e=this.y2-t:e=this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}get bottom(){return Math.max(this.y1,this.y2,this.y3)}set bottom(t){let e=0;this.y1>=this.y2&&this.y1>=this.y3?e=this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?e=this.y2-t:e=this.y3-t,this.y1-=e,this.y2-=e,this.y3-=e}};function pp(t,e,n){let r=n*(Math.sqrt(3)/2),s=t,i=e,o=t+n/2,a=e+r,c=t-n/2,u=e+r;return new xn(s,i,o,a,c,u)}function wp(t,e,n,r=n){let s=t,i=e,o=t,a=e-r,c=t+n,u=e;return new xn(s,i,o,a,c,u)}function Za(t,e=new T){return e.set((t.x1+t.x2+t.x3)/3,(t.y1+t.y2+t.y3)/3)}function Ja(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t.x3+=e,t.y3+=n,t}function gp(t,e,n,r=Za){let s=r(t),i=e-s.x,o=n-s.y;return Ja(t,i,o)}function Mp(t){let{x1:e,y1:n,x2:r,y2:s,x3:i,y3:o}=t;return new xn(e,n,r,s,i,o)}function Cp(t,e){let{x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=t;return e.set(n,r,s,i,o,a)}function bp(t){let{x1:e,y1:n,x2:r,y2:s,x3:i,y3:o}=t;return Math.abs(((i-e)*(s-n)-(r-e)*(o-n))/2)}function Qr(t,e,n,r){return t*r-e*n}function Rp(t,e=new T){let n=t.x3,r=t.y3,s=t.x1-n,i=t.y1-r,o=t.x2-n,a=t.y2-r,c=2*Qr(s,i,o,a),u=Qr(i,s*s+i*i,a,o*o+a*a),h=Qr(s,s*s+i*i,o,o*o+a*a);return e.set(n-u/c,r+h/c)}function Tp(t,e=new kr){let{x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=t,c=s-n,u=i-r,h=o-n,l=a-r,d=c*(n+s)+u*(r+i),f=h*(n+o)+l*(r+a),x=2*(c*(a-i)-u*(o-s));if(Math.abs(x)<1e-6){let p=Math.min(n,s,o),m=Math.min(r,i,a),w=(Math.max(n,s,o)-p)*.5,g=(Math.max(r,i,a)-m)*.5;return e.set(p+w,m+g,Math.sqrt(w*w+g*g))}else{let p=(l*d-u*f)/x,m=(c*f-h*d)/x,w=p-n,g=m-r;return e.set(p,m,Math.sqrt(w*w+g*g))}}function Xr(t,e,n,r){let s=t-n,i=e-r;return Math.sqrt(s*s+i*i)}function tc(t,e=new T){let{x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=t,c=Xr(o,a,s,i),u=Xr(n,r,o,a),h=Xr(s,i,n,r),l=c+u+h;return e.set((n*c+s*u+o*h)/l,(r*c+i*u+a*h)/l)}function Sp(t){let[e,n,r]=st(t);return ct(e)+ct(n)+ct(r)}function vp(t,e,n=new T){let[r,s,i]=st(t);if(e<=0||e>=1)return n.set(r.x1,r.y1);let o=ct(r),a=ct(s),c=ct(i),h=(o+a+c)*e,l=0;if(h<o){l=h/o;let{x1:d,y1:f,x2:x,y2:p}=r;return n.set(d+(x-d)*l,f+(p-f)*l)}else if(h>o+a){h-=o+a,l=h/c;let{x1:d,y1:f,x2:x,y2:p}=i;return n.set(d+(x-d)*l,f+(p-f)*l)}else{h-=o,l=h/a;let{x1:d,y1:f,x2:x,y2:p}=s;return n.set(d+(x-d)*l,f+(p-f)*l)}}function Ep(t,e,n,r=[]){let[s,i,o]=st(t),a=ct(s),c=ct(i),u=ct(o),h=a+c+u;e||(e=h/n);for(let l=0;l<e;l++){let d=h*(l/e),f=0,x;if(d<a){f=d/a;let{x1:p,y1:m,x2:w,y2:g}=s;x=new T(p+(w-p)*f,m+(g-m)*f)}else if(d>a+c){d-=a+c,f=d/u;let{x1:p,y1:m,x2:w,y2:g}=o;x=new T(p+(w-p)*f,m+(g-m)*f)}else{d-=a,f=d/c;let{x1:p,y1:m,x2:w,y2:g}=i;x=new T(p+(w-p)*f,m+(g-m)*f)}r.push(x)}return r}function Ap(t,e=new T){let{x1:n,y1:r,x2:s,y2:i,x3:o,y3:a}=t,c=s-n,u=i-r,h=o-n,l=a-r,d=Math.random(),f=Math.random();return d+f>=1&&(d=1-d,f=1-f),e.set(n+(c*d+h*f),r+(u*d+l*f))}function Kr(t,e,n,r){let{x1:s,y1:i,x2:o,y2:a,x3:c,y3:u}=t,h=Math.cos(r),l=Math.sin(r);return t.set((s-e)*h-(i-n)*l+e,(s-e)*l+(i-n)*h+n,(o-e)*h-(a-n)*l+e,(o-e)*l+(a-n)*h+n,(c-e)*h-(u-n)*l+e,(c-e)*l+(u-n)*h+n)}function zp(t,e){let n=tc(t);return Kr(t,n.x,n.y,e)}function Dp(t,e,n){return Kr(t,e.x,e.y,n)}function Fp(t,e){return _t(t,e.x,e.y)}function Vp(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}var Gp={};v(Gp,{BoxGeometry:()=>Aa,ConeGeometry:()=>Va,CylinderGeometry:()=>Fa,PlaneGeometry:()=>Tt,SphereGeometry:()=>Ga,TorusGeometry:()=>Lp});function Lp(t=1,e=.4,n=8,r=6,s=Math.PI*2){let i=Xt(),{vertices:o,normals:a,uvs:c,indices:u}=i,h=new E,l=new E,d=new E;for(let f=0;f<=n;f++)for(let x=0;x<=r;x++){let p=x/r*s,m=f/n*Math.PI*2;l.x=(t+e*Math.cos(m))*Math.cos(p),l.y=(t+e*Math.cos(m))*Math.sin(p),l.z=e*Math.sin(m),o.push(l.x,l.y,l.z),h.x=t*Math.cos(p),h.y=t*Math.sin(p),Ge(l,h,d),lt(d,d),a.push(d.x,d.y,d.z),c.push(x/r),c.push(f/n)}for(let f=1;f<=n;f++)for(let x=1;x<=r;x++){let p=(r+1)*f+x-1,m=(r+1)*(f-1)+x-1,w=(r+1)*(f-1)+x,g=(r+1)*f+x;u.push(p,m,g),u.push(m,w,g)}return i.numberOfVertices=o.length,i}var _p={};v(_p,{Keyboard:()=>ec,Mouse:()=>nc,SetInteractive:()=>Ip});var ec={};v(ec,{GetKeyDownDuration:()=>Pp,Key:()=>O,Keyboard:()=>Op,Keys:()=>rc,SetKeyRepeatRate:()=>Bp});var rc={};v(rc,{AKey:()=>Np,ArrowKeys:()=>kp,BKey:()=>Up,CKey:()=>Wp,DKey:()=>Hp,DownKey:()=>qp,EKey:()=>Kp,FKey:()=>Qp,GKey:()=>Xp,HKey:()=>Yp,IKey:()=>jp,JKey:()=>$p,KKey:()=>Zp,LKey:()=>Jp,LeftKey:()=>t1,MKey:()=>e1,NKey:()=>n1,OKey:()=>r1,PKey:()=>s1,QKey:()=>i1,RKey:()=>o1,RightKey:()=>a1,SKey:()=>c1,SpaceKey:()=>u1,TKey:()=>h1,UKey:()=>l1,UpKey:()=>f1,VKey:()=>d1,WASDKeys:()=>x1,WKey:()=>y1,XKey:()=>m1,YKey:()=>p1,ZKey:()=>w1});var O=class{constructor(t){this.capture=!0,this.isDown=!1,this.enabled=!0,this.repeatRate=0,this.canRepeat=!0,this.timeDown=0,this.timeUpdated=0,this.timeUp=0,this.value=t,this.events=new Map}getValue(){return this.value}down(t){!this.enabled||(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&this.canRepeat?(this.timeUpdated=t.timeStamp,this.timeUpdated-this.timeDown>=this.repeatRate&&(I(this,"keydown",this),this.downCallback&&this.downCallback(this))):(this.isDown=!0,this.timeDown=t.timeStamp,this.timeUpdated=t.timeStamp,I(this,"keydown",this),this.downCallback&&this.downCallback(this)))}up(t){!this.enabled||(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&(this.isDown=!1,this.timeUp=t.timeStamp,this.timeUpdated=t.timeStamp,I(this,"keyup",this),this.upCallback&&this.upCallback(this)))}reset(){this.isDown=!1,this.timeUpdated=this.timeDown,this.timeUp=this.timeDown}destroy(){this.downCallback=null,this.upCallback=null,this.events.clear()}},Np=class extends O{constructor(){super("a")}},kp=class{constructor(t,e){let{left:n=!0,right:r=!0,up:s=!0,down:i=!0,space:o=!0}=e,a=t.keys;n&&(this.left=new O("ArrowLeft"),a.set(this.left.value,this.left)),r&&(this.right=new O("ArrowRight"),a.set(this.right.value,this.right)),s&&(this.up=new O("ArrowUp"),a.set(this.up.value,this.up)),i&&(this.down=new O("ArrowDown"),a.set(this.down.value,this.down)),o&&(this.space=new O(" "),a.set(this.space.value,this.space))}},Up=class extends O{constructor(){super("b")}},Wp=class extends O{constructor(){super("c")}},Hp=class extends O{constructor(){super("d")}},qp=class extends O{constructor(){super("ArrowDown")}},Kp=class extends O{constructor(){super("e")}},Qp=class extends O{constructor(){super("f")}},Xp=class extends O{constructor(){super("g")}},Yp=class extends O{constructor(){super("h")}},jp=class extends O{constructor(){super("i")}},$p=class extends O{constructor(){super("j")}},Zp=class extends O{constructor(){super("k")}},Jp=class extends O{constructor(){super("l")}},t1=class extends O{constructor(){super("ArrowLeft")}},e1=class extends O{constructor(){super("m")}},n1=class extends O{constructor(){super("n")}},r1=class extends O{constructor(){super("o")}},s1=class extends O{constructor(){super("p")}},i1=class extends O{constructor(){super("q")}},o1=class extends O{constructor(){super("r")}},a1=class extends O{constructor(){super("ArrowRight")}},c1=class extends O{constructor(){super("s")}},u1=class extends O{constructor(){super(" ")}},h1=class extends O{constructor(){super("t")}},l1=class extends O{constructor(){super("u")}},f1=class extends O{constructor(){super("ArrowUp")}},d1=class extends O{constructor(){super("v")}},x1=class{constructor(t,e){let{W:n=!0,A:r=!0,S:s=!0,D:i=!0,space:o=!0}=e,a=t.keys;n&&(this.W=new O("w"),a.set(this.W.value,this.W)),r&&(this.A=new O("a"),a.set(this.A.value,this.A)),s&&(this.S=new O("s"),a.set(this.S.value,this.S)),i&&(this.D=new O("d"),a.set(this.D.value,this.D)),o&&(this.space=new O(" "),a.set(this.space.value,this.space))}},y1=class extends O{constructor(){super("w")}},m1=class extends O{constructor(){super("x")}},p1=class extends O{constructor(){super("y")}},w1=class extends O{constructor(){super("z")}};function Pp(t){return t.isDown?t.timeUpdated-t.timeDown:t.timeUp-t.timeDown}var Op=class extends ye{constructor(){super();this.keyConversion={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Win:"Meta",Scroll:"ScrollLock",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Add:"+",Subtract:"-",Multiply:"*",Decimal:".",Divide:"/"},this.keydownHandler=t=>this.onKeyDown(t),this.keyupHandler=t=>this.onKeyUp(t),this.blurHandler=()=>this.onBlur(),window.addEventListener("keydown",this.keydownHandler),window.addEventListener("keyup",this.keyupHandler),window.addEventListener("blur",this.blurHandler),this.keys=new Map}addKeys(...t){t.forEach(e=>{this.keys.set(e.getValue(),e)})}clearKeys(){this.keys.clear()}onBlur(){this.keys.forEach(t=>{t.reset()})}getKeyValue(t){return this.keyConversion.hasOwnProperty(t)?this.keyConversion[t]:t}onKeyDown(t){let e=this.getKeyValue(t.key);this.keys.has(e)&&this.keys.get(e).down(t),I(this,"keydown-"+e,t),I(this,"keydown",t)}onKeyUp(t){let e=this.getKeyValue(t.key);this.keys.has(e)&&this.keys.get(e).up(t),I(this,"keyup-"+e,t),I(this,"keyup",t)}destroy(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler),window.removeEventListener("blur",this.blurHandler),I(this,"destroy")}};function Bp(t,...e){return e.forEach(n=>{n.repeatRate=t}),e}var nc={};v(nc,{Mouse:()=>g1});var g1=class extends ye{constructor(t){super();this.primaryDown=!1,this.auxDown=!1,this.secondaryDown=!1,this.blockContextMenu=!0,this.resolution=1,this.mousedownHandler=e=>this.onMouseDown(e),this.mouseupHandler=e=>this.onMouseUp(e),this.mousemoveHandler=e=>this.onMouseMove(e),this.mousewheelHandler=e=>this.onMouseWheel(e),this.contextmenuHandler=e=>this.onContextMenuEvent(e),this.blurHandler=()=>this.onBlur(),this.localPoint=new T,this.hitPoint=new T,this.transPoint=new T,t||(t=rt.get().renderer.canvas),t.addEventListener("mousedown",this.mousedownHandler),t.addEventListener("mouseup",this.mouseupHandler),t.addEventListener("wheel",this.mousewheelHandler,{passive:!1}),t.addEventListener("contextmenu",this.contextmenuHandler),window.addEventListener("mouseup",this.mouseupHandler),window.addEventListener("mousemove",this.mousemoveHandler),window.addEventListener("blur",this.blurHandler),this.target=t}onBlur(){}onMouseDown(t){this.positionToPoint(t),this.primaryDown=t.button===0,this.auxDown=t.button===1,this.secondaryDown=t.button===2,I(this,"pointerdown",this.localPoint.x,this.localPoint.y,t.button,t)}onMouseUp(t){this.positionToPoint(t),this.primaryDown=t.button!==0,this.auxDown=t.button!==1,this.secondaryDown=t.button!==2,I(this,"pointerup",this.localPoint.x,this.localPoint.y,t.button,t)}onMouseMove(t){this.positionToPoint(t),I(this,"pointermove",this.localPoint.x,this.localPoint.y,t)}onMouseWheel(t){I(this,"wheel",t.deltaX,t.deltaY,t.deltaZ,t)}onContextMenuEvent(t){this.blockContextMenu&&t.preventDefault(),I(this,"contextmenu",t)}positionToPoint(t){return this.localPoint.set(t.offsetX,t.offsetY)}getInteractiveChildren(t,e){let n=t.children;for(let r=0;r<n.length;r++){let s=n[r];!s.visible||!s.input.enabled||(e.push(s),s.input.enabledChildren&&s.numChildren&&this.getInteractiveChildren(s,e))}}checkHitArea(t,e,n){if(t.input.hitArea){if(t.input.hitArea.contains(e,n))return!0}else return t.transform.extent.contains(e,n);return!1}hitTest(...t){let e=this.localPoint.x,n=this.localPoint.y,r=this.transPoint;for(let s=0;s<t.length;s++){let i=t[s];if(!i.world)continue;let o=_i(i.world.camera.worldTransform,i.transform.world);if(Ni(o,e,n,r),this.checkHitArea(i,r.x,r.y))return this.hitPoint.set(r.x,r.y),!0}return!1}hitTestChildren(t,e=!0){let n=[];if(!t.visible)return n;let r=[],s=t.input;s&&s.enabled&&r.push(t),s.enabledChildren&&t.numChildren&&this.getInteractiveChildren(t,r);for(let i=r.length-1;i>=0;i--){let o=r[i];if(this.hitTest(o)&&(n.push(o),e))break}return n}shutdown(){let t=this.target;t.removeEventListener("mousedown",this.mousedownHandler),t.removeEventListener("mouseup",this.mouseupHandler),t.removeEventListener("wheel",this.mousewheelHandler),t.removeEventListener("contextmenu",this.contextmenuHandler),window.removeEventListener("mouseup",this.mouseupHandler),window.removeEventListener("mousemove",this.mousemoveHandler),window.removeEventListener("blur",this.blurHandler)}};function Ip(...t){return t.forEach(e=>{e.input.enabled=!0}),t}var yn={};v(yn,{File:()=>ht,Files:()=>sc,Loader:()=>M1});var sc={};v(sc,{AtlasFile:()=>C1,BitmapTextFile:()=>b1,CSVFile:()=>R1,ImageFile:()=>Yr,JSONFile:()=>ic,JSONGeometryFile:()=>T1,OBJFile:()=>S1,OBJGeometryFile:()=>v1,SpriteSheetFile:()=>E1,XMLFile:()=>oc});function ac(t,e){let n;if(Array.isArray(e.textures)?n=e.textures[0].frames:Array.isArray(e.frames)?n=e.frames:e.hasOwnProperty("frames")?n=Object.values(e.frames):console.warn("Invalid Texture Atlas JSON"),n){let r;for(let s=0;s<n.length;s++){let i=n[s];r=t.addFrame(i.filename,i.frame.x,i.frame.y,i.frame.w,i.frame.h),i.trimmed?r.setTrim(i.sourceSize.w,i.sourceSize.h,i.spriteSourceSize.x,i.spriteSourceSize.y,i.spriteSourceSize.w,i.spriteSourceSize.h):r.setSourceSize(i.sourceSize.w,i.sourceSize.h),i.rotated,i.anchor&&r.setPivot(i.anchor.x,i.anchor.y)}}}var ht=class{constructor(t,e,n){this.responseType="text",this.crossOrigin=void 0,this.skipCache=!1,this.hasLoaded=!1,this.key=t,this.url=e,this.config=n}};function ut(t,e,n,r){return e||(e=t+n),/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(e)?e:r?r.baseURL+r.path+e:e}function cc(t){return t.data=new Image,t.crossOrigin&&(t.data.crossOrigin=t.crossOrigin),new Promise((e,n)=>{t.data.onload=()=>{t.data.onload&&(t.data.onload=null,t.data.onerror=null,e(t))},t.data.onerror=r=>{t.data.onload&&(t.data.onload=null,t.data.onerror=null,t.error=r,n(t))},t.data.src=t.url,t.data.complete&&t.data.width&&t.data.height&&(t.data.onload=null,t.data.onerror=null,e(t))})}function Yr(t,e,n){let r=new ht(t,e);return r.load=()=>(r.url=ut(r.key,r.url,".png",r.loader),r.loader&&(r.crossOrigin=r.loader.crossOrigin),new Promise((s,i)=>{let o=bt.get();o.has(r.key)?s(r):cc(r).then(a=>{o.add(a.key,a.data,n),s(a)}).catch(a=>{i(a)})})),r}var Re=new Map,Zt={get:t=>(Re.has(t)||Re.set(t,new Map),Re.get(t)),getEntry:(t,e)=>{if(Re.has(t))return Re.get(t).get(e)}};function Jt(t){let e=new XMLHttpRequest;return e.open("GET",t.url,!0),e.responseType=t.responseType,new Promise((n,r)=>{e.onload=()=>{t.data=e.responseText,t.hasLoaded=!0,n(t)},e.onerror=()=>{t.hasLoaded=!0,r(t)},e.send()})}function ic(t,e){let n=new ht(t,e);return n.load=()=>(n.url=ut(n.key,n.url,".json",n.loader),new Promise((r,s)=>{let i=Zt.get("JSON");!n.skipCache&&i.has(n.key)?r(n):Jt(n).then(o=>{o.data=JSON.parse(o.data),o.skipCache||i.set(o.key,o.data),r(o)}).catch(o=>{s(o)})})),n}function C1(t,e,n,r){let s=ic(t,n),i=Yr(t,e,r),o=new ht(t,"");return o.load=()=>(s.url=ut(s.key,s.url,".json",o.loader),i.url=ut(i.key,i.url,".png",o.loader),new Promise((a,c)=>{s.skipCache=!0,s.load().then(()=>{i.load().then(()=>{ac(bt.get().get(t),s.data),a(o)}).catch(()=>{c(o)})}).catch(()=>{c(o)})})),o}function it(t,e){return parseInt(t.getAttribute(e),10)}function uc(t,e,n){let r=0,s=0,i=e.getElementsByTagName("info")[0],o=e.getElementsByTagName("common")[0],a={font:i.getAttribute("face"),size:it(i,"size"),lineHeight:it(o,"lineHeight")+s,chars:{}},c=e.getElementsByTagName("char");for(let h=0;h<c.length;h++){let l=c[h],d=it(l,"id"),f=it(l,"x"),x=it(l,"y"),p=it(l,"width"),m=it(l,"height");a.chars[d]={x:f,y:x,width:p,height:m,xOffset:it(l,"xoffset"),yOffset:it(l,"yoffset"),xAdvance:it(l,"xadvance")+r,kerning:{}},t.addFrame(d,f,x,p,m)}let u=e.getElementsByTagName("kerning");for(let h=0;h<u.length;h++){let l=u[h],d=it(l,"first"),f=it(l,"second"),x=it(l,"amount");a.chars[f].kerning[d]=x}return a}function oc(t,e){let n=new ht(t,e);return n.load=()=>(n.url=ut(n.key,n.url,".xml",n.loader),new Promise((r,s)=>{let i=Zt.get("XML");!n.skipCache&&i.has(n.key)?r(n):Jt(n).then(o=>{let a=Ao(o.data);a!==null?(o.data=a,o.skipCache||i.set(o.key,a),r(o)):s(o)}).catch(o=>{s(o)})})),n}function b1(t,e,n,r){let s=oc(t,n),i=Yr(t,e,r),o=new ht(t,"");return o.load=()=>(s.url=ut(s.key,s.url,".xml",o.loader),i.url=ut(i.key,i.url,".png",o.loader),new Promise((a,c)=>{s.skipCache=!0,s.load().then(()=>{i.load().then(()=>{let u=bt.get().get(t),h=uc(u,s.data);u.data=h,a(o)}).catch(()=>{c(o)})}).catch(()=>{c(o)})})),o}function R1(t,e){let n=new ht(t,e);return n.load=()=>(n.url=ut(n.key,n.url,".csv",n.loader),new Promise((r,s)=>{let i=Zt.get("CSV");!n.skipCache&&i.has(n.key)?r(n):Jt(n).then(o=>{o.skipCache||i.set(o.key,o.data),r(o)}).catch(o=>{s(o)})})),n}function T1(t,e,n){let r=new ht(t,e),{vertices:s="verts",normals:i="normals",uvs:o="uvs",numberOfVertices:a=0}=n;return r.load=()=>(r.url=ut(r.key,r.url,".json",r.loader),new Promise((c,u)=>{let h=Zt.get("Geometry");!r.skipCache&&h.has(r.key)?c(r):Jt(r).then(l=>{let d=JSON.parse(l.data),f=new Gt({vertices:d[s],normals:d[i],uvs:d[o],numberOfVertices:a});l.data=f,l.skipCache||h.set(l.key,f),c(l)}).catch(l=>{u(l)})})),r}function S1(t,e){let n=new ht(t,e);return n.load=()=>(n.url=ut(n.key,n.url,".obj",n.loader),new Promise((r,s)=>{let i=Zt.get("Obj");!n.skipCache&&i.has(n.key)?r(n):Jt(n).then(o=>{o.skipCache||i.set(o.key,o.data),r(o)}).catch(o=>{s(o)})})),n}function v1(t,e,n=!0){let r=new ht(t,e);return r.load=()=>(r.url=ut(r.key,r.url,".obj",r.loader),new Promise((s,i)=>{let o=Zt.get("Geometry");!r.skipCache&&o.has(r.key)?s(r):Jt(r).then(a=>{let c=Ea(a.data,n);if(a.data=c,!a.skipCache){let u=a.key;c.forEach((h,l)=>{l>0&&(u=a.key+l.toString());let d=new Gt(h.buffer);o.set(u,d)})}s(a)}).catch(a=>{i(a)})})),r}function hc(t,e,n,r,s,i){let{frameWidth:o=null,endFrame:a=-1,margin:c=0,spacing:u=0}=i,{frameHeight:h=null,startFrame:l=0}=i;if(h||(h=o),o===null)throw new Error("SpriteSheetParser: Invalid frameWidth");let d=Math.floor((r-c+u)/(o+u)),f=Math.floor((s-c+u)/(h+u)),x=d*f;x===0&&console.warn("SpriteSheetParser: Frame config will result in zero frames"),(l>x||l<-x)&&(l=0),l<0&&(l=x+l),a!==-1&&(x=l+(a+1));let p=c,m=c,w=0,g=0;for(let M=0;M<x;M++){w=0,g=0;let C=p+o,b=m+h;C>r&&(w=C-r),b>s&&(g=b-s),t.addFrame(M,e+p,n+m,o-w,h-g),p+=o+u,p+o>r&&(p=c,m+=h+u)}}function E1(t,e,n,r){let s=new ht(t,e);return s.load=()=>(s.url=ut(s.key,s.url,".png",s.loader),s.loader&&(s.crossOrigin=s.loader.crossOrigin),new Promise((i,o)=>{let a=bt.get();a.has(s.key)?i(s):cc(s).then(c=>{let u=a.add(c.key,c.data,r);u?(hc(u,0,0,u.width,u.height,n),i(c)):o(c)}).catch(c=>{o(c)})})),s}var M1=class extends ye{constructor(){super();this.baseURL="",this.path="",this.crossOrigin="anonymous",this.maxParallelDownloads=-1,this.isLoading=!1,this.reset()}reset(){this.isLoading=!1,this.queue=new Set,this.inflight=new Set,this.completed=new Set,this.progress=0}add(...t){return t.forEach(e=>{e.loader=this,this.queue.add(e)}),this}start(){return this.isLoading?null:new Promise((t,e)=>{this.completed.clear(),this.progress=0,this.queue.size>0?(this.isLoading=!0,this.onComplete=t,this.onError=e,I(this,"start"),this.nextFile()):(this.progress=1,I(this,"complete"),t(this))})}nextFile(){let t=this.queue.size;if(this.maxParallelDownloads!==-1&&(t=Math.min(t,this.maxParallelDownloads)-this.inflight.size),t){let e=this.queue.values();for(;t>0;){let n=e.next().value;this.inflight.add(n),this.queue.delete(n),n.load().then(r=>this.fileComplete(r)).catch(r=>this.fileError(r)),t--}}else this.inflight.size===0&&this.stop()}stop(){!this.isLoading||(this.isLoading=!1,I(this,"complete",this.completed),this.onComplete(),this.completed.clear())}updateProgress(t){this.inflight.delete(t),this.completed.add(t);let e=this.completed.size,n=this.queue.size+this.inflight.size;e>0&&(this.progress=e/(e+n)),I(this,"progress",this.progress,e,n),this.nextFile()}fileComplete(t){I(this,"filecomplete",t),this.updateProgress(t)}fileError(t){I(this,"fileerror",t),this.updateProgress(t)}totalFilesToLoad(){return this.queue.size+this.inflight.size}setBaseURL(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.baseURL=t,this}setPath(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.path=t,this}setCORS(t){return this.crossOrigin=t,this}setMaxParallelDownloads(t){return this.maxParallelDownloads=t,this}},A1={};v(A1,{BlackPlastic:()=>z1,BlackRubber:()=>D1,Brass:()=>F1,Bronze:()=>V1,Chrome:()=>G1,Copper:()=>L1,CyanPlastic:()=>_1,CyanRubber:()=>I1,Emerald:()=>P1,Gold:()=>O1,GreenPlastic:()=>B1,GreenRubber:()=>N1,Jade:()=>k1,Obsidian:()=>U1,Pearl:()=>W1,RedPlastic:()=>H1,RedRubber:()=>q1,Ruby:()=>K1,Silver:()=>Q1,Turquoise:()=>X1,WhitePlastic:()=>Y1,WhiteRubber:()=>j1,YellowPlastic:()=>$1,YellowRubber:()=>Z1});var z1=new K({ambient:[0,0,0],diffuse:[.01,.01,.01],specular:[.5,.5,.5],shine:.25}),D1=new K({ambient:[.02,.02,.02],diffuse:[.01,.01,.01],specular:[.4,.4,.4],shine:.078125}),F1=new K({ambient:[.329412,.223529,.027451],diffuse:[.780392,.568627,.113725],specular:[.992157,.941176,.807843],shine:.21794872}),V1=new K({ambient:[.2125,.1275,.054],diffuse:[.714,.4284,.18144],specular:[.393548,.271906,.166721],shine:.2}),G1=new K({ambient:[.25,.25,.25],diffuse:[.4,.4,.4],specular:[.774597,.774597,.774597],shine:.6}),L1=new K({ambient:[.19125,.0735,.0225],diffuse:[.7038,.27048,.0828],specular:[.256777,.137622,.086014],shine:.1}),_1=new K({ambient:[0,.1,.06],diffuse:[0,.50980392,.50980392],specular:[.50196078,.50196078,.50196078],shine:.25}),I1=new K({ambient:[0,.05,.05],diffuse:[.4,.5,.5],specular:[.04,.7,.7],shine:.078125}),P1=new K({ambient:[.0215,.1745,.0215],diffuse:[.07568,.61424,.07568],specular:[.633,.727811,.633],shine:.6}),O1=new K({ambient:[.24725,.1995,.0745],diffuse:[.75164,.60648,.22648],specular:[.628281,.555802,.366065],shine:.4}),B1=new K({ambient:[0,0,0],diffuse:[.1,.35,.1],specular:[.45,.55,.45],shine:.25}),N1=new K({ambient:[0,.05,0],diffuse:[.4,.5,.4],specular:[.04,.7,.04],shine:.078125}),k1=new K({ambient:[.135,.2225,.1575],diffuse:[.54,.89,.63],specular:[.316228,.316228,.316228],shine:.1}),U1=new K({ambient:[.05375,.05,.06625],diffuse:[.18275,.17,.22525],specular:[.332741,.328634,.346435],shine:.3}),W1=new K({ambient:[.25,.20725,.20725],diffuse:[1,.829,.829],specular:[.296648,.296648,.296648],shine:.088}),H1=new K({ambient:[0,0,0],diffuse:[.5,0,0],specular:[.7,.6,.6],shine:.25}),q1=new K({ambient:[.05,0,0],diffuse:[.5,.4,.4],specular:[.7,.04,.04],shine:.078125}),K1=new K({ambient:[.1745,.01175,.01175],diffuse:[.61424,.04136,.04136],specular:[.727811,.626959,.626959],shine:.6}),Q1=new K({ambient:[.19225,.19225,.19225],diffuse:[.50754,.50754,.50754],specular:[.508273,.508273,.508273],shine:.4}),X1=new K({ambient:[.1,.18725,.1745],diffuse:[.396,.74151,.69102],specular:[.297254,.30829,.306678],shine:.1}),Y1=new K({ambient:[0,0,0],diffuse:[.55,.55,.55],specular:[.7,.7,.7],shine:.25}),j1=new K({ambient:[.05,.05,.05],diffuse:[.5,.5,.5],specular:[.7,.7,.7],shine:.078125}),$1=new K({ambient:[0,0,0],diffuse:[.5,.5,0],specular:[.6,.6,.5],shine:.25}),Z1=new K({ambient:[.05,.05,0],diffuse:[.5,.5,.4],specular:[.7,.7,.04],shine:.078125}),J1={};v(J1,{CreateCanvas:()=>Rt,Frame:()=>Un,GetFrames:()=>t2,GetFramesInRange:()=>e2,Palettes:()=>lc,Parsers:()=>fc,SetFilter:()=>n2,Texture:()=>Z,TextureManager:()=>xc,Types:()=>dc});var lc={};v(lc,{Arne16:()=>yc,C64:()=>r2,CGA:()=>s2,JMP:()=>i2,MSX:()=>o2,PICO8:()=>a2});var yc=["#000","#9D9D9D","#FFF","#BE2633","#E06F8B","#493C2B","#A46422","#EB8931","#F7E26B","#2F484E","#44891A","#A3CE27","#1B2632","#005784","#31A2F2","#B2DCEF"],r2=["#000","#fff","#8b4131","#7bbdc5","#8b41ac","#6aac41","#3931a4","#d5de73","#945a20","#5a4100","#bd736a","#525252","#838383","#acee8b","#7b73de","#acacac"],s2=["#000","#2234d1","#0c7e45","#44aacc","#8a3622","#5c2e78","#aa5c3d","#b5b5b5","#5e606e","#4c81fb","#6cd947","#7be2f9","#eb8a60","#e23d69","#ffd93f","#fff"],i2=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#f5f4eb"],o2=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#fff"],a2=["#000","#1D2B53","#7E2553","#008751","#AB5236","#5F574F","#C2C3C7","#FFF1E8","#FF004D","#FFA300","#FFEC27","#00E436","#29ADFF","#83769C","#FF77A8","#FFCCAA"],fc={};v(fc,{AtlasParser:()=>ac,BitmapTextParser:()=>uc,SpriteSheetParser:()=>hc});var dc={};v(dc,{CanvasTexture:()=>ga,GridTexture:()=>c2,PixelTexture:()=>u2,RenderTexture:()=>h2,SolidColorTexture:()=>l2});function c2(t,e,n=32,r=32,s=2,i=2){let o=Rt(n,r),a=n/s,c=r/i;o.fillStyle=t,o.fillRect(0,0,n,r),o.fillStyle=e;for(let u=0;u<i;u++)for(let h=u%2;h<s;h+=2)o.fillRect(h*a,u*c,a,c);return new Z(o.canvas)}function u2(t){let{data:e=[],palette:n=yc,pixelWidth:r=1,pixelHeight:s=r,preRender:i=null,postRender:o=null}=t,{canvas:a=null,resizeCanvas:c=!0,clearCanvas:u=!0}=t,h=Math.floor(Math.abs(e[0].length*r)),l=Math.floor(Math.abs(e.length*s));a||(a=Rt(h,l).canvas,c=!1,u=!1),c&&(a.width=h,a.height=l);let d=a.getContext("2d");u&&d.clearRect(0,0,h,l),i&&i(a,d);for(let f=0;f<e.length;f++){let x=e[f];for(let p=0;p<x.length;p++){let m=x[p];m!=="."&&m!==" "&&(d.fillStyle=n[parseInt("0x"+m.toUpperCase())],d.fillRect(p*r,f*s,r,s))}}return o&&o(a,d),new Z(a)}var h2=class extends Z{constructor(t,e=256,n=e){super(null,e,n);this.renderer=t}cls(){return this}batchStart(){return this}batchDraw(t){for(let e=0,n=t.length;e<n;e++);return this}batchEnd(){return this.renderer.reset(),this}draw(...t){return this.batchStart(),this.batchDraw(t),this.batchEnd(),this}};function l2(t="rgba(0,0,0,0)",e=32,n=32){let r=Rt(e,n);return r.fillStyle=t,r.fillRect(0,0,e,n),new Z(r.canvas)}function t2(t,e){let n=[];return e.forEach(r=>{n.push(t.getFrame(r))}),n}function e2(t,e){let{prefix:n="",start:r=0,zeroPad:s=0,suffix:i=""}=e,o=e.end,a=[],c=r<o?1:-1;o+=c;for(let u=r;u!==o;u+=c){let h=n+u.toString().padStart(s,"0")+i;a.push(t.getFrame(h))}return a}function n2(t,...e){return e.forEach(n=>{n.binding&&n.binding.setFilter(t)}),e}var xc=class{constructor(){this.textures=new Map,this.createDefaultTextures(),bt.set(this)}createDefaultTextures(){this.add("__BLANK",new Z(Rt(32,32).canvas));let t=Rt(32,32);t.strokeStyle="#0f0",t.moveTo(0,0),t.lineTo(32,32),t.stroke(),t.strokeRect(.5,.5,31,31),this.add("__MISSING",new Z(t.canvas));let e=Rt(32,32);e.fillStyle="#fff",e.fillRect(0,0,32,32),this.add("__WHITE",new Z(e.canvas))}get(t){let e=this.textures;return e.has(t)?e.get(t):e.get("__MISSING")}has(t){return this.textures.has(t)}add(t,e,n){let r,s=this.textures;return s.has(t)||(e instanceof Z?r=e:r=new Z(e,0,0,n),r.key=t,s.set(t,r)),r}},f2={};v(f2,{AddDelayedCall:()=>d2,AddTimer:()=>mc,Clock:()=>x2,NOOP:()=>Te});function Te(){}function mc(t,e){let{duration:n=0,repeat:r=0,delay:s=-1,onStart:i=Te,onUpdate:o=Te,onRepeat:a=Te,onComplete:c=Te}=e,u={elapsed:n,duration:n,repeat:r,delay:s,update:null,onStart:i,onUpdate:o,onRepeat:a,onComplete:c};u.update=h=>{if(u.delay>0)if(u.delay-=h,u.delay<0)u.delay=0;else return!1;return u.delay===0&&(u.onStart(),u.delay=-1),u.delay===-1&&(u.elapsed-=h,u.onUpdate(h,u.elapsed/u.duration),u.elapsed<=0&&(u.repeat>0?(u.repeat--,u.elapsed=u.duration,u.onRepeat(u.repeat)):(u.elapsed=0,u.onComplete()))),u.elapsed===0},t.events.add(u)}function d2(t,e,n){mc(t,{duration:0,delay:e,onComplete:n})}var x2=class{constructor(t){this.world=t,this.timeScale=1,this.events=new Set}update(t,e){this.now=e,t*=this.timeScale,this.events.forEach(n=>{n.update(t)&&this.events.delete(n)})}},jr={};v(jr,{BaseWorld:()=>Jr,BuildRenderList:()=>Mc,CalculateTotalRenderable:()=>$r,CreateWorldRenderData:()=>ts,Events:()=>pc,HasDirtyChildren:()=>wc,MergeRenderData:()=>Cc,ResetWorldRenderData:()=>mn,StaticWorld:()=>y2,UpdateCachedLayers:()=>gc,World:()=>m2,WorldDepthFirstSearch:()=>Zr});var pc={};v(pc,{WorldRenderEvent:()=>bc,WorldShutdownEvent:()=>Rc});var bc="worldrender",Rc="worldshutdown";function $r(t,e){e.numRendered++,e.numRenderable++,t.node.dirtyFrame>=e.gameFrame&&e.dirtyFrame++,t.children.forEach(n=>{n.children.length>0&&$r(n,e)})}function wc(t){if(t.node.isDirty(G.CHILD_CACHE))return!0;let e=[t];for(;e.length>0;){let n=e.pop();if(n.node.isDirty(G.TRANSFORM))return!0;let r=n.children.length;if(r>0)for(let s=0;s<r;s++)e.push(n.children[s])}return e.length=0,!1}function gc(t,e){t.forEach(n=>{e||wc(n)?n.node.setDirty(G.CHILD_CACHE):n.children.length=0})}function Zr(t,e,n=[]){for(let r=0;r<e.numChildren;r++){let s=e.children[r];if(s.isRenderable()){let i=[],o={node:s,children:i};n.push(o),s.willRenderChildren&&s.numChildren>0&&(s.willCacheChildren&&t.push(o),Zr(t,s,i))}}return n}function Mc(t){let e=[],r=Zr(e,t,[]),s=t.renderData;e.length>0&&gc(e,t.camera.dirtyRender),r.forEach(i=>{i.children.length>0?$r(i,s):(s.numRendered++,s.numRenderable++,i.node.dirtyFrame>=s.gameFrame&&s.dirtyFrame++)}),t.renderList=r,t.forceRefresh&&(s.dirtyFrame++,t.forceRefresh=!1)}function Cc(t,e){t.numDirtyFrames+=e.dirtyFrame,t.numTotalFrames+=e.numRendered,e.camera.dirtyRender&&t.numDirtyCameras++,t.worldData.push(e)}function mn(t,e){t.gameFrame=e,t.dirtyFrame=0,t.numRendered=0,t.numRenderable=0}var Jr=class extends hn{constructor(t){super();this.forceRefresh=!1,this.is3D=!1,this.type="BaseWorld",this.scene=t,this.world=this,this.events=new Map,this.renderList=[],this._updateListener=Mt(t,"update",(e,n)=>this.update(e,n)),this._renderListener=Mt(t,"render",e=>this.render(e)),this._shutdownListener=Mt(t,"shutdown",()=>this.shutdown()),un(t,"destroy",()=>this.destroy())}update(t,e){!this.willUpdate||(I(this,Ho,t,e,this),super.update(t,e))}postUpdate(t,e){I(this,Wo,t,e,this)}render(t){let e=this.renderData;mn(e,t.gameFrame),!(!this.willRender||!this.visible)&&(Mc(this),I(this,bc,e,this),Cc(t,e),this.camera.dirtyRender=!1)}renderGL(t){let e=t.current2DCamera,n=this.camera;(!e||!Ii(n.worldTransform,e.worldTransform))&&at(t),W0(t,n),this.renderList.forEach(r=>{r.children.length>0?this.renderNode(r,t):r.node.renderGL(t)})}renderNode(t,e){t.node.renderGL(e),t.children.forEach(n=>{n.children.length>0?this.renderNode(n,e):n.node.renderGL(e)}),t.node.postRenderGL(e)}postRenderGL(t){}shutdown(){let t=this.scene;Vt(t,"update",this._updateListener),Vt(t,"render",this._renderListener),Vt(t,"shutdown",this._shutdownListener),ko(this),I(this,Rc,this),mn(this.renderData,0),this.camera&&this.camera.reset()}destroy(t){super.destroy(t),I(this,sn,this),mn(this.renderData,0),this.camera&&this.camera.destroy(),this.events.clear(),this.camera=null,this.renderData=null,this.events=null}};function ts(t,e){return{world:t,camera:e,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var y2=class extends Jr{constructor(t){super(t);this.type="StaticWorld",this.camera=new wn,this.renderData=ts(this,this.camera)}},m2=class extends Jr{constructor(t){super(t);this.enableCameraCull=!0,this.type="World",this.camera=new os,this.renderData=ts(this,this.camera)}},p2={};v(p2,{BaseWorld3D:()=>zc,BuildRenderList:()=>Ec,CalculateTotalRenderable:()=>es,CreateWorld3DRenderData:()=>Dc,Events:()=>Tc,HasDirtyChildren:()=>Sc,MergeRenderData:()=>Ac,ResetWorld3DRenderData:()=>pn,UpdateCachedLayers:()=>vc,World3D:()=>w2,WorldDepthFirstSearch:()=>ns});var Tc={};v(Tc,{World3DRenderEvent:()=>Fc,World3DShutdownEvent:()=>Vc});var Fc="worldrender",Vc="worldshutdown";function es(t,e){e.numRendered++,e.numRenderable++,t.node.dirtyFrame>=e.gameFrame&&e.dirtyFrame++,t.children.forEach(n=>{n.children.length>0&&es(n,e)})}function Sc(t){if(t.node.isDirty(G.CHILD_CACHE))return!0;let e=[t];for(;e.length>0;){let n=e.pop();if(n.node.isDirty(G.TRANSFORM))return!0;let r=n.children.length;if(r>0)for(let s=0;s<r;s++)e.push(n.children[s])}return e.length=0,!1}function vc(t,e){t.forEach(n=>{e||Sc(n)?n.node.setDirty(G.CHILD_CACHE):n.children.length=0})}function ns(t,e,n=[]){for(let r=0;r<e.numChildren;r++){let s=e.children[r];if(s.isRenderable()){let i=[],o={node:s,children:i};n.push(o),s.willRenderChildren&&s.numChildren>0&&(s.willCacheChildren&&t.push(o),ns(t,s,i))}}return n}function Ec(t){let e=[],r=ns(e,t,[]),s=t.renderData;e.length>0&&vc(e,t.camera.dirtyRender),r.forEach(i=>{i.children.length>0?es(i,s):(s.numRendered++,s.numRenderable++,i.node.dirtyFrame>=s.gameFrame&&s.dirtyFrame++)}),t.renderList=r,t.forceRefresh&&(s.dirtyFrame++,t.forceRefresh=!1)}function Ac(t,e){t.numDirtyFrames+=e.dirtyFrame,t.numTotalFrames+=e.numRendered,e.camera.dirtyRender&&t.numDirtyCameras++,t.worldData.push(e)}function pn(t,e){t.gameFrame=e,t.dirtyFrame=0,t.numRendered=0,t.numRenderable=0}var zc=class extends Or{constructor(t){super();this.forceRefresh=!1,this.is3D=!0,this.type="BaseWorld",this.scene=t,this.world=this,this.events=new Map,this.renderList=[],this._updateListener=Mt(t,"update",(e,n)=>this.update(e,n)),this._renderListener=Mt(t,"render",e=>this.render(e)),this._shutdownListener=Mt(t,"shutdown",()=>this.shutdown()),un(t,"destroy",()=>this.destroy())}update(t,e){!this.willUpdate||(I(this,Ho,t,e,this),super.update(t,e))}postUpdate(t,e){I(this,Wo,t,e,this)}render(t){let e=this.renderData;pn(e,t.gameFrame),!(!this.willRender||!this.visible)&&(Ec(this),I(this,Fc,e,this),Ac(t,e))}renderNode(t,e){t.node.renderGL(e),t.children.forEach(n=>{n.children.length>0?this.renderNode(n,e):n.node.renderGL(e)}),t.node.postRenderGL(e)}shutdown(){let t=this.scene;Vt(t,"update",this._updateListener),Vt(t,"render",this._renderListener),Vt(t,"shutdown",this._shutdownListener),$o(this),I(this,Vc,this),pn(this.renderData,0)}destroy(t){super.destroy(t),I(this,sn,this),pn(this.renderData,0),this.events.clear(),this.camera=null,this.renderData=null,this.events=null}};function Dc(t,e){return{world:t,camera:e,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var g2=`#define SHADER_NAME AMBIENT_LIGHT_FRAG

precision highp float;

uniform vec3 uLightPosition;
uniform vec3 uLightAmbient;
uniform vec3 uLightDiffuse;
uniform vec3 uLightSpecular;

uniform vec3 uMaterialAmbient;
uniform vec3 uMaterialDiffuse;
uniform vec3 uMaterialSpecular;
uniform float uMaterialShine;

uniform vec3 uCameraPosition;

uniform sampler2D uTexture;

varying vec2 vTextureCoord;
varying vec3 vNormal;
varying vec3 vPosition;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    vec3 ambient = uLightAmbient * uMaterialAmbient;

    vec3 norm = normalize(vNormal);
    vec3 lightDir = normalize(uLightPosition - vPosition);
    float diff = max(dot(norm, lightDir), 0.0);
    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);

    vec3 viewDir = normalize(uCameraPosition - vPosition);
    vec3 reflectDir = reflect(-lightDir, norm);
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);
    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);

    vec3 result = (ambient + diffuse + specular) * color.rgb;

    gl_FragColor = vec4(result, color.a);
}`,M2=`
#define SHADER_NAME AMBIENT_LIGHT_VERT

precision highp float;

attribute vec3 aVertexPosition;
attribute vec3 aVertexNormal;
attribute vec2 aTextureCoord;

uniform mat4 uViewProjectionMatrix;
uniform mat4 uModelMatrix;
uniform mat4 uNormalMatrix;

varying vec2 vTextureCoord;
varying vec3 vNormal;
varying vec3 vPosition;

void main(void)
{
    vTextureCoord = aTextureCoord;

    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));

    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));

    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
}
`,C2=class extends yo{constructor(){super();let t=new Float32Array(16).fill(0),e=[0,0,0],n={fragmentShader:g2,vertexShader:M2,attributes:{aVertexPosition:{size:3,type:kt,normalized:!1,offset:0},aVertexNormal:{size:3,type:kt,normalized:!1,offset:12},aTextureCoord:{size:2,type:kt,normalized:!1,offset:24}},uniforms:{uViewProjectionMatrix:t,uNormalMatrix:t,uModelMatrix:t,uCameraPosition:e,uTexture:0,uLightPosition:e,uLightAmbient:e,uLightDiffuse:e,uLightSpecular:e,uMaterialAmbient:e,uMaterialDiffuse:e,uMaterialSpecular:e,uMaterialShine:0}};this.fromConfig(n)}},b2=class{constructor(t=45,e=.1,n=1e3){this.isOrbit=!1,this.minDistance=0,this.maxDistance=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.dirtyRender=!0,this.panRate=5,this.zoomRate=200,this.rotateRate=-3,this._yaw=0,this._pitch=0,this._roll=0,this.type="Camera3D",this._fov=t,this._near=e,this._far=n,this.matrix=new _,this.viewMatrix=new _,this.projectionMatrix=new _,this.viewProjectionMatrix=new _,this.position=new mt(()=>this.update()),this.rotation=new k;let s=rt.get().renderer;this.viewport=new J(0,0,s.width,s.height),this.renderer=s,this.forward=De(),this.up=se(),this.right=Fe(),this.start=new E,this.setAspectRatio()}update(){let t=this.matrix,e=this.viewMatrix;return fs(this.rotation,this.position,!this.isOrbit,t),_e(Ps,t,this.forward),_e(Mn,t,this.up),_e(Is,t,this.right),ve(t,e),It(this.projectionMatrix,e,this.viewProjectionMatrix),this}panX(t){let e=this.position;return this.isOrbit||Le(e,this.right,t,e),this}panY(t){let e=this.position,n=this.up;return this.isOrbit?e.y+=n.y*t:Le(e,n,t,e),this}panZ(t){let e=this.position;return this.isOrbit?e.z+=t:Le(e,this.forward,t,e),this}begin(t,e){this.start.set(t,e)}pan(t,e){let n=t-this.start.x,r=e-this.start.y,s=this.viewport;this.panX(-n*(this.panRate/s.width)),this.panY(r*(this.panRate/s.height)),this.start.set(t,e)}rotate(t,e){let n=t-this.start.x,r=e-this.start.y,s=this.viewport;this.rotation.x+=r*(this.rotateRate/s.height),this.rotation.y+=n*(this.rotateRate/s.width),this.start.set(t,e),this.update()}zoom(t){this.panZ(q(t,-1,1)*(this.zoomRate/this.viewport.height))}setAspectRatio(t){if(!t){let e=this.renderer;t=e.width/e.height}return this.aspect=t,this.updateProjectionMatrix()}updateProjectionMatrix(){return Ee(oe(this._fov),this.aspect,this._near,this._far,this.projectionMatrix),this}get fov(){return this._fov}set fov(t){this._fov=q(t,0,180),this.updateProjectionMatrix()}get near(){return this._near}set near(t){t>0&&(this._near=t,this.updateProjectionMatrix())}get far(){return this._far}set far(t){t>0&&(this._far=t,this.updateProjectionMatrix())}get yaw(){return this._yaw}set yaw(t){this._yaw=t,Pt(t,this._pitch,this._roll,this.rotation)}get pitch(){return this._pitch}set pitch(t){this._pitch=t,Pt(this._yaw,t,this._roll,this.rotation)}get roll(){return this._roll}set roll(t){this._roll=t,Pt(this._yaw,this._pitch,t,this.rotation)}},w2=class extends zc{constructor(t,e=0,n=0,r=0,s){super(t);this.enableCameraCull=!0,this.type="World3D",this.camera=new b2,this.camera.position.set(e,n,r),this.light=new ba(s),this.shader=new C2,this.renderData=Dc(this,this.camera)}renderGL(t){at(t);let e=this.shader,n=this.camera,r=t.renderer.gl;Co(t,e,0),e.setUniform("uViewProjectionMatrix",n.viewProjectionMatrix.data),e.setUniform("uCameraPosition",n.position.toArray()),this.light.setUniforms(e),r.enable(r.DEPTH_TEST),this.renderList.forEach(s=>{s.children.length>0?this.renderNode(s,t):s.node.renderGL(t)})}postRenderGL(t){let e=t.renderer.gl;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),Mo(t)}};function R2(){let{title:t,version:e,url:n,color:r,background:s}=X.get(Q.BANNER);if(t!==""){let i=e!==""?t+" "+e:t;console.log(`%c${i}%c ${n}`,`padding: 4px 16px; color: ${r}; background: ${s}`,"")}}function T2(){return X.get(Q.PARENT)}function S2(){return X.get(Q.RENDERER)}function v2(){return{gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]}}function E2(){return X.get(Q.SCENES)}function A2(t,e=0){t.gameFrame=e,t.numTotalFrames=0,t.numDirtyFrames=0,t.numDirtyCameras=0,t.worldData.length=0}var Gc,Lc={get:()=>Gc,set:t=>{Gc=t}},z2=class{constructor(){this.scenes=new Map,this.sceneIndex=0,this.flush=!1,this.renderResult=v2(),this.game=rt.get(),Lc.set(this),un(this.game,"boot",()=>this.boot())}boot(){E2().forEach(t=>new t)}update(t,e){for(let n of this.scenes.values())I(n,"update",t,e)}render(t){let e=this.renderResult;A2(e,t);for(let n of this.scenes.values())I(n,"render",e);return this.flush&&(e.numDirtyFrames++,this.flush=!1),e}};function D2(){Zi(0),to(4096),Ji("Phaser","4.0.0","https://phaser4.io"),On(0),so(.5,.5),eo(800,600,1)}var _c=class extends ye{constructor(...t){super();this.VERSION="4.0.0-beta1",this.isBooted=!1,this.isPaused=!1,this.willUpdate=!0,this.willRender=!0,this.lastTick=0,this.elapsed=0,this.frame=0,rt.set(this),D2(),Eo(()=>this.boot(t))}boot(t){t.forEach(r=>r());let e=S2();this.renderer=new e,this.textureManager=new xc,this.sceneManager=new z2;let n=T2();n&&vo(this.renderer.canvas,n),this.isBooted=!0,R2(),I(this,"boot"),this.lastTick=performance.now(),this.step(this.lastTick)}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.lastTick=performance.now()}step(t){let e=t-this.lastTick;this.lastTick=t,this.elapsed+=e,this.isPaused||(this.willUpdate&&(this.sceneManager.update(e,t),I(this,"update",e,t)),this.willRender&&this.renderer.render(this.sceneManager.render(this.frame))),this.frame++,rt.setFrame(this.frame),rt.setElapsed(this.elapsed),requestAnimationFrame(n=>this.step(n))}destroy(){}};function F2(t,e,n){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:n}function V2(t,e={}){let n=Lc.get(),r=n.scenes.size,s=n.sceneIndex,i=r===0;typeof e=="string"?t.key=e:(e||!e&&i)&&(t.key=F2(e,"key","scene"+s.toString())),n.scenes.has(t.key)?console.warn("Scene key already in use: "+t.key):(n.scenes.set(t.key,t),n.flush=!0,n.sceneIndex++)}var Ic=class{constructor(t){this.game=rt.get(),this.events=new Map,V2(this,t)}};var Pc=class extends Ic{constructor(){super();let e=new jr.StaticWorld(this),n=new yn.Loader;window.location.href.includes("192.168.0.100/phaser-genesis/")?n.setPath("/phaser4-examples/public/assets/"):n.setPath("/examples/public/assets/"),n.add(yn.ImageFile("logo","logo.png")),n.start().then(()=>{let r=new _r.Sprite(400,300,"logo").setRotation(.3);vr.AddChildren(e,r)})}};new _c(Nt.WebGL(),Nt.Parent("gameParent"),Nt.BackgroundColor(2960685),Nt.Scenes(Pc));})();
/**
 * @author       Florian Vazelle
 * @author       Geoffrey Glaive
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Niklas von Hertzen (https://github.com/niklasvh/base64-arraybuffer)
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @author       Florian Mertens
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
//# sourceMappingURL=index.min.js.map
