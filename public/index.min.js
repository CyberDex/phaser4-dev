(()=>{var Po=Object.defineProperty;var ko=(e,t)=>{for(var r in t)Po(e,r,{get:t[r],enumerable:!0})};function fe(e,t=1.70158){return e*e*((t+1)*e-t)}function ce(e,t=1.70158){let r=t*1.525;return(e*=2)<1?.5*(e*e*((r+1)*e-r)):.5*((e-=2)*e*((r+1)*e+r)+2)}function Ft(e,t=1.70158){return--e*e*((t+1)*e+t)+1}var Dt={};ko(Dt,{In:()=>At,InOut:()=>Gt,Out:()=>et});function At(e){return e=1-e,e<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}function Gt(e){let t=!1;return e<.5?(e=1-e*2,t=!0):e=e*2-1,e<1/2.75?e=7.5625*e*e:e<2/2.75?e=7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?e=7.5625*(e-=2.25/2.75)*e+.9375:e=7.5625*(e-=2.625/2.75)*e+.984375,t?(1-e)*.5:e*.5+.5}function et(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function ue(e){return 1-Math.sqrt(1-e*e)}function he(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}function Bt(e){return Math.sqrt(1- --e*e)}function le(e){return e*e*e}function pe(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}function rt(e){return--e*e*e+1}function de(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r))}}function xe(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?-.5*(t*Math.pow(2,10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r)):t*Math.pow(2,-10*(e-=1))*Math.sin((e-o)*(2*Math.PI)/r)*.5+1}}function Vt(e,t=.1,r=.1){if(e===0)return 0;if(e===1)return 1;{let o=r/4;return t<1?t=1:o=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-o)*(2*Math.PI)/r)+1}}function ge(e){return Math.pow(2,10*(e-1))-.001}function Se(e){return e==0?0:e==1?1:(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))}function It(e){return 1-Math.pow(2,-10*e)}function Re(e){return e*e}function ye(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function ot(e){return e*(2-e)}function Ce(e){return e*e*e*e}function Te(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function nt(e){return-(--e*e*e*e-1)}function Me(e){return e*e*e*e*e}function we(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}function it(e){return(e=e-1)*e*e*e*e+1}function Ee(e){return e===0?0:e===1?1:1-Math.cos(e*Math.PI/2)}function be(e){return e===0?0:e===1?1:.5*(1-Math.cos(Math.PI*e))}function Ot(e){return e===0?0:e===1?1:Math.sin(e*Math.PI/2)}function st(e){return e}function Wr(e,t=1){return e<=0?0:e>=1?1:((t*e|0)+1)*(1/t)}var fs=new Map([["power0",st],["power1",ot],["power2",rt],["power3",nt],["power4",it],["linear",st],["quad",ot],["cubic",rt],["quart",nt],["quint",it],["sine",Ot],["expo",It],["circ",Bt],["elastic",Vt],["back",Ft],["bounce",et],["stepped",Wr],["quad.in",Re],["cubic.in",le],["quart.in",Ce],["quint.in",Me],["sine.in",Ee],["expo.in",ge],["circ.in",ue],["elastic.in",de],["back.in",fe],["bounce.in",At],["quad.out",ot],["cubic.out",rt],["quart.out",nt],["quint.out",it],["sine.out",Ot],["expo.out",It],["circ.out",Bt],["elastic.out",Vt],["back.out",Ft],["bounce.out",et],["quad.inout",ye],["cubic.inout",pe],["quart.inout",Te],["quint.inout",we],["sine.inout",be],["expo.inout",Se],["circ.inout",he],["elastic.inout",xe],["back.inout",ce],["bounce.inout",Gt]]);var l={BACKGROUND_COLOR:"BackgroundColor",BATCH_SIZE:"BatchSize",DEFAULT_ORIGIN:"DefaultOrigin",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",SIZE:"Size",SCENES:"Scenes",RENDERER:"Renderer",AUTO:"Auto",WEBGL:"WebGL",CANVAS:"Canvas",WEBGL_CONTEXT:"WebGLContext",CANVAS_CONTEXT:"CanvasContext",BANNER:"Banner"};var p=new Map;function Lt(e){p.set(l.BACKGROUND_COLOR,e)}function Fe(e){return()=>{Lt(e)}}function _t(e="",t="",r="",o="#fff",i="linear-gradient(#3e0081 40%, #00bcc3)"){p.set(l.BANNER,{title:e,version:t,url:r,color:o,background:i})}function Ae(e){p.set(l.BATCH_SIZE,e)}function D(){return p.get(l.SIZE).height}function B(){return p.get(l.SIZE).resolution}function V(){return p.get(l.SIZE).width}function vt(e=800,t=600,r=1){r===0&&(r=window.devicePixelRatio),p.set(l.SIZE,{width:e,height:t,resolution:r})}var Ge=[],Y={add:(e,t)=>{Ge.push({texture:e,glConfig:t})},get:()=>Ge,clear:()=>{Ge.length=0}};function De(){return p.get(l.BACKGROUND_COLOR)}function Nt(e){p.set(l.RENDERER,e)}function zt(e=.5,t=e){p.set(l.DEFAULT_ORIGIN,{x:e,y:t})}function X(e){p.set(l.MAX_TEXTURES,e)}function at(e){let t;return e&&(typeof e=="string"?t=document.getElementById(e):typeof e=="object"&&e.nodeType===1&&(t=e)),t||(t=document.body),t}function Be(e){e&&p.set(l.PARENT,at(e))}function Ut(e){return()=>{Be(e)}}function Ve(e){p.set(l.SCENES,[].concat(e))}function Pt(e){return()=>{Ve(e)}}function kt(e,t,r){return e.width<=0||e.height<=0?!1:e.x<=t&&e.x+e.width>=t&&e.y<=r&&e.y+e.height>=r}var C=class{constructor(t=0,r=0,o=0,i=0){this.set(t,r,o,i)}set(t=0,r=0,o=0,i=0){return this.x=t,this.y=r,this.width=o,this.height=i,this}contains(t,r){return kt(this,t,r)}set right(t){t<=this.x?this.width=0:this.width=t-this.x}get right(){return this.x+this.width}set bottom(t){t<=this.y?this.height=0:this.height=t-this.y}get bottom(){return this.y+this.height}};function Ie(e,t=0,r=0,o=0,i=0){let s=new C(t,r,o,i);return e.viewportStack.push(s),s}var n,Yr={get:()=>n,set:e=>{n=e}};function I(e,t){if(!t&&(t=e.currentViewport,!t))return;let r=n.getParameter(n.VIEWPORT);(r[0]!==t.x||r[1]!==t.y||r[2]!==t.width||r[3]!==t.height)&&n.viewport(t.x,t.y,t.width,t.height)}function Oe(e,t=0,r=0,o=0,i=0){let s=Ie(e,t,r,o,i);I(e,s),e.currentViewport=s}function O(e,t=!0,r){r||(r=e.currentFramebuffer);let{framebuffer:o,viewport:i}=r;n.bindFramebuffer(n.FRAMEBUFFER,o),t&&(n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)),i&&Oe(e,i.x,i.y,i.width,i.height)}function Le(e){let t=e.viewportStack;t.length>1&&t.pop(),e.currentViewport=t[t.length-1],I(e)}function mt(e){let t=e.framebufferStack;t.length>1&&(e.currentFramebuffer.viewport&&Le(e),t.pop()),e.currentFramebuffer=t[t.length-1],O(e,!1)}function _e(e,t,r){let o={framebuffer:t,viewport:r};return e.framebufferStack.push(o),o}function Wt(e,t,r=!0,o){let i=_e(e,t,o);O(e,r,i),e.currentFramebuffer=i}function ve(e){let t=e.count;if(t===0)return;let r=e.currentVertexBuffer,o=e.currentShader,i=o.shader.renderToFramebuffer;if(i&&Wt(e,o.shader.framebuffer,!0),t===r.batchSize){let s=r.isDynamic?n.DYNAMIC_DRAW:n.STATIC_DRAW;n.bufferData(n.ARRAY_BUFFER,r.data,s)}else{let s=r.indexed?t*r.entryElementSize:t*r.vertexElementSize,a=r.vertexViewF32.subarray(0,s);n.bufferSubData(n.ARRAY_BUFFER,0,a)}r.indexed?n.drawElements(n.TRIANGLES,t*r.entryIndexSize,n.UNSIGNED_SHORT,0):n.drawArrays(n.TRIANGLES,0,t),i&&mt(e)}function E(e,t){t&&(e.count=t);let r=e.count;return r===0?!1:(ve(e),e.prevCount=r,e.count=0,e.flushTotal++,!0)}function Ne(e){E(e)}function Xr(e,t=[]){let r=e>>16&255,o=e>>8&255,i=e&255,s=e>16777215?e>>>24:255;return t[0]=r/255,t[1]=o/255,t[2]=i/255,t[3]=s/255,t}function Qr(){return p.get(l.WEBGL_CONTEXT)}function Yt(e){let{parent:t,flipY:r,unpackPremultiplyAlpha:o,minFilter:i,magFilter:s,wrapS:a,wrapT:m,generateMipmap:c,isPOT:f}=e,u=t.image,R=t.width,S=t.height,w=n.createTexture();return n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,w),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),u?(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,u),R=u.width,S=u.height):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,R,S,0,n.RGBA,n.UNSIGNED_BYTE,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,s),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,m),c&&f&&n.generateMipmap(n.TEXTURE_2D),e.texture=w,w}function ft(e){n&&n.isFramebuffer(e)&&n.deleteFramebuffer(e)}function ct(e){n.isTexture(e)&&n.deleteTexture(e)}function Hr(e,t){return e<1||t<1?!1:(e&e-1)==0&&(t&t-1)==0}function qr(e,t=!0){n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e);let r=t?n.LINEAR:n.NEAREST;n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,r)}function jr(e){let t=e.parent.image,r=t.width,o=t.height;return r>0&&o>0&&(n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e.texture),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e.flipY),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),e.texture}var Q=class{constructor(t,r={}){this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=t,this.isPOT=Hr(t.width,t.height);let{texture:o=null,framebuffer:i=null,depthbuffer:s=null,unpackPremultiplyAlpha:a=!0,minFilter:m=this.isPOT?n.LINEAR_MIPMAP_LINEAR:n.LINEAR,magFilter:c=n.LINEAR,wrapS:f=n.CLAMP_TO_EDGE,wrapT:u=n.CLAMP_TO_EDGE,generateMipmap:R=this.isPOT,flipY:S=!1}=r;this.minFilter=m,this.magFilter=c,this.wrapS=f,this.wrapT=u,this.generateMipmap=R,this.flipY=S,this.unpackPremultiplyAlpha=a,i&&(this.framebuffer=i),s&&(this.depthbuffer=s),o?this.texture=o:Yt(this)}setFilter(t){this.texture&&qr(this.texture,t)}create(){let t=this.texture;return t&&ct(t),Yt(this)}update(){return this.texture?jr(this):Yt(this)}setIndex(t){this.dirtyIndex=t!==this.index,this.index=t}destroy(){ct(this.texture),ft(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null}};function ze(){Y.get().forEach(t=>{let{texture:r,glConfig:o}=t;r.binding||(r.binding=new Q(r,o))}),Y.clear()}function ut(){return p.get(l.MAX_TEXTURES)}var on=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function nn(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}function Ue(e){let t=n.createShader(n.FRAGMENT_SHADER);for(;;){let r=on.replace(/%forloop%/gi,nn(e));if(n.shaderSource(t,r),n.compileShader(t),!n.getShaderParameter(t,n.COMPILE_STATUS))e=e/2|0;else break}return e}function Pe(e){let t=Ue(n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r=ut();r===0||r>0&&r>t?X(t):r>0&&r<t&&(t=Math.max(8,r));let o=e.tempTextures;o.length&&o.forEach(s=>{n.deleteTexture(s)});let i=[];for(let s=0;s<t;s++){let a=n.createTexture();n.activeTexture(n.TEXTURE0+s),n.bindTexture(n.TEXTURE_2D,a),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),o[s]=a,i.push(s)}e.maxTextures=t,e.textureIndex=i,e.currentActiveTexture=1}function $r(){return p.get(l.BATCH_SIZE)}function ht(e){n.isBuffer(e)&&n.deleteBuffer(e)}var ke=class{constructor(t={}){this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;let{batchSize:r=1,dataSize:o=4,isDynamic:i=!0,elementsPerEntry:s=4,vertexElementSize:a=6}=t;this.batchSize=r,this.dataSize=o,this.vertexElementSize=a,this.isDynamic=i,this.elementsPerEntry=s,this.vertexByteSize=a*o,this.entryByteSize=this.vertexByteSize*s,this.bufferByteSize=r*this.entryByteSize,this.create()}resize(t){this.batchSize=t,this.bufferByteSize=t*this.entryByteSize,this.vertexBuffer&&ht(this.vertexBuffer),this.create()}create(){let t=new ArrayBuffer(this.bufferByteSize);this.data=t,this.vertexViewF32=new Float32Array(t),this.vertexViewU32=new Uint32Array(t),this.vertexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer);let r=this.isDynamic?n.DYNAMIC_DRAW:n.STATIC_DRAW;n.bufferData(n.ARRAY_BUFFER,t,r),n.bindBuffer(n.ARRAY_BUFFER,null)}add(t){this.count+=t,this.offset+=this.vertexElementSize*t}reset(){this.count=0,this.offset=0}canContain(t){return this.count+t<=this.batchSize}free(){return Math.max(0,1-this.count/this.batchSize)}bind(){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer)}destroy(){ht(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null}};var Xt=class extends ke{constructor(t={}){super(t);let{indexSize:r=4,entryIndexSize:o=6,indexLayout:i=null}=t;this.indexed=!0,this.indexSize=r,this.entryIndexSize=o,this.entryElementSize=this.vertexElementSize*this.elementsPerEntry;let s=[];if(i){this.indexLayout=i;for(let a=0;a<this.batchSize*r;a+=r)for(let m=0;m<i.length;m++)s.push(a+i[m])}this.create(),this.createIndexBuffer(s)}createIndexBuffer(t){this.index=new Uint16Array(t),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.index,n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),t=[]}bind(){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer)}destroy(){super.destroy(),ht(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null}};var Kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fn=new Uint8Array(256);for(let e=0;e<Kr.length;e++)fn[Kr.charCodeAt(e)]=e;function L(){}var d=class{constructor(t){let r=new Float32Array(16);this.data=r,this.onChange=L,t?Array.isArray(t)?this.fromArray(t):this.fromArray(t.data):(r[0]=1,r[5]=1,r[10]=1,r[15]=1)}set(t,r,o,i,s,a,m,c,f,u,R,S,w,b,J,tt){let y=this.data;return y[0]=t,y[1]=r,y[2]=o,y[3]=i,y[4]=s,y[5]=a,y[6]=m,y[7]=c,y[8]=f,y[9]=u,y[10]=R,y[11]=S,y[12]=w,y[13]=b,y[14]=J,y[15]=tt,this.onChange(this),this}toArray(t=[],r=0){let o=this.data;for(let i=0;i<16;i++)t[r+i]=o[i];return t}fromArray(t,r=0){let o=this.data;for(let i=0;i<16;i++)o[i]=t[r+i];return this.onChange(this),this}toString(){return"[ mat4="+this.data.join(", ")+" ]"}destroy(){this.onChange=L,this.data=null}};function Ye(e,t,r,o,i,s,a=new d){let m=1/(e-t),c=1/(r-o),f=1/(i-s);return a.set(-2*m,0,0,0,0,-2*c,0,0,0,0,2*f,0,(e+t)*m,(o+r)*c,(s+i)*f,1)}function Xe(e,t){let r=new Map,o={size:1,type:n.FLOAT,normalized:!1,stride:0,offset:0},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let a=n.getActiveAttrib(e,s);if(!a)break;let m=a.name,c=n.getAttribLocation(e,m);n.enableVertexAttribArray(c);let f=t.hasOwnProperty(m)?t[m]:{},{size:u=o.size,type:R=o.type,normalized:S=o.normalized,stride:w=o.stride,offset:b=o.offset}=f;r.set(m,{index:c,size:u,type:R,normalized:S,stride:w,offset:b})}return r}function lt(...e){e.forEach(t=>{n.deleteShader(t)})}function Qe(...e){let t=n.createProgram();if(e.forEach(o=>{n.attachShader(t,o)}),n.linkProgram(t),!n.getProgramParameter(t,n.LINK_STATUS)){let o=n.getProgramInfoLog(t);return console.error(`Error linking program: ${o}`),n.deleteProgram(t),lt(...e),null}return t}function Qt(e,t){let r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){let i=n.getShaderInfoLog(r),s=e.split(`
`).map((a,m)=>`${m}: ${a}`);return console.error(`Error compiling shader: ${i}`,s.join(`
`)),n.deleteShader(r),null}return r}function He(e,t,r=!1){switch(e.type){case n.INT:case n.BOOL:return r?o=>{n.uniform1iv(t,o)}:o=>{n.uniform1i(t,o)};case n.INT_VEC2:case n.BOOL_VEC2:return o=>{n.uniform2iv(t,o)};case n.INT_VEC3:case n.BOOL_VEC3:return o=>{n.uniform3iv(t,o)};case n.INT_VEC4:case n.BOOL_VEC4:return o=>{n.uniform4iv(t,o)};case n.FLOAT:return r?o=>{n.uniform1fv(t,o)}:o=>{n.uniform1f(t,o)};case n.FLOAT_VEC2:return o=>{n.uniform2fv(t,o)};case n.FLOAT_VEC3:return o=>{n.uniform3fv(t,o)};case n.FLOAT_VEC4:return o=>{n.uniform4fv(t,o)};case n.FLOAT_MAT2:return o=>{n.uniformMatrix2fv(t,!1,o)};case n.FLOAT_MAT3:return o=>{n.uniformMatrix3fv(t,!1,o)};case n.FLOAT_MAT4:return o=>{n.uniformMatrix4fv(t,!1,o)};case n.SAMPLER_2D:case n.SAMPLER_CUBE:return e.size>1?o=>{n.uniform1iv(t,o)}:o=>{n.uniform1i(t,o)}}}function qe(e){let t=new Map,r=n.getProgramParameter(e,n.ACTIVE_UNIFORMS);for(let o=0;o<r;o++){let i=n.getActiveUniform(e,o),s=i.name;if(s.startsWith("gl_")||s.startsWith("webgl_"))continue;let a=n.getUniformLocation(e,i.name);if(a){let m=!1;s.substr(-3)==="[0]"&&(s=s.substr(0,s.length-3),m=i.size>1),t.set(s,He(i,a,m))}}return t}var Jr=5121;var Ht=5126;var H={aVertexPosition:{size:2,type:Ht,normalized:!1,offset:0},aTextureCoord:{size:2,type:Ht,normalized:!1,offset:8},aTextureId:{size:1,type:Ht,normalized:!1,offset:16},aTintColor:{size:4,type:Jr,normalized:!0,offset:20}};var je={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function to(e,t,r){n.bindFramebuffer(n.FRAMEBUFFER,e);let o=n.createRenderbuffer();return n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,t,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,o),n.bindFramebuffer(n.FRAMEBUFFER,null),o}function $e(e,t){t||(t=n.COLOR_ATTACHMENT0);let r=n.createFramebuffer();return n.bindFramebuffer(n.FRAMEBUFFER,r),n.framebufferTexture2D(n.FRAMEBUFFER,t,n.TEXTURE_2D,e,0),n.bindFramebuffer(n.FRAMEBUFFER,null),r}var eo=`#define SHADER_NAME SINGLE_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var ro=`#define SHADER_NAME SINGLE_QUAD_VERT

precision highp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute float aTextureId;
attribute vec4 aTintColor;

uniform mat4 uProjectionMatrix;
uniform mat4 uCameraMatrix;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

void main (void)
{
    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vTintColor = aTintColor;

    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);
}`;var qt=class{constructor(t,r,o,i,s,a){this.trimmed=!1,this.texture=t,this.key=r,this.x=o,this.y=i,this.width=s,this.height=a,this.sourceSizeWidth=s,this.sourceSizeHeight=a,this.updateUVs()}setPivot(t,r){this.pivot={x:t,y:r}}setSize(t,r){this.width=t,this.height=r,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.updateUVs()}setSourceSize(t,r){this.sourceSizeWidth=t,this.sourceSizeHeight=r}setTrim(t,r,o,i,s,a){this.trimmed=!0,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.spriteSourceSizeX=o,this.spriteSourceSizeY=i,this.spriteSourceSizeWidth=s,this.spriteSourceSizeHeight=a}getExtent(t,r){let o=this.sourceSizeWidth,i=this.sourceSizeHeight,s,a,m,c;return this.trimmed?(s=this.spriteSourceSizeX-t*o,a=s+this.spriteSourceSizeWidth,m=this.spriteSourceSizeY-r*i,c=m+this.spriteSourceSizeHeight):(s=-t*o,a=s+o,m=-r*i,c=m+i),{left:s,right:a,top:m,bottom:c}}setExtent(t){let r=t.transform,o=r.origin.x,i=r.origin.y,s=this.sourceSizeWidth,a=this.sourceSizeHeight,m,c,f,u;this.trimmed?(m=this.spriteSourceSizeX-o*s,c=this.spriteSourceSizeY-i*a,f=this.spriteSourceSizeWidth,u=this.spriteSourceSizeHeight):(m=-o*s,c=-i*a,f=s,u=a),r.setExtent(m,c,f,u)}updateUVs(){let{x:t,y:r,width:o,height:i}=this,s=this.texture.width,a=this.texture.height;this.u0=t/s,this.v0=r/a,this.u1=(t+o)/s,this.v1=(r+i)/a}};var M=class{constructor(t,r,o,i){this.key="",t&&(r=t.width,o=t.height),this.image=t,this.width=r,this.height=o,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,r,o),Y.add(this,i)}addFrame(t,r,o,i,s){if(this.frames.has(t))return null;let a=new qt(this,t,r,o,i,s);return this.frames.set(t,a),(!this.firstFrame||this.firstFrame.key==="__BASE")&&(this.firstFrame=a),a}getFrame(t){if(!t)return this.firstFrame;t instanceof qt&&(t=t.key);let r=this.frames.get(t);return r||(console.warn(`Frame missing: ${t}`),r=this.firstFrame),r}setSize(t,r){this.width=t,this.height=r,this.frames.get("__BASE").setSize(t,r)}destroy(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null}};var jt=class{constructor(t){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,t&&this.fromConfig(t)}fromConfig(t){let{attributes:r=H,fragmentShader:o=eo,height:i=D(),renderToFramebuffer:s=!1,renderToDepthbuffer:a=!1,resolution:m=B(),vertexShader:c=ro,width:f=V(),uniforms:u=je}=t;if(this.create(o,c,u,r),s){this.renderToFramebuffer=!0;let R=new M(null,f*m,i*m),S=new Q(R);R.binding=S,S.framebuffer=$e(S.texture),a&&(this.renderToDepthbuffer=!0,S.depthbuffer=to(S.framebuffer,R.width,R.height)),this.texture=R,this.framebuffer=S.framebuffer}}create(t,r,o,i){let s=Qt(t,n.FRAGMENT_SHADER),a=Qt(r,n.VERTEX_SHADER);if(!s||!a)return;let m=Qe(s,a);if(!m)return;let c=n.getParameter(n.CURRENT_PROGRAM);n.useProgram(m),this.program=m,this.uniformSetters=qe(m),this.uniforms=new Map;for(let[f,u]of Object.entries(o))this.uniforms.set(f,u);this.attributes=Xe(m,i),n.useProgram(c)}updateUniforms(t){}bind(t){return this.updateUniforms(t),this.setUniforms(t)}setUniform(t,r){let o=this.uniforms;o.has(t)&&(o.set(t,r),this.uniformSetters.get(t)(r))}setUniforms(t){if(!this.program)return!1;n.useProgram(this.program);let r=this.uniforms;for(let[o,i]of this.uniformSetters.entries())i(r.get(o));return!0}setAttributes(t){if(this.program){let r=t.currentVertexBuffer.vertexByteSize;this.attributes.forEach(o=>{n.vertexAttribPointer(o.index,o.size,o.type,o.normalized,r,o.offset)})}}destroy(){lt(this.program),ct(this.texture),ft(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null}};var _=class extends jt{constructor(t={}){let r=t;r.attributes=r.attributes?r.attributes:H,super(r)}bind(t){let r=this.uniforms;return r.set("uProjectionMatrix",t.projectionMatrix.data),r.set("uCameraMatrix",t.cameraMatrix.data),super.bind(t)}};var oo=`#define SHADER_NAME MULTI_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture[%count%];

void main (void)
{
    vec4 color;

    %forloop%

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var $t=class extends _{constructor(t={}){t.fragmentShader||(t.fragmentShader=oo),super(t)}create(t,r,o,i){let s=ut(),a="";for(let m=1;m<s;m++)m>1&&(a+=`
	else `),m<s-1&&(a+=`if (vTextureId < ${m}.5)`),a+=`
	{`,a+=`
		color = texture2D(uTexture[${m}], vTextureCoord);`,a+=`
	}`;t=t.replace(/%count%/gi,`${s}`),t=t.replace(/%forloop%/gi,a),super.create(t,r,o,i)}bind(t){return this.uniforms.set("uTexture",t.textureIndex),super.bind(t)}};function Ze(e,t,r,o){let i={enable:t,sfactor:r,dfactor:o};e.blendModeStack[0]=i,e.currentBlendMode=i,e.defaultBlendMode=i}function Ke(e,t=null,r){let o={framebuffer:t,viewport:r};e.framebufferStack[0]=o,e.currentFramebuffer=o,e.defaultFramebuffer=o}function Je(e,t,r){let o={shader:t,textureID:r};e.shaderStack[0]=o,e.currentShader=o,e.defaultShader=o}function tr(e,t){e.vertexBufferStack[0]=t,e.currentVertexBuffer=t,e.defaultVertexBuffer=t}function er(e,t=0,r=0,o=0,i=0){let s=new C(t,r,o,i);e.viewportStack[0]=s,e.currentViewport=s,e.defaultViewport=s}var no,io=0,so=0,T={get:()=>no,set:e=>{no=e},getFrame:()=>io,setFrame:e=>{io=e},getElapsed:()=>so,setElapsed:e=>{so=e}};function pt(e=new d){return e.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}var v=class{constructor(t=1,r=0,o=0,i=1,s=0,a=0){this.set(t,r,o,i,s,a)}set(t=1,r=0,o=0,i=1,s=0,a=0){return this.a=t,this.b=r,this.c=o,this.d=i,this.tx=s,this.ty=a,this}identity(){return this.set()}toArray(){let{a:t,b:r,c:o,d:i,tx:s,ty:a}=this;return[t,r,o,i,s,a]}fromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5])}};var G=class{constructor(t,r=0,o=0){this._x=r,this._y=o,this.onChange=t}destroy(){this.onChange=L}set(t=0,r=0){return this._x=t,this._y=r,this.onChange&&this.onChange(this),this}get x(){return this._x}set x(t){let r=this._x;this._x=t,r!==t&&this.onChange(this)}get y(){return this._y}set y(t){let r=this._y;this._y=t,r!==t&&this.onChange(this)}toArray(t=[],r=0){let{x:o,y:i}=this;return t[r]=o,t[r+1]=i,t}fromArray(t,r=0){return this.set(t[r],t[r+1])}toString(){let{x:t,y:r}=this;return`{ x=${t}, y=${r} }`}};var dt={PI2:Math.PI*2,HALF_PI:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};var q=class{constructor(){this.type="StaticCamera",this.dirtyRender=!0;let t=T.get();this.renderer=t.renderer,this.matrix=pt(),this.bounds=new C,this.worldTransform=new v,this.reset()}reset(){let t=this.renderer;if(t){let r=t.width,o=t.height;this.width=r,this.height=o}this.bounds.set(0,0,this.width,this.height)}destroy(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null}};var Zt=class{constructor(t){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=t,this.projectionMatrix=new d,this.reset()}reset(){let t=this.renderer.gl,r=[0,1,2,2,3,0];this.quadShader=new _,this.quadBuffer=new Xt({isDynamic:!1,indexLayout:r}),this.quadCamera=new q,Pe(this),Ke(this),Ze(this,!0,t.ONE,t.ONE_MINUS_SRC_ALPHA),tr(this,new Xt({batchSize:$r(),indexLayout:r})),Je(this,new $t)}resize(t,r){Ye(0,t,r,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),er(this,0,0,t,r)}};function xt(e,t){t||(t=e.currentShader),t.shader.bind(e,t.textureID)&&t.shader.setAttributes(e)}function rr(e,t){e.current2DCamera=t,e.cameraMatrix=t.matrix,xt(e)}function gt(e,t){t||(t=e.currentBlendMode),t.enable?(n.enable(n.BLEND),n.blendFunc(t.sfactor,t.dfactor)):n.disable(n.BLEND)}function St(e,t){t||(t=e.currentVertexBuffer);let r=t.indexed?t.indexBuffer:null;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r),n.bindBuffer(n.ARRAY_BUFFER,t.vertexBuffer)}function Kt(e,t=0){let r=e.currentVertexBuffer;e.count+t>=r.batchSize&&E(e);let o=r.indexed?e.count*r.entryElementSize:e.count*r.vertexElementSize;return e.count+=t,{buffer:r,F32:r.vertexViewF32,U32:r.vertexViewU32,offset:o}}function or(e,t){let r=t.binding,o=e.currentActiveTexture;return r.indexCounter<e.startActiveTexture&&(r.indexCounter=e.startActiveTexture,o<e.maxTextures?(r.setIndex(o),n.activeTexture(n.TEXTURE0+o),n.bindTexture(n.TEXTURE_2D,r.texture),e.currentActiveTexture++):(E(e),e.startActiveTexture++,r.indexCounter=e.startActiveTexture,r.setIndex(1),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,r.texture),e.currentActiveTexture=2)),r.index}function nr(e){e.current2DCamera=e.quadCamera,e.cameraMatrix=e.quadCamera.matrix,e.count=0,e.flushTotal=0,O(e,!1,e.defaultFramebuffer),gt(e,e.defaultBlendMode),I(e,e.defaultViewport),St(e,e.defaultVertexBuffer)}var fo,ir={get:()=>fo,set:e=>{fo=e}};var sr=class{constructor(){this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=V(),this.height=D(),this.resolution=B(),this.setBackgroundColor(De());let t=document.createElement("canvas");t.addEventListener("webglcontextlost",r=>this.onContextLost(r),!1),t.addEventListener("webglcontextrestored",()=>this.onContextRestored(),!1),this.canvas=t,this.initContext(),ir.set(this),this.renderPass=new Zt(this),this.resize(this.width,this.height,this.resolution)}initContext(){let t=this.canvas.getContext("webgl",Qr());Yr.set(t),this.gl=t,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)}resize(t,r,o=1){let i=t*o,s=r*o;this.width=i,this.height=s,this.resolution=o;let a=this.canvas;a.width=i,a.height=s,this.autoResize&&(a.style.width=t.toString()+"px",a.style.height=r.toString()+"px"),this.renderPass.resize(i,s)}onContextLost(t){t.preventDefault(),this.contextLost=!0}onContextRestored(){this.contextLost=!1,this.initContext()}setBackgroundColor(t){return Xr(t,this.clearColor),this}reset(){}render(t){if(this.contextLost)return;let r=this.gl,o=this.renderPass;if(ze(),this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0)return;if(this.clearBeforeRender){let s=this.clearColor;r.clearColor(s[0],s[1],s[2],s[3]),r.clear(r.COLOR_BUFFER_BIT)}let i=t.worldData;nr(o);for(let s=0;s<i.length;s++){let{world:a}=i[s];a.renderGL(o),a.postRenderGL(o)}Ne(o)}destroy(){ir.set(void 0)}};function ar(){return()=>{Nt(sr)}}function N(e){let t=[e],r=[];for(;t.length>0;){let o=t.shift();r.push(o);let i=o.numChildren;if(i>0)for(let s=i-1;s>=0;s--)t.unshift(o.children[s])}return r.shift(),r}function F(e,t){return e.children.indexOf(t)}function Jt(e,t){let r=e.children,o;if(t>=0&&t<r.length){let i=r.splice(t,1);i[0]&&(o=i[0],o.parent=null)}return o}function Rt(e,t){let r=F(e,t);return r>-1&&Jt(e,r),t}var te="addedtoworld";var yt="destroy";var mr="postupdate";var ee="removedfromworld";var j="update";function g(e,t,...r){if(e.events.size===0||!e.events.has(t))return!1;let o=e.events.get(t);for(let i of o)i.callback.apply(i.context,r),i.once&&o.delete(i);return o.size===0&&e.events.delete(t),!0}function fr(e,...t){return t.forEach(r=>{r.world&&(g(r.world,ee,r,r.world),g(r,ee,r,r.world)),r.world=e,g(e,te,r,e),g(r,te,r,e)}),t}function z(e,...t){t.forEach(o=>{o.parent&&Rt(o.parent,o),o.parent=e});let r=e.world;return r&&fr(r,...N(e)),t}function cr(e,t){return e.children.push(t),z(e,t),t.transform.updateWorld(),t}function ur(e,...t){return t.forEach(r=>{cr(e,r)}),t}var x={CLEAR:0,TRANSFORM:1,UPDATE:2,CHILD_CACHE:4,POST_RENDER:8,COLORS:16,BOUNDS:32,TEXTURE:64,FRAME:128,ALPHA:256,CHILD:512,DEFAULT:1+2+16+32,USER1:536870912,USER2:1073741824,USER3:2147483648,USER4:4294967296};function Ct(e,t=0,r){let o=e.children;r===void 0&&(r=o.length);let i=r-t;if(i>0&&i<=r){let s=o.splice(t,i);return s.forEach(a=>{a.parent=null}),s}else return[]}function hr(e,t=0,r){Ct(e,t,r).forEach(i=>{i.destroy()})}function pr(e,...t){return t.forEach(r=>{Rt(e,r)}),t}function dr(e,t,r=0,o){let i=Ct(e,r,o);return z(t,...i),i.forEach(s=>{s.transform.updateWorld()}),i}var $=class{constructor(){this.events=new Map}};var Z=class{constructor(t,r,o=!1){this.callback=t,this.context=r,this.once=o}};function U(e,t,r,o,i){let s=e.events,a=s.get(t);if(!r)s.delete(t);else if(r instanceof Z)a.delete(r);else{let m=!o,c=i!==void 0;for(let f of a)f.callback===r&&m&&f.context===o&&c&&f.once===i&&a.delete(f)}return a.size===0&&s.delete(t),e}function A(e,t,r,o=e,i=!1){if(typeof r!="function")throw new TypeError("Listener not a function");let s=new Z(r,o,i),a=e.events.get(t);return a?a.add(s):e.events.set(t,new Set([s])),s}function Tt(e,t,r,o=e){return A(e,t,r,o,!0)}var xr=class{constructor(t,r){this.name=t,typeof r=="string"?(this.modifier=r.substr(0,1),this.end=parseFloat(r.substring(1))):this.end=r}getEnd(t){let r=this.modifier,o=this.end;return r==="+"?t+o:r==="-"?t-o:o}to(t){let r=t[this.name],o=this.getEnd(r);this.start=r,this.end=o}from(t){let r=t[this.name],o=this.getEnd(r);this.start=o,this.end=r,t[this.name]=o}update(t,r){t[this.name]=this.start+(this.end-this.start)*r}};var gr=class{constructor(t,r,o=!0){this.state={running:!1,repeat:!1,hold:!1,delay:!1,yoyo:!1,yoyoing:!1,autoStart:!0,reversed:!1},this.init={duration:0,repeat:0,repeatDelay:0,hold:0,delay:0},this.counters={repeat:0,delay:0,progress:0,elapsed:0},this.ease=st,this.properties=[],r||(r=T.get()),this.target=t,this.state.autoStart=o,this.emitter=r}to(t,r=null){return this.add(t,r,!1)}from(t,r=null){return this.add(t,r,!0)}add(t,r,o){let i=this.state,s=this.init;if(i.running)return this;let a=this.properties;for(let[m,c]of Object.entries(r))a.push(new xr(m,c));return s.duration=t,i.reversed=o,i.autoStart&&this.start(),this}start(){let t=this.state;if(t.running)return this;let r=this.target;return this.properties.forEach(i=>{t.reversed?i.from(r):i.to(r)}),t.running=!0,this.listener=A(this.emitter,j,i=>this.update(i)),this}restart(){let t=this.state,r=this.init,o=this.counters;if(!t)throw"Cannot restart destroyed tween";return o.delay=r.delay,o.elapsed=0,o.progress=0,o.repeat=r.repeat,t.yoyoing=!1,t.running=!0,this}update(t){let r=this.state,o=this.init,i=this.counters;if(!r.running)return!1;if(i.delay>0)if(i.delay-=t,i.delay<=0)i.elapsed=Math.abs(i.delay)-t,i.delay=0;else return!1;i.elapsed+=t;let s=Math.min(i.elapsed/o.duration,1);i.progress=s;let a=r.yoyoing?this.ease(1-s):this.ease(s),m=this.target;if(this.properties.forEach(u=>{u.update(m,a)}),s<1)return!1;let f=i.elapsed-o.duration;return r.yoyo&&!r.yoyoing?(i.elapsed=f,i.delay=o.hold-f,r.yoyoing=!0,!1):i.repeat>0?(i.repeat--,i.elapsed=f,i.delay=o.repeatDelay-f,r.yoyoing=!1,!1):(this.destroy(),!0)}delay(t){let r=t;return this.init.delay=r,this.counters.delay=r,this}hold(t){return this.init.hold=t,this}yoyo(t=!0){return this.state.yoyo=t,this}repeat(t=1,r=0){let o=this.init;return this.state.repeat=t>0,this.counters.repeat=t,o.repeat=t,o.repeatDelay=r,this}easing(t){return this.ease=t,this}destroy(){U(this.emitter,j,this.listener),this.properties.length=0,this.target=null,this.ease=null,this.emitter=null,this.state=null,this.init=null,this.counters=null}};function uo(e,t=null,r=!0){return new gr(e,t,r)}function Sr(e,t){return at(t).appendChild(e),e}function Rr(e){let t=document.readyState;if(t==="complete"||t==="interactive"){e();return}let r=()=>{document.removeEventListener("deviceready",r,!0),document.removeEventListener("DOMContentLoaded",r,!0),window.removeEventListener("load",r,!0),e()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",r,!0):(document.addEventListener("DOMContentLoaded",r,!0),window.addEventListener("load",r,!0)):window.setTimeout(r,20)}function yr(){let{title:e,version:t,url:r,color:o,background:i}=p.get(l.BANNER);if(e!==""){let s=t!==""?e+" "+t:e;console.log(`%c${s}%c ${r}`,`padding: 4px 16px; color: ${o}; background: ${i}`,"")}}function Cr(){return p.get(l.PARENT)}function Tr(){return p.get(l.RENDERER)}function ho(){return{gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]}}function Mr(){return p.get(l.SCENES)}function lo(e,t=0){e.gameFrame=t,e.numTotalFrames=0,e.numDirtyFrames=0,e.numDirtyCameras=0,e.worldData.length=0}var po,re={get:()=>po,set:e=>{po=e}};var wr=class{constructor(){this.scenes=new Map,this.sceneIndex=0,this.flush=!1,this.renderResult=ho(),this.game=T.get(),re.set(this),Tt(this.game,"boot",()=>this.boot())}boot(){Mr().forEach(t=>new t)}update(t,r){for(let o of this.scenes.values())g(o,"update",t,r)}render(t){let r=this.renderResult;lo(r,t);for(let o of this.scenes.values())g(o,"render",r);return this.flush&&(r.numDirtyFrames++,this.flush=!1),r}};function xo(){Lt(0),Ae(4096),_t("Phaser","4.0.0","https://phaser4.io"),X(0),zt(.5,.5),vt(800,600,1)}function Mt(e,t){let r=document.createElement("canvas");return r.width=e,r.height=t,r.getContext("2d")}var go,P={get:()=>go,set:e=>{go=e}};var Er=class{constructor(){this.textures=new Map,this.createDefaultTextures(),P.set(this)}createDefaultTextures(){this.add("__BLANK",new M(Mt(32,32).canvas));let t=Mt(32,32);t.strokeStyle="#0f0",t.moveTo(0,0),t.lineTo(32,32),t.stroke(),t.strokeRect(.5,.5,31,31),this.add("__MISSING",new M(t.canvas));let r=Mt(32,32);r.fillStyle="#fff",r.fillRect(0,0,32,32),this.add("__WHITE",new M(r.canvas))}get(t){let r=this.textures;return r.has(t)?r.get(t):r.get("__MISSING")}has(t){return this.textures.has(t)}add(t,r,o){let i,s=this.textures;return s.has(t)||(r instanceof M?i=r:i=new M(r,0,0,o),i.key=t,s.set(t,i)),i}};var br=class extends ${constructor(...t){super();this.VERSION="4.0.0-beta1",this.isBooted=!1,this.isPaused=!1,this.willUpdate=!0,this.willRender=!0,this.lastTick=0,this.elapsed=0,this.frame=0,T.set(this),xo(),Rr(()=>this.boot(t))}boot(t){t.forEach(i=>i());let r=Tr();this.renderer=new r,this.textureManager=new Er,this.sceneManager=new wr;let o=Cr();o&&Sr(this.renderer.canvas,o),this.isBooted=!0,yr(),g(this,"boot"),this.lastTick=performance.now(),this.step(this.lastTick)}pause(){this.isPaused=!0}resume(){this.isPaused=!1,this.lastTick=performance.now()}step(t){let r=t-this.lastTick;this.lastTick=t,this.elapsed+=r,this.isPaused||(this.willUpdate&&(this.sceneManager.update(r,t),g(this,"update",r,t)),this.willRender&&this.renderer.render(this.sceneManager.render(this.frame))),this.frame++,T.setFrame(this.frame),T.setElapsed(this.elapsed),requestAnimationFrame(o=>this.step(o))}destroy(){}};var Fr=class{constructor(t,r,o){this.responseType="text",this.crossOrigin=void 0,this.skipCache=!1,this.hasLoaded=!1,this.key=t,this.url=r,this.config=o}};function So(e,t,r,o){return t||(t=e+r),/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(t)?t:o?o.baseURL+o.path+t:t}function Ro(e){return e.data=new Image,e.crossOrigin&&(e.data.crossOrigin=e.crossOrigin),new Promise((t,r)=>{e.data.onload=()=>{e.data.onload&&(e.data.onload=null,e.data.onerror=null,t(e))},e.data.onerror=o=>{e.data.onload&&(e.data.onload=null,e.data.onerror=null,e.error=o,r(e))},e.data.src=e.url,e.data.complete&&e.data.width&&e.data.height&&(e.data.onload=null,e.data.onerror=null,t(e))})}function yo(e,t,r){let o=new Fr(e,t);return o.load=()=>(o.url=So(o.key,o.url,".png",o.loader),o.loader&&(o.crossOrigin=o.loader.crossOrigin),new Promise((i,s)=>{let a=P.get();a.has(o.key)?i(o):Ro(o).then(m=>{a.add(m.key,m.data,r),i(m)}).catch(m=>{s(m)})})),o}var Ar=class extends ${constructor(){super();this.baseURL="",this.path="",this.crossOrigin="anonymous",this.maxParallelDownloads=-1,this.isLoading=!1,this.reset()}reset(){this.isLoading=!1,this.queue=new Set,this.inflight=new Set,this.completed=new Set,this.progress=0}add(...t){return t.forEach(r=>{r.loader=this,this.queue.add(r)}),this}start(){return this.isLoading?null:new Promise((t,r)=>{this.completed.clear(),this.progress=0,this.queue.size>0?(this.isLoading=!0,this.onComplete=t,this.onError=r,g(this,"start"),this.nextFile()):(this.progress=1,g(this,"complete"),t(this))})}nextFile(){let t=this.queue.size;if(this.maxParallelDownloads!==-1&&(t=Math.min(t,this.maxParallelDownloads)-this.inflight.size),t){let r=this.queue.values();for(;t>0;){let o=r.next().value;this.inflight.add(o),this.queue.delete(o),o.load().then(i=>this.fileComplete(i)).catch(i=>this.fileError(i)),t--}}else this.inflight.size===0&&this.stop()}stop(){!this.isLoading||(this.isLoading=!1,g(this,"complete",this.completed),this.onComplete(),this.completed.clear())}updateProgress(t){this.inflight.delete(t),this.completed.add(t);let r=this.completed.size,o=this.queue.size+this.inflight.size;r>0&&(this.progress=r/(r+o)),g(this,"progress",this.progress,r,o),this.nextFile()}fileComplete(t){g(this,"filecomplete",t),this.updateProgress(t)}fileError(t){g(this,"fileerror",t),this.updateProgress(t)}totalFilesToLoad(){return this.queue.size+this.inflight.size}setBaseURL(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.baseURL=t,this}setPath(t=""){return t!==""&&t.substr(-1)!=="/"&&(t=t.concat("/")),this.path=t,this}setCORS(t){return this.crossOrigin=t,this}setMaxParallelDownloads(t){return this.maxParallelDownloads=t,this}};function Co(e,t,r){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:r}function To(e,t={}){let r=re.get(),o=r.scenes.size,i=r.sceneIndex,s=o===0;typeof t=="string"?e.key=t:(t||!t&&s)&&(e.key=Co(t,"key","scene"+i.toString())),r.scenes.has(e.key)?console.warn("Scene key already in use: "+e.key):(r.scenes.set(e.key,e),r.flush=!0,r.sceneIndex++)}var Gr=class{constructor(t){this.game=T.get(),this.events=new Map,To(this,t)}};function wt(e){let{a:t,b:r,c:o,d:i,tx:s,ty:a}=e.world,{x:m,y:c,right:f,bottom:u}=e.extent,R=m*t+c*o+s,S=m*r+c*i+a,w=m*t+u*o+s,b=m*r+u*i+a,J=f*t+u*o+s,tt=f*r+u*i+a,y=f*t+c*o+s,Uo=f*r+c*i+a;return{x0:R,y0:S,x1:w,y1:b,x2:J,y2:tt,x3:y,y3:Uo}}var oe=class{constructor(t){this.fixed=!1,this.includeChildren=!0,this.visibleOnly=!0,this.entity=t,this.area=new C}set(t,r,o,i){this.area.set(t,r,o,i)}get(){return this.entity.isDirty(x.BOUNDS)&&!this.fixed&&this.update(),this.area}updateLocal(){let{x0:t,y0:r,x1:o,y1:i,x2:s,y2:a,x3:m,y3:c}=wt(this.entity.transform),f=Math.min(t,o,s,m),u=Math.min(r,i,a,c),R=Math.max(t,o,s,m),S=Math.max(r,i,a,c);return this.area.set(f,u,R-f,S-u)}update(){let t=this.updateLocal();if(this.entity.clearDirty(x.BOUNDS),!this.includeChildren||!this.entity.numChildren)return t;let r=this.visibleOnly,o=this.entity.children,i=t.x,s=t.y,a=t.right,m=t.bottom;for(let c=0;c<o.length;c++){let f=o[c];if(!f||r&&!f.visible)continue;let u=f.bounds.get();u.x<i&&(i=u.x),u.y<s&&(s=u.y),u.right>a&&(a=u.right),u.bottom>m&&(m=u.bottom)}return t.set(i,s,a-i,m-s)}destroy(){this.entity=null,this.area=null}};var ne=class{constructor(t){this.enabled=!1,this.enabledChildren=!0,this.entity=t}destroy(){this.entity=null,this.hitArea=null}};function Dr(){return p.get(l.DEFAULT_ORIGIN).x}function Br(){return p.get(l.DEFAULT_ORIGIN).y}var h=class{constructor(t=0,r=0){this.set(t,r)}set(t=0,r=0){return this.x=t,this.y=r,this}toArray(t=[],r=0){let{x:o,y:i}=this;return t[r]=o,t[r+1]=i,t}fromArray(t,r=0){return this.set(t[r],t[r+1])}toString(){let{x:t,y:r}=this;return`{ x=${t}, y=${r} }`}};function Ir(e){let t=e.local,r=e.position.x,o=e.position.y,i=e.rotation,s=e.scale.x,a=e.scale.y,m=e.skew.x,c=e.skew.y;t.set(Math.cos(i+c)*s,Math.sin(i+c)*s,-Math.sin(i-m)*a,Math.cos(i-m)*a,r,o)}function Or(e,t){let{a:r,b:o,c:i,d:s,tx:a,ty:m}=e;return t.set(r,o,i,s,a,m)}function Lr(e){let t=e.parent,r=e.transform,o=r.local,i=r.world;if(!t)Or(o,i);else if(r.passthru)Or(t.transform.world,i);else{let{a:s,b:a,c:m,d:c,tx:f,ty:u}=o,{a:R,b:S,c:w,d:b,tx:J,ty:tt}=t.transform.world;i.set(s*R+a*w,s*S+a*b,m*R+c*w,m*S+c*b,f*R+u*w+J,f*S+u*b+tt)}}var ie=class{constructor(t,r=0,o=0){this.passthru=!1,this._rotation=0,this.entity=t,this.local=new v,this.world=new v;let i=()=>this.update(),s=()=>this.updateExtent();this.position=new G(i,r,o),this.scale=new G(i,1,1),this.skew=new G(i),this.origin=new G(s,Dr(),Br()),this.extent=new C}update(){this.updateLocal(),this.updateWorld()}updateLocal(){this.entity.setDirty(x.TRANSFORM,x.BOUNDS),Ir(this)}updateWorld(){let t=this.entity;t.setDirty(x.TRANSFORM,x.BOUNDS),Lr(t),t.numChildren&&this.updateChildren()}updateChildren(){let t=this.entity.children;for(let r=0;r<t.length;r++)t[r].transform.updateWorld()}globalToLocal(t,r,o=new h){let{a:i,b:s,c:a,d:m,tx:c,ty:f}=this.world,u=1/(i*m+a*-s);return o.x=m*u*t+-a*u*r+(f*a-c*m)*u,o.y=i*u*r+-s*u*t+(-f*i+c*s)*u,o}localToGlobal(t,r,o=new h){let{a:i,b:s,c:a,d:m,tx:c,ty:f}=this.world;return o.x=i*t+a*r+c,o.y=s*t+m*r+f,o}setExtent(t,r,o,i){this.extent.set(t,r,o,i),this.entity.setDirty(x.TRANSFORM,x.BOUNDS)}updateExtent(t,r){let o=this.extent,i=this.entity;t!==void 0&&(o.width=t),r!==void 0&&(o.height=r),o.x=-this.origin.x*o.width,o.y=-this.origin.y*o.height,i.setDirty(x.TRANSFORM,x.BOUNDS)}set rotation(t){t!==this._rotation&&(this._rotation=t,this.update())}get rotation(){return this._rotation}destroy(){this.position.destroy(),this.scale.destroy(),this.skew.destroy(),this.origin.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.skew=null,this.origin=null,this.extent=null}};function _r(e,t){return(((t*255|0)&255)<<24|e)>>>0}var k=class{constructor(t=0,r=0,o=0){this.x=0,this.y=0,this.z=0,this.u=0,this.v=0,this.texture=0,this.tint=16777215,this.alpha=1,this.color=4294967295,this.x=t,this.y=r,this.z=o}setPosition(t,r,o=0){return this.x=t,this.y=r,this.z=o,this}setUV(t,r){return this.u=t,this.v=r,this}setColor(t,r=1){return this.tint=t,this.alpha=r,this.packColor(),this}setAlpha(t){return this.alpha=t,this}setTint(t){return this.tint=t,this}packColor(){this.color=_r(this.tint,this.alpha)}};function Fo(e,t){let{F32:r,U32:o,offset:i}=Kt(t,1),s=or(t,e.texture),a=i;e.vertices.forEach(m=>{r[a+0]=m.x,r[a+1]=m.y,r[a+2]=m.u,r[a+3]=m.v,r[a+4]=s,o[a+5]=m.color,a+=6})}var W=class{constructor(t=0,r=0){this.type="GameObject",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new ie(this,t,r),this.bounds=new oe(this),this.input=new ne(this),this.dirty=x.DEFAULT,this.transform.update()}isRenderable(){return this.visible&&this.willRender}isDirty(t){return(this.dirty&t)!=0}clearDirty(t){return this.isDirty(t)&&(this.dirty^=t),this}setDirty(t,r){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=T.getFrame()),this.isDirty(r)||(this.dirty^=r),this}update(t,r){if(this.willUpdateChildren){let o=this.children;for(let i=0;i<o.length;i++){let s=o[i];s&&s.willUpdate&&s.update(t,r)}}this.postUpdate(t,r)}postUpdate(t,r){}renderGL(t){}renderCanvas(t){}postRenderGL(t){}postRenderCanvas(t){}get numChildren(){return this.children.length}destroy(t){t?dr(this,t):hr(this),g(this,yt,this),this.transform.destroy(),this.bounds.destroy(),this.input.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null}};var se=class extends W{constructor(t=0,r=0){super(t,r);this._alpha=1,this.type="Container"}setSize(t,r=t){return this.transform.updateExtent(t,r),this}setPosition(t,r){return this.transform.position.set(t,r),this}setOrigin(t,r=t){return this.transform.origin.set(t,r),this}setSkew(t,r=t){return this.transform.skew.set(t,r),this}setScale(t,r=t){return this.transform.scale.set(t,r),this}setRotation(t){return this.transform.rotation=t,this}set width(t){this.transform.updateExtent(t)}get width(){return this.transform.extent.width}set height(t){this.transform.updateExtent(void 0,t)}get height(){return this.transform.extent.height}set x(t){this.transform.position.x=t}get x(){return this.transform.position.x}set y(t){this.transform.position.y=t}get y(){return this.transform.position.y}set originX(t){this.transform.origin.x=t}get originX(){return this.transform.origin.x}set originY(t){this.transform.origin.y=t}get originY(){return this.transform.origin.y}set skewX(t){this.transform.skew.x=t}get skewX(){return this.transform.skew.x}set skewY(t){this.transform.skew.y=t}get skewY(){return this.transform.skew.y}set scaleX(t){this.transform.scale.x=t}get scaleX(){return this.transform.scale.x}set scaleY(t){this.transform.scale.y=t}get scaleY(){return this.transform.scale.y}set rotation(t){this.transform.rotation=t}get rotation(){return this.transform.rotation}get alpha(){return this._alpha}set alpha(t){t!==this._alpha&&(this._alpha=t,this.setDirty(x.TRANSFORM))}};function Ao(e,t){let r=e.frame;if(!r)return;let o=t.ctx,i=e.transform,{a:s,b:a,c:m,d:c,tx:f,ty:u}=i.world,{x:R,y:S}=i.extent;o.save(),o.setTransform(s,a,m,c,f,u),o.globalAlpha=e.alpha,o.drawImage(r.texture.image,r.x,r.y,r.width,r.height,R,S,r.width,r.height),o.restore()}function Go(e){return e.vertices.forEach(t=>{t.packColor()}),e}function ae(e,t,...r){let o=e.getFrame(t),{u0:i,u1:s,v0:a,v1:m,pivot:c}=o;return r.forEach(f=>{if(!f||o===f.frame)return;f.frame=o,c&&f.setOrigin(c.x,c.y),f.frame.setExtent(f),f.hasTexture=!0;let u=f.vertices;u[0].setUV(i,a),u[1].setUV(i,m),u[2].setUV(s,m),u[3].setUV(s,a)}),r}function Do(e,t,...r){if(!e)r.forEach(o=>{o.texture=null,o.frame=null,o.hasTexture=!1});else{let o;e instanceof M?o=e:o=P.get().get(e),o?(r.forEach(i=>{i.texture=o}),ae(o,t,...r)):console.warn(`Invalid Texture key: ${e}`)}return r}function Bo(e){let t=e.vertices,{x0:r,y0:o,x1:i,y1:s,x2:a,y2:m,x3:c,y3:f}=wt(e.transform);return t[0].setPosition(r,o),t[1].setPosition(i,s),t[2].setPosition(a,m),t[3].setPosition(c,f),e}var K=class extends se{constructor(t,r,o,i){super(t,r);this.hasTexture=!1,this._tint=16777215,this.type="Sprite",this.vertices=[new k,new k,new k,new k],this.setTexture(o,i)}setTexture(t,r){return Do(t,r,this),this}setFrame(t){return ae(this.texture,t,this),this}isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0}preRender(){this.isDirty(x.COLORS)&&(Go(this),this.clearDirty(x.COLORS)),this.isDirty(x.TRANSFORM)&&(Bo(this),this.clearDirty(x.TRANSFORM))}renderGL(t){this.preRender(),Fo(this,t)}renderCanvas(t){this.preRender(),Ao(this,t)}get alpha(){return this._alpha}set alpha(t){t!==this._alpha&&(this._alpha=t,this.vertices.forEach(r=>{r.setAlpha(t)}),this.setDirty(x.COLORS))}get tint(){return this._tint}set tint(t){t!==this._tint&&(this._tint=t,this.vertices.forEach(r=>{r.setTint(t)}),this.setDirty(x.COLORS))}destroy(t){super.destroy(t),this.texture=null,this.frame=null,this.hasTexture=!1,this.vertices=[]}};var vr="worldrender";var Nr="worldshutdown";function zr(e,t){t.numRendered++,t.numRenderable++,e.node.dirtyFrame>=t.gameFrame&&t.dirtyFrame++,e.children.forEach(r=>{r.children.length>0&&zr(r,t)})}function Io(e){if(e.node.isDirty(x.CHILD_CACHE))return!0;let t=[e];for(;t.length>0;){let r=t.pop();if(r.node.isDirty(x.TRANSFORM))return!0;let o=r.children.length;if(o>0)for(let i=0;i<o;i++)t.push(r.children[i])}return t.length=0,!1}function Oo(e,t){e.forEach(r=>{t||Io(r)?r.node.setDirty(x.CHILD_CACHE):r.children.length=0})}function Ur(e,t,r=[]){for(let o=0;o<t.numChildren;o++){let i=t.children[o];if(i.isRenderable()){let s=[],a={node:i,children:s};r.push(a),i.willRenderChildren&&i.numChildren>0&&(i.willCacheChildren&&e.push(a),Ur(e,i,s))}}return r}function Lo(e){let t=[],o=Ur(t,e,[]),i=e.renderData;t.length>0&&Oo(t,e.camera.dirtyRender),o.forEach(s=>{s.children.length>0?zr(s,i):(i.numRendered++,i.numRenderable++,s.node.dirtyFrame>=i.gameFrame&&i.dirtyFrame++)}),e.renderList=o,e.forceRefresh&&(i.dirtyFrame++,e.forceRefresh=!1)}function _o(e,t){return e.a===t.a&&e.b===t.b&&e.c===t.c&&e.d===t.d&&e.tx===t.tx&&e.ty===t.ty}function vo(e,t){e.numDirtyFrames+=t.dirtyFrame,e.numTotalFrames+=t.numRendered,t.camera.dirtyRender&&e.numDirtyCameras++,e.worldData.push(t)}function me(e,t){e.gameFrame=t,e.dirtyFrame=0,e.numRendered=0,e.numRenderable=0}var Pr=class extends W{constructor(t){super();this.forceRefresh=!1,this.is3D=!1,this.type="BaseWorld",this.scene=t,this.world=this,this.events=new Map,this.renderList=[],this._updateListener=A(t,"update",(r,o)=>this.update(r,o)),this._renderListener=A(t,"render",r=>this.render(r)),this._shutdownListener=A(t,"shutdown",()=>this.shutdown()),Tt(t,"destroy",()=>this.destroy())}update(t,r){!this.willUpdate||(g(this,j,t,r,this),super.update(t,r))}postUpdate(t,r){g(this,mr,t,r,this)}render(t){let r=this.renderData;me(r,t.gameFrame),!(!this.willRender||!this.visible)&&(Lo(this),g(this,vr,r,this),vo(t,r),this.camera.dirtyRender=!1)}renderGL(t){let r=t.current2DCamera,o=this.camera;(!r||!_o(o.worldTransform,r.worldTransform))&&E(t),rr(t,o),this.renderList.forEach(i=>{i.children.length>0?this.renderNode(i,t):i.node.renderGL(t)})}renderNode(t,r){t.node.renderGL(r),t.children.forEach(o=>{o.children.length>0?this.renderNode(o,r):o.node.renderGL(r)}),t.node.postRenderGL(r)}postRenderGL(t){}shutdown(){let t=this.scene;U(t,"update",this._updateListener),U(t,"render",this._renderListener),U(t,"shutdown",this._shutdownListener),pr(this),g(this,Nr,this),me(this.renderData,0),this.camera&&this.camera.reset()}destroy(t){super.destroy(t),g(this,yt,this),me(this.renderData,0),this.camera&&this.camera.destroy(),this.events.clear(),this.camera=null,this.renderData=null,this.events=null}};function No(e,t){return{world:e,camera:t,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var kr=class extends Pr{constructor(t){super(t);this.type="StaticWorld",this.camera=new q,this.renderData=No(this,this.camera)}};var zo=class extends Gr{constructor(){super();let t=new kr(this),r=new Ar;window.location.href.includes("192.168.0.100/phaser-genesis/")?r.setPath("/phaser4-examples/public/assets/"):r.setPath("/examples/public/assets/"),r.add(yo("logo","logo.png")),r.start().then(()=>{let o=new K(400,100,"logo").setRotation(.3);uo(o).to(3e3,{y:400,rotation:0}).easing(Dt.Out),ur(t,o)})}};new br(ar(),Ut("gameParent"),Fe(2960685),Pt(zo));})();
/**
 * @author       Niklas von Hertzen (https://github.com/niklasvh/base64-arraybuffer)
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
//# sourceMappingURL=index.min.js.map
