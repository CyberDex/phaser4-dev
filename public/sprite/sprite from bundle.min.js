(()=>{var IM=Object.create,io=Object.defineProperty,NM=Object.getPrototypeOf,UM=Object.prototype.hasOwnProperty,kM=Object.getOwnPropertyNames,WM=Object.getOwnPropertyDescriptor;var jM=y=>io(y,"__esModule",{value:!0});var HM=(y,l)=>()=>(l||y((l={exports:{}}).exports,l),l.exports);var QM=(y,l,x)=>{if(l&&typeof l=="object"||typeof l=="function")for(let T of kM(l))!UM.call(y,T)&&T!=="default"&&io(y,T,{get:()=>l[T],enumerable:!(x=WM(l,T))||x.enumerable});return y},KM=y=>QM(jM(io(y!=null?IM(NM(y)):{},"default",y&&y.__esModule&&"default"in y?{get:()=>y.default,enumerable:!0}:{value:y,enumerable:!0})),y);var Mu=HM((an,xu)=>{(function(y,l){typeof an=="object"&&typeof xu!="undefined"?l(an):typeof define=="function"&&define.amd?define(["exports"],l):(y=typeof globalThis!="undefined"?globalThis:y||self,l(y.Phaser={}))})(an,function(y){"use strict";var l,x=0,T=0,A={get:function(){return l},set:function(e){l=e},getFrame:function(){return x},setFrame:function(e){x=e},getElapsed:function(){return T},setElapsed:function(e){T=e}};var F=function(e,t){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},F(e,t)};function z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");F(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function U(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o}function Y(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e}function lt(e){var t=L(e.data,16),r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],f=t[6],u=t[7],h=t[8],c=t[9],m=t[10],d=t[11],v=t[12],g=t[13],p=t[14],b=t[15],C=m*b-p*d,S=c*b-g*d,R=c*p-g*m,E=h*b-v*d,_=h*p-m*v,G=h*g-v*c,V=+(s*C-f*S+u*R),P=-(a*C-f*E+u*_),O=+(a*S-s*E+u*G),k=-(a*R-s*_+f*G);return r*V+n*P+i*O+o*k}function pt(e){var t=L(e.data,16),r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],f=t[6],u=t[7],h=t[8],c=t[9],m=t[10],d=t[11],v=t[12],g=t[13],p=t[14],b=t[15];return Math.hypot(r,n,i,o,a,s,f,u,h,c,m,d,v,g,p,b)}function vt(e){return e>0?Math.ceil(e):Math.floor(e)}for(var Ft="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ve=new Uint8Array(256),ue=0;ue<Ft.length;ue++)Ve[Ft.charCodeAt(ue)]=ue;function Vt(){}var I=function(){function e(t){var r=new Float32Array(16);this.data=r,this.onChange=Vt,t?Array.isArray(t)?this.fromArray(t):this.fromArray(t.data):(r[0]=1,r[5]=1,r[10]=1,r[15]=1)}return e.prototype.set=function(t,r,n,i,o,a,s,f,u,h,c,m,d,v,g,p){var b=this.data;return b[0]=t,b[1]=r,b[2]=n,b[3]=i,b[4]=o,b[5]=a,b[6]=s,b[7]=f,b[8]=u,b[9]=h,b[10]=c,b[11]=m,b[12]=d,b[13]=v,b[14]=g,b[15]=p,this.onChange(this),this},e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);for(var n=this.data,i=0;i<16;i++)t[r+i]=n[i];return t},e.prototype.fromArray=function(t,r){r===void 0&&(r=0);for(var n=this.data,i=0;i<16;i++)n[i]=t[r+i];return this.onChange(this),this},e.prototype.toString=function(){return"[ mat4="+this.data.join(", ")+" ]"},e.prototype.destroy=function(){this.onChange=Vt,this.data=null},e}();function Ku(e,t,r){r===void 0&&(r=new I);var n=L(e.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=L(t.data,16),E=R[0],_=R[1],G=R[2],V=R[3],P=R[4],O=R[5],k=R[6],W=R[7],K=R[8],N=R[9],q=R[10],J=R[11],X=R[12],rt=R[13],ot=R[14],ht=R[15];return r.set(i+E,o+_,a+G,s+V,f+P,u+O,h+k,c+W,m+K,d+N,v+q,g+J,p+X,b+rt,C+ot,S+ht)}function Xu(e,t,r,n){var i=e.data;return i[12]+=t,i[13]+=r,i[14]+=n,e.onChange(e),e}function $u(e,t){t===void 0&&(t=new I);var r=L(e.data,16),n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],f=r[5],u=r[6],h=r[7],c=r[8],m=r[9],d=r[10],v=r[11],g=r[12],p=r[13],b=r[14],C=r[15],S=n*f-i*s,R=n*u-o*s,E=n*h-a*s,_=i*u-o*f,G=i*h-a*f,V=o*h-a*u,P=c*p-m*g,O=c*b-d*g,k=c*C-v*g,W=m*b-d*p,K=m*C-v*p,N=d*C-v*b;return t.set(f*N-u*K+h*W,o*K-i*N-a*W,p*V-b*G+C*_,d*G-m*V-v*_,u*k-s*N-h*O,n*N-o*k+a*O,b*E-g*V-C*R,c*V-d*E+v*R,s*K-f*k+h*P,i*k-n*K-a*P,g*G-p*E+C*S,m*E-c*G-v*S,f*O-s*W-u*P,n*W-i*O+o*P,p*R-g*_-b*S,c*_-m*R+d*S)}function Yu(e){return new I(e)}function qu(e,t){return t.fromArray(e.data)}function Zu(e,t){var r=e.data,n=t.data;return n[12]=r[12],n[13]=r[13],n[14]=r[14],t.onChange(t),t}function Ju(e,t){var r=L(e.data,16),n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],f=r[5],u=r[6],h=r[7],c=r[8],m=r[9],d=r[10],v=r[11],g=r[12],p=r[13],b=r[14],C=r[15],S=L(t.data,16),R=S[0],E=S[1],_=S[2],G=S[3],V=S[4],P=S[5],O=S[6],k=S[7],W=S[8],K=S[9],N=S[10],q=S[11],J=S[12],X=S[13],rt=S[14],ot=S[15];return n===R&&i===E&&o===_&&a===G&&s===V&&f===P&&u===O&&h===k&&c===W&&m===K&&d===N&&v===q&&g===J&&p===X&&b===rt&&C===ot}function th(e,t){t===void 0&&(t=new I);var r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,f=i+i,u=r*a,h=n*a,c=n*s,m=i*a,d=i*s,v=i*f,g=o*a,p=o*s,b=o*f;return t.set(1-c-v,h+b,m-p,0,h-b,1-u-v,d+g,0,m+p,d-g,1-u-c,0,0,0,0,1)}function eh(e,t,r){r===void 0&&(r=new I);var n=t.x,i=t.y,o=t.z,a=Math.hypot(n,i,o);if(a<1e-5)return null;a=1/a,n*=a,i*=a,o*=a;var s=Math.sin(e),f=Math.cos(e),u=1-f;return r.set(n*n*u+f,i*n*u+o*s,o*n*u-i*s,0,n*i*u-o*s,i*i*u+f,o*i*u+n*s,0,n*o*u+i*s,i*o*u-n*s,o*o*u+f,0,0,0,0,1)}function rh(e,t,r){r===void 0&&(r=new I);var n=e.x,i=e.y,o=e.z,a=e.w,s=n+n,f=i+i,u=o+o,h=n*s,c=n*f,m=n*u,d=i*f,v=i*u,g=o*u,p=a*s,b=a*f,C=a*u,S=t.x,R=t.y,E=t.z;return r.set(1-(d+g),c+C,m-b,0,c-C,1-(h+g),v+p,0,m+b,v-p,1-(h+d),0,S,R,E,1)}function Qo(e,t,r,n){n===void 0&&(n=new I);var i=e.x,o=e.y,a=e.z,s=e.w,f=i+i,u=o+o,h=a+a,c=i*f,m=i*u,d=i*h,v=o*u,g=o*h,p=a*h,b=s*f,C=s*u,S=s*h,R=r.x,E=r.y,_=r.z,G=t.x,V=t.y,P=t.z;return n.set((1-(v+p))*R,(m+S)*R,(d-C)*R,0,(m-S)*E,(1-(c+p))*E,(g+b)*E,0,(d+C)*_,(g-b)*_,(1-(c+v))*_,0,G,V,P,1)}function nh(e,t,r,n,i){i===void 0&&(i=new I);var o=e.x,a=e.y,s=e.z,f=e.w,u=o+o,h=a+a,c=s+s,m=o*u,d=o*h,v=o*c,g=a*h,p=a*c,b=s*c,C=f*u,S=f*h,R=f*c,E=r.x,_=r.y,G=r.z,V=n.x,P=n.y,O=n.z,k=t.x,W=t.y,K=t.z,N=(1-(g+b))*E,q=(d+R)*E,J=(v-S)*E,X=(d-R)*_,rt=(1-(m+b))*_,ot=(p+C)*_,ht=(v+S)*G,zt=(p-C)*G,Lt=(1-(m+g))*G;return i.set(N,q,J,0,X,rt,ot,0,ht,zt,Lt,0,k+V-(N*V+X*P+ht*O),W+P-(q*V+rt*P+zt*O),K+O-(J*V+ot*P+Lt*O),1)}function Ko(e,t,r,n){r===void 0&&(r=!0),n===void 0&&(n=new I);var i=t.x,o=t.y,a=t.z,s=Math.sin(e.x),f=Math.cos(e.x),u=Math.sin(e.y),h=Math.cos(e.y),c=i,m=o,d=a,v=-s,g=0-v*u,p=0-f*u,b=v*h,C=f*h;return r||(c=h*i+u*a,m=g*i+f*o+b*a,d=p*i+s*o+C*a),n.set(h,g,p,0,0,f,s,0,u,b,C,0,c,m,d,1)}function ih(e,t){t===void 0&&(t=new I);var r=e.x,n=e.y,i=e.z;return t.set(r,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1)}function oh(e,t){t===void 0&&(t=new I);var r=e.x,n=e.y,i=e.z;return t.set(1,0,0,0,0,1,0,0,0,0,1,0,r,n,i,1)}function ah(e,t){t===void 0&&(t=new I);var r=Math.cos(e),n=Math.sin(e);return t.set(1,0,0,0,0,r,n,0,0,-n,r,0,0,0,0,1)}function sh(e,t){t===void 0&&(t=new I);var r=Math.cos(e),n=Math.sin(e);return t.set(r,0,-n,0,0,1,0,0,n,0,r,0,0,0,0,1)}function fh(e,t){t===void 0&&(t=new I);var r=Math.cos(e),n=Math.sin(e);return t.set(r,n,0,0,-n,r,0,0,0,0,1,0,0,0,0,1)}function uh(e,t,r,n,i,o,a){a===void 0&&(a=new I);var s=1/(t-e),f=1/(n-r),u=1/(i-o);return a.set(i*2*s,0,0,0,0,i*2*f,0,0,(t+e)*s,(n+r)*f,(o+i)*u,-1,0,0,o*i*2*u,0)}var B=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.set(t,r,n)}return e.prototype.set=function(t,r,n){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=t,this.y=r,this.z=n,this},e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y,a=n.z;return t[r]=i,t[r+1]=o,t[r+2]=a,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1],t[r+2])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y,i=t.z;return"{ x="+r+", y="+n+", z="+i+" }"},e}();function Xo(e,t){t===void 0&&(t=new B);var r=L(e.data,11),n=r[0],i=r[1],o=r[2];r[3];var a=r[4],s=r[5],f=r[6];r[7];var u=r[8],h=r[9],c=r[10];return t.set(Math.hypot(n,i,o),Math.hypot(a,s,f),Math.hypot(u,h,c))}var tt=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),this._x=t,this._y=r,this._z=n,this._w=i,this.onChange=Vt}return e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),this._x=t,this._y=r,this._z=n,this._w=i,this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var r=this._x;this._x=t,t!==r&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var r=this._y;this._y=t,t!==r&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){var r=this._z;this._z=t,t!==r&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){var r=this._w;this._w=t,t!==r&&this.onChange(this)},enumerable:!1,configurable:!0}),e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y,a=n.z,s=n.w;return t[r]=i,t[r+1]=o,t[r+2]=a,t[r+3]=s,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1],t[r+2],t[r+3])},e.prototype.destroy=function(){this.onChange=Vt},e.prototype.toString=function(){var t=this,r=t.x,n=t.y,i=t.z,o=t.w;return"{ x="+r+", y="+n+", z="+i+", w="+o+" }"},e}();function hh(e,t){t===void 0&&(t=new tt);var r=Xo(e),n=1/r.x,i=1/r.y,o=1/r.z,a=L(e.data,11),s=a[0],f=a[1],u=a[2];a[3];var h=a[4],c=a[5],m=a[6];a[7];var d=a[8],v=a[9],g=a[10],p=s*n,b=f*i,C=u*o,S=h*n,R=c*i,E=m*o,_=d*n,G=v*i,V=g*o,P=p+R+V,O=0;return P>0?(O=Math.sqrt(P+1)*2,t.set((E-G)/O,(_-C)/O,(b-S)/O,.25*O)):p>R&&p>V?(O=Math.sqrt(1+p-R-V)*2,t.set(.25*O,(b+S)/O,(_+C)/O,(E-G)/O)):R>V?(O=Math.sqrt(1+R-p-V)*2,t.set((b+S)/O,.25*O,(E+G)/O,(_-C)/O)):(O=Math.sqrt(1+V-p-R)*2,t.set((_+C)/O,(E+G)/O,.25*O,(b-S)/O))}function ch(e,t){t===void 0&&(t=new B);var r=e.data;return t.set(r[12],r[13],r[14])}function dr(e){return e===void 0&&(e=new I),e.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}function vr(e,t){t===void 0&&(t=new I);var r=L(e.data,16),n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],f=r[5],u=r[6],h=r[7],c=r[8],m=r[9],d=r[10],v=r[11],g=r[12],p=r[13],b=r[14],C=r[15],S=d*C-b*v,R=m*C-p*v,E=m*b-p*d,_=c*C-g*v,G=c*b-d*g,V=c*p-g*m,P=+(f*S-u*R+h*E),O=-(s*S-u*_+h*G),k=+(s*R-f*_+h*V),W=-(s*E-f*G+u*V),K=n*P+i*O+o*k+a*W;if(K===0)return t;var N=1/K,q=u*C-b*h,J=f*C-p*h,X=f*b-p*u,rt=s*C-g*h,ot=s*b-g*u,ht=s*p-g*f,zt=u*v-d*h,Lt=f*v-m*h,ie=f*d-m*u,Nt=s*v-c*h,oe=s*d-c*u,on=s*m-c*f,EM=-(i*S-o*R+a*E),AM=+(n*S-o*_+a*G),zM=-(n*R-i*_+a*V),FM=+(n*E-i*G+o*V),_M=+(i*q-o*J+a*X),DM=-(n*q-o*rt+a*ot),GM=+(n*J-i*rt+a*ht),LM=-(n*X-i*ot+o*ht),VM=-(i*zt-o*Lt+a*ie),OM=+(n*zt-o*Nt+a*oe),BM=-(n*Lt-i*Nt+a*on),PM=+(n*ie-i*oe+o*on);return t.set(P*N,EM*N,_M*N,VM*N,O*N,AM*N,DM*N,OM*N,k*N,zM*N,GM*N,BM*N,W*N,FM*N,LM*N,PM*N)}function $o(e,t,r,n){n===void 0&&(n=new I);var i=e.x,o=e.y,a=e.z,s=r.x,f=r.y,u=r.z,h=t.x,c=t.y,m=t.z;if(Math.abs(i-h)<1e-5&&Math.abs(o-c)<1e-5&&Math.abs(a-m)<1e-5)return dr(n);var d=i-h,v=o-c,g=a-m,p=1/Math.hypot(d,v,g);d*=p,v*=p,g*=p;var b=f*g-u*v,C=u*d-s*g,S=s*v-f*d;p=Math.hypot(b,C,S),p?(p=1/p,b*=p,C*=p,S*=p):(b=0,C=0,S=0);var R=v*S-g*C,E=g*b-d*S,_=d*C-v*b;return p=Math.hypot(R,E,_),p?(p=1/p,R*=p,E*=p,_*=p):(R=0,E=0,_=0),n.set(b,R,d,0,C,E,v,0,S,_,g,0,-(b*i+C*o+S*a),-(R*i+E*o+_*a),-(d*i+v*o+g*a),1)}function he(e,t,r){r===void 0&&(r=new I);var n=L(e.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=L(t.data,16),E=R[0],_=R[1],G=R[2],V=R[3],P=R[4],O=R[5],k=R[6],W=R[7],K=R[8],N=R[9],q=R[10],J=R[11],X=R[12],rt=R[13],ot=R[14],ht=R[15];return r.set(E*i+_*f+G*m+V*p,_*o+_*u+G*d+V*b,G*a+_*h+G*v+V*C,V*s+_*c+G*g+V*S,P*i+O*f+k*m+W*p,P*o+O*u+k*d+W*b,P*a+O*h+k*v+W*C,P*s+O*c+k*g+W*S,K*i+N*f+q*m+J*p,K*o+N*u+q*d+J*b,K*a+N*h+q*v+J*C,K*s+N*c+q*g+J*S,X*i+rt*f+ot*m+ht*p,X*o+rt*u+ot*d+ht*b,X*a+rt*h+ot*v+ht*C,X*s+rt*c+ot*g+ht*S)}function lh(e,t,r){r===void 0&&(r=new I);var n=L(e.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15];return r.set(i*t,o*t,a*t,s*t,f*t,u*t,h*t,c*t,m*t,d*t,v*t,g*t,p*t,b*t,C*t,S*t)}function dh(e,t,r,n){n===void 0&&(n=new I);var i=L(e.data,16),o=i[0],a=i[1],s=i[2],f=i[3],u=i[4],h=i[5],c=i[6],m=i[7],d=i[8],v=i[9],g=i[10],p=i[11],b=i[12],C=i[13],S=i[14],R=i[15],E=L(t.data,16),_=E[0],G=E[1],V=E[2],P=E[3],O=E[4],k=E[5],W=E[6],K=E[7],N=E[8],q=E[9],J=E[10],X=E[11],rt=E[12],ot=E[13],ht=E[14],zt=E[15];return n.set(o+_*r,a+G*r,s+V*r,f+P*r,u+O*r,h+k*r,c+W*r,m+K*r,d+N*r,v+q*r,g+J*r,p+X*r,b+rt*r,C+ot*r,S+ht*r,R+zt*r)}function Yo(e,t,r,n,i,o,a){a===void 0&&(a=new I);var s=1/(e-t),f=1/(r-n),u=1/(i-o);return a.set(-2*s,0,0,0,0,-2*f,0,0,0,0,2*u,0,(e+t)*s,(n+r)*f,(o+i)*u,1)}function mr(e,t,r,n,i){i===void 0&&(i=new I);var o=1/Math.tan(e/2),a=-1,s=-2*r;if(n!==null&&n!==Infinity){var f=1/(r-n);a=(n+r)*f,s=2*n*r*f}return i.set(o/t,0,0,0,0,o,0,0,0,0,a,-1,0,0,s,0)}function vh(e,t,r,n){n===void 0&&(n=new I);var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),f=2/(a+s),u=2/(i+o);return n.set(f,0,0,0,0,u,0,0,-((a-s)*f*.5),(i-o)*u*.5,r/(t-r),-1,0,0,r*t/(t-r),0)}function mh(e,t,r,n){n===void 0&&(n=new I);var i=r.x,o=r.y,a=r.z,s=Math.hypot(i,o,a);if(s<1e-5)return null;s=1/s,i*=s,o*=s,a*=s;var f=Math.sin(t),u=Math.cos(t),h=1-u,c=L(e.data,16),m=c[0],d=c[1],v=c[2],g=c[3],p=c[4],b=c[5],C=c[6],S=c[7],R=c[8],E=c[9],_=c[10],G=c[11],V=c[12],P=c[13],O=c[14],k=c[15],W=i*i*h+u,K=o*i*h+a*f,N=a*i*h-o*f,q=i*o*h-a*f,J=o*o*h+u,X=a*o*h+i*f,rt=i*a*h+o*f,ot=o*a*h-i*f,ht=a*a*h+u;return n.set(m*W+p*K+R*N,d*W+b*K+E*N,v*W+C*K+_*N,g*W+S*K+G*N,m*q+p*J+R*X,d*q+b*J+E*X,v*q+C*J+_*X,g*q+S*J+G*X,m*rt+p*ot+R*ht,d*rt+b*ot+E*ht,v*rt+C*ot+_*ht,g*rt+S*ot+G*ht,V,P,O,k)}function ph(e,t,r){r===void 0&&(r=new I);var n=Math.sin(t),i=Math.cos(t),o=L(e.data,16),a=o[0],s=o[1],f=o[2],u=o[3],h=o[4],c=o[5],m=o[6],d=o[7],v=o[8],g=o[9],p=o[10],b=o[11],C=o[12],S=o[13],R=o[14],E=o[15];return r.set(a,s,f,u,h*i+v*n,c*i+g*n,m*i+p*n,d*i+b*n,v*i-h*n,g*i-c*n,p*i-m*n,b*i-d*n,C,S,R,E)}function yh(e,t,r){r===void 0&&(r=new I);var n=Math.sin(t),i=Math.cos(t),o=L(e.data,16),a=o[0],s=o[1],f=o[2],u=o[3],h=o[4],c=o[5],m=o[6],d=o[7],v=o[8],g=o[9],p=o[10],b=o[11],C=o[12],S=o[13],R=o[14],E=o[15];return r.set(a*i-v*n,s*i-g*n,f*i-p*n,u*i-b*n,h,c,m,d,a*n+v*i,s*n+g*i,f*n+p*i,u*n+b*i,C,S,R,E)}function xh(e,t,r){r===void 0&&(r=new I);var n=Math.sin(t),i=Math.cos(t),o=L(e.data,16),a=o[0],s=o[1],f=o[2],u=o[3],h=o[4],c=o[5],m=o[6],d=o[7],v=o[8],g=o[9],p=o[10],b=o[11],C=o[12],S=o[13],R=o[14],E=o[15];return r.set(a*i+h*n,s*i+c*n,f*i+m*n,u*i+d*n,h*i-a*n,c*i-s*n,m*i-f*n,d*i-u*n,v,g,p,b,C,S,R,E)}function Mh(e,t,r){r===void 0&&(r=new I);var n=L(e.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=t.x,E=t.y,_=t.z;return r.set(i*R,o*R,a*R,s*R,f*E,u*E,h*E,c*E,m*_,d*_,v*_,g*_,p,b,C,S)}function wh(e,t){var r=e.data,n=t.x,i=t.y,o=t.z;return r[12]=n,r[13]=i,r[14]=o,e.onChange(e),e}function gh(e,t,r,n){var i=e.data;return i[12]=t,i[13]=r,i[14]=n,e.onChange(e),e}function bh(e,t,r){r===void 0&&(r=new I);var n=L(e.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=L(t.data,16),E=R[0],_=R[1],G=R[2],V=R[3],P=R[4],O=R[5],k=R[6],W=R[7],K=R[8],N=R[9],q=R[10],J=R[11],X=R[12],rt=R[13],ot=R[14],ht=R[15];return r.set(i-E,o-_,a-G,s-V,f-P,u-O,h-k,c-W,m-K,d-N,v-q,g-J,p-X,b-rt,C-ot,S-ht)}function Ch(e,t,r,n){n===void 0&&(n=new I);var i=e.x,o=e.y,a=e.z,s=r.x,f=r.y,u=r.z,h=t.x,c=t.y,m=t.z,d=i-h,v=o-c,g=a-m,p=d*d+v*v+g*g;p>0&&(p=1/Math.sqrt(p),d*=p,v*=p,g*=p);var b=f*g-u*v,C=u*d-s*g,S=s*v-f*d;return p=b*b+C*C+S*S,p>0&&(p=1/Math.sqrt(p),b*=p,C*=p,S*=p),n.set(b,C,S,0,v*S-g*C,g*b-d*S,d*C-v*b,0,d,v,g,0,i,o,a,1)}function Th(e,t,r){r===void 0&&(r=new I);var n=t.x,i=t.y,o=t.z,a=e.data,s=L(a,16),f=s[0],u=s[1],h=s[2],c=s[3],m=s[4],d=s[5],v=s[6],g=s[7],p=s[8],b=s[9],C=s[10],S=s[11],R=s[12],E=s[13],_=s[14],G=s[15];return e===r?(a[12]=f*n+m*i+p*o+R,a[13]=u*n+d*i+b*o+E,a[14]=h*n+v*i+C*o+_,a[15]=c*n+g*i+S*o+G):r.set(f,u,h,c,m,d,v,g,p,b,C,S,f*n+m*i+p*o+R,u*n+d*i+b*o+E,h*n+v*i+C*o+_,c*n+g*i+S*o+G),r}function qo(e,t,r,n,i){i===void 0&&(i=new I);var o=e.data,a=L(o,16),s=a[0],f=a[1],u=a[2],h=a[3],c=a[4],m=a[5],d=a[6],v=a[7],g=a[8],p=a[9],b=a[10],C=a[11],S=a[12],R=a[13],E=a[14],_=a[15];return e===i?(o[12]=s*t+c*r+g*n+S,o[13]=f*t+m*r+p*n+R,o[14]=u*t+d*r+b*n+E,o[15]=h*t+v*r+C*n+_):i.set(s,f,u,h,c,m,d,v,g,p,b,C,s*t+c*r+g*n+S,f*t+m*r+p*n+R,u*t+d*r+b*n+E,h*t+v*r+C*n+_),i}function Zo(e,t){t===void 0&&(t=new I);var r=L(e.data,16),n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],f=r[5],u=r[6],h=r[7],c=r[8],m=r[9],d=r[10],v=r[11],g=r[12],p=r[13],b=r[14],C=r[15];return t.set(n,s,c,g,i,f,m,p,o,u,d,b,a,h,v,C)}function Sh(e){return e.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}var Rh=Object.freeze({__proto__:null,GetMat4Determinant:lt,GetMat4Frobenius:pt,Mat4Add:Ku,Mat4AddTranslationFromFloats:Xu,Mat4Adjoint:$u,Mat4Clone:Yu,Mat4CopyFrom:qu,Mat4CopyPosition:Zu,Mat4Equals:Ju,Mat4FromQuat:th,Mat4FromRotation:eh,Mat4FromRotationTranslation:rh,Mat4FromRotationTranslationScale:Qo,Mat4FromRotationTranslationScaleOrigin:nh,Mat4FromRotationXYTranslation:Ko,Mat4FromScaling:ih,Mat4FromTranslation:oh,Mat4FromXRotation:ah,Mat4FromYRotation:sh,Mat4FromZRotation:fh,Mat4Frustum:uh,Mat4GetRotation:hh,Mat4GetScaling:Xo,Mat4GetTranslation:ch,Mat4Identity:dr,Mat4Invert:vr,Mat4LookAt:$o,Mat4Multiply:he,Mat4MultiplyScalar:lh,Mat4MultiplyScalarAndAdd:dh,Mat4Ortho:Yo,Mat4Perspective:mr,Mat4PerspectiveFromFieldOfView:vh,Mat4Rotate:mh,Mat4RotateX:ph,Mat4RotateY:yh,Mat4RotateZ:xh,Mat4Scale:Mh,Mat4SetTranslation:wh,Mat4SetTranslationFromFloats:gh,Mat4Subtract:bh,Mat4TargetTo:Ch,Mat4Translate:Th,Mat4TranslateFromFloats:qo,Mat4Transpose:Zo,Mat4Zero:Sh,Matrix4:I}),dt=function(){function e(t,r,n,i,o,a){t===void 0&&(t=1),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=0),a===void 0&&(a=0),this.set(t,r,n,i,o,a)}return e.prototype.set=function(t,r,n,i,o,a){return t===void 0&&(t=1),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=0),a===void 0&&(a=0),this.a=t,this.b=r,this.c=n,this.d=i,this.tx=o,this.ty=a,this},e.prototype.identity=function(){return this.set()},e.prototype.toArray=function(){var t=this,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty;return[r,n,i,o,a,s]},e.prototype.fromArray=function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5])},e}();function Ot(e,t,r){return e.width<=0||e.height<=0?!1:e.x<=t&&e.x+e.width>=t&&e.y<=r&&e.y+e.height>=r}var yt=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.set(t,r,n,i)}return e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=t,this.y=r,this.width=n,this.height=i,this},e.prototype.contains=function(t,r){return Ot(this,t,r)},Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},set:function(t){t<=this.x?this.width=0:this.width=t-this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){t<=this.y?this.height=0:this.height=t-this.y},enumerable:!1,configurable:!0}),e}(),Ut=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=0),this._x=r,this._y=n,this.onChange=t}return e.prototype.destroy=function(){this.onChange=Vt},e.prototype.set=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=0),this._x=t,this._y=r,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var r=this._x;this._x=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var r=this._y;this._y=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y;return t[r]=i,t[r+1]=o,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y;return"{ x="+r+", y="+n+" }"},e}();function Eh(e,t,r,n){return Math.atan2(n-t,r-e)}function Ah(e,t,r,n){return Math.atan2(r-e,n-t)}var ct={PI2:Math.PI*2,HALF_PI:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};function zh(e){return e>Math.PI&&(e-=ct.PI2),Math.abs(((e+ct.HALF_PI)%ct.PI2-ct.PI2)%ct.PI2)}function Jo(e){return e=e%ct.PI2,e>=0?e:e+ct.PI2}function Fh(e){return Jo(e+Math.PI)}function _h(e,t,r){return r===void 0&&(r=.05),e===t||(Math.abs(t-e)<=r||Math.abs(t-e)>=ct.PI2-r?e=t:(Math.abs(t-e)>Math.PI&&(t<e?t+=ct.PI2:t-=ct.PI2),t>e?e+=r:t<e&&(e-=r))),e}function Dh(e,t){var r=t-e;if(r===0)return 0;var n=Math.floor((r- -180)/360);return r-n*360}function pr(e,t,r){var n=r-t;return t+((e-t)%n+n)%n}function ta(e){return pr(e,-Math.PI,Math.PI)}function Gh(e){return pr(e,-180,180)}var Lh=Object.freeze({__proto__:null,AngleBetween:Eh,AngleBetweenY:Ah,CounterClockwise:zh,NormalizeAngle:Jo,ReverseAngle:Fh,RotateAngleTo:_h,ShortestAngleBetween:Dh,WrapAngle:ta,WrapAngleDegrees:Gh}),ea=function(){function e(){var t=this;this._rotation=0,this.type="Camera",this.dirtyRender=!0;var r=A.get();this.renderer=r.renderer,this.matrix=dr(),this.bounds=new yt,this.worldTransform=new dt,this.position=new Ut(function(){return t.updateTransform()},0,0),this.scale=new Ut(function(){return t.updateTransform()},1,1),this.origin=new Ut(function(){return t.updateTransform()},.5,.5),this.reset()}return e.prototype.updateTransform=function(){var t=this.matrix.data,r=this.position.x,n=this.position.y,i=this.scale.x,o=this.scale.y,a=-r+this.width*this.origin.x,s=-n+this.height*this.origin.y,f=Math.sin(this.rotation),u=Math.cos(this.rotation),h=f+f,c=f*h,m=u*h,d=(1-c)*i,v=m*i,g=-m*o,p=(1-c)*o;t[0]=d,t[1]=v,t[4]=g,t[5]=p,t[12]=r+a-(d*a+g*s),t[13]=n+s-(v*a+p*s),this.worldTransform.set(u*i,f*i,-f*o,u*o,-r,-n);var b=this.width*(1/i),C=this.height*(1/o);this.bounds.set(a-b/2,s-C/2,b,C),this.dirtyRender=!0},e.prototype.reset=function(){var t=this.renderer.width,r=this.renderer.height;this.width=t,this.height=r,this.bounds.set(0,0,t,r)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){t!==this._rotation&&(this._rotation=ta(t),this.updateTransform())},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null},e}(),gn=function(){function e(){this.type="StaticCamera",this.dirtyRender=!0;var t=A.get();this.renderer=t.renderer,this.matrix=dr(),this.bounds=new yt,this.worldTransform=new dt,this.reset()}return e.prototype.reset=function(){var t=this.renderer;if(t){var r=t.width,n=t.height;this.width=r,this.height=n}this.bounds.set(0,0,this.width,this.height)},e.prototype.destroy=function(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null},e}(),Vh=Object.freeze({__proto__:null,Camera:ea,StaticCamera:gn});function yr(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function ra(e,t){var r=yr(e,t);return Math.acos(2*r*r-1)}function at(e,t,r){return Math.max(t,Math.min(r,e))}function Oh(e,t){return 2*Math.acos(Math.abs(at(yr(e,t),-1,1)))}function Bh(e,t){return yr(e,t)>=0}function Ph(e,t){t===void 0&&(t=new tt);var r=Math.acos(e.w)*2,n=Math.sin(r/2),i=1e-6;return n>i?t.set(e.x/n,e.y/n,e.z/n):t.set(1,0,0),r}function na(e){var t=e.x,r=e.y,n=e.z,i=e.w;return Math.sqrt(t*t+r*r+n*n+i*i)}function Ih(e){var t=e.x,r=e.y,n=e.z,i=e.w;return t*t+r*r+n*n+i*i}function Nh(e,t,r){return r===void 0&&(r=new tt),r.set(e.x+t.x,e.y+t.y,e.z+t.z,e.w+t.w)}function Uh(e,t,r){return r===void 0&&(r=new tt),r.set(e.x+t,e.y+t,e.z+t,e.w+t)}function kh(e){var t=e.x,r=e.y,n=e.z,i=e.w;return new tt(t,r,n,i)}function Wh(e,t){t===void 0&&(t=new tt);var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(r*-1,n*-1,i*-1,o)}function Oe(e,t){var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(r,n,i,o)}function jh(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}function ce(e,t,r,n){n===void 0&&(n=new tt);var i=r*.5,o=t*.5,a=e*.5,s=Math.sin(i),f=Math.cos(i),u=Math.sin(o),h=Math.cos(o),c=Math.sin(a),m=Math.cos(a);return n.set(m*u*f+c*h*s,c*h*f-m*u*s,m*h*s-c*u*f,m*h*f+c*u*s)}function Hh(e,t,r,n){return n===void 0&&(n=new tt),ce(t,e,r,n)}function Qh(e,t){return t===void 0&&(t=new tt),ce(e.y,e.x,e.z,t)}function ia(){return new B(0,0,-1)}function oa(){return new B(0,-1,0)}function xr(){return new B(0,0,1)}function bn(){return new B(-1,0,0)}function Mr(){return new B(1,0,0)}function Be(){return new B(0,1,0)}function aa(){return new B(0,0,0)}var Cn=Be(),Kh=oa(),Xh=bn(),sa=Mr(),fa=xr(),$h=ia(),Yh=aa();function wr(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function qh(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z,f=Math.sqrt(r*r+n*n+i*i),u=Math.sqrt(o*o+a*a+s*s),h=f*u,c=h&&wr(e,t)/h;return Math.acos(Math.min(Math.max(c,-1),1))}function ua(e,t){var r=e.x-t.x,n=e.y-t.y,i=e.z-t.z;return r*r+n*n+i*i}function Zh(e,t){return Math.sqrt(ua(e,t))}function ha(e){var t=e.x,r=e.y,n=e.z;return Math.sqrt(t*t+r*r+n*n)}function Jh(e){var t=e.x,r=e.y,n=e.z;return t*t+r*r+n*n}function tc(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z)}function ec(e){return Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)}var Bt=function(){function e(t,r,n,i){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this._x=r,this._y=n,this._z=i,this.onChange=t}return e.prototype.destroy=function(){this.onChange=Vt},e.prototype.set=function(t,r,n){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this._x=t,this._y=r,this._z=n,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var r=this._x;this._x=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var r=this._y;this._y=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){var r=this._z;this._z=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y,a=n.z;return t[r]=i,t[r+1]=o,t[r+2]=a,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1],t[r+2])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y,i=t.z;return"{ x="+r+", y="+n+", z="+i+" }"},e}(),Yt=function(e){z(t,e);function t(r,n,i,o){return n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0),e.call(this,r,n,i,o)||this}return Object.defineProperty(t.prototype,"r",{get:function(){return this.x},set:function(r){this.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this.y},set:function(r){this.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.z},set:function(r){this.z=r},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var r=this,n=r.x,i=r.y,o=r.z;return"[ r="+n+", g="+i+", b="+o+" ]"},t}(Bt);function rc(e,t){return t===void 0&&(t=new B),t.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z))}function Tn(e,t,r){return r===void 0&&(r=new B),r.set(e.x+t.x,e.y+t.y,e.z+t.z)}function nc(e,t,r){return r===void 0&&(r=new B),r.set(e.x+t,e.y+t,e.z+t)}function _t(e,t,r,n,i){var o=1-i,a=o*o,s=i*i,f=a*o,u=3*i*a,h=3*s*o,c=s*i;return e*f+t*u+r*h+n*c}function ic(e,t,r,n,i,o){return o===void 0&&(o=new B),o.set(_t(i,e.x,t.x,r.x,n.x),_t(i,e.y,t.y,r.y,n.y),_t(i,e.z,t.z,r.z,n.z))}function Mt(e,t,r,n,i){var o=(n-t)*.5,a=(i-r)*.5,s=e*e,f=e*s;return(2*r-2*n+o+a)*f+(-3*r+3*n-2*o-a)*s+o*e+r}function oc(e,t,r,n,i,o){return o===void 0&&(o=new B),o.set(Mt(i,e.x,t.x,r.x,n.x),Mt(i,e.y,t.y,r.y,n.y),Mt(i,e.z,t.z,r.z,n.z))}function ac(e,t){return t===void 0&&(t=new B),t.set(Math.ceil(e.x),Math.ceil(e.y),Math.ceil(e.z))}function le(e,t,r){return r===void 0&&(r=new B),r.set(e.x*t,e.y*t,e.z*t)}function sc(e,t,r){return r===void 0&&(r=new B),Tn(e,t,r),le(r,.5,r)}function fc(e,t,r,n){return n===void 0&&(n=new B),n.set(at(e.x,t.x,r.x),at(e.y,t.y,r.y),at(e.z,t.z,r.z))}function ca(e,t,r){r===void 0&&(r=new B);var n=e.x,i=e.y,o=e.z;return r.set(n/t,i/t,o/t)}function uc(e,t,r,n){n===void 0&&(n=new B);var i=ha(e);return ca(e,i||1,n),le(n,at(t,r,i),n)}function hc(e,t,r,n){return n===void 0&&(n=new B),n.set(at(e.x,t,r),at(e.y,t,r),at(e.z,t,r))}function cc(e){var t=e.x,r=e.y,n=e.z;return new B(t,r,n)}function lc(e,t){var r=e.x,n=e.y,i=e.z;return t.set(r,n,i)}function dc(e,t,r){r===void 0&&(r=new B);var n=e.x,i=e.y,o=e.z,a=t.x,s=t.y,f=t.z;return r.set(i*f-o*s,o*a-n*f,n*s-i*a)}function Sn(e,t,r){r===void 0&&(r=new B);var n=e.x,i=e.y,o=e.z,a=t.x,s=t.y,f=t.z,u=i*f-o*s,h=o*a-n*f,c=n*s-i*a,m=u*u+h*h+c*c;return m>0&&(m=1/Math.sqrt(m)),r.set(u*m,h*m,c*m)}function vc(e,t,r){return r===void 0&&(r=new B),r.set(e.x/t.x,e.y/t.y,e.z/t.z)}function mc(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}function pc(e,t){return t===void 0&&(t=new B),t.set(Math.floor(e.x),Math.floor(e.y),Math.floor(e.z))}function yc(e,t){return t===void 0&&(t=new B),t.set(e.x-Math.floor(e.x),e.y-Math.floor(e.y),e.z-Math.floor(e.z))}function xc(e,t,r,n){return n===void 0&&(n=new B),n.set(e*Math.sin(t),r,e*Math.cos(t))}function Mc(e,t,r,n){n===void 0&&(n=new B);var i=Math.sin(t)*e;return n.set(i*Math.sin(r),Math.cos(t)*e,i*Math.cos(r))}function wt(e,t,r){return r===void 0&&(r=1e-4),Math.abs(e-t)<r}function wc(e,t,r){return r===void 0&&(r=1e-4),wt(e.x,t.x,r)&&wt(e.y,t.y,r)&&wt(e.z,t.z,r)}function gt(e,t,r,n,i){var o=i*i,a=o*(2*i-3)+1,s=o*(i-2)+i,f=o*(i-1),u=o*(3-2*i);return e*a+t*s+r*f+n*u}function gc(e,t,r,n,i,o){return o===void 0&&(o=new B),o.set(gt(i,e.x,t.x,r.x,n.x),gt(i,e.y,t.y,r.y,n.y),gt(i,e.z,t.z,r.z,n.z))}function bc(e,t){return t===void 0&&(t=new B),t.set(1/e.x,1/e.y,1/e.z)}function Cc(e){var t=Math.abs(e.x),r=Math.abs(e.y),n=Math.abs(e.z);return t!==r||t!==n||r!==n}function Tc(e,t,r,n){n===void 0&&(n=new B);var i=e.x,o=e.y,a=e.z;return n.set(i+r*(t.x-i),o+r*(t.y-o),a+r*(t.z-a))}function Sc(e,t,r){r===void 0&&(r=new B);var n=e.x,i=e.y,o=e.z,a=t.x,s=t.y,f=t.z;return r.set(Math.max(n,a),Math.max(i,s),Math.max(o,f))}function Rc(e,t,r){r===void 0&&(r=new B);var n=e.x,i=e.y,o=e.z,a=t.x,s=t.y,f=t.z;return r.set(Math.min(n,a),Math.min(i,s),Math.min(o,f))}function Ec(e,t,r){return r===void 0&&(r=new B),r.set(e.x*t.x,e.y*t.y,e.z*t.z)}function Ac(e,t,r,n,i){return i===void 0&&(i=new B),i.set(e.x*t,e.y*r,e.z*n)}function zc(e,t){return t===void 0&&(t=new B),t.set(-e.x,-e.y,-e.z)}function Dt(e,t){t===void 0&&(t=new B);var r=e.x,n=e.y,i=e.z,o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),t.set(r*o,n*o,i*o)}function Fc(){return new B(1,1,1)}function Rn(e,t,r){r===void 0&&(r=new B);var n=L(t.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=e.x,E=e.y,_=e.z,G=s*R+c*E+g*_+S;return G=G||1,r.set((i*R+f*E+m*_+p)/G,(o*R+u*E+d*_+b)/G,(a*R+h*E+v*_+C)/G)}var la=new I,gr=new I;function _c(e,t,r,n,i){i===void 0&&(i=new B);var o=n.x,a=n.y,s=n.width,f=n.height;return la.set(s/2,0,0,0,0,-f/2,0,0,0,0,.5,0,o+s/2,f/2+a,.5,1),he(t,r,gr),he(gr,la,gr),Rn(e,gr,i)}function Dc(e,t,r){t===void 0&&(t=1),r===void 0&&(r=new B);var n=Math.random()*2*Math.PI,i=Math.random()*2-1,o=Math.sqrt(1-i*i)*t;return r.set(Math.cos(n)*o,Math.sin(n)*o,i*t)}function br(e,t,r){return r===void 0&&(r=new B),r.set(e.x-t.x,e.y-t.y,e.z-t.z)}function Gc(e,t,r){return r===void 0&&(r=new B),le(t,2*wr(e,t),r),br(e,r,r)}function Lc(e,t,r,n){n===void 0&&(n=new B);var i=e.x,o=e.y,a=e.z,s=t.x,f=t.y,u=t.z,h=i-s,c=o-f,m=a-u,d=h,v=c*Math.cos(r)-m*Math.sin(r),g=c*Math.sin(r)+m*Math.cos(r);return n.set(d+s,v+f,g+u)}function Vc(e,t,r,n){n===void 0&&(n=new B);var i=e.x,o=e.y,a=e.z,s=t.x,f=t.y,u=t.z,h=i-s,c=o-f,m=a-u,d=m*Math.sin(r)+h*Math.cos(r),v=c,g=m*Math.cos(r)-h*Math.sin(r);return n.set(d+s,v+f,g+u)}function Oc(e,t,r,n){n===void 0&&(n=new B);var i=e.x,o=e.y,a=e.z,s=t.x,f=t.y,u=t.z,h=i-s,c=o-f,m=a-u,d=h*Math.cos(r)-c*Math.sin(r),v=h*Math.sin(r)+c*Math.cos(r),g=m;return n.set(d+s,v+f,g+u)}function Bc(e,t){return t===void 0&&(t=new B),t.set(Math.round(e.x),Math.round(e.y),Math.round(e.z))}function Pc(e,t){return t===void 0&&(t=new B),t.set(e.x<0?Math.ceil(e.x):Math.floor(e.x),e.y<0?Math.ceil(e.y):Math.floor(e.y),e.z<0?Math.ceil(e.z):Math.floor(e.z))}function Cr(e,t,r,n){return n===void 0&&(n=new B),n.set(e.x+t.x*r,e.y+t.y*r,e.z+t.z*r)}function Ic(e,t,r){return r===void 0&&(r=new B),Dt(e,r),le(r,t,r)}function Nc(e,t,r){return r===void 0&&(r=new B),r.set(e.x-t,e.y-t,e.z-t)}function Tr(e,t,r){r===void 0&&(r=new B);var n=L(t.data,11),i=n[0],o=n[1],a=n[2];n[3];var s=n[4],f=n[5],u=n[6];n[7];var h=n[8],c=n[9],m=n[10],d=e.x,v=e.y,g=e.z;return r.set(i*d+s*v+h*g,o*d+f*v+c*g,a*d+u*v+m*g)}function Sr(e,t,r){r===void 0&&(r=new B);var n=t.x,i=t.y,o=t.z,a=t.w,s=e.x,f=e.y,u=e.z,h=i*u-o*f,c=o*s-n*u,m=n*f-i*s,d=i*m-o*c,v=o*h-n*m,g=n*c-i*h,p=a*2;return h*=p,c*=p,m*=p,d*=2,v*=2,g*=2,r.set(s+h+d,f+c+v,u+m+g)}var qt=new I,Pe=new B;function Uc(e,t,r,n,i,o,a){a===void 0&&(a=new B),he(n,i,qt),he(qt,o,qt),vr(qt,qt);var s=e.x,f=e.y,u=e.z;Pe.set(s/t*2-1,-(f/r*2-1),2*u-1),Rn(Pe,qt,a);var h=qt.data,c=Pe.x*h[3]+Pe.y*h[7]+Pe.z*h[11]+h[15];return le(a,1/c,a)}var kc=Object.freeze({__proto__:null,GetVec3Angle:qh,GetVec3Distance:Zh,GetVec3DistanceSquared:ua,GetVec3Length:ha,GetVec3LengthSquared:Jh,GetVec3ManhattanDistance:tc,GetVec3ManhattanLength:ec,RGBCallback:Yt,Vec3:B,Vec3Abs:rc,Vec3Add:Tn,Vec3AddScalar:nc,Vec3Backward:ia,Vec3Bezier:ic,Vec3Callback:Bt,Vec3CatmullRom:oc,Vec3Ceil:ac,Vec3Center:sc,Vec3Clamp:fc,Vec3ClampLength:uc,Vec3ClampScalar:hc,Vec3Clone:cc,Vec3CopyFrom:lc,Vec3Cross:dc,Vec3CrossNormalize:Sn,Vec3Divide:vc,Vec3DivideScalar:ca,Vec3Dot:wr,Vec3Down:oa,Vec3Equals:mc,Vec3Floor:pc,Vec3Forward:xr,Vec3Fract:yc,Vec3FromCylindricalCoords:xc,Vec3FromSphericalCoords:Mc,Vec3FuzzyEquals:wc,Vec3Hermite:gc,Vec3Inverse:bc,Vec3IsNonUniform:Cc,Vec3Left:bn,Vec3Lerp:Tc,Vec3Max:Sc,Vec3Min:Rc,Vec3Multiply:Ec,Vec3MultiplyByFloats:Ac,Vec3Negate:zc,Vec3Normalize:Dt,Vec3One:Fc,Vec3Project:_c,Vec3Random:Dc,Vec3Reflect:Gc,Vec3Right:Mr,Vec3RotateX:Lc,Vec3RotateY:Vc,Vec3RotateZ:Oc,Vec3Round:Bc,Vec3RoundToZero:Pc,Vec3Scale:le,Vec3ScaleAndAdd:Cr,Vec3SetLength:Ic,Vec3Subtract:br,Vec3SubtractScalar:Nc,Vec3TransformMat4:Rn,Vec3TransformMat4Zero:Tr,Vec3TransformQuat:Sr,Vec3Unproject:Uc,Vec3Up:Be,Vec3Zero:aa,BACKWARD:$h,DOWN:Kh,FORWARD:fa,LEFT:Xh,RIGHT:sa,UP:Cn,ZERO:Yh});function Wc(e,t,r){r===void 0&&(r=new tt);var n=Math.sin(t/2);Dt(e,e);var i=e.x,o=e.y,a=e.z;return r.set(i*n,o*n,a*n,Math.cos(t/2))}function jc(e,t){t===void 0&&(t=new tt);var r=L(e.data,11),n=r[0],i=r[1],o=r[2];r[3];var a=r[4],s=r[5],f=r[6];r[7];var u=r[8],h=r[9],c=r[10],m=n+s+c,d;return m>0?(d=.5/Math.sqrt(m+1),t.set((f-h)*d,(u-o)*d,(i-a)*d,.25/d)):n>s&&n>c?(d=2*Math.sqrt(1+n-s-c),t.set(.25*d,(a+i)/d,(u+o)/d,(f-h)/d)):s>c?(d=2*Math.sqrt(1+s-n-c),t.set((a+i)/d,.25*d,(h+f)/d,(u-o)/d)):(d=2*Math.sqrt(1+c-n-s),t.set((u+o)/d,(h+f)/d,.25*d,(i-a)/d))}function Hc(e,t,r){return r===void 0&&(r=1e-4),wt(e.x,t.x,r)&&wt(e.y,t.y,r)&&wt(e.z,t.z,r)&&wt(e.w,t.w,r)}function Qc(e,t,r,n,i,o){return o===void 0&&(o=new tt),o.set(gt(i,e.x,t.x,r.x,n.x),gt(i,e.y,t.y,r.y,n.y),gt(i,e.z,t.z,r.z,n.z),gt(i,e.w,t.w,r.w,n.w))}function Kc(e,t){t===void 0&&(t=new tt);var r=e.x,n=e.y,i=e.z,o=e.w,a=r*r+n*n+i*i+o*o,s=a?1/a:0;return t.set(-r*s,-n*s,-i*s,o*s)}function Xc(e,t,r){r===void 0&&(r=new tt);var n=e.x,i=e.y,o=e.z,a=e.w,s=t.x,f=t.y,u=t.z,h=t.w;return r.set(n*h+a*s+i*u-o*f,i*h+a*f+o*s-n*u,o*h+a*u+n*f-i*s,a*h-n*s-i*f-o*u)}function $c(e,t,r,n,i,o){return o===void 0&&(o=new tt),o.set(e.x*t,e.y*r,e.z*n,e.w*i)}function da(e,t,r){r===void 0&&(r=new tt);var n=e.x,i=e.y,o=e.z,a=e.w;return r.set(n*t,i*t,o*t,a*t)}function va(e,t){t===void 0&&(t=new tt);var r=na(e);return r===0?t.set(0,0,0,1):da(e,r,t)}function ma(e,t,r,n){if(n===void 0&&(n=new tt),r===0)return Oe(e,n);if(r===1)return Oe(t,n);var i=e.x,o=e.y,a=e.z,s=e.w,f=t.x,u=t.y,h=t.z,c=t.w,m=s*c+i*f+o*u+a*h;if(m<0?(n.set(-f,-u,-h,-c),m=-m):Oe(t,n),m>=1)return n.set(i,o,a,s);var d=1-m*m;if(d<=Number.EPSILON){var v=1-r;return n.set(v*i+r*n.x,v*o+r*n.y,v*a+r*n.z,v*s+r*n.w),va(n,n)}var g=Math.sqrt(d),p=Math.atan2(g,m),b=Math.sin((1-r)*p)/g,C=Math.sin(r*p)/g;return n.set(i*b+n.x*C,o*b+n.y*C,a*b+n.z*C,s*b+n.w*C)}function Yc(e,t,r,n){n===void 0&&(n=new tt);var i=ra(e,t);if(i===0)return Oe(e,n);var o=Math.min(1,r/i);return ma(e,t,o,n)}function pa(e,t,r){r===void 0&&(r=new tt),t*=.5;var n=e.x,i=e.y,o=e.z,a=e.w,s=Math.sin(t),f=Math.cos(t);return r.set(n*f+a*s,i*f+o*s,o*f-i*s,a*f-n*s)}function ya(e,t,r){r===void 0&&(r=new tt),t*=.5;var n=e.x,i=e.y,o=e.z,a=e.w,s=Math.sin(t),f=Math.cos(t);return r.set(n*f-o*s,i*f+a*s,o*f+n*s,a*f-i*s)}function xa(e,t,r){r===void 0&&(r=new tt),t*=.5;var n=e.x,i=e.y,o=e.z,a=e.w,s=Math.sin(t),f=Math.cos(t);return r.set(n*f+i*s,i*f-n*s,o*f+a*s,a*f-o*s)}function qc(e,t,r,n){n===void 0&&(n=new tt);var i=(r+e)*.5,o=(r-e)*.5,a=t*.5;return n.set(Math.cos(o)*Math.sin(a),Math.sin(o)*Math.sin(a),Math.sin(i)*Math.cos(a),Math.cos(i)*Math.cos(a))}function Zc(e,t,r,n){return n===void 0&&(n=new tt),n.set(e.x+t.x*r,e.y+t.y*r,e.z+t.z*r,e.w+t.w*r)}function Ma(e,t,r){r===void 0&&(r=new tt);var n=e.x,i=e.y,o=e.z;t*=.5;var a=Math.sin(t);return r.set(n*a,i*a,o*a,Math.cos(t))}function Jc(e,t,r,n){n===void 0&&(n=new tt);var i=t.x,o=t.y,a=t.z,s=r.x,f=r.y,u=r.z,h=1e-6,c=wr(t,r)+1;return c<h?(c=0,Math.abs(i)>Math.abs(a)?n.set(-o,i,0,c):n.set(0,-a,o,c)):n.set(o*u-a*f,a*s-i*u,i*f-o*s,c)}function tl(e,t,r){return r===void 0&&(r=new tt),r.set(e.x-t.x,e.y-t.y,e.z-t.z,e.w-t.w)}function el(e,t,r){r===void 0&&(r=new tt);var n=e.x,i=e.y,o=e.z,a=e.w;return r.set(n-t,i-t,o-t,a-t)}function rl(e,t){t===void 0&&(t=new B);var r=e.x,n=e.y,i=e.z,o=e.w,a=o*o,s=i*i,f=r*r,u=n*n,h=n*i-r*o,c=.4999999;return h<-c?t.set(Math.PI/2,2*Math.atan2(n,o),0):h>c?t.set(-Math.PI/2,2*Math.atan2(n,o),0):t.set(Math.asin(-2*(i*n-r*o)),Math.atan2(2*(i*r+n*o),s-f-u+a),Math.atan2(2*(r*n+i*o),-s-f+u+a))}function nl(){return new tt(0,0,0,0)}var il=Object.freeze({__proto__:null,GetQuatAngle:ra,GetQuatAngleTo:Oh,GetQuatAreClose:Bh,GetQuatAxisAngle:Ph,GetQuatLength:na,GetQuatLengthSquared:Ih,QuatAdd:Nh,QuatAddScalar:Uh,QuatClone:kh,QuatConjugate:Wh,QuatCopyFrom:Oe,QuatDot:yr,QuatEquals:jh,Quaternion:tt,QuatFromEulerAngles:Hh,QuatFromEulerVector:Qh,QuatFromRotationAxis:Wc,QuatFromRotationMatrix:jc,QuatFuzzyEquals:Hc,QuatHermite:Qc,QuatInvert:Kc,QuatMultiply:Xc,QuatMultiplyByFloats:$c,QuatNormalize:va,QuatRotateTowards:Yc,QuatRotateX:pa,QuatRotateY:ya,QuatRotateZ:xa,QuatRotationAlphaBetaGamma:qc,QuatRotationYawPitchRoll:ce,QuatScale:da,QuatScaleAndAdd:Zc,QuatSetAxisAngle:Ma,QuatSetFromUnitVectors:Jc,QuatSlerp:ma,QuatSubtract:tl,QuatSubtractScalar:el,QuatToEulerAngles:rl,QuatZero:nl});function wa(e,t){return t===void 0&&(t=1.70158),e*e*((t+1)*e-t)}function ga(e,t){t===void 0&&(t=1.70158);var r=t*1.525;return(e*=2)<1?.5*(e*e*((r+1)*e-r)):.5*((e-=2)*e*((r+1)*e+r)+2)}function En(e,t){return t===void 0&&(t=1.70158),--e*e*((t+1)*e+t)+1}var ol=Object.freeze({__proto__:null,In:wa,InOut:ga,Out:En});function ba(e){return e=1-e,e<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)}function Ca(e){var t=!1;return e<.5?(e=1-e*2,t=!0):e=e*2-1,e<1/2.75?e=7.5625*e*e:e<2/2.75?e=7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?e=7.5625*(e-=2.25/2.75)*e+.9375:e=7.5625*(e-=2.625/2.75)*e+.984375,t?(1-e)*.5:e*.5+.5}function An(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}var al=Object.freeze({__proto__:null,In:ba,InOut:Ca,Out:An});function Ta(e){return 1-Math.sqrt(1-e*e)}function Sa(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}function zn(e){return Math.sqrt(1- --e*e)}var sl=Object.freeze({__proto__:null,In:Ta,InOut:Sa,Out:zn});function Ra(e){return e*e*e}function Ea(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}function Rr(e){return--e*e*e+1}var fl=Object.freeze({__proto__:null,In:Ra,InOut:Ea,Out:Rr});function Aa(e,t,r){if(t===void 0&&(t=.1),r===void 0&&(r=.1),e===0)return 0;if(e===1)return 1;var n=r/4;return t<1?t=1:n=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/r))}function za(e,t,r){if(t===void 0&&(t=.1),r===void 0&&(r=.1),e===0)return 0;if(e===1)return 1;var n=r/4;return t<1?t=1:n=r*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?-.5*(t*Math.pow(2,10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/r)):t*Math.pow(2,-10*(e-=1))*Math.sin((e-n)*(2*Math.PI)/r)*.5+1}function Fn(e,t,r){if(t===void 0&&(t=.1),r===void 0&&(r=.1),e===0)return 0;if(e===1)return 1;var n=r/4;return t<1?t=1:n=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-n)*(2*Math.PI)/r)+1}var ul=Object.freeze({__proto__:null,In:Aa,InOut:za,Out:Fn});function Fa(e){return Math.pow(2,10*(e-1))-.001}function _a(e){return e==0?0:e==1?1:(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))}function _n(e){return 1-Math.pow(2,-10*e)}var hl=Object.freeze({__proto__:null,In:Fa,InOut:_a,Out:_n});function Da(e){return e*e}function Ga(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function Er(e){return e*(2-e)}var cl=Object.freeze({__proto__:null,In:Da,InOut:Ga,Out:Er});function La(e){return e*e*e*e}function Va(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function Ar(e){return-(--e*e*e*e-1)}var ll=Object.freeze({__proto__:null,In:La,InOut:Va,Out:Ar});function Oa(e){return e*e*e*e*e}function Ba(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}function zr(e){return(e=e-1)*e*e*e*e+1}var dl=Object.freeze({__proto__:null,In:Oa,InOut:Ba,Out:zr});function Pa(e){return e===0?0:e===1?1:1-Math.cos(e*Math.PI/2)}function Ia(e){return e===0?0:e===1?1:.5*(1-Math.cos(Math.PI*e))}function Dn(e){return e===0?0:e===1?1:Math.sin(e*Math.PI/2)}var vl=Object.freeze({__proto__:null,In:Pa,InOut:Ia,Out:Dn});function Fr(e){return e}var ml=Object.freeze({__proto__:null,Linear:Fr});function Na(e,t){return t===void 0&&(t=1),e<=0?0:e>=1?1:((t*e|0)+1)*(1/t)}var pl=Object.freeze({__proto__:null,Stepped:Na}),Ua=new Map([["power0",Fr],["power1",Er],["power2",Rr],["power3",Ar],["power4",zr],["linear",Fr],["quad",Er],["cubic",Rr],["quart",Ar],["quint",zr],["sine",Dn],["expo",_n],["circ",zn],["elastic",Fn],["back",En],["bounce",An],["stepped",Na],["quad.in",Da],["cubic.in",Ra],["quart.in",La],["quint.in",Oa],["sine.in",Pa],["expo.in",Fa],["circ.in",Ta],["elastic.in",Aa],["back.in",wa],["bounce.in",ba],["quad.out",Er],["cubic.out",Rr],["quart.out",Ar],["quint.out",zr],["sine.out",Dn],["expo.out",_n],["circ.out",zn],["elastic.out",Fn],["back.out",En],["bounce.out",An],["quad.inout",Ga],["cubic.inout",Ea],["quart.inout",Va],["quint.inout",Ba],["sine.inout",Ia],["expo.inout",_a],["circ.inout",Sa],["elastic.inout",za],["back.inout",ga],["bounce.inout",Ca]]);function yl(e){return e=e.toLowerCase(),e=e.replace("ease",""),Ua.has(e)?Ua.get(e):Fr}var xl=Object.freeze({__proto__:null,GetEase:yl}),Ml=Object.freeze({__proto__:null,Back:ol,Bounce:al,Circular:sl,Cubic:fl,Elastic:ul,Expo:hl,GetEase:xl,Linear:ml,Quadratic:cl,Quartic:ll,Quintic:dl,Sine:vl,Stepped:pl});function wl(e,t){return t===void 0&&(t=1e-4),Math.ceil(e-t)}function gl(e,t){return t===void 0&&(t=1e-4),Math.floor(e+t)}function bl(e,t,r){return r===void 0&&(r=1e-4),e>t-r}function Cl(e,t,r){return r===void 0&&(r=1e-4),e<t+r}var Tl=Object.freeze({__proto__:null,FuzzyCeil:wl,FuzzyEqual:wt,FuzzyFloor:gl,FuzzyGreaterThan:bl,FuzzyLessThan:Cl});function _r(e){if(e===0)return 1;for(var t=e;--e;)t*=e;return t}function ka(e,t){return _r(e)/_r(t)/_r(e-t)}function Sl(e,t){for(var r=0,n=e.length-1,i=0;i<=n;i++)r+=Math.pow(1-t,n-i)*Math.pow(t,i)*e[i]*ka(n,i);return r}function Rl(e,t){var r=e.length-1,n=r*t,i=Math.floor(n);return e[0]===e[r]?(t<0&&(i=Math.floor(n=r*(1+t))),Mt(n-i,e[(i-1+r)%r],e[i],e[(i+1)%r],e[(i+2)%r])):t<0?e[0]-(Mt(-n,e[0],e[0],e[1],e[1])-e[0]):t>1?e[r]-(Mt(n-r,e[r],e[r],e[r-1],e[r-1])-e[r]):Mt(n-i,e[i?i-1:0],e[i],e[r<i+1?r:i+1],e[r<i+2?r:i+2])}function El(e,t){var r=1-e;return r*r*r*t}function Al(e,t){var r=1-e;return 3*r*r*e*t}function zl(e,t){return 3*(1-e)*e*e*t}function Fl(e,t){return e*e*e*t}function _l(e,t,r,n,i){return El(e,t)+Al(e,r)+zl(e,n)+Fl(e,i)}function Dr(e,t,r){return(t-e)*r+e}function Dl(e,t){var r=e.length-1,n=r*t,i=Math.floor(n);return t<0?Dr(e[0],e[1],n):t>1?Dr(e[r],e[r-1],r-n):Dr(e[i],e[i+1>r?r:i+1],n-i)}function Gl(e,t){var r=1-e;return r*r*t}function Ll(e,t){return 2*(1-e)*e*t}function Vl(e,t){return e*e*t}function Ol(e,t,r,n){return Gl(e,t)+Ll(e,r)+Vl(e,n)}function Wa(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function Bl(e,t,r){return t+(r-t)*Wa(e,0,1)}function ja(e,t,r){return e=Math.max(0,Math.min(1,(e-t)/(r-t))),e*e*e*(e*(e*6-15)+10)}function Pl(e,t,r){return t+(r-t)*ja(e,0,1)}var Il=Object.freeze({__proto__:null,BezierInterpolation:Sl,CatmullRomInterpolation:Rl,CubicBezierInterpolation:_l,LinearInterpolation:Dl,QuadraticBezierInterpolation:Ol,SmoothStepInterpolation:Bl,SmootherStepInterpolation:Pl});function Nl(e){var t=e.a,r=e.b,n=e.c,i=e.d;return t*i-r*n}function Ul(e){return Math.hypot(e.a,e.b,e.c,e.d,e.tx,e.ty,1)}function kl(e,t,r){return r===void 0&&(r=new dt),r.set(e.a+t.a,e.b+t.b,e.c+t.c,e.d+t.d,e.tx+t.tx,e.ty+t.ty)}function Ha(e,t,r){r===void 0&&(r=new dt);var n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,f=e.ty,u=t.a,h=t.b,c=t.c,m=t.d,d=t.tx,v=t.ty;return r.set(u*n+h*o,u*i+h*a,c*n+m*o,c*i+m*a,d*n+v*o+s,d*i+v*a+f)}function Wl(e){return new dt(e.a,e.b,e.c,e.d,e.tx,e.ty)}function Gn(e,t){var r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty;return t.set(r,n,i,o,a,s)}function jl(e,t){var r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty;return t.transform(r,n,i,o,a,s),t}function Qa(e,t){return e.a===t.a&&e.b===t.b&&e.c===t.c&&e.d===t.d&&e.tx===t.tx&&e.ty===t.ty}function Ka(e,t,r){r===void 0&&(r=new dt);var n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,f=e.ty,u=Math.sin(t),h=Math.cos(t);return r.set(n*h+o*u,i*h+a*u,n*-u+o*h,i*-u+a*h,s,f)}function Hl(e){var t=new dt;return Ka(t,e,t)}function Xa(e,t,r,n){n===void 0&&(n=new dt);var i=e.a,o=e.b,a=e.c,s=e.d,f=e.tx,u=e.ty;return n.set(i*t,o*t,a*r,s*r,f,u)}function Ql(e,t){t===void 0&&(t=e);var r=new dt;return Xa(r,e,t,r)}function $a(e,t,r,n){n===void 0&&(n=new dt);var i=e.a,o=e.b,a=e.c,s=e.d,f=e.tx,u=e.ty;return n.tx=i*t+a*r+f,n.ty=o*t+s*r+u,n}function Kl(e,t){var r=new dt;return $a(r,e,t,r)}function Xl(e,t,r){r===void 0&&(r=1e-6);var n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,f=e.ty,u=t.a,h=t.b,c=t.c,m=t.d,d=t.tx,v=t.ty;return Math.abs(n-u)<=r*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-h)<=r*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-c)<=r*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-m)<=r*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-d)<=r*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(f-v)<=r*Math.max(1,Math.abs(f),Math.abs(v))}var D=function(){function e(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.set(t,r)}return e.prototype.set=function(t,r){return t===void 0&&(t=0),r===void 0&&(r=0),this.x=t,this.y=r,this},e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y;return t[r]=i,t[r+1]=o,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y;return"{ x="+r+", y="+n+" }"},e}();function Ya(e,t,r,n){n===void 0&&(n=new D);var i=e.a,o=e.b,a=e.c,s=e.d,f=e.tx,u=e.ty,h=1/(i*s+a*-o);return n.set(s*h*t+-a*h*r+(u*a-f*s)*h,i*h*r+-o*h*t+(-u*i+f*o)*h)}function $l(e,t,r,n,i,o){if(n===0)return e.set(1,0,0,1,t,r);var a=Math.sin(n),s=Math.cos(n);return e.set(s*i,a*i,-a*o,s*o,t,r)}function Yl(e,t,r,n,i,o,a,s){return n===void 0&&(n=0),i===void 0&&(i=1),o===void 0&&(o=1),a===void 0&&(a=0),s===void 0&&(s=0),n===0?e.set(1,0,0,1,t,r):e.set(Math.cos(n+s)*i,Math.sin(n+s)*i,-Math.sin(n-a)*o,Math.cos(n-a)*o,t,r)}function ql(){return new dt}function Zl(e,t){t===void 0&&(t=new dt);var r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty,f=r*o-n*i;return f&&(f=1/f,t.set(o*f,-n*f,-i*f,r*f,(i*s-o*a)*f,(n*a-r*s)*f)),t}function Jl(e,t,r,n){n===void 0&&(n=new D);var i=e.a,o=e.b,a=e.c,s=e.d,f=e.tx,u=e.ty;return n.set(i*t+a*r+f,o*t+s*r+u)}function td(e,t,r){r===void 0&&(r=new dt);var n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,f=e.ty,u=t.a,h=t.b,c=t.c,m=t.d,d=t.tx,v=t.ty;return r.set(n*u+o*h,i*u+a*h,n*c+o*m,i*c+a*m,n*d+o*v+s,i*d+a*v+f)}function ed(e,t,r){r===void 0&&(r=new dt);var n=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,f=e.ty;return r.set(n*t,i*t,o*t,a*t,s*t,f*t)}function rd(e,t,r,n){n===void 0&&(n=new dt);var i=t.a,o=t.b,a=t.c,s=t.d,f=t.tx,u=t.ty,h=e.a,c=e.b,m=e.c,d=e.d,v=e.tx,g=e.ty;return n.set(h+i*r,c+o*r,m+a*r,d+s*r,v+f*r,g+u*r)}function nd(e,t){var r=e.a,n=e.b,i=e.c,o=e.d,a=e.tx,s=e.ty;return t.setTransform(r,n,i,o,a,s),t}function id(e,t,r,n){n===void 0&&(n=new dt);var i=e.a,o=e.b,a=e.c,s=e.d,f=e.tx,u=e.ty;return n.set(i,o+Math.tan(t),a+Math.tan(r),s,f,u)}function od(e,t,r){return r===void 0&&(r=new dt),r.set(e.a-t.a,e.b-t.b,e.c-t.c,e.d-t.d,e.tx-t.tx,e.ty-t.ty)}function ad(e){return e.set(0,0,0,0,0,0)}var sd=Object.freeze({__proto__:null,GetMat2dDeterminant:Nl,GetMat2dFrobenius:Ul,Mat2dAdd:kl,Mat2dAppend:Ha,Mat2dClone:Wl,Mat2dCopyFrom:Gn,Mat2dCopyToContext:jl,Mat2dEquals:Qa,Mat2dFromRotation:Hl,Mat2dFromScaling:Ql,Mat2dFromTranslation:Kl,Mat2dFuzzyEquals:Xl,Mat2dGlobalToLocal:Ya,Mat2dIdentity:ql,Mat2dInvert:Zl,Mat2dITRS:$l,Mat2dITRSS:Yl,Mat2dLocalToGlobal:Jl,Mat2dMultiply:td,Mat2dMultiplyScalar:ed,Mat2dMultiplyScalarAndAdd:rd,Mat2dRotate:Ka,Mat2dScale:Xa,Mat2dSetToContext:nd,Mat2dSkew:id,Mat2dSubtract:od,Mat2dTranslate:$a,Mat2dZero:ad,Matrix2D:dt});function fd(e){var t=Math.log(e)/.6931471805599453;return 1<<Math.ceil(t)}function qa(e,t){return e<1||t<1?!1:(e&e-1)==0&&(t&t-1)==0}function ud(e){return e>0&&(e&e-1)==0}var hd=Object.freeze({__proto__:null,GetPowerOfTwo:fd,IsSizePowerOfTwo:qa,IsValuePowerOfTwo:ud});function cd(e,t,r,n){return r===void 0&&(r=0),n===void 0&&(n=!1),t===0?e:(e-=r,e=t*Math.ceil(e/t),n?(r+e)/t:r+e)}function ld(e,t,r,n){return r===void 0&&(r=0),n===void 0&&(n=!1),t===0?e:(e-=r,e=t*Math.floor(e/t),n?(r+e)/t:r+e)}function dd(e,t,r,n){return r===void 0&&(r=0),n===void 0&&(n=!1),t===0?e:(e-=r,e=t*Math.round(e/t),n?(r+e)/t:r+e)}var vd=Object.freeze({__proto__:null,SnapCeil:cd,SnapFloor:ld,SnapTo:dd});function md(e,t){return Math.max(Math.abs(e.x-t.x),Math.abs(e.y-t.y))}function Ln(e,t){var r=e.x-t.x,n=e.y-t.y;return r*r+n*n}function de(e,t){return Math.sqrt(Ln(e,t))}function Vn(e,t,r){return r===void 0&&(r=new D),r.set(e.x+t.x,e.y+t.y)}function Za(e,t){return e.x*t.x+e.y*t.y}function Ja(e,t,r,n){return n===void 0&&(n=new D),n.set(e.x*t,e.y*r)}function On(e,t,r){return r===void 0&&(r=new D),r.set(e.x-t.x,e.y-t.y)}function pd(e,t,r){var n=Ln(t,r);if(n===0)return de(e,t);var i=On(r,t);On(e,t,e);var o=Math.max(0,Math.min(1,Za(e,i)/12)),a=Vn(t,Ja(i,o,o,i));return de(e,a)}function yd(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function xd(e,t){return Math.atan2(t.x-e.x,t.y-e.y)}function Md(e,t,r){return r===void 0&&(r=2),Math.sqrt(Math.pow(t.x-e.x,r)+Math.pow(t.y-e.y,r))}function ts(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function wd(e){return e.x*e.x+e.y*e.y}function gd(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function bd(e){return Math.abs(e.x)+Math.abs(e.y)}function Cd(e,t){return t===void 0&&(t=new D),t.set(Math.abs(e.x),Math.abs(e.y))}function Td(e,t,r){return r===void 0&&(r=new D),r.set(e.x+t,e.y+t)}function Sd(e,t,r,n,i,o){return o===void 0&&(o=new D),o.set(_t(i,e.x,t.x,r.x,n.x),_t(i,e.y,t.y,r.y,n.y))}function Rd(e,t,r,n,i,o){return o===void 0&&(o=new D),o.set(Mt(i,e.x,t.x,r.x,n.x),Mt(i,e.y,t.y,r.y,n.y))}function Ed(e,t){return t===void 0&&(t=new D),t.set(Math.ceil(e.x),Math.ceil(e.y))}function Bn(e,t,r){return r===void 0&&(r=new D),r.set(e.x*t,e.y*t)}function Ad(e,t,r){return r===void 0&&(r=new D),Vn(e,t,r),Bn(r,.5,r)}function zd(e,t,r,n){return n===void 0&&(n=new D),n.set(at(e.x,t.x,r.x),at(e.y,t.y,r.y))}function Fd(e,t,r,n){return n===void 0&&(n=new D),n.set(at(e.x,t,r),at(e.y,t,r))}function _d(e){return new D(e.x,e.y)}function Dd(e,t){return t.set(e.x,e.y)}function Gd(e,t){return e.x*t.y-e.y*t.x}function Ld(e,t,r){return r===void 0&&(r=new D),r.set(e.x/t.x,e.y/t.y)}function es(e,t,r){return r===void 0&&(r=new D),r.set(e.x/t,e.y/t)}function Vd(e,t){return e.x===t.x&&e.y===t.y}function Od(e,t){return t===void 0&&(t=new D),t.set(Math.floor(e.x),Math.floor(e.y))}function Bd(e,t){return t===void 0&&(t=new D),t.set(e.x-Math.floor(e.x),e.y-Math.floor(e.y))}function Pd(e,t,r,n){n===void 0&&(n=new D);var i=0,o=0,a=t*r;return e>0&&e<=a&&(e>t-1?(o=Math.floor(e/t),i=e-o*t):i=e,n.set(i,o)),n}function rs(e,t,r,n,i,o,a,s){s===void 0&&(s=new D);var f=Math.sin(i),u=Math.cos(i),h=u*o,c=f*o,m=-f*a,d=u*a,v=1/(h*d+m*-c);return s.set(d*v*e+-m*v*t+(n*m-r*d)*v,h*v*t+-c*v*e+(-n*h+r*c)*v)}function Id(e,t,r){return r===void 0&&(r=1e-4),wt(e.x,t.x,r)&&wt(e.y,t.y,r)}function Nd(e,t,r,n,i,o){return o===void 0&&(o=new D),o.set(gt(i,e.x,t.x,r.x,n.x),gt(i,e.y,t.y,r.y,n.y))}function Ud(e,t){return t===void 0&&(t=new D),t.set(1/e.x,1/e.y)}function kd(e,t,r,n){n===void 0&&(n=new D);var i=e.x,o=e.y;return n.set(i+r*(t.x-i),o+r*(t.y-o))}function Wd(e,t,r){r===void 0&&(r=new D);var n=e.x,i=e.y,o=t.x,a=t.y;return r.set(Math.max(n,o),Math.max(i,a))}function jd(e,t,r){r===void 0&&(r=new D);var n=e.x,i=e.y,o=t.x,a=t.y;return r.set(Math.min(n,o),Math.min(i,a))}function Hd(e,t,r){return r===void 0&&(r=new D),r.set(e.x*t.x,e.y*t.y)}function Qd(e,t){return t===void 0&&(t=new D),t.set(-e.x,-e.y)}function ns(e,t){return t===void 0&&(t=new D),es(e,ts(e)||1,t)}function Kd(){return new D(1,1)}function Xd(e,t){return e.x*t.y-e.y*t.x}function $d(e,t,r){t===void 0&&(t=1),r===void 0&&(r=new D);var n=Math.random()*2*Math.PI;return r.set(Math.cos(n)*t,Math.sin(n)*t)}function Yd(e,t,r,n){n===void 0&&(n=new D);var i=Math.sin(r),o=Math.cos(r),a=e.x-t.x,s=e.y-t.y;return n.set(a*o-s*i+t.x,a*i+s*o+t.y)}function qd(e,t){return t===void 0&&(t=new D),t.set(Math.round(e.x),Math.round(e.y))}function Zd(e,t){return t===void 0&&(t=new D),t.set(e.x<0?Math.ceil(e.x):Math.floor(e.x),e.y<0?Math.ceil(e.y):Math.floor(e.y))}function Jd(e,t,r,n){return n===void 0&&(n=new D),n.set(e.x+t.x*r,e.y+t.y*r)}function tv(e,t,r){return r===void 0&&(r=new D),ns(e,r),Bn(r,t,r)}function ev(e,t,r){return r===void 0&&(r=new D),r.set(e.x-t,e.y-t)}function rv(e,t,r,n,i,o,a){return a===void 0&&(a=new D),rs(e.x,e.y,t,r,n,i,o,a)}function nv(e,t,r){r===void 0&&(r=new D);var n=t.a,i=t.b,o=t.c,a=t.d,s=t.tx,f=t.ty;return r.set(n*e.x+o*e.y+s,i*e.x+a*e.y+f)}function iv(e,t,r){r===void 0&&(r=new D);var n=t.data;return r.set(n[0]*e.x+n[4]*e.y+n[12],n[1]*e.x+n[5]*e.y+n[13])}function ov(){return new D(0,0)}var av=Object.freeze({__proto__:null,GetChebyshevDistance:md,GetDistanceFromSegment:pd,GetVec2ManhattanDistance:gd,GetVec2ManhattanLength:bd,GetVec2Length:ts,GetVec2LengthSquared:wd,Vec2:D,Vec2Abs:Cd,Vec2Add:Vn,Vec2AddScalar:Td,GetVec2Angle:yd,GetVec2AngleY:xd,Vec2Bezier:Sd,Vec2Callback:Ut,Vec2CatmullRom:Rd,Vec2Ceil:Ed,Vec2Center:Ad,Vec2Clamp:zd,Vec2ClampScalar:Fd,Vec2Clone:_d,Vec2CopyFrom:Dd,Vec2Cross:Gd,GetVec2Distance:de,GetVec2DistancePower:Md,GetVec2DistanceSquared:Ln,Vec2Divide:Ld,Vec2DivideScalar:es,Vec2Dot:Za,Vec2Equals:Vd,Vec2Floor:Od,Vec2Fract:Bd,Vec2FromGridIndex:Pd,Vec2FromTransform:rs,Vec2FuzzyEquals:Id,Vec2Hermite:Nd,Vec2Inverse:Ud,Vec2Lerp:kd,Vec2Max:Wd,Vec2Min:jd,Vec2Multiply:Hd,Vec2MultiplyByFloats:Ja,Vec2Negate:Qd,Vec2Normalize:ns,Vec2One:Kd,Vec2PerpDot:Xd,Vec2Random:$d,Vec2Rotate:Yd,Vec2Round:qd,Vec2RoundToZero:Zd,Vec2Scale:Bn,Vec2ScaleAndAdd:Jd,Vec2SetLength:tv,Vec2Subtract:On,Vec2SubtractScalar:ev,Vec2Transform:rv,Vec2TransformMat2d:nv,Vec2TransformMat4:iv,Vec2Zero:ov});function is(e,t){var r=e.x-t.x,n=e.y-t.y,i=e.z-t.z,o=e.w-t.w;return r*r+n*n+i*i+o*o}function sv(e,t){return Math.sqrt(is(e,t))}function Pn(e){var t=e.x,r=e.y,n=e.z,i=e.w;return Math.sqrt(t*t+r*r+n*n+i*i)}function fv(e){var t=e.x,r=e.y,n=e.z,i=e.w;return t*t+r*r+n*n+i*i}function uv(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z)+Math.abs(e.w-t.w)}function hv(e){var t=e.x,r=e.y,n=e.z,i=e.w;return Math.abs(t)+Math.abs(r)+Math.abs(n)+Math.abs(i)}var os=function(){function e(t,r,n,i,o){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0),this._x=r,this._y=n,this._z=i,this._w=o,this.onChange=t}return e.prototype.destroy=function(){this.onChange=Vt},e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this._x=t,this._y=r,this._z=n,this._w=i,this.onChange&&this.onChange(this),this},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){var r=this._x;this._x=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){var r=this._y;this._y=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){var r=this._z;this._z=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"w",{get:function(){return this._w},set:function(t){var r=this._w;this._w=t,r!==t&&this.onChange(this)},enumerable:!1,configurable:!0}),e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y,a=n.z,s=n.w;return t[r]=i,t[r+1]=o,t[r+2]=a,t[r+3]=s,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1],t[r+2],t[r+3])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y,i=t.z,o=t.w;return"{ x="+r+", y="+n+", z="+i+", w="+o+" }"},e}(),cv=function(e){z(t,e);function t(r,n,i,o,a){return n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=1),e.call(this,r,n,i,o,a)||this}return Object.defineProperty(t.prototype,"r",{get:function(){return this.x},set:function(r){this.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this.y},set:function(r){this.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this.z},set:function(r){this.z=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this.w},set:function(r){this.w=r},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var r=this,n=r.x,i=r.y,o=r.z,a=r.w;return"[ r="+n+", g="+i+", b="+o+", a="+a+" ]"},t}(os),Z=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),this.set(t,r,n,i)}return e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=1),this.x=t,this.y=r,this.z=n,this.w=i,this},e.prototype.toArray=function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var n=this,i=n.x,o=n.y,a=n.z,s=n.w;return t[r]=i,t[r+1]=o,t[r+2]=a,t[r+3]=s,t},e.prototype.fromArray=function(t,r){return r===void 0&&(r=0),this.set(t[r],t[r+1],t[r+2],t[r+3])},e.prototype.toString=function(){var t=this,r=t.x,n=t.y,i=t.z,o=t.w;return"{ x="+r+", y="+n+", z="+i+", w="+o+" }"},e}();function lv(e,t){return t===void 0&&(t=new Z),t.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z),Math.abs(e.w))}function as(e,t,r){return r===void 0&&(r=new Z),r.set(e.x+t.x,e.y+t.y,e.z+t.z,e.w+t.w)}function dv(e,t,r){return r===void 0&&(r=new Z),r.set(e.x+t,e.y+t,e.z+t,e.w+t)}function vv(e,t,r,n,i,o){return o===void 0&&(o=new Z),o.set(_t(i,e.x,t.x,r.x,n.x),_t(i,e.y,t.y,r.y,n.y),_t(i,e.z,t.z,r.z,n.z),_t(i,e.w,t.w,r.w,n.w))}function mv(e,t,r,n,i,o){return o===void 0&&(o=new Z),o.set(Mt(i,e.x,t.x,r.x,n.x),Mt(i,e.y,t.y,r.y,n.y),Mt(i,e.z,t.z,r.z,n.z),Mt(i,e.w,t.w,r.w,n.w))}function pv(e,t){t===void 0&&(t=new Z);var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(Math.ceil(r),Math.ceil(n),Math.ceil(i),Math.ceil(o))}function Gr(e,t,r){r===void 0&&(r=new Z);var n=e.x,i=e.y,o=e.z,a=e.w;return r.set(n*t,i*t,o*t,a*t)}function yv(e,t,r){return r===void 0&&(r=new Z),as(e,t,r),Gr(r,.5,r)}function xv(e,t,r,n){return n===void 0&&(n=new Z),n.set(at(e.x,t.x,r.x),at(e.y,t.y,r.y),at(e.z,t.z,r.z),at(e.w,t.w,r.w))}function In(e,t,r){r===void 0&&(r=new Z);var n=e.x,i=e.y,o=e.z,a=e.w;return r.set(n/t,i/t,o/t,a/t)}function Mv(e,t,r,n){n===void 0&&(n=new Z);var i=Pn(e);return In(e,i||1,n),Gr(n,at(t,r,i),n)}function wv(e,t,r,n){return n===void 0&&(n=new Z),n.set(at(e.x,t,r),at(e.y,t,r),at(e.z,t,r),at(e.w,t,r))}function gv(e){var t=e.x,r=e.y,n=e.z,i=e.w;return new Z(t,r,n,i)}function bv(e,t){var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(r,n,i,o)}function Cv(e,t,r,n){n===void 0&&(n=new Z);var i=e.x,o=e.y,a=e.z,s=e.w,f=t.x,u=t.y,h=t.z,c=t.w,m=r.x,d=r.y,v=r.z,g=r.w,p=f*d-u*m,b=f*v-h*m,C=f*g-c*m,S=u*v-h*d,R=u*g-c*d,E=h*g-c*v,_=i,G=o,V=a,P=s;return n.set(G*E-V*R+P*S,-(_*E)+V*C-P*b,_*R-G*C+P*p,-(_*S)+G*b-V*p)}function Tv(e,t,r){return r===void 0&&(r=new Z),r.set(e.x/t.x,e.y/t.y,e.z/t.z,e.w/t.w)}function Sv(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function Rv(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}function Ev(e,t){t===void 0&&(t=new Z);var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(Math.floor(r),Math.floor(n),Math.floor(i),Math.floor(o))}function Av(e,t){return t===void 0&&(t=new Z),t.set(e.x-Math.floor(e.x),e.y-Math.floor(e.y),e.z-Math.floor(e.z),e.w-Math.floor(e.w))}function zv(e,t,r){return r===void 0&&(r=1e-4),wt(e.x,t.x,r)&&wt(e.y,t.y,r)&&wt(e.z,t.z,r)&&wt(e.w,t.w,r)}function Fv(e,t,r,n,i,o){return o===void 0&&(o=new Z),o.set(gt(i,e.x,t.x,r.x,n.x),gt(i,e.y,t.y,r.y,n.y),gt(i,e.z,t.z,r.z,n.z),gt(i,e.w,t.w,r.w,n.w))}function _v(e,t,r,n){n===void 0&&(n=new Z);var i=e.x,o=e.y,a=e.z,s=e.w;return n.set(i+r*(t.x-i),o+r*(t.y-o),a+r*(t.z-a),s+r*(t.w-s))}function Dv(e,t,r){r===void 0&&(r=new Z);var n=e.x,i=e.y,o=e.z,a=e.w,s=t.x,f=t.y,u=t.z,h=t.w;return r.set(Math.max(n,s),Math.max(i,f),Math.max(o,u),Math.max(a,h))}function Gv(e,t,r){r===void 0&&(r=new Z);var n=e.x,i=e.y,o=e.z,a=e.w,s=t.x,f=t.y,u=t.z,h=t.w;return r.set(Math.min(n,s),Math.min(i,f),Math.min(o,u),Math.min(a,h))}function Lv(e,t,r){return r===void 0&&(r=new Z),r.set(e.x*t.x,e.y*t.y,e.z*t.z,e.w*t.w)}function Vv(e,t,r,n,i,o){return o===void 0&&(o=new Z),o.set(e.x*t,e.y*r,e.z*n,e.w*i)}function Ov(e,t){return t===void 0&&(t=new Z),t.set(-e.x,-e.y,-e.z,-e.w)}function ss(e,t){return t===void 0&&(t=new Z),In(e,Pn(e)||1,t)}function Bv(){return new Z(1,1,1,1)}function Pv(e,t,r){t===void 0&&(t=1),r===void 0&&(r=new Z);var n,i,o,a,s,f;do n=Math.random()*2-1,i=Math.random()*2-1,s=n*n+i*i;while(s>=1);do o=Math.random()*2-1,a=Math.random()*2-1,f=o*o+a*a;while(f>=1);var u=Math.sqrt((1-s)/f);return r.set(t*n,t*i,t*o*u,t*a*u)}function Iv(e,t){t===void 0&&(t=new Z);var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(Math.round(r),Math.round(n),Math.round(i),Math.round(o))}function Nv(e,t){t===void 0&&(t=new Z);var r=e.x,n=e.y,i=e.z,o=e.w;return t.set(r<0?Math.ceil(r):Math.floor(r),n<0?Math.ceil(n):Math.floor(n),i<0?Math.ceil(i):Math.floor(i),o<0?Math.ceil(o):Math.floor(o))}function Uv(e,t,r,n){return n===void 0&&(n=new Z),n.set(e.x+t.x*r,e.y+t.y*r,e.z+t.z*r,e.w+t.w*r)}function kv(e,t,r){return r===void 0&&(r=new Z),ss(e,r),Gr(r,t,r)}function Wv(e,t,r){return r===void 0&&(r=new Z),r.set(e.x-t.x,e.y-t.y,e.z-t.z,e.w-t.w)}function jv(e,t,r){r===void 0&&(r=new Z);var n=e.x,i=e.y,o=e.z,a=e.w;return r.set(n-t,i-t,o-t,a-t)}function Hv(e,t,r){r===void 0&&(r=new Z);var n=L(t.data,16),i=n[0],o=n[1],a=n[2],s=n[3],f=n[4],u=n[5],h=n[6],c=n[7],m=n[8],d=n[9],v=n[10],g=n[11],p=n[12],b=n[13],C=n[14],S=n[15],R=e.x,E=e.y,_=e.z,G=e.w;return r.set(i*R+f*E+m*_+p*G,o*R+u*E+d*_+b*G,a*R+h*E+v*_+C*G,s*R+c*E+g*_+S*G)}function Qv(){return new Z(0,0,0,0)}var Kv=Object.freeze({__proto__:null,GetVec4Distance:sv,GetVec4DistanceSquared:is,GetVec4Length:Pn,GetVec4LengthSquared:fv,GetVec4ManhattanDistance:uv,GetVec4ManhattanLength:hv,RGBACallback:cv,Vec4:Z,Vec4Abs:lv,Vec4Add:as,Vec4AddScalar:dv,Vec4Bezier:vv,Vec4Callback:os,Vec4CatmullRom:mv,Vec4Ceil:pv,Vec4Center:yv,Vec4Clamp:xv,Vec4ClampLength:Mv,Vec4ClampScalar:wv,Vec4Clone:gv,Vec4CopyFrom:bv,Vec4Cross:Cv,Vec4Divide:Tv,Vec4DivideScalar:In,Vec4Dot:Sv,Vec4Equals:Rv,Vec4Floor:Ev,Vec4Fract:Av,Vec4FuzzyEquals:zv,Vec4Hermite:Fv,Vec4Lerp:_v,Vec4Max:Dv,Vec4Min:Gv,Vec4Multiply:Lv,Vec4MultiplyByFloats:Vv,Vec4Negate:Ov,Vec4Normalize:ss,Vec4One:Bv,Vec4Random:Pv,Vec4Round:Iv,Vec4RoundToZero:Nv,Vec4Scale:Gr,Vec4ScaleAndAdd:Uv,Vec4SetLength:kv,Vec4Subtract:Wv,Vec4SubtractScalar:jv,Vec4TransformMat4:Hv,Vec4Zero:Qv});function Xv(e){for(var t=0,r=0;r<e.length;r++)t+=+e[r];return t/e.length}function fs(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function $v(e,t,r){t===void 0&&(t=0),r===void 0&&(r=10);var n=Math.pow(r,-t);return Math.ceil(e*n)/n}function Ie(e){return e*ct.DEG_TO_RAD}function Yv(e,t){return Math.abs(e-t)}function qv(e,t){return Math.random()*(t-e)+e}function Zv(e,t,r){t===void 0&&(t=0),r===void 0&&(r=10);var n=Math.pow(r,-t);return Math.floor(e*n)/n}function Ne(e,t,r){return e=at(e,0,1),(r-t)*e}function Jv(e,t){return e/t/1e3}function t0(e,t,r){return Math.min(e+t,r)}function e0(e,t,r){return Math.max(e-t,r)}function r0(e,t,r,n){r===void 0&&(r=t+1);var i=(e-t)/(r-t);return i>1?n!==void 0?(i=(n-e)/(n-r),i<0&&(i=0)):i=1:i<0&&(i=0),i}function n0(e){return e*ct.RAD_TO_DEG}function i0(e,t,r){t===void 0&&(t=0),r===void 0&&(r=10);var n=Math.pow(r,-t);return Math.round(e*n)/n}function o0(e,t,r,n){t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=1),n*=Math.PI/e;for(var i=[],o=[],a=0;a<e;a++)r-=t*n,t+=r*n,i[a]=r,o[a]=t;return{sin:o,cos:i,length:e}}function a0(e,t,r){return Math.abs(e-t)<=r}var s0=Object.freeze({__proto__:null,Angle:Lh,Easing:Ml,Average:Xv,Bernstein:ka,Between:fs,Bezier:_t,CatmullRom:Mt,CeilTo:$v,Clamp:at,DegToRad:Ie,Difference:Yv,Factorial:_r,FloatBetween:qv,FloorTo:Zv,FromPercent:Ne,Fuzzy:Tl,GetSpeed:Jv,Hermite:gt,Interpolation:Il,Linear:Dr,MATH_CONST:ct,Matrix2D:sd,Matrix4:Rh,MaxAdd:t0,MinSub:e0,Percent:r0,Pow2:hd,Quaternion:il,RadToDeg:n0,RoundAwayFromZero:vt,RoundTo:i0,SinCosTableGenerator:o0,SmootherStep:ja,SmoothStep:Wa,Snap:vd,Vec2:av,Vec3:kc,Vec4:Kv,Within:a0,Wrap:pr}),f0=function(){function e(t,r,n,i,o,a){var s=this;t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=45),o===void 0&&(o=.1),a===void 0&&(a=1e3),this.dirtyRender=!0,this.type="Camera3D";var f=A.get();this.renderer=f.renderer,this.position=new Bt(function(){return s.update()},t,r,n),this.direction=new Bt(function(){return s.update()},0,1,0),this._lookAtPosition=new B,this._lookAtView=new I,this._axis=new tt,this.up=Be(),this.left=bn(),this._fov=i,this._near=o,this._far=a,this.aspectRatio=this.renderer.width/this.renderer.height,this.viewMatrix=new I,this.projectionMatrix=mr(Ie(i),this.aspectRatio,o,a),this.lookAt(new B)}return e.prototype.updateProjectionMatrix=function(){return mr(Ie(this._fov),this.aspectRatio,this._near,this._far,this.projectionMatrix),this},e.prototype.lookAt=function(t){var r=this.position,n=this.direction,i=this.left;return br(t,r,n),Dt(n,n),Sn(Cn,n,i),Sn(n,i,this.up),this.update()},e.prototype.rotateOnAxis=function(t,r){var n=this.direction,i=this.left,o=this.up,a=Ma(t,r,this._axis);return Sr(n,a,n),Sr(i,a,i),Sr(o,a,o),Dt(o,o),Dt(i,i),Dt(n,n),this.update()},e.prototype.yaw=function(t){return this.rotateOnAxis(this.up,t)},e.prototype.pitch=function(t){return this.rotateOnAxis(this.left,t)},e.prototype.roll=function(t){return this.rotateOnAxis(this.direction,t)},e.prototype.forward=function(t){var r=this.position,n=r.x,i=r.y,o=r.z,a=this.direction,s=a.x,f=a.y,u=a.z;return r.set(n-t*s,i-t*f,o-t*u),this.update()},e.prototype.update=function(){var t=this._lookAtPosition,r=this._lookAtView,n=this.position;return Tn(n,this.direction,t),$o(n,t,this.up,r),qo(r,-n.x,-n.y,-n.z,this.viewMatrix),this},e.prototype.reset=function(){},e.prototype.destroy=function(){this.position.destroy(),this.direction.destroy(),this.up=null,this.left=null,this.viewMatrix=null,this.projectionMatrix=null,this._lookAtPosition=null,this._lookAtView=null,this._axis=null},Object.defineProperty(e.prototype,"fov",{get:function(){return this._fov},set:function(t){t>0&&t<180&&(this._fov=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(t){t>0&&(this._near=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(t){t>0&&(this._far=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),e}(),u0=Object.freeze({__proto__:null,Camera3D:f0}),ft={BACKGROUND_COLOR:"BackgroundColor",BATCH_SIZE:"BatchSize",DEFAULT_ORIGIN:"DefaultOrigin",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",SIZE:"Size",SCENES:"Scenes",RENDERER:"Renderer",AUTO:"Auto",WEBGL:"WebGL",CANVAS:"Canvas",WEBGL_CONTEXT:"WebGLContext",CANVAS_CONTEXT:"CanvasContext",BANNER:"Banner"},ut=new Map;function us(e){ut.set(ft.BACKGROUND_COLOR,e)}function h0(e){return function(){us(e)}}function hs(e,t,r,n,i){e===void 0&&(e=""),t===void 0&&(t=""),r===void 0&&(r=""),n===void 0&&(n="#fff"),i===void 0&&(i="linear-gradient(#3e0081 40%, #00bcc3)"),ut.set(ft.BANNER,{title:e,version:t,url:r,color:n,background:i})}function c0(e,t,r,n,i){return function(){hs(e,t,r,n,i)}}function cs(e){ut.set(ft.BATCH_SIZE,e)}function l0(e){return function(){cs(e)}}function Ue(){return ut.get(ft.SIZE).height}function ke(){return ut.get(ft.SIZE).resolution}function We(){return ut.get(ft.SIZE).width}function ls(e,t,r){e===void 0&&(e=800),t===void 0&&(t=600),r===void 0&&(r=1),r===0&&(r=window.devicePixelRatio),ut.set(ft.SIZE,{width:e,height:t,resolution:r})}function d0(e,t,r){return e===void 0&&(e=800),t===void 0&&(t=600),r===void 0&&(r=1),function(){ls(e,t,r)}}var Nn=[],Lr={add:function(e,t){Nn.push({texture:e,glConfig:t})},get:function(){return Nn},clear:function(){Nn.length=0}};function ds(){return ut.get(ft.BACKGROUND_COLOR)}function v0(){return ut.get(ft.CANVAS_CONTEXT)}var m0=function(){function e(){this.clearBeforeRender=!0,this.optimizeRedraw=!0,this.autoResize=!0,this.width=We(),this.height=Ue(),this.resolution=ke(),this.setBackgroundColor(ds());var t=document.createElement("canvas");this.canvas=t,this.initContext()}return e.prototype.initContext=function(){var t=this.canvas.getContext("2d",v0());this.ctx=t,this.resize(this.width,this.height,this.resolution)},e.prototype.resize=function(t,r,n){n===void 0&&(n=1),this.width=t*n,this.height=r*n,this.resolution=n;var i=this.canvas;i.width=this.width,i.height=this.height,this.autoResize&&(i.style.width=(this.width/n).toString()+"px",i.style.height=(this.height/n).toString()+"px")},e.prototype.setBackgroundColor=function(t){var r=t>>16&255,n=t>>8&255,i=t&255,o=t>16777215?t>>>24:255;return this.clearColor="rgba("+r+", "+n+", "+i+", "+o+")",this},e.prototype.reset=function(){var t=this.ctx;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0)},e.prototype.render=function(t){Lr.clear();var r=this.ctx;this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0||(this.reset(),this.clearBeforeRender&&(r.clearRect(0,0,this.width,this.height),r.fillStyle=this.clearColor,r.fillRect(0,0,this.width,this.height)))},e.prototype.destroy=function(){},e}();function vs(e){ut.set(ft.RENDERER,e)}function p0(){return function(){vs(m0)}}function y0(e){ut.set(ft.CANVAS_CONTEXT,e)}function x0(e){return function(){y0(e)}}function ms(e,t){e===void 0&&(e=.5),t===void 0&&(t=e),ut.set(ft.DEFAULT_ORIGIN,{x:e,y:t})}function M0(e,t){return e===void 0&&(e=.5),t===void 0&&(t=e),function(){ms(e,t)}}function Un(e){ut.set(ft.MAX_TEXTURES,e)}function w0(e){return e===void 0&&(e=0),function(){Un(e)}}function kn(e){var t;return e&&(typeof e=="string"?t=document.getElementById(e):typeof e=="object"&&e.nodeType===1&&(t=e)),t||(t=document.body),t}function g0(e){e&&ut.set(ft.PARENT,kn(e))}function b0(e){return function(){g0(e)}}function C0(e){ut.set(ft.SCENES,[].concat(e))}function T0(e){return function(){C0(e)}}function S0(e,t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0);var o=new yt(t,r,n,i);return e.viewportStack.push(o),o}var M,ps={get:function(){return M},set:function(e){M=e}};function Wn(e,t){if(!(!t&&(t=e.currentViewport,!t))){var r=M.getParameter(M.VIEWPORT);(r[0]!==t.x||r[1]!==t.y||r[2]!==t.width||r[3]!==t.height)&&M.viewport(t.x,t.y,t.width,t.height)}}function R0(e,t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0);var o=S0(e,t,r,n,i);Wn(e,o),e.currentViewport=o}function jn(e,t,r){t===void 0&&(t=!0),r||(r=e.currentFramebuffer);var n=r.framebuffer,i=r.viewport;M.bindFramebuffer(M.FRAMEBUFFER,n),t&&(M.clearColor(0,0,0,0),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT)),i&&R0(e,i.x,i.y,i.width,i.height)}function E0(e){var t=e.viewportStack;t.length>1&&t.pop(),e.currentViewport=t[t.length-1],Wn(e)}function Vr(e){var t=e.framebufferStack;t.length>1&&(e.currentFramebuffer.viewport&&E0(e),t.pop()),e.currentFramebuffer=t[t.length-1],jn(e,!1)}function A0(e,t,r){var n={framebuffer:t,viewport:r};return e.framebufferStack.push(n),n}function je(e,t,r,n){r===void 0&&(r=!0);var i=A0(e,t,n);jn(e,r,i),e.currentFramebuffer=i}function z0(e){var t=e.count;if(t!==0){var r=e.currentVertexBuffer,n=e.currentShader,i=n.shader.renderToFramebuffer;if(i&&je(e,n.shader.framebuffer,!0),t===r.batchSize){var o=r.isDynamic?M.DYNAMIC_DRAW:M.STATIC_DRAW;M.bufferData(M.ARRAY_BUFFER,r.data,o)}else{var a=r.indexed?t*r.entryElementSize:t*r.vertexElementSize,s=r.vertexViewF32.subarray(0,a);M.bufferSubData(M.ARRAY_BUFFER,0,s)}r.indexed?M.drawElements(M.TRIANGLES,t*r.entryIndexSize,M.UNSIGNED_SHORT,0):M.drawArrays(M.TRIANGLES,0,t),i&&Vr(e)}}function Tt(e,t){t&&(e.count=t);var r=e.count;return r===0?!1:(z0(e),e.prevCount=r,e.count=0,e.flushTotal++,!0)}function F0(e){Tt(e)}function _0(e,t){t===void 0&&(t=[]);var r=e>>16&255,n=e>>8&255,i=e&255,o=e>16777215?e>>>24:255;return t[0]=r/255,t[1]=n/255,t[2]=i/255,t[3]=o/255,t}function D0(){return ut.get(ft.WEBGL_CONTEXT)}function Or(e){var t=e.parent,r=e.flipY,n=e.unpackPremultiplyAlpha,i=e.minFilter,o=e.magFilter,a=e.wrapS,s=e.wrapT,f=e.generateMipmap,u=e.isPOT,h=t.image,c=t.width,m=t.height,d=M.createTexture();return M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,d),M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,r),M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),h?(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,h),c=h.width,m=h.height):M.texImage2D(M.TEXTURE_2D,0,M.RGBA,c,m,0,M.RGBA,M.UNSIGNED_BYTE,null),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,i),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,o),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,a),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,s),f&&u&&M.generateMipmap(M.TEXTURE_2D),e.texture=d,d}function Zt(e){M&&M.isFramebuffer(e)&&M.deleteFramebuffer(e)}function Br(e){M.isTexture(e)&&M.deleteTexture(e)}function ys(e,t){t===void 0&&(t=!0),M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,e);var r=t?M.LINEAR:M.NEAREST;M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,r),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,r)}function xs(e){var t=e.parent.image,r=t.width,n=t.height;return r>0&&n>0&&(M.activeTexture(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,e.texture),M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,e.flipY),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,t)),e.texture}var Pr=function(){function e(t,r){r===void 0&&(r={}),this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=t,this.isPOT=qa(t.width,t.height);var n=r.texture,i=n===void 0?null:n,o=r.framebuffer,a=o===void 0?null:o,s=r.depthbuffer,f=s===void 0?null:s,u=r.unpackPremultiplyAlpha,h=u===void 0?!0:u,c=r.minFilter,m=c===void 0?this.isPOT?M.LINEAR_MIPMAP_LINEAR:M.LINEAR:c,d=r.magFilter,v=d===void 0?M.LINEAR:d,g=r.wrapS,p=g===void 0?M.CLAMP_TO_EDGE:g,b=r.wrapT,C=b===void 0?M.CLAMP_TO_EDGE:b,S=r.generateMipmap,R=S===void 0?this.isPOT:S,E=r.flipY,_=E===void 0?!1:E;this.minFilter=m,this.magFilter=v,this.wrapS=p,this.wrapT=C,this.generateMipmap=R,this.flipY=_,this.unpackPremultiplyAlpha=h,a&&(this.framebuffer=a),f&&(this.depthbuffer=f),i?this.texture=i:Or(this)}return e.prototype.setFilter=function(t){this.texture&&ys(this.texture,t)},e.prototype.create=function(){var t=this.texture;return t&&Br(t),Or(this)},e.prototype.update=function(){var t=this.texture;return t?xs(this):Or(this)},e.prototype.setIndex=function(t){this.dirtyIndex=t!==this.index,this.index=t},e.prototype.destroy=function(){Br(this.texture),Zt(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null},e}();function G0(){var e=Lr.get();e.forEach(function(t){var r=t.texture,n=t.glConfig;r.binding||(r.binding=new Pr(r,n))}),Lr.clear()}function Ms(){return ut.get(ft.MAX_TEXTURES)}var L0=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function V0(e){for(var t="",r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+="if(test == "+r+".0){}");return t}function O0(e){for(var t=M.createShader(M.FRAGMENT_SHADER);;){var r=L0.replace(/%forloop%/gi,V0(e));if(M.shaderSource(t,r),M.compileShader(t),!M.getShaderParameter(t,M.COMPILE_STATUS))e=e/2|0;else break}return e}function B0(e){var t=O0(M.getParameter(M.MAX_TEXTURE_IMAGE_UNITS)),r=Ms();r===0||r>0&&r>t?Un(t):r>0&&r<t&&(t=Math.max(8,r));var n=e.tempTextures;n.length&&n.forEach(function(s){M.deleteTexture(s)});for(var i=[],o=0;o<t;o++){var a=M.createTexture();M.activeTexture(M.TEXTURE0+o),M.bindTexture(M.TEXTURE_2D,a),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),n[o]=a,i.push(o)}e.maxTextures=t,e.textureIndex=i,e.currentActiveTexture=1}function P0(){return ut.get(ft.BATCH_SIZE)}function Ir(e){M.isBuffer(e)&&M.deleteBuffer(e)}var Nr=function(){function e(t){t===void 0&&(t={}),this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;var r=t.batchSize,n=r===void 0?1:r,i=t.dataSize,o=i===void 0?4:i,a=t.isDynamic,s=a===void 0?!0:a,f=t.elementsPerEntry,u=f===void 0?4:f,h=t.vertexElementSize,c=h===void 0?6:h;this.batchSize=n,this.dataSize=o,this.vertexElementSize=c,this.isDynamic=s,this.elementsPerEntry=u,this.vertexByteSize=c*o,this.entryByteSize=this.vertexByteSize*u,this.bufferByteSize=n*this.entryByteSize,this.create()}return e.prototype.resize=function(t){this.batchSize=t,this.bufferByteSize=t*this.entryByteSize,this.vertexBuffer&&Ir(this.vertexBuffer),this.create()},e.prototype.create=function(){var t=new ArrayBuffer(this.bufferByteSize);this.data=t,this.vertexViewF32=new Float32Array(t),this.vertexViewU32=new Uint32Array(t),this.vertexBuffer=M.createBuffer(),M.bindBuffer(M.ARRAY_BUFFER,this.vertexBuffer);var r=this.isDynamic?M.DYNAMIC_DRAW:M.STATIC_DRAW;M.bufferData(M.ARRAY_BUFFER,t,r),M.bindBuffer(M.ARRAY_BUFFER,null)},e.prototype.add=function(t){this.count+=t,this.offset+=this.vertexElementSize*t},e.prototype.reset=function(){this.count=0,this.offset=0},e.prototype.canContain=function(t){return this.count+t<=this.batchSize},e.prototype.free=function(){return Math.max(0,1-this.count/this.batchSize)},e.prototype.bind=function(){M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,null),M.bindBuffer(M.ARRAY_BUFFER,this.vertexBuffer)},e.prototype.destroy=function(){Ir(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null},e}(),ws=function(e){z(t,e);function t(r){r===void 0&&(r={});var n=e.call(this,r)||this,i=r.indexSize,o=i===void 0?4:i,a=r.entryIndexSize,s=a===void 0?6:a,f=r.indexLayout,u=f===void 0?null:f;n.indexed=!0,n.indexSize=o,n.entryIndexSize=s,n.entryElementSize=n.vertexElementSize*n.elementsPerEntry;var h=[];if(u){n.indexLayout=u;for(var c=0;c<n.batchSize*o;c+=o)for(var m=0;m<u.length;m++)h.push(c+u[m])}return n.create(),n.createIndexBuffer(h),n}return t.prototype.createIndexBuffer=function(r){this.index=new Uint16Array(r),this.indexBuffer=M.createBuffer(),M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,this.indexBuffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,this.index,M.STATIC_DRAW),M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,null),r=[]},t.prototype.bind=function(){M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,this.indexBuffer),M.bindBuffer(M.ARRAY_BUFFER,this.vertexBuffer)},t.prototype.destroy=function(){e.prototype.destroy.call(this),Ir(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null},t}(Nr);function I0(e,t){for(var r=new Map,n={size:1,type:M.FLOAT,normalized:!1,stride:0,offset:0},i=M.getProgramParameter(e,M.ACTIVE_ATTRIBUTES),o=0;o<i;o++){var a=M.getActiveAttrib(e,o);if(!a)break;var s=a.name,f=M.getAttribLocation(e,s);M.enableVertexAttribArray(f);var u=t.hasOwnProperty(s)?t[s]:{},h=u.size,c=h===void 0?n.size:h,m=u.type,d=m===void 0?n.type:m,v=u.normalized,g=v===void 0?n.normalized:v,p=u.stride,b=p===void 0?n.stride:p,C=u.offset,S=C===void 0?n.offset:C;r.set(s,{index:f,size:c,type:d,normalized:g,stride:b,offset:S})}return r}function gs(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.forEach(function(r){M.deleteShader(r)})}function N0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=M.createProgram();e.forEach(function(o){M.attachShader(r,o)}),M.linkProgram(r);var n=M.getProgramParameter(r,M.LINK_STATUS);if(!n){var i=M.getProgramInfoLog(r);return console.error("Error linking program: "+i),M.deleteProgram(r),gs.apply(void 0,Y([],L(e))),null}return r}function bs(e,t){var r=M.createShader(t);M.shaderSource(r,e),M.compileShader(r);var n=M.getShaderParameter(r,M.COMPILE_STATUS);if(!n){var i=M.getShaderInfoLog(r),o=e.split(`
`).map(function(a,s){return s+": "+a});return console.error("Error compiling shader: "+i,o.join(`
`)),M.deleteShader(r),null}return r}function U0(e,t,r){switch(r===void 0&&(r=!1),e.type){case M.INT:case M.BOOL:return r?function(n){M.uniform1iv(t,n)}:function(n){M.uniform1i(t,n)};case M.INT_VEC2:case M.BOOL_VEC2:return function(n){M.uniform2iv(t,n)};case M.INT_VEC3:case M.BOOL_VEC3:return function(n){M.uniform3iv(t,n)};case M.INT_VEC4:case M.BOOL_VEC4:return function(n){M.uniform4iv(t,n)};case M.FLOAT:return r?function(n){M.uniform1fv(t,n)}:function(n){M.uniform1f(t,n)};case M.FLOAT_VEC2:return function(n){M.uniform2fv(t,n)};case M.FLOAT_VEC3:return function(n){M.uniform3fv(t,n)};case M.FLOAT_VEC4:return function(n){M.uniform4fv(t,n)};case M.FLOAT_MAT2:return function(n){M.uniformMatrix2fv(t,!1,n)};case M.FLOAT_MAT3:return function(n){M.uniformMatrix3fv(t,!1,n)};case M.FLOAT_MAT4:return function(n){M.uniformMatrix4fv(t,!1,n)};case M.SAMPLER_2D:case M.SAMPLER_CUBE:return e.size>1?function(n){M.uniform1iv(t,n)}:function(n){M.uniform1i(t,n)}}}function k0(e){for(var t=new Map,r=M.getProgramParameter(e,M.ACTIVE_UNIFORMS),n=0;n<r;n++){var i=M.getActiveUniform(e,n),o=i.name;if(!(o.startsWith("gl_")||o.startsWith("webgl_"))){var a=M.getUniformLocation(e,i.name);if(a){var s=!1;o.substr(-3)==="[0]"&&(o=o.substr(0,o.length-3),s=i.size>1),t.set(o,U0(i,a,s))}}}return t}var W0=5121,ve=5126,Hn={aVertexPosition:{size:2,type:ve,normalized:!1,offset:0},aTextureCoord:{size:2,type:ve,normalized:!1,offset:8},aTextureId:{size:1,type:ve,normalized:!1,offset:16},aTintColor:{size:4,type:W0,normalized:!0,offset:20}},j0={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function Cs(e,t,r){M.bindFramebuffer(M.FRAMEBUFFER,e);var n=M.createRenderbuffer();return M.bindRenderbuffer(M.RENDERBUFFER,n),M.renderbufferStorage(M.RENDERBUFFER,M.DEPTH_COMPONENT16,t,r),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,n),M.bindFramebuffer(M.FRAMEBUFFER,null),n}function Ur(e,t){t||(t=M.COLOR_ATTACHMENT0);var r=M.createFramebuffer();return M.bindFramebuffer(M.FRAMEBUFFER,r),M.framebufferTexture2D(M.FRAMEBUFFER,t,M.TEXTURE_2D,e,0),M.bindFramebuffer(M.FRAMEBUFFER,null),r}var H0=`#define SHADER_NAME SINGLE_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`,Q0=`#define SHADER_NAME SINGLE_QUAD_VERT

precision highp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute float aTextureId;
attribute vec4 aTintColor;

uniform mat4 uProjectionMatrix;
uniform mat4 uCameraMatrix;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

void main (void)
{
    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vTintColor = aTintColor;

    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);
}`,Qn=function(){function e(t,r,n,i,o,a){this.trimmed=!1,this.texture=t,this.key=r,this.x=n,this.y=i,this.width=o,this.height=a,this.sourceSizeWidth=o,this.sourceSizeHeight=a,this.updateUVs()}return e.prototype.setPivot=function(t,r){this.pivot={x:t,y:r}},e.prototype.setSize=function(t,r){this.width=t,this.height=r,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.updateUVs()},e.prototype.setSourceSize=function(t,r){this.sourceSizeWidth=t,this.sourceSizeHeight=r},e.prototype.setTrim=function(t,r,n,i,o,a){this.trimmed=!0,this.sourceSizeWidth=t,this.sourceSizeHeight=r,this.spriteSourceSizeX=n,this.spriteSourceSizeY=i,this.spriteSourceSizeWidth=o,this.spriteSourceSizeHeight=a},e.prototype.getExtent=function(t,r){var n=this.sourceSizeWidth,i=this.sourceSizeHeight,o,a,s,f;return this.trimmed?(o=this.spriteSourceSizeX-t*n,a=o+this.spriteSourceSizeWidth,s=this.spriteSourceSizeY-r*i,f=s+this.spriteSourceSizeHeight):(o=-t*n,a=o+n,s=-r*i,f=s+i),{left:o,right:a,top:s,bottom:f}},e.prototype.setExtent=function(t){var r=t.transform,n=r.origin.x,i=r.origin.y,o=this.sourceSizeWidth,a=this.sourceSizeHeight,s,f,u,h;this.trimmed?(s=this.spriteSourceSizeX-n*o,f=this.spriteSourceSizeY-i*a,u=this.spriteSourceSizeWidth,h=this.spriteSourceSizeHeight):(s=-n*o,f=-i*a,u=o,h=a),r.setExtent(s,f,u,h)},e.prototype.updateUVs=function(){var t=this,r=t.x,n=t.y,i=t.width,o=t.height,a=this.texture.width,s=this.texture.height;this.u0=r/a,this.v0=n/s,this.u1=(r+i)/a,this.v1=(n+o)/s},e}(),mt=function(){function e(t,r,n,i){this.key="",t&&(r=t.width,n=t.height),this.image=t,this.width=r,this.height=n,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,r,n),Lr.add(this,i)}return e.prototype.addFrame=function(t,r,n,i,o){if(this.frames.has(t))return null;var a=new Qn(this,t,r,n,i,o);return this.frames.set(t,a),(!this.firstFrame||this.firstFrame.key==="__BASE")&&(this.firstFrame=a),a},e.prototype.getFrame=function(t){if(!t)return this.firstFrame;t instanceof Qn&&(t=t.key);var r=this.frames.get(t);return r||(console.warn("Frame missing: "+t),r=this.firstFrame),r},e.prototype.setSize=function(t,r){this.width=t,this.height=r;var n=this.frames.get("__BASE");n.setSize(t,r)},e.prototype.destroy=function(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null},e}(),Ts=function(){function e(t){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,t&&this.fromConfig(t)}return e.prototype.fromConfig=function(t){var r=t.attributes,n=r===void 0?Hn:r,i=t.fragmentShader,o=i===void 0?H0:i,a=t.height,s=a===void 0?Ue():a,f=t.renderToFramebuffer,u=f===void 0?!1:f,h=t.renderToDepthbuffer,c=h===void 0?!1:h,m=t.resolution,d=m===void 0?ke():m,v=t.vertexShader,g=v===void 0?Q0:v,p=t.width,b=p===void 0?We():p,C=t.uniforms,S=C===void 0?j0:C;if(this.create(o,g,S,n),u){this.renderToFramebuffer=!0;var R=new mt(null,b*d,s*d),E=new Pr(R);R.binding=E,E.framebuffer=Ur(E.texture),c&&(this.renderToDepthbuffer=!0,E.depthbuffer=Cs(E.framebuffer,R.width,R.height)),this.texture=R,this.framebuffer=E.framebuffer}},e.prototype.create=function(t,r,n,i){var o,a,s=bs(t,M.FRAGMENT_SHADER),f=bs(r,M.VERTEX_SHADER);if(!(!s||!f)){var u=N0(s,f);if(!!u){var h=M.getParameter(M.CURRENT_PROGRAM);M.useProgram(u),this.program=u,this.uniformSetters=k0(u),this.uniforms=new Map;try{for(var c=U(Object.entries(n)),m=c.next();!m.done;m=c.next()){var d=L(m.value,2),v=d[0],g=d[1];this.uniforms.set(v,g)}}catch(p){o={error:p}}finally{try{m&&!m.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}this.attributes=I0(u,i),M.useProgram(h)}}},e.prototype.updateUniforms=function(t){},e.prototype.bind=function(t){return this.updateUniforms(t),this.setUniforms(t)},e.prototype.setUniform=function(t,r){var n=this.uniforms;if(n.has(t)){n.set(t,r);var i=this.uniformSetters.get(t);i(r)}},e.prototype.setUniforms=function(t){var r,n;if(!this.program)return!1;M.useProgram(this.program);var i=this.uniforms;try{for(var o=U(this.uniformSetters.entries()),a=o.next();!a.done;a=o.next()){var s=L(a.value,2),f=s[0],u=s[1];u(i.get(f))}}catch(h){r={error:h}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!0},e.prototype.setAttributes=function(t){if(this.program){var r=t.currentVertexBuffer.vertexByteSize;this.attributes.forEach(function(n){M.vertexAttribPointer(n.index,n.size,n.type,n.normalized,r,n.offset)})}},e.prototype.destroy=function(){gs(this.program),Br(this.texture),Zt(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null},e}(),Kn=function(e){z(t,e);function t(r){r===void 0&&(r={});var n=this,i=r;return i.attributes=i.attributes?i.attributes:Hn,n=e.call(this,i)||this,n}return t.prototype.bind=function(r){var n=this.uniforms;return n.set("uProjectionMatrix",r.projectionMatrix.data),n.set("uCameraMatrix",r.cameraMatrix.data),e.prototype.bind.call(this,r)},t}(Ts);(function(e){z(t,e);function t(r){r===void 0&&(r={});var n=this,i=r;return i.attributes=i.attributes?i.attributes:Hn,i.renderToFramebuffer=!0,n=e.call(this,i)||this,n}return t.prototype.bind=function(r){var n=r.renderer;return this.uniforms.set("uTime",performance.now()),this.uniforms.set("uResolution",[n.width,n.height]),e.prototype.bind.call(this,r)},t})(Kn);var K0=`#define SHADER_NAME MULTI_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture[%count%];

void main (void)
{
    vec4 color;

    %forloop%

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`,X0=function(e){z(t,e);function t(r){r===void 0&&(r={});var n=this;return r.fragmentShader||(r.fragmentShader=K0),n=e.call(this,r)||this,n}return t.prototype.create=function(r,n,i,o){for(var a=Ms(),s="",f=1;f<a;f++)f>1&&(s+=`
	else `),f<a-1&&(s+="if (vTextureId < "+f+".5)"),s+=`
	{`,s+=`
		color = texture2D(uTexture[`+f+"], vTextureCoord);",s+=`
	}`;r=r.replace(/%count%/gi,""+a),r=r.replace(/%forloop%/gi,s),e.prototype.create.call(this,r,n,i,o)},t.prototype.bind=function(r){return this.uniforms.set("uTexture",r.textureIndex),e.prototype.bind.call(this,r)},t}(Kn);function $0(e,t,r,n){var i={enable:t,sfactor:r,dfactor:n};e.blendModeStack[0]=i,e.currentBlendMode=i,e.defaultBlendMode=i}function Y0(e,t,r){t===void 0&&(t=null);var n={framebuffer:t,viewport:r};e.framebufferStack[0]=n,e.currentFramebuffer=n,e.defaultFramebuffer=n}function q0(e,t,r){var n={shader:t,textureID:r};e.shaderStack[0]=n,e.currentShader=n,e.defaultShader=n}function Z0(e,t){e.vertexBufferStack[0]=t,e.currentVertexBuffer=t,e.defaultVertexBuffer=t}function J0(e,t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0);var o=new yt(t,r,n,i);e.viewportStack[0]=o,e.currentViewport=o,e.defaultViewport=o}var tm=function(){function e(t){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=t,this.projectionMatrix=new I,this.reset()}return e.prototype.reset=function(){var t=this.renderer.gl,r=[0,1,2,2,3,0];this.quadShader=new Kn,this.quadBuffer=new ws({isDynamic:!1,indexLayout:r}),this.quadCamera=new gn,B0(this),Y0(this),$0(this,!0,t.ONE,t.ONE_MINUS_SRC_ALPHA),Z0(this,new ws({batchSize:P0(),indexLayout:r})),q0(this,new X0)},e.prototype.resize=function(t,r){Yo(0,t,r,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),J0(this,0,0,t,r)},e}();function em(e,t,r){var n={shader:t,textureID:r};return e.shaderStack.push(n),n}function rm(e,t){return e.vertexBufferStack.push(t),t}function Xn(e,t){t||(t=e.currentShader);var r=t.shader.bind(e,t.textureID);r&&t.shader.setAttributes(e)}function nm(e,t){e.current2DCamera=t,e.cameraMatrix=t.matrix,Xn(e)}function im(e,t){t||(t=e.currentBlendMode),t.enable?(M.enable(M.BLEND),M.blendFunc(t.sfactor,t.dfactor)):M.disable(M.BLEND)}function om(e,t){t===void 0&&(t=0);var r=e.binding;r.setIndex(t),M.activeTexture(M.TEXTURE0+t),M.bindTexture(M.TEXTURE_2D,r.texture)}function $n(e,t){t||(t=e.currentVertexBuffer);var r=t.indexed?t.indexBuffer:null;M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,r),M.bindBuffer(M.ARRAY_BUFFER,t.vertexBuffer)}function Ss(e){var t=e.vertexBufferStack;t.length>1&&t.pop(),e.currentVertexBuffer=t[t.length-1],$n(e)}function Rs(e,t){var r=rm(e,t);$n(e,r),e.currentVertexBuffer=r}function am(e,t){Rs(e,t),e.currentShader.shader.setAttributes(e);var r=Tt(e,t.count);return Ss(e),r}function Es(e,t){t===void 0&&(t=0);var r=e.currentVertexBuffer;e.count+t>=r.batchSize&&Tt(e);var n=r.indexed?e.count*r.entryElementSize:e.count*r.vertexElementSize;return e.count+=t,{buffer:r,F32:r.vertexViewF32,U32:r.vertexViewU32,offset:n}}function As(e){var t=e.shaderStack;t.length>1&&t.pop(),e.currentShader=t[t.length-1],Xn(e)}function zs(e,t,r){var n=em(e,t,r);Xn(e,n),e.currentShader=n}function Fs(e,t){var r=t.binding,n=e.currentActiveTexture;return r.indexCounter<e.startActiveTexture&&(r.indexCounter=e.startActiveTexture,n<e.maxTextures?(r.setIndex(n),M.activeTexture(M.TEXTURE0+n),M.bindTexture(M.TEXTURE_2D,r.texture),e.currentActiveTexture++):(Tt(e),e.startActiveTexture++,r.indexCounter=e.startActiveTexture,r.setIndex(1),M.activeTexture(M.TEXTURE1),M.bindTexture(M.TEXTURE_2D,r.texture),e.currentActiveTexture=2)),r.index}function sm(e){e.current2DCamera=e.quadCamera,e.cameraMatrix=e.quadCamera.matrix,e.count=0,e.flushTotal=0,jn(e,!1,e.defaultFramebuffer),im(e,e.defaultBlendMode),Wn(e,e.defaultViewport),$n(e,e.defaultVertexBuffer)}function fm(e,t){t===void 0&&(t=0),M.activeTexture(M.TEXTURE0+t),M.bindTexture(M.TEXTURE_2D,e.tempTextures[t]),t>0&&e.startActiveTexture++}var _s=function(){function e(){var t=this;this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=We(),this.height=Ue(),this.resolution=ke(),this.setBackgroundColor(ds());var r=document.createElement("canvas");r.addEventListener("webglcontextlost",function(n){return t.onContextLost(n)},!1),r.addEventListener("webglcontextrestored",function(){return t.onContextRestored()},!1),this.canvas=r,this.initContext(),this.renderPass=new tm(this),this.resize(this.width,this.height,this.resolution)}return e.prototype.initContext=function(){var t=this.canvas.getContext("webgl",D0());ps.set(t),this.gl=t,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE)},e.prototype.resize=function(t,r,n){n===void 0&&(n=1);var i=t*n,o=r*n;this.width=i,this.height=o,this.resolution=n;var a=this.canvas;a.width=i,a.height=o,this.autoResize&&(a.style.width=t.toString()+"px",a.style.height=r.toString()+"px"),this.renderPass.resize(i,o)},e.prototype.onContextLost=function(t){t.preventDefault(),this.contextLost=!0},e.prototype.onContextRestored=function(){this.contextLost=!1,this.initContext()},e.prototype.setBackgroundColor=function(t){return _0(t,this.clearColor),this},e.prototype.reset=function(){},e.prototype.render=function(t){if(!this.contextLost){var r=this.gl,n=this.renderPass;if(G0(),!(this.optimizeRedraw&&t.numDirtyFrames===0&&t.numDirtyCameras===0)){if(this.clearBeforeRender){var i=this.clearColor;r.clearColor(i[0],i[1],i[2],i[3]),r.clear(r.COLOR_BUFFER_BIT)}var o=t.worldData;sm(n);for(var a=0;a<o.length;a++){var s=o[a].world;s.renderGL(n),s.postRenderGL(n)}F0(n)}}},e.prototype.destroy=function(){},e}();function um(){return function(){vs(_s)}}function hm(e){ut.set(ft.WEBGL_CONTEXT,e)}function cm(e){return function(){hm(e)}}var lm=Object.freeze({__proto__:null,BackgroundColor:h0,Banner:c0,BatchSize:l0,Canvas:p0,CanvasContext:x0,DefaultOrigin:M0,MaxTextures:w0,Parent:b0,Scenes:T0,Size:d0,WebGL:um,WebGLContext:cm});function Ds(e,t){var r=kn(t);return r.appendChild(e),e}function Gs(e){var t=document.readyState;if(t==="complete"||t==="interactive"){e();return}var r=function(){document.removeEventListener("deviceready",r,!0),document.removeEventListener("DOMContentLoaded",r,!0),window.removeEventListener("load",r,!0),e()};document.body?window.hasOwnProperty("cordova")?document.addEventListener("deviceready",r,!0):(document.addEventListener("DOMContentLoaded",r,!0),window.addEventListener("load",r,!0)):window.setTimeout(r,20)}function Ls(e){var t;try{var r=new DOMParser;return t=r.parseFromString(e,"text/xml"),!t||!t.documentElement||t.getElementsByTagName("parsererror").length?null:t}catch(n){return null}}function dm(e){e.parentNode&&e.parentNode.removeChild(e)}var vm=Object.freeze({__proto__:null,AddToDOM:Ds,DOMContentLoaded:Gs,GetElement:kn,ParseXML:Ls,RemoveFromDOM:dm}),Yn;function Gt(e,t){return t||(Yn||(Yn=document.createElement("audio")),t=Yn),t&&t.canPlayType(e)!==""}function qn(e){return Gt("audio/x-m4a",e)||Gt("audio/aac",e)}function Zn(e){return Gt('audio/mpeg; codecs="mp3"',e)}function Jn(e){return Gt('audio/ogg; codecs="vorbis"',e)}function ti(e){return Gt('audio/ogg; codecs="opus"',e)||Gt('audio/webm; codecs="opus"',e)}function ei(e){return Gt('audio/wav; codecs="1"',e)}function ri(e){return Gt('audio/webm; codecs="vorbis"',e)}function ni(){return window&&window.hasOwnProperty("Audio")}function ii(){return window&&(window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"))}function Vs(){var e={audioData:ni(),m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:ii(),webm:!1};return e.audioData&&(e.m4a=qn(),e.mp3=Zn(),e.ogg=Jn(),e.opus=ti(),e.wav=ei(),e.webm=ri()),e}var mm=Object.freeze({__proto__:null,CanPlayAudioType:Gt,CanPlayM4A:qn,CanPlayMP3:Zn,CanPlayOGG:Jn,CanPlayOpus:ti,CanPlayWAV:ei,CanPlayWebM:ri,GetAudio:Vs,HasAudio:ni,HasWebAudio:ii});function oi(){var e=/Chrome\/(\d+)/.test(navigator.userAgent),t=e?parseInt(RegExp.$1,10):0;return{chrome:e,chromeVersion:t}}function ai(){var e=/Edge\/\d+/.test(navigator.userAgent);return{edge:e}}function si(){var e=/Firefox\D+(\d+)/.test(navigator.userAgent),t=e?parseInt(RegExp.$1,10):0;return{firefox:e,firefoxVersion:t}}function fi(){var e=/MSIE (\d+\.\d+);/.test(navigator.userAgent),t=e?parseInt(RegExp.$1,10):0;return{ie:e,ieVersion:t}}function kr(){var e=navigator.userAgent,t={iOS:!1,iOSVersion:0,iPhone:!1,iPad:!1};if(/iP[ao]d|iPhone/i.test(e)){var r=/OS (\d+)/.exec(navigator.appVersion);t.iOS=!0,t.iOSVersion=parseInt(r[0],10),t.iPhone=e.toLowerCase().includes("iphone"),t.iPad=e.toLowerCase().includes("ipad")}return t}function ui(){var e=kr().iOS,t=navigator.userAgent.includes("AppleWebKit")&&e;return{mobileSafari:t}}function hi(){var e=navigator.userAgent.includes("Opera");return{opera:e}}function Wr(){var e=navigator.userAgent;return/Windows Phone/i.test(e)||/IEMobile/i.test(e)}function ci(){var e=navigator.userAgent,t=e.includes("Safari")&&!Wr(),r=/Version\/(\d+)\./.test(e)?parseInt(RegExp.$1,10):0;return{safari:t,safariVersion:r}}function li(){var e=navigator.userAgent.includes("Silk");return{silk:e}}function di(){var e=/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(navigator.userAgent),t=e?parseInt(RegExp.$1,10):0,r=e?parseInt(RegExp.$3,10):0;return{trident:e,tridentVersion:t,tridentIEVersion:r}}function Os(){var e=oi(),t=e.chrome,r=e.chromeVersion,n=ai().edge,i=si(),o=i.firefox,a=i.firefoxVersion,s=fi(),f=s.ie,u=s.ieVersion,h=ui().mobileSafari,c=hi().opera,m=ci(),d=m.safari,v=m.safariVersion,g=li().silk,p=di(),b=p.trident,C=p.tridentVersion,S=p.tridentIEVersion;b&&(f=!0,u=S);var R={chrome:t,chromeVersion:r,edge:n,firefox:o,firefoxVersion:a,ie:f,ieVersion:u,mobileSafari:h,opera:c,safari:d,safariVersion:v,silk:g,trident:b,tridentVersion:C};return R}var pm=Object.freeze({__proto__:null,GetBrowser:Os,IsChrome:oi,IsEdge:ai,IsFirefox:si,IsMobileSafari:ui,IsMSIE:fi,IsOpera:hi,IsSafari:ci,IsSilk:li,IsTrident:di});function vi(){return navigator.userAgent.includes("Android")}function mi(){return navigator.userAgent.includes("CrOS")}function pi(){return window.hasOwnProperty("cordova")}function yi(){return navigator.userAgent.includes("Crosswalk")}function xi(){return window.hasOwnProperty("ejecta")}function Mi(){var e=navigator.userAgent;return e.includes("Kindle")||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)}function wi(){return navigator.userAgent.includes("Linux")}function gi(){var e=navigator.userAgent;return e.includes("Mac OS")&&!e.includes("like Mac OS")}function jr(){return typeof process!="undefined"&&typeof process.versions=="object"&&process.versions.hasOwnProperty("node")}function bi(){return jr()&&!!process.versions.hasOwnProperty("node-webkit")}function Ci(){return navigator.hasOwnProperty("standalone")}function Ti(){return navigator.userAgent.includes("Windows")}function Bs(){var e=navigator.userAgent,t=kr(),r=t.iOS,n=t.iOSVersion,i=t.iPad,o=t.iPhone,a={android:vi(),chromeOS:mi(),cordova:pi(),crosswalk:yi(),desktop:!1,ejecta:xi(),iOS:r,iOSVersion:n,iPad:i,iPhone:o,kindle:Mi(),linux:wi(),macOS:gi(),node:jr(),nodeWebkit:bi(),pixelRatio:1,webApp:Ci(),windows:Ti(),windowsPhone:Wr()};a.windowsPhone&&(a.android=!1,a.iOS=!1,a.macOS=!1,a.windows=!0);var s=e.includes("Silk");return(a.windows||a.macOS||a.linux&&!s||a.chromeOS)&&(a.desktop=!0),(a.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(a.desktop=!1),a}var ym=Object.freeze({__proto__:null,GetOS:Bs,IsAndroid:vi,IsChromeOS:mi,IsCordova:pi,IsCrosswalk:yi,IsEjecta:xi,IsiOS:kr,IsKindle:Mi,IsLinux:wi,IsMacOS:gi,IsNode:jr,IsNodeWebkit:bi,IsWebApp:Ci,IsWindows:Ti,IsWindowsPhone:Wr}),Si;function Jt(e,t){return t||(Si||(Si=document.createElement("video")),t=Si),t&&t.canPlayType(e)!==""}function Ri(e){return Jt('video/mp4; codecs="avc1.42E01E"',e)}function Ei(e){return Jt('application/x-mpegURL; codecs="avc1.42E01E"',e)}function Ai(e){return Jt('video/ogg; codecs="theora"',e)}function zi(e){return Jt('video/webm; codecs="vp9"',e)}function Fi(e){return Jt('video/webm; codecs="vp8, vorbis"',e)}function Ps(){return{h264Video:Ri(),hlsVideo:Ei(),oggVideo:Ai(),vp9Video:zi(),webmVideo:Fi()}}var xm=Object.freeze({__proto__:null,CanPlayH264Video:Ri,CanPlayHLSVideo:Ei,CanPlayOGGVideo:Ai,CanPlayVP9Video:zi,CanPlayVideoType:Jt,CanPlayWebMVideo:Fi,GetVideo:Ps}),Mm=Object.freeze({__proto__:null,Audio:mm,Browser:pm,OS:ym,Video:xm,CanPlayAudioType:Gt,CanPlayM4A:qn,CanPlayMP3:Zn,CanPlayOGG:Jn,CanPlayOpus:ti,CanPlayWAV:ei,CanPlayWebM:ri,GetAudio:Vs,HasAudio:ni,HasWebAudio:ii,GetBrowser:Os,IsChrome:oi,IsEdge:ai,IsFirefox:si,IsMobileSafari:ui,IsMSIE:fi,IsOpera:hi,IsSafari:ci,IsSilk:li,IsTrident:di,GetOS:Bs,IsAndroid:vi,IsChromeOS:mi,IsCordova:pi,IsCrosswalk:yi,IsEjecta:xi,IsiOS:kr,IsKindle:Mi,IsLinux:wi,IsMacOS:gi,IsNode:jr,IsNodeWebkit:bi,IsWebApp:Ci,IsWindows:Ti,IsWindowsPhone:Wr,CanPlayH264Video:Ri,CanPlayHLSVideo:Ei,CanPlayOGGVideo:Ai,CanPlayVP9Video:zi,CanPlayVideoType:Jt,CanPlayWebMVideo:Fi,GetVideo:Ps});function me(e){for(var t=[e],r=[];t.length>0;){var n=t.shift();r.push(n);var i=n.numChildren;if(i>0)for(var o=i-1;o>=0;o--)t.unshift(n.children[o])}return r.shift(),r}function Pt(e,t){return e.children.indexOf(t)}function _i(e,t){var r=e.children,n;if(t>=0&&t<r.length){var i=r.splice(t,1);i[0]&&(n=i[0],n.parent=null)}return n}function Di(e,t){var r=Pt(e,t);return r>-1&&_i(e,r),t}var Hr="addedtoworld",Qr="destroy",Is="postupdate",Kr="removedfromworld",Ns="update";function H(e,t){for(var r,n,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(e.events.size===0||!e.events.has(t))return!1;var a=e.events.get(t);try{for(var s=U(a),f=s.next();!f.done;f=s.next()){var u=f.value;u.callback.apply(u.context,i),u.once&&a.delete(u)}}catch(h){r={error:h}}finally{try{f&&!f.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return a.size===0&&e.events.delete(t),!0}function Us(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.world&&(H(n.world,Kr,n,n.world),H(n,Kr,n,n.world)),n.world=e,H(e,Hr,n,e),H(n,Hr,n,e)}),t}function He(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.forEach(function(i){i.parent&&Di(i.parent,i),i.parent=e});var n=e.world;return n&&Us.apply(void 0,Y([n],L(me(e)))),t}function ks(e,t){return e.children.push(t),He(e,t),t.transform.updateWorld(),t}function wm(e,t,r){var n=e.children;return t>=0&&t<=n.length&&(He(e,r),n.splice(t,0,r),r.transform.updateWorld()),r}function gm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){ks(e,n)}),t}function bm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e.children;return t>=0&&t<=i.length&&r.reverse().forEach(function(o){r.splice(t,0,o),He(e,o),o.transform.updateWorld()}),r}function Cm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.x+=e,i.y+=t}),r}function Tm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.rotation+=e}),t}function Sm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.scaleX+=e,i.scaleY+=t}),r}function Rm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.skewX+=e,i.skewY+=t}),r}var j={CLEAR:0,TRANSFORM:1,UPDATE:2,CHILD_CACHE:4,POST_RENDER:8,COLORS:16,BOUNDS:32,TEXTURE:64,FRAME:128,ALPHA:256,CHILD:512,DEFAULT:1+2+16+32,USER1:536870912,USER2:1073741824,USER3:2147483648,USER4:4294967296};function Em(e,t){var r=e.children,n=Pt(e,t);return n!==-1&&n<r.length&&(r.splice(n,1),r.push(t),t.setDirty(j.TRANSFORM)),t}function Gi(e,t){t===void 0&&(t=[]);for(var r=0;r<e.numChildren;r++){var n=e.children[r],i=[];t.push({node:n,children:i}),n.numChildren>0&&Gi(n,i)}return t}function Xr(e){var t=e.numChildren>0?"Parent":"Child";return t+" [ type="+e.type+", name="+e.name+" ]"}function Ws(e){console.group(Xr(e.node)),e.children.forEach(function(t){t.children.length>0?Ws(t):console.log(Xr(t.node))}),console.groupEnd()}function Am(e){var t=Gi(e);e.world===e?console.group("World"):console.group(Xr(e)),t.forEach(function(r){r.children.length?Ws(r):console.log(Xr(r.node))}),console.groupEnd()}function zm(e,t,r){var n=e.children,i=0;return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i++}),i}function js(e,t){t===void 0&&(t=[]);for(var r=0;r<e.numChildren;r++){var n=e.children[r];t.push(n),n.numChildren>0&&js(n,t)}return t}function Li(e,t,r){t===void 0&&(t=0);var n=e.children;r===void 0&&(r=n.length);var i=r-t;if(i>0&&i<=r){var o=n.splice(t,i);return o.forEach(function(a){a.parent=null}),o}else return[]}function Hs(e,t,r){t===void 0&&(t=0);var n=Li(e,t,r);n.forEach(function(i){i.destroy()})}function Fm(e,t){for(var r=me(e),n=RegExp(t),i=0;i<r.length;i++){var o=r[i];if(n.test(o.name))return o}}function _m(e,t){var r=me(e),n=RegExp(t),i=[];return r.forEach(function(o){n.test(o.name)&&i.push(o)}),i}function Dm(e,t,r){var n=me(e);if(!t)return n;var i=[];return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i.push(o)}),i}function Gm(e,t){var r=e.children;if(t<0||t>r.length)throw new Error("Index out of bounds: "+t);return r[t]}function Lm(e,t,r){var n=e.children;if(!t)return Y([],L(n));var i=[];return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i.push(o)}),i}function Vm(e,t){var r=e.children,n=null,i=0;return r.forEach(function(o){var a=de(t,o.transform.position);(!n||a<i)&&(n=o,i=a)}),n}function Om(e,t,r){for(var n=e.children,i=0;i<n.length;i++){var o=n[i],a=Object.getOwnPropertyDescriptor(o,t);if(a&&(r===void 0||r===a.value))return o}}function Bm(e,t){var r=e.children,n=null,i=0;return r.forEach(function(o){var a=de(t,o.transform.position);(!n||a>i)&&(n=o,i=a)}),n}function Pm(e,t,r){for(var n=e.children,i=n.length-1;i>=0;i--){var o=n[i],a=Object.getOwnPropertyDescriptor(o,t);if(a&&(r===void 0||r===a.value))return o}}function Im(e){for(var t=[];e.parent;)t.push(e.parent),e=e.parent;return t}function Nm(e,t,r){t===void 0&&(t=0);var n=e.children;r||(r=n.length);var i=t+Math.floor(Math.random()*r);return n[i]}function Um(e,t){var r=e.children,n=Pt(e,t);if(n>0){var i=r[n-1],o=r.indexOf(i);r[n]=i,r[o]=t,t.setDirty(j.TRANSFORM),i.setDirty(j.TRANSFORM)}return t}function km(e,t,r){var n=e.children,i=Pt(e,t);if(i===-1||r<0||r>=n.length)throw new Error("Index out of bounds");return i!==r&&(n.splice(i,1),n.splice(r,0,t),t.setDirty(j.TRANSFORM)),t}function Wm(e,t){var r=e.children,n=Pt(e,t);if(n!==-1&&n>0){var i=r[n+1],o=r.indexOf(i);r[n]=i,r[o]=t,t.setDirty(j.TRANSFORM),i.setDirty(j.TRANSFORM)}return t}function Qe(e,t){return e.width<=0||e.height<=0||t.width<=0||t.height<=0?!1:!(e.right<t.x||e.bottom<t.y||e.x>t.right||e.y>t.bottom)}function jm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=e.bounds.get(),i=0;i<t.length;i++){var o=t[i],a=o.bounds.get();if(Qe(n,a))return!0}return!1}function Qs(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){Di(e,n)}),t}function Hm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[];return t.sort(function(i,o){return i-o}),t.reverse().forEach(function(i){var o=_i(e,i);o&&n.push(o)}),n}function Ks(e,t,r,n){r===void 0&&(r=0);var i=Li(e,r,n);return He.apply(void 0,Y([t],L(i))),i.forEach(function(o){o.transform.updateWorld()}),i}function Qm(e,t){t===void 0&&(t=1);for(var r=e.children,n=null,i=0;i<t;i++)n=r.shift(),r.push(n),n.setDirty(j.TRANSFORM);return n}function Km(e,t){t===void 0&&(t=1);for(var r=e.children,n=null,i=0;i<t;i++)n=r.pop(),r.unshift(n),n.setDirty(j.TRANSFORM);return n}function Xm(e,t){var r=e.children,n=Pt(e,t);return n!==-1&&n>0&&(r.splice(n,1),r.unshift(t),t.setDirty(j.TRANSFORM)),t}function $m(e,t,r,n){for(var i=[],o=4;o<arguments.length;o++)i[o-4]=arguments[o];return i.forEach(function(a){a.bounds.set(e,t,r,n)}),i}function Ym(e,t,r){var n=me(e);return n.forEach(function(i){var o=Object.getOwnPropertyDescriptor(i,t);o&&o.set(r)}),n}function qm(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.name=e}),t}function Zm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.setOrigin(e,t)}),r}function Jm(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.setPosition(e,t)}),r}function tp(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.rotation=e}),t}function ep(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.setScale(e,t)}),r}function rp(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.setSize(e,t)}),r}function np(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){i.setSkew(e,t)}),r}function ip(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.type=e}),t}function op(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return r.forEach(function(i){var o=Object.getOwnPropertyDescriptor(i,e);o&&o.set(t)}),r}function ap(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.visible=e}),t}function sp(e){for(var t=e.children,r=t.length-1;r>0;r--){var n=Math.floor(Math.random()*(r+1)),i=t[r];t[r]=t[n],t[n]=i,i.setDirty(j.TRANSFORM)}return t}function fp(e,t){if(e.parent===t.parent){var r=e.parent.children,n=Pt(e.parent,e),i=Pt(t.parent,t);n!==i&&(r[n]=t,r[i]=e)}}var up=Object.freeze({__proto__:null,AddChild:ks,AddChildAt:wm,AddChildren:gm,AddChildrenAt:bm,AddPosition:Cm,AddRotation:Tm,AddScale:Sm,AddSkew:Rm,BringChildToTop:Em,ConsoleTreeChildren:Am,CountMatchingChildren:zm,DepthFirstSearch:me,DepthFirstSearchRecursive:js,DepthFirstSearchRecursiveNested:Gi,DestroyChildren:Hs,FindChildByName:Fm,FindChildrenByName:_m,GetAllChildren:Dm,GetChildAt:Gm,GetChildIndex:Pt,GetChildren:Lm,GetClosestChild:Vm,GetFirstChild:Om,GetFurthestChild:Bm,GetLastChild:Pm,GetParents:Im,GetRandomChild:Nm,MoveChildDown:Um,MoveChildTo:km,MoveChildUp:Wm,Overlap:jm,RemoveChild:Di,RemoveChildAt:_i,RemoveChildren:Qs,RemoveChildrenAt:Hm,RemoveChildrenBetween:Li,ReparentChildren:Ks,RotateChildrenLeft:Qm,RotateChildrenRight:Km,SendChildToBack:Xm,SetBounds:$m,SetChildrenValue:Ym,SetName:qm,SetOrigin:Zm,SetParent:He,SetPosition:Jm,SetRotation:tp,SetScale:ep,SetSize:rp,SetSkew:np,SetType:ip,SetValue:op,SetVisible:ap,SetWorld:Us,ShuffleChildren:sp,SwapChildren:fp});function pe(e){for(var t=[e],r=[];t.length>0;){var n=t.shift();r.push(n);var i=n.numChildren;if(i>0)for(var o=i-1;o>=0;o--)t.unshift(n.children[o])}return r.shift(),r}function ye(e,t){return e.children.indexOf(t)}function Vi(e,t){var r=e.children,n;if(t>=0&&t<r.length){var i=r.splice(t,1);i[0]&&(n=i[0],n.parent=null)}return n}function xe(e,t){var r=ye(e,t);return r>-1&&Vi(e,r),t}function Xs(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.world&&(H(n.world,Kr,n,n.world),H(n,Kr,n,n.world)),n.world=e,H(e,Hr,n,e),H(n,Hr,n,e)}),t}function Ke(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t.forEach(function(i){i.parent&&xe(i.parent,i),i.parent=e});var n=e.world;return n&&Xs.apply(void 0,Y([n],L(pe(e)))),t}function $s(e,t){return e.children.push(t),Ke(e,t),t}function Ys(e,t,r){var n=e.children;return t>=0&&t<=n.length&&(Ke(e,r),n.splice(t,0,r)),r}function hp(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){$s(e,n)}),t}function cp(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e.children;return t>=0&&t<=i.length&&r.reverse().forEach(function(o){r.splice(t,0,o),Ke(e,o)}),r}function Oi(e,t){t===void 0&&(t=[]);for(var r=0;r<e.numChildren;r++){var n=e.children[r],i=[];t.push({node:n,children:i}),n.numChildren>0&&Oi(n,i)}return t}function $r(e){var t=e.numChildren>0?"Parent":"Child";return t+" [ type="+e.type+", name="+e.name+" ]"}function qs(e){console.group($r(e.node)),e.children.forEach(function(t){t.children.length>0?qs(t):console.log($r(t.node))}),console.groupEnd()}function lp(e){var t=Oi(e);e.world===e?console.group("World"):console.group($r(e)),t.forEach(function(r){r.children.length?qs(r):console.log($r(r.node))}),console.groupEnd()}function dp(e,t,r){var n=e.children,i=0;return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i++}),i}function Zs(e,t){t===void 0&&(t=[]);for(var r=0;r<e.numChildren;r++){var n=e.children[r];t.push(n),n.numChildren>0&&Zs(n,t)}return t}function Bi(e,t,r){t===void 0&&(t=0);var n=e.children;r===void 0&&(r=n.length);var i=r-t;if(i>0&&i<=r){var o=n.splice(t,i);return o.forEach(function(a){a.parent=null}),o}else return[]}function vp(e,t,r){t===void 0&&(t=0);var n=Bi(e,t,r);n.forEach(function(i){i.destroy()})}function mp(e,t){for(var r=pe(e),n=RegExp(t),i=0;i<r.length;i++){var o=r[i];if(n.test(o.name))return o}}function pp(e,t){var r=pe(e),n=RegExp(t),i=[];return r.forEach(function(o){n.test(o.name)&&i.push(o)}),i}function yp(e,t,r){var n=pe(e);if(!t)return n;var i=[];return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i.push(o)}),i}function xp(e,t){var r=e.children;if(t<0||t>r.length)throw new Error("Index out of bounds: "+t);return r[t]}function Mp(e,t,r){var n=e.children;if(!t)return Y([],L(n));var i=[];return n.forEach(function(o){var a=Object.getOwnPropertyDescriptor(o,t);a&&(r===void 0||r===a.value)&&i.push(o)}),i}function wp(e,t,r){for(var n=e.children,i=0;i<n.length;i++){var o=n[i],a=Object.getOwnPropertyDescriptor(o,t);if(a&&(r===void 0||r===a.value))return o}}function gp(e,t,r){for(var n=e.children,i=n.length-1;i>=0;i--){var o=n[i],a=Object.getOwnPropertyDescriptor(o,t);if(a&&(r===void 0||r===a.value))return o}}function bp(e){for(var t=[];e.parent;)t.push(e.parent),e=e.parent;return t}function Cp(e,t,r){t===void 0&&(t=0);var n=e.children;r||(r=n.length);var i=t+Math.floor(Math.random()*r);return n[i]}function Js(e,t,r){var n=e.children,i=ye(e,t);if(i===-1||r<0||r>=n.length)throw new Error("Index out of bounds");return i!==r&&(n.splice(i,1),n.splice(r,0,t),t.setDirty(j.TRANSFORM)),t}function tf(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){xe(e,n)}),t}function Tp(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[];return t.sort(function(i,o){return i-o}),t.reverse().forEach(function(i){var o=Vi(e,i);o&&n.push(o)}),n}function Sp(e,t,r,n){r===void 0&&(r=0);var i=Bi(e,r,n);return Ke.apply(void 0,Y([t],L(i))),i.forEach(function(o){}),i}function Rp(e,t){var r=e.parent,n=t.parent,i=ye(r,e);return r===n?(Js(r,t,i),xe(r,e)):(xe(r,e),xe(n,t),Ys(r,i,t)),e}function Ep(e,t,r){var n=pe(e);return n.forEach(function(i){var o=Object.getOwnPropertyDescriptor(i,t);o&&o.set(r)}),n}function Ap(e,t){if(e.parent===t.parent){var r=e.parent.children,n=ye(e.parent,e),i=ye(t.parent,t);n!==i&&(r[n]=t,r[i]=e)}}var zp=Object.freeze({__proto__:null,AddChild3D:$s,AddChild3DAt:Ys,AddChildren3D:hp,AddChildren3DAt:cp,ConsoleTreeChildren3D:lp,CountMatchingChildren3D:dp,DepthFirstSearch3D:pe,DepthFirstSearchRecursive3D:Zs,DepthFirstSearchRecursiveNested3D:Oi,DestroyChildren3D:vp,FindChild3DByName:mp,FindChildren3DByName:pp,GetAllChildren3D:yp,GetChild3DAt:xp,GetChild3DIndex:ye,GetChildren3D:Mp,GetFirstChild3D:wp,GetLastChild3D:gp,GetParents3D:bp,GetRandomChild3D:Cp,MoveChild3DTo:Js,RemoveChild3D:xe,RemoveChild3DAt:Vi,RemoveChildren3D:tf,RemoveChildren3DAt:Tp,RemoveChildren3DBetween:Bi,ReparentChildren3D:Sp,ReplaceChild3D:Rp,SetChildren3DValue:Ep,SetParent3D:Ke,SetWorld3D:Xs,SwapChildren3D:Ap});function Fp(e,t){return e.events.delete(t),e}var Xe=function(){function e(){this.events=new Map}return e}(),Pi=function(){function e(t,r,n){n===void 0&&(n=!1),this.callback=t,this.context=r,this.once=n}return e}();function _p(e){return Y([],L(e.events.keys()))}function Dp(e,t){var r=e.events.get(t);return r?r.size:0}function Gp(e,t){var r=[],n=e.events.get(t);return n.forEach(function(i){r.push(i.callback)}),r}function te(e,t,r,n,i){var o,a,s=e.events,f=s.get(t);if(!r)s.delete(t);else if(r instanceof Pi)f.delete(r);else{var u=!n,h=i!==void 0;try{for(var c=U(f),m=c.next();!m.done;m=c.next()){var d=m.value;d.callback===r&&u&&d.context===n&&h&&d.once===i&&f.delete(d)}}catch(v){o={error:v}}finally{try{m&&!m.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}}return f.size===0&&s.delete(t),e}function kt(e,t,r,n,i){if(n===void 0&&(n=e),i===void 0&&(i=!1),typeof r!="function")throw new TypeError("Listener not a function");var o=new Pi(r,n,i),a=e.events.get(t);return a?a.add(o):e.events.set(t,new Set([o])),o}function Yr(e,t,r,n){return n===void 0&&(n=e),kt(e,t,r,n,!0)}function Lp(e,t){t?e.events.delete(t):e.events.clear()}var Vp=Object.freeze({__proto__:null,ClearEvent:Fp,Emit:H,EventEmitter:Xe,EventInstance:Pi,GetEventNames:_p,GetListenerCount:Dp,GetListeners:Gp,Off:te,On:kt,Once:Yr,RemoveAllListeners:Lp});function Ii(e){var t=e.world,r=t.a,n=t.b,i=t.c,o=t.d,a=t.tx,s=t.ty,f=e.extent,u=f.x,h=f.y,c=f.right,m=f.bottom,d=u*r+h*i+a,v=u*n+h*o+s,g=u*r+m*i+a,p=u*n+m*o+s,b=c*r+m*i+a,C=c*n+m*o+s,S=c*r+h*i+a,R=c*n+h*o+s;return{x0:d,y0:v,x1:g,y1:p,x2:b,y2:C,x3:S,y3:R}}var ef=function(){function e(t){this.fixed=!1,this.includeChildren=!0,this.visibleOnly=!0,this.entity=t,this.area=new yt}return e.prototype.set=function(t,r,n,i){this.area.set(t,r,n,i)},e.prototype.get=function(){return this.entity.isDirty(j.BOUNDS)&&!this.fixed&&this.update(),this.area},e.prototype.updateLocal=function(){var t=Ii(this.entity.transform),r=t.x0,n=t.y0,i=t.x1,o=t.y1,a=t.x2,s=t.y2,f=t.x3,u=t.y3,h=Math.min(r,i,a,f),c=Math.min(n,o,s,u),m=Math.max(r,i,a,f),d=Math.max(n,o,s,u);return this.area.set(h,c,m-h,d-c)},e.prototype.update=function(){var t=this.updateLocal();if(this.entity.clearDirty(j.BOUNDS),!this.includeChildren||!this.entity.numChildren)return t;for(var r=this.visibleOnly,n=this.entity.children,i=t.x,o=t.y,a=t.right,s=t.bottom,f=0;f<n.length;f++){var u=n[f];if(!(!u||r&&!u.visible)){var h=u.bounds.get();h.x<i&&(i=h.x),h.y<o&&(o=h.y),h.right>a&&(a=h.right),h.bottom>s&&(s=h.bottom)}}return t.set(i,o,a-i,s-o)},e.prototype.destroy=function(){this.entity=null,this.area=null},e}(),Op=Object.freeze({__proto__:null,BoundsComponent:ef}),rf=function(){function e(t){this.enabled=!1,this.enabledChildren=!0,this.entity=t}return e.prototype.destroy=function(){this.entity=null,this.hitArea=null},e}(),Bp=Object.freeze({__proto__:null,InputComponent:rf});function Pp(){return ut.get(ft.DEFAULT_ORIGIN).x}function Ip(){return ut.get(ft.DEFAULT_ORIGIN).y}function Np(e){return e.x=Math.ceil(e.x),e.y=Math.ceil(e.y),e.width=Math.ceil(e.width),e.height=Math.ceil(e.height),e}function Up(e){return e.x=Math.ceil(e.x),e.y=Math.ceil(e.y),e}function nf(e,t,r){return e.x=t-e.width/2,e.y=r-e.height/2,e}function kp(e){return new yt(e.x,e.y,e.width,e.height)}function Wp(e,t){return t.set(e.x,e.y,e.width,e.height)}function of(e,t){return t===void 0&&(t=[]),t.push(new D(e.x,e.y),new D(e.right,e.y),new D(e.right,e.bottom),new D(e.x,e.bottom)),t}function $e(e){return e.height===0?NaN:e.width/e.height}function Me(e){return e.x+e.width/2}function we(e){return e.y+e.height/2}function jp(e,t){var r=$e(e),n=t.width,i=t.height;return r<$e(t)?n=t.height*r:i=t.width/r,e.set(Me(t)-e.width/2,we(t)-e.height/2,n,i)}function Hp(e,t){var r=$e(e),n=t.width,i=t.height;return r>$e(t)?n=t.height*r:i=t.width/r,e.set(Me(t)-e.width/2,we(t)-e.height/2,n,i)}function Qp(e,t,r){var n=Math.min(e.x,t),i=Math.max(e.right,t),o=Math.min(e.y,r),a=Math.max(e.bottom,r);return e.set(n,o,i-n,a-o)}function Kp(e,t){for(var r=e.x,n=e.right,i=e.y,o=e.bottom,a=0;a<t.length;a++)r=Math.min(r,t[a].x),n=Math.max(n,t[a].x),i=Math.min(i,t[a].y),o=Math.max(o,t[a].y);return e.set(r,i,n-r,o-i)}function Xp(e){return e.x=Math.floor(e.x),e.y=Math.floor(e.y),e.width=Math.floor(e.width),e.height=Math.floor(e.height),e}function $p(e){return e.x=Math.floor(e.x),e.y=Math.floor(e.y),e}function Yp(e){return e.width*e.height}function qp(e,t){return t===void 0&&(t=new D),t.set(Me(e),we(e))}var It=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.set(t,r,n,i)}return e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x1=t,this.y1=r,this.x2=n,this.y2=i,this},Object.defineProperty(e.prototype,"left",{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t},enumerable:!1,configurable:!0}),e}();function Ye(e){var t=e.x,r=e.y,n=e.right,i=e.bottom,o=new It(t,r,n,r),a=new It(n,r,n,i),s=new It(n,i,t,i),f=new It(t,i,t,r);return[o,a,s,f]}function Zp(e,t,r){return r===void 0&&(r=new yt),Qe(e,t)?r.set(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.min(e.right,t.right)-r.x,Math.min(e.bottom,t.bottom)-r.y):r.set(),r}function qe(e){return 2*(e.width+e.height)}function Jp(e,t,r,n){if(n===void 0&&(n=[]),!t&&!r)return n;t?r=Math.round(qe(e)/t):t=qe(e)/r;for(var i=e.x,o=e.y,a=0,s=0;s<r;s++)switch(n.push(new D(i,o)),a){case 0:i+=t,i>=e.right&&(a=1,o+=i-e.right,i=e.right);break;case 1:o+=t,o>=e.bottom&&(a=2,i-=o-e.bottom,o=e.bottom);break;case 2:i-=t,i<=e.x&&(a=3,o-=e.x-i,i=e.x);break;case 3:o-=t,o<=e.y&&(a=0,o=e.y);break}return n}function ty(e,t){return e.x<t.right&&e.right>t.x&&e.y<t.bottom&&e.bottom>t.y}function ey(e,t,r){r===void 0&&(r=new D),t=Ie(t);var n=Math.sin(t),i=Math.cos(t),o=i>0?e.width/2:e.width/-2,a=n>0?e.height/2:e.height/-2;return Math.abs(o*n)<Math.abs(a*i)?a=o*n/i:o=a*i/n,r.set(o+Me(e),a+we(e))}function af(e,t,r){if(r===void 0&&(r=new D),t<=0||t>=1)return r.set(e.x,e.y);var n=qe(e)*t;return t>.5?(n-=e.width+e.height,n<=e.width?r.set(e.right-n,e.bottom):r.set(e.x,e.bottom-(n-e.width))):n<=e.width?r.set(e.x+n,e.y):r.set(e.right,e.y+(n-e.width))}function ry(e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=[]),r||(r=qe(e)/t);for(var i=0;i<r;i++)n.push(af(e,i/r));return n}function ny(e,t){return t===void 0&&(t=new D),t.set(e.x+Math.random()*e.width,e.y+Math.random()*e.height)}function sf(e,t){return t.width*t.height>e.width*e.height?!1:t.x>e.x&&t.x<e.right&&t.right>e.x&&t.right<e.right&&t.y>e.y&&t.y<e.bottom&&t.bottom>e.y&&t.bottom<e.bottom}function iy(e,t,r){if(r===void 0&&(r=new D),sf(e,t))switch(fs(0,3)){case 0:r.x=e.x+Math.random()*(t.right-e.x),r.y=e.y+Math.random()*(t.y-e.y);break;case 1:r.x=t.x+Math.random()*(e.right-t.x),r.y=t.bottom+Math.random()*(e.bottom-t.bottom);break;case 2:r.x=e.x+Math.random()*(t.x-e.x),r.y=t.y+Math.random()*(e.bottom-t.y);break;case 3:r.x=t.right+Math.random()*(e.right-t.right),r.y=e.y+Math.random()*(t.bottom-e.y);break}return r}function oy(e,t){return t===void 0&&(t=new D),t.set(e.width,e.height)}function ay(e,t,r){r===void 0&&(r=new yt);var n=Math.min(e.x,t.x),i=Math.min(e.y,t.y),o=Math.max(e.right,t.right)-n,a=Math.max(e.bottom,t.bottom)-i;return r.set(n,i,o,a)}function sy(e,t,r){var n=Me(e),i=we(e);return e.width=e.width+t*2,e.height=e.height+r*2,nf(e,n,i)}function fy(e,t){var r=Math.min(e.x,t.x),n=Math.max(e.right,t.right),i=Math.min(e.y,t.y),o=Math.max(e.bottom,t.bottom);return e.set(r,i,n-r,o-i)}function uy(e,t){return Ot(e,t.x,t.y)}function hy(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function cy(e,t){if(t===void 0&&(t=new yt),e.length===0)return t;for(var r=Number.MAX_VALUE,n=Number.MAX_VALUE,i=ct.MIN_SAFE_INTEGER,o=ct.MIN_SAFE_INTEGER,a=0;a<e.length;a++){var s=e[a].x,f=e[a].y;r=Math.min(r,s),n=Math.min(n,f),i=Math.max(i,s),o=Math.max(o,f)}return t.set(r,n,i-r,o-n)}function ly(e,t){return e.width===t.width&&e.height===t.height}function dy(e,t,r){return r===void 0&&(r=t),e.width*=t,e.height*=r,e}function vy(e,t,r){return e.x+=t,e.y+=r,e}function my(e,t){return e.x+=t.x,e.y+=t.y,e}var py=Object.freeze({__proto__:null,CeilRectangle:Np,CeilRectanglePosition:Up,CenterRectangleOn:nf,CloneRectangle:kp,CopyRectangleFrom:Wp,DecomposeRectangle:of,FitRectangleInside:jp,FitRectangleOutside:Hp,FitRectangleToPoint:Qp,FitRectangleToPoints:Kp,FloorRectangle:Xp,FloorRectanglePosition:$p,GetRectangleArea:Yp,GetRectangleAspectRatio:$e,GetRectangleCenter:qp,GetRectangleCenterX:Me,GetRectangleCenterY:we,GetRectangleEdges:Ye,GetRectangleIntersection:Zp,GetRectangleMarchingAnts:Jp,GetRectangleOverlap:ty,GetRectanglePerimeter:qe,GetRectanglePerimeterPoint:ey,GetRectanglePoint:af,GetRectanglePoints:ry,GetRectangleRandomPoint:ny,GetRectangleRandomPointOutside:iy,GetRectangleSize:oy,GetRectangleUnion:ay,InflateRectangle:sy,MergeRectangle:fy,Rectangle:yt,RectangleContains:Ot,RectangleContainsPoint:uy,RectangleContainsRectangle:sf,RectangleEquals:hy,RectangleFromPoints:cy,RectangleSizeEquals:ly,ScaleRectangle:dy,TranslateRectangle:vy,TranslateRectanglePoint:my});function ff(e){var t=e.local,r=e.position.x,n=e.position.y,i=e.rotation,o=e.scale.x,a=e.scale.y,s=e.skew.x,f=e.skew.y;t.set(Math.cos(i+f)*o,Math.sin(i+f)*o,-Math.sin(i-s)*a,Math.cos(i-s)*a,r,n)}function uf(e){var t=e.parent,r=e.transform,n=r.local,i=r.world;if(!t)Gn(n,i);else if(r.passthru)Gn(t.transform.world,i);else{var o=n.a,a=n.b,s=n.c,f=n.d,u=n.tx,h=n.ty,c=t.transform.world,m=c.a,d=c.b,v=c.c,g=c.d,p=c.tx,b=c.ty;i.set(o*m+a*v,o*d+a*g,s*m+f*v,s*d+f*g,u*m+h*v+p,u*d+h*g+b)}}var hf=function(){function e(t,r,n){var i=this;r===void 0&&(r=0),n===void 0&&(n=0),this.passthru=!1,this._rotation=0,this.entity=t,this.local=new dt,this.world=new dt;var o=function(){return i.update()},a=function(){return i.updateExtent()};this.position=new Ut(o,r,n),this.scale=new Ut(o,1,1),this.skew=new Ut(o),this.origin=new Ut(a,Pp(),Ip()),this.extent=new yt}return e.prototype.update=function(){this.updateLocal(),this.updateWorld()},e.prototype.updateLocal=function(){this.entity.setDirty(j.TRANSFORM,j.BOUNDS),ff(this)},e.prototype.updateWorld=function(){var t=this.entity;t.setDirty(j.TRANSFORM,j.BOUNDS),uf(t),t.numChildren&&this.updateChildren()},e.prototype.updateChildren=function(){for(var t=this.entity.children,r=0;r<t.length;r++){var n=t[r];n.transform.updateWorld()}},e.prototype.globalToLocal=function(t,r,n){n===void 0&&(n=new D);var i=this.world,o=i.a,a=i.b,s=i.c,f=i.d,u=i.tx,h=i.ty,c=1/(o*f+s*-a);return n.x=f*c*t+-s*c*r+(h*s-u*f)*c,n.y=o*c*r+-a*c*t+(-h*o+u*a)*c,n},e.prototype.localToGlobal=function(t,r,n){n===void 0&&(n=new D);var i=this.world,o=i.a,a=i.b,s=i.c,f=i.d,u=i.tx,h=i.ty;return n.x=o*t+s*r+u,n.y=a*t+f*r+h,n},e.prototype.setExtent=function(t,r,n,i){this.extent.set(t,r,n,i),this.entity.setDirty(j.TRANSFORM,j.BOUNDS)},e.prototype.updateExtent=function(t,r){var n=this.extent,i=this.entity;t!==void 0&&(n.width=t),r!==void 0&&(n.height=r),n.x=-this.origin.x*n.width,n.y=-this.origin.y*n.height,i.setDirty(j.TRANSFORM,j.BOUNDS)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){t!==this._rotation&&(this._rotation=t,this.update())},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.skew.destroy(),this.origin.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.skew=null,this.origin=null,this.extent=null},e}(),yy=Object.freeze({__proto__:null,GetVertices:Ii,TransformComponent:hf,UpdateLocalTransform:ff,UpdateWorldTransform:uf});function Ze(e,t){var r=(t*255|0)&255;return(r<<24|e)>>>0}var Wt=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=0,this.y=0,this.z=0,this.u=0,this.v=0,this.texture=0,this.tint=16777215,this.alpha=1,this.color=4294967295,this.x=t,this.y=r,this.z=n}return e.prototype.setPosition=function(t,r,n){return n===void 0&&(n=0),this.x=t,this.y=r,this.z=n,this},e.prototype.setUV=function(t,r){return this.u=t,this.v=r,this},e.prototype.setColor=function(t,r){return r===void 0&&(r=1),this.tint=t,this.alpha=r,this.packColor(),this},e.prototype.setAlpha=function(t){return this.alpha=t,this},e.prototype.setTint=function(t){return this.tint=t,this},e.prototype.packColor=function(){this.color=Ze(this.tint,this.alpha)},e}(),xy=Object.freeze({__proto__:null,Bounds:Op,Input:Bp,Transform:yy,Vertex:Wt});function My(e,t){var r=Es(t,1),n=r.F32,i=r.U32,o=r.offset,a=Fs(t,e.texture),s=o;e.vertices.forEach(function(f){n[s+0]=f.x,n[s+1]=f.y,n[s+2]=f.u,n[s+3]=f.v,n[s+4]=a,i[s+5]=f.color,s+=6})}var qr=function(){function e(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.type="GameObject",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new hf(this,t,r),this.bounds=new ef(this),this.input=new rf(this),this.dirty=j.DEFAULT,this.transform.update()}return e.prototype.isRenderable=function(){return this.visible&&this.willRender},e.prototype.isDirty=function(t){return(this.dirty&t)!=0},e.prototype.clearDirty=function(t){return this.isDirty(t)&&(this.dirty^=t),this},e.prototype.setDirty=function(t,r){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=A.getFrame()),this.isDirty(r)||(this.dirty^=r),this},e.prototype.update=function(t,r){if(this.willUpdateChildren)for(var n=this.children,i=0;i<n.length;i++){var o=n[i];o&&o.willUpdate&&o.update(t,r)}this.postUpdate(t,r)},e.prototype.postUpdate=function(t,r){},e.prototype.renderGL=function(t){},e.prototype.renderCanvas=function(t){},e.prototype.postRenderGL=function(t){},e.prototype.postRenderCanvas=function(t){},Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t){t?Ks(this,t):Hs(this),H(this,Qr,this),this.transform.destroy(),this.bounds.destroy(),this.input.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null},e}(),cf=function(e){z(t,e);function t(r,n){r===void 0&&(r=0),n===void 0&&(n=0);var i=e.call(this,r,n)||this;return i._alpha=1,i.type="Container",i}return t.prototype.setSize=function(r,n){return n===void 0&&(n=r),this.transform.updateExtent(r,n),this},t.prototype.setPosition=function(r,n){return this.transform.position.set(r,n),this},t.prototype.setOrigin=function(r,n){return n===void 0&&(n=r),this.transform.origin.set(r,n),this},t.prototype.setSkew=function(r,n){return n===void 0&&(n=r),this.transform.skew.set(r,n),this},t.prototype.setScale=function(r,n){return n===void 0&&(n=r),this.transform.scale.set(r,n),this},t.prototype.setRotation=function(r){return this.transform.rotation=r,this},Object.defineProperty(t.prototype,"width",{get:function(){return this.transform.extent.width},set:function(r){this.transform.updateExtent(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.transform.extent.height},set:function(r){this.transform.updateExtent(void 0,r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.transform.position.x},set:function(r){this.transform.position.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.transform.position.y},set:function(r){this.transform.position.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originX",{get:function(){return this.transform.origin.x},set:function(r){this.transform.origin.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originY",{get:function(){return this.transform.origin.y},set:function(r){this.transform.origin.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skewX",{get:function(){return this.transform.skew.x},set:function(r){this.transform.skew.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skewY",{get:function(){return this.transform.skew.y},set:function(r){this.transform.skew.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.transform.scale.x},set:function(r){this.transform.scale.x=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.transform.scale.y},set:function(r){this.transform.scale.y=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(r){this.transform.rotation=r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(r){r!==this._alpha&&(this._alpha=r,this.setDirty(j.TRANSFORM))},enumerable:!1,configurable:!0}),t}(qr);function wy(e,t){var r=e.frame;if(!!r){var n=t.ctx,i=e.transform,o=i.world,a=o.a,s=o.b,f=o.c,u=o.d,h=o.tx,c=o.ty,m=i.extent,d=m.x,v=m.y;n.save(),n.setTransform(a,s,f,u,h,c),n.globalAlpha=e.alpha,n.drawImage(r.texture.image,r.x,r.y,r.width,r.height,d,v,r.width,r.height),n.restore()}}function lf(e){return e.vertices.forEach(function(t){t.packColor()}),e}function df(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e.getFrame(t),o=i.u0,a=i.u1,s=i.v0,f=i.v1,u=i.pivot;return r.forEach(function(h){if(!(!h||i===h.frame)){h.frame=i,u&&h.setOrigin(u.x,u.y),h.frame.setExtent(h),h.hasTexture=!0;var c=h.vertices;c[0].setUV(o,s),c[1].setUV(o,f),c[2].setUV(a,f),c[3].setUV(a,s)}}),r}var vf,jt={get:function(){return vf},set:function(e){vf=e}};function gy(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!e)r.forEach(function(o){o.texture=null,o.frame=null,o.hasTexture=!1});else{var i;e instanceof mt?i=e:i=jt.get().get(e),i?(r.forEach(function(o){o.texture=i}),df.apply(void 0,Y([i,t],L(r)))):console.warn("Invalid Texture key: "+e)}return r}function by(e){var t=e.vertices,r=Ii(e.transform),n=r.x0,i=r.y0,o=r.x1,a=r.y1,s=r.x2,f=r.y2,u=r.x3,h=r.y3;return t[0].setPosition(n,i),t[1].setPosition(o,a),t[2].setPosition(s,f),t[3].setPosition(u,h),e}var Ni=function(e){z(t,e);function t(r,n,i,o){var a=e.call(this,r,n)||this;return a.hasTexture=!1,a._tint=16777215,a.type="Sprite",a.vertices=[new Wt,new Wt,new Wt,new Wt],a.setTexture(i,o),a}return t.prototype.setTexture=function(r,n){return gy(r,n,this),this},t.prototype.setFrame=function(r){return df(this.texture,r,this),this},t.prototype.isRenderable=function(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0},t.prototype.preRender=function(){this.isDirty(j.COLORS)&&(lf(this),this.clearDirty(j.COLORS)),this.isDirty(j.TRANSFORM)&&(by(this),this.clearDirty(j.TRANSFORM))},t.prototype.renderGL=function(r){this.preRender(),My(this,r)},t.prototype.renderCanvas=function(r){this.preRender(),wy(this,r)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(r){r!==this._alpha&&(this._alpha=r,this.vertices.forEach(function(n){n.setAlpha(r)}),this.setDirty(j.COLORS))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(r){r!==this._tint&&(this._tint=r,this.vertices.forEach(function(n){n.setTint(r)}),this.setDirty(j.COLORS))},enumerable:!1,configurable:!0}),t.prototype.destroy=function(r){e.prototype.destroy.call(this,r),this.texture=null,this.frame=null,this.hasTexture=!1,this.vertices=[]},t}(cf),Cy=function(e){z(t,e);function t(r,n,i,o){var a=e.call(this,r,n,i,o)||this;return a.type="AnimatedSprite",a.anims=new Map,a.animData={currentAnim:"",currentFrames:[],frameIndex:0,animSpeed:0,nextFrameTime:0,repeatCount:0,isPlaying:!1,yoyo:!1,pendingStart:!1,playingForward:!0,delay:0,repeatDelay:0,onStart:null,onRepeat:null,onComplete:null},a}return t.prototype.stop=function(){var r=this.animData;r.isPlaying=!1,r.currentAnim="",r.onComplete&&r.onComplete(this,r.currentAnim)},t.prototype.nextFrame=function(){var r=this.animData;if(r.frameIndex++,r.frameIndex===r.currentFrames.length)if(r.yoyo)r.frameIndex--,r.playingForward=!1;else if(r.repeatCount===-1||r.repeatCount>0)r.frameIndex=0,r.repeatCount!==-1&&r.repeatCount--,r.onRepeat&&r.onRepeat(this,r.currentAnim),r.nextFrameTime+=r.repeatDelay;else return r.frameIndex--,this.stop();this.setFrame(r.currentFrames[r.frameIndex]),r.nextFrameTime+=r.animSpeed},t.prototype.prevFrame=function(){var r=this.animData;if(r.frameIndex--,r.frameIndex===-1)if(r.repeatCount===-1||r.repeatCount>0)r.frameIndex=0,r.playingForward=!0,r.repeatCount!==-1&&r.repeatCount--,r.onRepeat&&r.onRepeat(this,r.currentAnim),r.nextFrameTime+=r.repeatDelay;else return r.frameIndex=0,this.stop();this.setFrame(r.currentFrames[r.frameIndex]),r.nextFrameTime+=r.animSpeed},t.prototype.update=function(r,n){e.prototype.update.call(this,r,n);var i=this.animData;!i.isPlaying||(i.nextFrameTime-=r*1e3,i.nextFrameTime=Math.max(i.nextFrameTime,0),i.nextFrameTime===0&&(i.pendingStart?(i.onStart&&i.onStart(this,i.currentAnim),i.pendingStart=!1,i.nextFrameTime=i.animSpeed):i.playingForward?this.nextFrame():this.prevFrame()))},Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this.animData.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlayingForward",{get:function(){return this.animData.isPlaying&&this.animData.playingForward},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentAnimation",{get:function(){return this.animData.currentAnim},enumerable:!1,configurable:!0}),t.prototype.destroy=function(r){e.prototype.destroy.call(this,r),this.anims.clear(),this.animData=null},t}(Ni);function Ty(e,t,r,n,i,o,a,s,f,u,h){u===void 0&&(u=0),h===void 0&&(h=4294967295);var c=Es(e,1),m=c.F32,d=c.U32,v=c.offset;m[v+0]=t,m[v+1]=r,m[v+2]=o,m[v+3]=f,m[v+4]=u,d[v+5]=h,m[v+6]=t,m[v+7]=r+i,m[v+8]=o,m[v+9]=a,m[v+10]=u,d[v+11]=h,m[v+12]=t+n,m[v+13]=r+i,m[v+14]=s,m[v+15]=a,m[v+16]=u,d[v+17]=h,m[v+18]=t+n,m[v+19]=r,m[v+20]=s,m[v+21]=f,m[v+22]=u,d[v+23]=h}function Je(e,t,r){r||(r=e.quadShader);var n=t.firstFrame,i=n.u0,o=n.v0,a=n.u1,s=n.v1;om(t,0),Rs(e,e.quadBuffer),zs(e,r,0),Ty(e,0,0,t.width,t.height,i,o,a,s,0),Tt(e),Ss(e),As(e),fm(e)}var Zr=function(e){z(t,e);function t(){var r=e.call(this)||this;return r.type="Layer",r.transform.passthru=!0,r.willRender=!1,r}return t}(qr),mf=function(e){z(t,e);function t(){var r=e.call(this)||this;r.type="RenderLayer",r.willRender=!0,r.willRenderChildren=!0,r.willCacheChildren=!0,r.setDirty(j.CHILD_CACHE);var n=We(),i=Ue(),o=ke(),a=new mt(null,n*o,i*o),s=new Pr(a);return a.binding=s,s.framebuffer=Ur(s.texture),r.texture=a,r.framebuffer=s.framebuffer,r}return t.prototype.renderGL=function(r){this.numChildren>0&&(Tt(r),!this.willCacheChildren||this.isDirty(j.CHILD_CACHE)?(je(r,this.framebuffer,!0),this.clearDirty(j.CHILD_CACHE)):(je(r,this.framebuffer,!1),this.postRenderGL(r)))},t.prototype.postRenderGL=function(r){Tt(r),Vr(r),Je(r,this.texture),this.clearDirty(j.TRANSFORM)},t}(Zr),Sy=function(e){z(t,e);function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.call(this)||this;return i.shaders=[],i.type="EffectLayer",Array.isArray(r)&&(i.shaders=r),i}return t.prototype.postRenderGL=function(r){var n=this.shaders,i=this.texture;if(Tt(r),Vr(r),n.length===0)Je(r,i);else{for(var o=i,a=0;a<n.length;a++){var s=n[a];Je(r,o,s),o=s.texture}Je(r,o)}this.clearDirty(j.TRANSFORM)},t}(mf);function pf(e,t,r,n,i,o,a,s,f,u,h){a===void 0&&(a=0),s===void 0&&(s=1),f===void 0&&(f=1),u===void 0&&(u=0),h===void 0&&(h=0);var c=Math.cos(a+h)*s,m=Math.sin(a+h)*s,d=-Math.sin(a-u)*f,v=Math.cos(a-u)*f,g=e*c+r*d+i,p=e*m+r*v+o,b=e*c+n*d+i,C=e*m+n*v+o,S=t*c+n*d+i,R=t*m+n*v+o,E=t*c+r*d+i,_=t*m+r*v+o;return{x0:g,y0:p,x1:b,y1:C,x2:S,y2:R,x3:E,y3:_}}var Ry=function(e){z(t,e);function t(r,n){var i=e.call(this)||this;return i.glTextureIndex=0,i.hasTexture=!1,i.type="SpriteBatch",i.willRender=!0,i.setTexture(n),i.setMaxSize(r),i}return t.prototype.resetBuffers=function(){for(var r=[],n=0;n<this.maxSize*4;n+=4)r.push(n+0,n+1,n+2,n+2,n+3,n+0);this.data=new ArrayBuffer(this.maxSize*96),this.index=new Uint16Array(r),this.vertexViewF32=new Float32Array(this.data),this.vertexViewU32=new Uint32Array(this.data),M&&(Zt(this.vertexBuffer),Zt(this.indexBuffer),this.vertexBuffer=M.createBuffer(),this.indexBuffer=M.createBuffer(),M.bindBuffer(M.ARRAY_BUFFER,this.vertexBuffer),M.bufferData(M.ARRAY_BUFFER,this.data,M.STATIC_DRAW),M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,this.indexBuffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,this.index,M.STATIC_DRAW),M.bindBuffer(M.ARRAY_BUFFER,null)),r=[],this.count=0},t.prototype.setMaxSize=function(r){return this.maxSize=at(r,0,65535),this.resetBuffers(),this},t.prototype.setTexture=function(r){var n;return r instanceof mt?n=r:n=jt.get().get(r),n?(this.texture=n,this.hasTexture=!0,this.glTextureIndex=-1):console.warn("Invalid Texture key: "+r),this},t.prototype.isRenderable=function(){return this.visible&&this.willRender&&this.hasTexture&&this.count>0},t.prototype.clear=function(){return this.count=0,this},t.prototype.addToBatch=function(r,n,i,o,a,s,f,u,h,c){if(this.count>=this.maxSize)return console.warn("SpriteBatch full"),this;var m=r.u0,d=r.u1,v=r.v0,g=r.v1,p=this.vertexViewF32,b=this.vertexViewU32,C=this.count*24,S=this.texture.binding?this.texture.binding.index:0;return p[C+0]=i,p[C+1]=o,p[C+2]=m,p[C+3]=v,p[C+4]=S,b[C+5]=n,p[C+6]=a,p[C+7]=s,p[C+8]=m,p[C+9]=g,p[C+10]=S,b[C+11]=n,p[C+12]=f,p[C+13]=u,p[C+14]=d,p[C+15]=g,p[C+16]=S,b[C+17]=n,p[C+18]=h,p[C+19]=c,p[C+20]=d,p[C+21]=v,p[C+22]=S,b[C+23]=n,this.setDirty(j.TRANSFORM),this.count++,this},t.prototype.add=function(r){var n=r.frame,i=n===void 0?null:n,o=r.x,a=o===void 0?0:o,s=r.y,f=s===void 0?0:s,u=r.rotation,h=u===void 0?0:u,c=r.scaleX,m=c===void 0?1:c,d=r.scaleY,v=d===void 0?1:d,g=r.skewX,p=g===void 0?0:g,b=r.skewY,C=b===void 0?0:b,S=r.originX,R=S===void 0?0:S,E=r.originY,_=E===void 0?0:E,G=r.alpha,V=G===void 0?1:G,P=r.tint,O=P===void 0?16777215:P,k=this.texture.getFrame(i),W=k.getExtent(R,_),K=W.left,N=W.right,q=W.top,J=W.bottom,X=pf(K,N,q,J,a,f,h,m,v,p,C),rt=X.x0,ot=X.y0,ht=X.x1,zt=X.y1,Lt=X.x2,ie=X.y2,Nt=X.x3,oe=X.y3,on=Ze(O,V);return this.addToBatch(k,on,rt,ot,ht,zt,Lt,ie,Nt,oe)},t.prototype.addXY=function(r,n,i){var o=this.texture.getFrame(i),a=o.getExtent(0,0),s=a.left,f=a.right,u=a.top,h=a.bottom,c=pf(s,f,u,h,r,n),m=c.x0,d=c.y0,v=c.x1,g=c.y1,p=c.x2,b=c.y2,C=c.x3,S=c.y3;return this.addToBatch(o,4294967295,m,d,v,g,p,b,C,S)},t.prototype.updateTextureIndex=function(){var r=this.texture.binding.index;if(r!==this.glTextureIndex){var n=this.vertexViewF32;this.glTextureIndex=r;for(var i=0;i<this.count;i++)n[i*24+4]=r,n[i*24+10]=r,n[i*24+16]=r,n[i*24+22]=r}},t.prototype.renderGL=function(r){},t.prototype.destroy=function(){e.prototype.destroy.call(this),Zt(this.vertexBuffer),Zt(this.indexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.index=null,this.texture=null,this.hasTexture=!1},t}(Zr);function Ht(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r.getContext("2d")}function yf(e,t){e===void 0&&(e=32),t===void 0&&(t=32);var r=Ht(e,t);return new mt(r.canvas)}var Ey=function(e){z(t,e);function t(r,n,i,o,a){i===void 0&&(i="");var s=e.call(this,r,n,yf())||this;s.splitRegExp=/(?:\r\n|\r|\n)/,s.padding={left:0,right:0,top:0,bottom:0},s.verticalAlign="ascent",s.lineSpacing=0,s.font="16px monospace",s.fillStyle="#fff",s.strokeStyle="",s.backgroundStyle="",s.cornerRadius=0,s.textAlign="left",s.textBaseline="alphabetic",s.lineWidth=0,s.lineDash=[],s.antialias=!1,s.type="Text";var f=A.get();return s.resolution=f.renderer.resolution,s.canvas=s.texture.image,s.context=s.canvas.getContext("2d"),o&&(s.font=o),a&&(s.fillStyle=a),s.setText(i),s}return t.prototype.syncContext=function(r,n){this.preRenderCallback&&this.preRenderCallback(r,n),n.font=this.font,n.textBaseline=this.textBaseline,n.textAlign=this.textAlign,n.fillStyle=this.fillStyle,n.strokeStyle=this.strokeStyle,n.lineWidth=this.lineWidth,n.lineCap="round",n.lineJoin="round",n.setLineDash(this.lineDash),n.imageSmoothingEnabled=this.antialias},t.prototype.updateText=function(){var r=this.canvas,n=this.context,i=this.resolution,o=this._text.split(this.splitRegExp),a=this.padding,s=this.fillStyle,f=this.strokeStyle,u=this.lineWidth,h=this.lineSpacing,c=u>0?u/2:0;n.clearRect(0,0,r.width,r.height),this.syncContext(r,n),n.textAlign="start";for(var m=0,d=0,v=0,g=[],p=this.verticalAlign==="ascent",b=n.measureText("|M\xC9q"),C=Math.ceil(Math.abs(b.actualBoundingBoxAscent)+Math.abs(b.actualBoundingBoxDescent))+u,S=0;S<o.length;S++){var R=n.measureText(o[S]),E=R.actualBoundingBoxLeft,_=R.actualBoundingBoxRight,G=R.actualBoundingBoxAscent,V=R.actualBoundingBoxDescent;(!G&&!V||o[S]==="")&&(G=C,V=0);var P=Math.ceil(Math.abs(E)+Math.abs(_))+u,O=Math.ceil(Math.abs(G)+Math.abs(V))+u;p?(v+=G+c,S>0&&(v+=h+c),d=v+V+c):(v=d+(O-V-c),d+=O,S<o.length-1&&(d+=h)),m=Math.max(m,P),g.push({lineWidth:P,lineHeight:O,ascent:G,descent:V,left:E,right:_,y:v})}m+=a.left+a.right,d+=a.top+a.bottom;var k=this.fixedWidth?this.fixedWidth:m,W=this.fixedHeight?this.fixedHeight:d,K=Math.ceil(k*i),N=Math.ceil(W*i);(r.width!==K||r.height!==N)&&(r.width=K,r.height=N,this.texture.setSize(k,W),this.setSize(k,W)),n.save(),n.scale(i,i),this.syncContext(r,n);var q=this.backgroundStyle;if(q){n.save(),n.fillStyle=q,n.strokeStyle=q;var J=this.cornerRadius,X=J>0?J/2:0;J&&(n.lineWidth=J,n.strokeRect(X,X,k-J,W-J)),n.fillRect(X,X,k-J,W-J),n.restore()}for(var rt=this.textAlign,ot=rt==="center",ht=rt==="right"||rt==="end",zt=(W-d)/2+a.top,S=0;S<o.length;S++){var Lt=o[S],ie=g[S],Nt=a.left+ie.left+c,oe=zt+ie.y;ot?Nt=k/2:ht&&(Nt=k-c),f&&n.strokeText(Lt,Nt,oe),s&&n.fillText(Lt,Nt,oe)}return n.restore(),this.texture.binding&&this.texture.binding.update(),this.setDirty(j.TEXTURE),this},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(r){this.setText(r)},enumerable:!1,configurable:!0}),t.prototype.setText=function(r){return r===void 0&&(r=""),Array.isArray(r)&&(r=r.join(`
`)),r!==this._text&&(this._text=r.toString(),this.updateText()),this},t.prototype.destroy=function(r){this.texture.destroy(),this.fillStyle=null,this.strokeStyle=null,this.backgroundStyle=null,this.canvas=null,this.context=null,e.prototype.destroy.call(this,r)},t}(Ni),Ay=Object.freeze({__proto__:null,AnimatedSprite:Cy,Components:xy,Container:cf,EffectLayer:Sy,Layer:Zr,RenderLayer:mf,GameObject:qr,Sprite:Ni,SpriteBatch:Ry,Text:Ey}),xf=function(){function e(t,r,n,i){var o=this;r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.passthru=!1,this.entity=t,this.local=new I,this.world=new I,this.normal=new I,this.position=new Bt(function(){return o.update()},r,n,i),this.scale=new Bt(function(){return o.update()},1,1,1),this.origin=new Bt(function(){return o.update()}),this.rotation=new tt,this.rotation.onChange=function(){return o.update()},this.forward=xr(),this.up=Be(),this.right=Mr(),this.update()}return e.prototype.rotateX=function(t){pa(this.rotation,t,this.rotation)},e.prototype.rotateY=function(t){ya(this.rotation,t,this.rotation)},e.prototype.rotateZ=function(t){xa(this.rotation,t,this.rotation)},e.prototype.update=function(){var t=this.local,r=this.normal;Qo(this.rotation,this.position,this.scale,t),vr(t,r),Zo(r,r)},e.prototype.updateLocal=function(){this.entity.setDirty(j.TRANSFORM,j.BOUNDS)},e.prototype.updateWorld=function(){var t=this.entity;t.setDirty(j.TRANSFORM,j.BOUNDS),t.numChildren&&this.updateChildren()},e.prototype.updateChildren=function(){for(var t=this.entity.children,r=0;r<t.length;r++)t[r]},e.prototype.destroy=function(){this.position.destroy(),this.scale.destroy(),this.origin.destroy(),this.rotation.destroy(),this.entity=null,this.local=null,this.world=null,this.position=null,this.scale=null,this.origin=null,this.rotation=null},e}(),zy=Object.freeze({__proto__:null,Transform3DComponent:xf});function ge(){return{vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0}}var Fy=Object.freeze({__proto__:null,CreateFramebuffer:Ur,CreateGLTexture:Or,DeleteFramebuffer:Zt,DeleteGLBuffer:Ir,DeleteGLTexture:Br,GL:ps,PackColor:Ze,PackColors:lf,SetGLTextureFilterMode:ys,UpdateGLTexture:xs,WebGLRenderer:_s}),Mf=function(){function e(t,r,n,i,o,a,s,f,u,h){h===void 0&&(h=1),this.color=16777215,this.alpha=1,this.size=30,this.vertex1=new Wt(t.x*h,t.y*h,t.z*h),this.vertex2=new Wt(r.x*h,r.y*h,r.z*h),this.vertex3=new Wt(n.x*h,n.y*h,n.z*h),this.vertex1.setUV(s.x,s.y),this.vertex2.setUV(f.x,f.y),this.vertex3.setUV(u.x,u.y),this.normal1=i,this.normal2=o,this.normal3=a,this._packedColor=Ze(this.color,this.alpha)}return e.prototype.setColor=function(t,r){r===void 0&&(r=1),this.color=t,this.alpha=r,this._packedColor=Ze(t,r)},e.prototype.addToBuffer=function(t,r,n,i){var o=this.vertex1,a=this.vertex2,s=this.vertex3,f=this.normal1,u=this.normal2,h=this.normal3,c=this._packedColor;return t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=f.x,t[i++]=f.y,t[i++]=f.z,t[i++]=o.u,t[i++]=o.v,t[i++]=n,r[i++]=c,t[i++]=a.x,t[i++]=a.y,t[i++]=a.z,t[i++]=u.x,t[i++]=u.y,t[i++]=u.z,t[i++]=a.u,t[i++]=a.v,t[i++]=n,r[i++]=c,t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=h.x,t[i++]=h.y,t[i++]=h.z,t[i++]=s.u,t[i++]=s.v,t[i++]=n,r[i++]=c,i},e}();function be(e,t){var r=e[t*3+0],n=e[t*3+1],i=e[t*3+2];return[r,n,i]}function Ui(e,t){var r=e[t*2+0],n=e[t*2+1];return[r,n]}function _y(e){for(var t=e.vertices,r=e.normals,n=e.uvs,i=t.length,o=i/3,a=o/3,s=new Nr({batchSize:a,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),f=s.vertexViewF32,u=0,h=0,c=0;c<i;c+=3)f[u++]=t[c+0],f[u++]=t[c+1],f[u++]=t[c+2],f[u++]=r[c+0],f[u++]=r[c+1],f[u++]=r[c+2],f[u++]=n[h+0],f[u++]=n[h+1],h+=2;return s.count=o,s}function Dy(e){for(var t=e.vertices,r=e.normals,n=e.uvs,i=e.indices,o=new Nr({batchSize:i.length/3,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),a=o.vertexViewF32,s=0,f=0;f<i.length;f+=3){var u=i[f+0],h=i[f+1],c=i[f+2],m=be(t,u),d=be(t,h),v=be(t,c),g=be(r,u),p=be(r,h),b=be(r,c),C=Ui(n,u),S=Ui(n,h),R=Ui(n,c);a[s++]=m[0],a[s++]=m[1],a[s++]=m[2],a[s++]=g[0],a[s++]=g[1],a[s++]=g[2],a[s++]=C[0],a[s++]=C[1],a[s++]=d[0],a[s++]=d[1],a[s++]=d[2],a[s++]=p[0],a[s++]=p[1],a[s++]=p[2],a[s++]=S[0],a[s++]=S[1],a[s++]=v[0],a[s++]=v[1],a[s++]=v[2],a[s++]=b[0],a[s++]=b[1],a[s++]=b[2],a[s++]=R[0],a[s++]=R[1]}return o.count=i.length,o}function wf(e){return e.indices&&e.indices.length>0?Dy(e):_y(e)}var ee=function(){function e(t){t&&(t.hasOwnProperty("vertices")?this.buffer=wf(t):this.buffer=t)}return e.prototype.destroy=function(){this.buffer.destroy()},e}(),gf=function(){function e(t,r,n){r===void 0&&(r=!0),n===void 0&&(n="untitled"),this.currentMaterial="",this.currentGroup="",this.smoothingGroup=0,this.result={materialLibraries:[],models:[]},this.fileContents=t,this.defaultModelName=n,this.flipUVs=r}return e.prototype.parseAsync=function(){var t=this;return new Promise(function(r,n){try{r(t.parse())}catch(i){n(i)}})},e.prototype.parse=function(){var t,r,n=function(h){var c=h.indexOf("#");return c>-1?h.substring(0,c):h},i=this.fileContents.split(`
`);try{for(var o=U(i),a=o.next();!a.done;a=o.next()){var s=a.value,f=n(s),u=f.replace(/\s\s+/g," ").trim().split(" ");switch(u[0].toLowerCase()){case"o":this.parseObject(u);break;case"g":this.parseGroup(u);break;case"v":this.parseVertexCoords(u);break;case"vt":this.parseTextureCoords(u);break;case"vn":this.parseVertexNormal(u);break;case"s":this.parseSmoothShadingStatement(u);break;case"f":this.parsePolygon(u);break;case"mtllib":this.parseMtlLib(u);break;case"usemtl":this.parseUseMtl(u);break}}}catch(h){t={error:h}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this.fileContents="",this.result},e.prototype.currentModel=function(){return this.result.models.length===0&&(this.result.models.push({faces:[],name:this.defaultModelName,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0),this.result.models[this.result.models.length-1]},e.prototype.parseObject=function(t){var r=t.length>=2?t[1]:this.defaultModelName;this.result.models.push({faces:[],name:r,textureCoords:[],vertexNormals:[],vertices:[]}),this.currentGroup="",this.smoothingGroup=0},e.prototype.parseGroup=function(t){if(t.length!==2)throw"Group statements must have exactly 1 argument (eg. g group_1)";this.currentGroup=t[1]},e.prototype.parseVertexCoords=function(t){var r=t.length,n=r>=2?parseFloat(t[1]):0,i=r>=3?parseFloat(t[2]):0,o=r>=4?parseFloat(t[3]):0;this.currentModel().vertices.push({x:n,y:i,z:o})},e.prototype.parseTextureCoords=function(t){var r=t.length,n=r>=2?parseFloat(t[1]):0,i=r>=3?parseFloat(t[2]):0,o=r>=4?parseFloat(t[3]):0;isNaN(n)&&(n=0),isNaN(i)&&(i=0),isNaN(o)&&(o=0),this.flipUVs&&(i=1-i),this.currentModel().textureCoords.push({u:n,v:i,w:o})},e.prototype.parseVertexNormal=function(t){var r=t.length,n=r>=2?parseFloat(t[1]):0,i=r>=3?parseFloat(t[2]):0,o=r>=4?parseFloat(t[3]):0;this.currentModel().vertexNormals.push({x:n,y:i,z:o})},e.prototype.parsePolygon=function(t){var r=t.length-1;if(r<3)throw"Face < 3 vertices";for(var n={group:this.currentGroup,material:this.currentMaterial,smoothingGroup:this.smoothingGroup,vertices:[]},i=0;i<r;i++){var o=t[i+1],a=o.split("/"),s=a.length;if(s<1||s>3)throw"Too many / values for single vertex";var f=0,u=0,h=0;if(f=parseInt(a[0],10),s>1&&a[1]!==""&&(u=parseInt(a[1],10)),s>2&&(h=parseInt(a[2],10)),f===0)throw"Faces uses invalid vertex index of 0";f<0&&(f=this.currentModel().vertices.length+1+f),u-=1,f-=1,h-=1,n.vertices.push({textureCoordsIndex:u,vertexIndex:f,vertexNormalIndex:h})}this.currentModel().faces.push(n)},e.prototype.parseMtlLib=function(t){t.length>=2&&this.result.materialLibraries.push(t[1])},e.prototype.parseUseMtl=function(t){t.length>=2&&(this.currentMaterial=t[1])},e.prototype.parseSmoothShadingStatement=function(t){if(t.length!==2)throw"Smoothing group statements must have exactly 1 argument (eg. s <number|off>)";var r=t[1].toLowerCase()==="off"?0:parseInt(t[1],10);this.smoothingGroup=r},e}();function bf(e,t){t===void 0&&(t=!0);var r=new gf(e,t),n=r.parse(),i=[];return n.models.forEach(function(o){for(var a=o.faces,s=o.textureCoords,f=o.vertexNormals,u=o.vertices,h=0,c=0;c<a.length;c++)h+=a[c].vertices.length===4?6:3;for(var m=new Nr({batchSize:h,isDynamic:!1,vertexElementSize:8,elementsPerEntry:3}),d=m.vertexViewF32,v=0,c=0;c<a.length;c++){var g=a[c],p=g.vertices[0],b=g.vertices[1],C=g.vertices[2],S=u[p.vertexIndex],R=u[b.vertexIndex],E=u[C.vertexIndex],_=f[p.vertexNormalIndex],G=f[b.vertexNormalIndex],V=f[C.vertexNormalIndex],P=s[p.textureCoordsIndex],O=s[b.textureCoordsIndex],k=s[C.textureCoordsIndex];if(d[v++]=S.x,d[v++]=S.y,d[v++]=S.z,d[v++]=_.x,d[v++]=_.y,d[v++]=_.z,d[v++]=P.u,d[v++]=P.v,d[v++]=R.x,d[v++]=R.y,d[v++]=R.z,d[v++]=G.x,d[v++]=G.y,d[v++]=G.z,d[v++]=O.u,d[v++]=O.v,d[v++]=E.x,d[v++]=E.y,d[v++]=E.z,d[v++]=V.x,d[v++]=V.y,d[v++]=V.z,d[v++]=k.u,d[v++]=k.v,m.count+=3,g.vertices.length===4){var W=g.vertices[3],K=u[W.vertexIndex],N=f[W.vertexNormalIndex],q=s[W.textureCoordsIndex];d[v++]=S.x,d[v++]=S.y,d[v++]=S.z,d[v++]=_.x,d[v++]=_.y,d[v++]=_.z,d[v++]=P.u,d[v++]=P.v,d[v++]=E.x,d[v++]=E.y,d[v++]=E.z,d[v++]=V.x,d[v++]=V.y,d[v++]=V.z,d[v++]=k.u,d[v++]=k.v,d[v++]=K.x,d[v++]=K.y,d[v++]=K.z,d[v++]=N.x,d[v++]=N.y,d[v++]=N.z,d[v++]=q.u,d[v++]=q.v,m.count+=3}}i.push({name:o.name,buffer:m})}),i}function Ce(e,t){var r=e[t*3+0],n=e[t*3+1],i=e[t*3+2];return[r,n,i]}function ki(e,t){var r=e[t*2+0],n=e[t*2+1];return[r,n]}function Gy(e){for(var t=e.vertices,r=e.normals,n=e.uvs,i=e.indices,o=[],a=0;a<i.length;a+=3){var s=i[a+0],f=i[a+1],u=i[a+2],h=Ce(t,s),c=Ce(t,f),m=Ce(t,u),d=Ce(r,s),v=Ce(r,f),g=Ce(r,u),p=ki(n,s),b=ki(n,f),C=ki(n,u),S=new Mf({x:h[0],y:h[1],z:h[2]},{x:c[0],y:c[1],z:c[2]},{x:m[0],y:m[1],z:m[2]},{x:d[0],y:d[1],z:d[2]},{x:v[0],y:v[1],z:v[2]},{x:g[0],y:g[1],z:g[2]},{x:p[0],y:p[1]},{x:b[0],y:b[1]},{x:C[0],y:C[1]},1);o.push(S)}return o}var Ly=Object.freeze({__proto__:null,CreateVertexSet:ge,FaceUVNormalTexture:Mf,Geometry:ee,GetBufferFromObj:bf,GetBufferFromVertexSet:wf,GetFacesFromVertexSet:Gy,ParseObj:gf});function Qt(e,t,r,n,i,o,a,s,f,u,h,c,m,d){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=1),a===void 0&&(a=2),s===void 0&&(s=1),f===void 0&&(f=-1),u===void 0&&(u=1),h===void 0&&(h=1),c===void 0&&(c=1),m===void 0&&(m=1),d===void 0&&(d=1),e||(e=ge());for(var v=e.vertices,g=e.normals,p=e.uvs,b=e.indices,C=e.numberOfVertices,S=u/m,R=h/d,E=u/2,_=h/2,G=c/2,V=m+1,P=d+1,O=0,k=[],W=0;W<P;W++)for(var K=W*R-_,N=0;N<V;N++){var q=N*S-E;k[i]=q*s,k[o]=K*f,k[a]=G,v.push(t+k[0],r+k[1],n+k[2]),k[i]=0,k[o]=0,k[a]=c>0?1:-1,g.push(k[0],k[1],k[2]),p.push(N/m),p.push(1-W/d),O+=1}for(var W=0;W<d;W++)for(var N=0;N<m;N++){var J=C+N+V*W,X=C+N+V*(W+1),rt=C+(N+1)+V*(W+1),ot=C+(N+1)+V*W;b.push(J,X,ot),b.push(X,rt,ot)}return e.numberOfVertices+=O,e}function Cf(e,t,r,n,i,o,a,s,f){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=1),i===void 0&&(i=1),o===void 0&&(o=1),a===void 0&&(a=1),s===void 0&&(s=1),f===void 0&&(f=1);var u=ge();return Qt(u,e,t,r,2,1,0,-1,-1,o,i,n,f,s),Qt(u,e,t,r,2,1,0,1,-1,o,i,-n,f,s),Qt(u,e,t,r,0,2,1,1,1,n,o,i,a,f),Qt(u,e,t,r,0,2,1,1,-1,n,o,-i,a,f),Qt(u,e,t,r,0,1,2,1,-1,n,i,o,a,s),Qt(u,e,t,r,0,1,2,-1,-1,n,i,-o,a,s),u}var Wi=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.type="GameObject3D",this.name="",this.willUpdate=!0,this.willUpdateChildren=!0,this.willRender=!0,this.willRenderChildren=!0,this.willCacheChildren=!1,this.dirty=0,this.dirtyFrame=0,this.visible=!0,this.children=[],this.events=new Map,this.transform=new xf(this,t,r,n),this.dirty=j.DEFAULT}return e.prototype.isRenderable=function(){return this.visible&&this.willRender},e.prototype.isDirty=function(t){return(this.dirty&t)!=0},e.prototype.clearDirty=function(t){return this.isDirty(t)&&(this.dirty^=t),this},e.prototype.setDirty=function(t,r){return this.isDirty(t)||(this.dirty^=t,this.dirtyFrame=A.getFrame()),this.isDirty(r)||(this.dirty^=r),this},e.prototype.update=function(t,r){if(this.willUpdateChildren)for(var n=this.children,i=0;i<n.length;i++){var o=n[i];o&&o.willUpdate&&o.update(t,r)}this.postUpdate(t,r)},e.prototype.postUpdate=function(t,r){},e.prototype.renderGL=function(t){},e.prototype.postRenderGL=function(t){},Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t){H(this,Qr,this),this.transform.destroy(),this.events.clear(),this.world=null,this.parent=null,this.children=null},e}(),st=function(){function e(t){var r=this;t===void 0&&(t={}),this.isDirty=!1;var n=t.ambient,i=n===void 0?[1,1,1]:n,o=t.diffuse,a=o===void 0?[1,1,1]:o,s=t.specular,f=s===void 0?[1,1,1]:s,u=t.shine,h=u===void 0?.25:u,c=function(){return r.update()};this.ambient=new Yt(c).fromArray(i),this.diffuse=new Yt(c).fromArray(a),this.specular=new Yt(c).fromArray(f),this._shine=h}return Object.defineProperty(e.prototype,"shine",{get:function(){return this._shine},set:function(t){this._shine=at(t,0,1),this.isDirty=!0},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.isDirty=!0},e.prototype.setUniforms=function(t){t.setUniform("uMaterialAmbient",this.ambient.toArray()),t.setUniform("uMaterialDiffuse",this.diffuse.toArray()),t.setUniform("uMaterialSpecular",this.specular.toArray()),t.setUniform("uMaterialShine",this._shine*256)},e.prototype.destroy=function(){this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()},e}();function Tf(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e.getFrame(t);return r.forEach(function(o){!o||i===o.frame||(o.frame=i,o.hasTexture=!0)}),r}function Vy(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!e)r.forEach(function(o){o.texture=null,o.frame=null,o.hasTexture=!1});else{var i;e instanceof mt?i=e:i=jt.get().get(e),i?(r.forEach(function(o){o.texture=i}),Tf.apply(void 0,Y([i,t],L(r)))):console.warn("Invalid Texture key: "+e)}return r}var tr=function(e){z(t,e);function t(r,n,i,o,a){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),a===void 0&&(a=new st);var s=e.call(this,r,n,i)||this;return s.hasTexture=!1,s.cullFaces=!0,s.geometry=o,s.material=a,s.setTexture("__WHITE"),s}return t.prototype.setTexture=function(r,n){return Vy(r,n,this),this},t.prototype.setFrame=function(r){return Tf(this.texture,r,this),this},t.prototype.setMaterial=function(r){return this.material=r,this},t.prototype.renderGL=function(r){var n=r.currentShader.shader;if(n.setUniform("uModelMatrix",this.transform.local.data),n.setUniform("uNormalMatrix",this.transform.normal.data),this.hasTexture){var i=Fs(r,this.texture);n.setUniform("uTexture",i)}this.material.setUniforms(n),am(r,this.geometry.buffer)},t.prototype.destroy=function(r){e.prototype.destroy.call(this,r),this.geometry=null,this.material=null,this.texture=null,this.frame=null,this.hasTexture=!1},t}(Wi),Oy=function(e){z(t,e);function t(r,n,i,o,a,s,f,u,h){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=1),a===void 0&&(a=1),s===void 0&&(s=1),f===void 0&&(f=1),u===void 0&&(u=1),h===void 0&&(h=1);var c=this,m=Cf(0,0,0,o,a,s,f,u,h),d=new ee(m);return c=e.call(this,r,n,i,d)||this,c}return t}(tr);function Sf(e,t,r,n,i,o,a,s,f){for(var u=t.vertices,h=t.normals,c=t.uvs,m=t.indices,d=new D,v=new B,g=e===!0?i:o,p=e===!0?1:-1,b=r,C=1;C<=a;C++)u.push(0,n*p,0),h.push(0,p,0),c.push(.5,.5),r++;for(var S=r,C=0;C<=a;C++){var R=C/a,E=R*f+s,_=Math.cos(E),G=Math.sin(E);v.x=g*G,v.y=n*p,v.z=g*_,u.push(v.x,v.y,v.z),h.push(0,p,0),d.x=_*.5+.5,d.y=G*.5*p+.5,c.push(d.x,d.y),r++}for(var C=0;C<a;C++){var V=b+C,P=S+C;e?m.push(P,P+1,V):m.push(P+1,P,V)}return r}function Rf(e,t,r,n,i,o,a,s){e===void 0&&(e=1),t===void 0&&(t=1),r===void 0&&(r=1),n===void 0&&(n=8),i===void 0&&(i=1),o===void 0&&(o=!1),a===void 0&&(a=0),s===void 0&&(s=Math.PI*2);for(var f=ge(),u=f.vertices,h=f.normals,c=f.uvs,m=f.indices,d=0,v=[],g=r/2,p=new B,b=new B,C=(t-e)/r,S=0;S<=i;S++){for(var R=[],E=S/i,_=E*(t-e)+e,G=0;G<=n;G++){var V=G/n,P=V*s+a,O=Math.sin(P),k=Math.cos(P);b.x=_*O,b.y=-E*r+g,b.z=_*k,u.push(b.x,b.y,b.z),p.set(O,C,k),Dt(p,p),h.push(p.x,p.y,p.z),c.push(V,1-E),R.push(d++)}v.push(R)}for(var G=0;G<n;G++)for(var S=0;S<i;S++){var W=v[S][G],K=v[S+1][G],N=v[S+1][G+1],q=v[S][G+1];m.push(W,K,q),m.push(K,N,q)}return o||(e>0&&(d=Sf(!0,f,d,g,e,t,n,a,s)),t>0&&Sf(!1,f,d,g,e,t,n,a,s)),f.numberOfVertices=u.length,f}function Ef(e,t,r,n,i,o,a){return e===void 0&&(e=1),t===void 0&&(t=1),r===void 0&&(r=8),n===void 0&&(n=1),i===void 0&&(i=!1),o===void 0&&(o=0),a===void 0&&(a=Math.PI*2),Rf(0,e,t,r,n,i,o,a)}var By=function(e){z(t,e);function t(r,n,i,o,a,s,f,u,h,c){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=1),a===void 0&&(a=1),s===void 0&&(s=8),f===void 0&&(f=1),u===void 0&&(u=!1),h===void 0&&(h=0),c===void 0&&(c=Math.PI*2);var m=this,d=Ef(o,a,s,f,u,h,c),v=new ee(d);return m=e.call(this,r,n,i,v)||this,m}return t}(tr),Af=function(){function e(t){var r=this;t===void 0&&(t={}),this.isDirty=!1;var n=t.x,i=n===void 0?0:n,o=t.y,a=o===void 0?0:o,s=t.z,f=s===void 0?.1:s,u=t.ambient,h=u===void 0?[1,1,1]:u,c=t.diffuse,m=c===void 0?[1,1,1]:c,d=t.specular,v=d===void 0?[1,1,1]:d,g=function(){return r.update()};this.position=new Bt(g,i,a,f),this.ambient=new Yt(g).fromArray(h),this.diffuse=new Yt(g).fromArray(m),this.specular=new Yt(g).fromArray(v)}return e.prototype.setUniforms=function(t){t.setUniform("uLightPosition",this.position.toArray()),t.setUniform("uLightAmbient",this.ambient.toArray()),t.setUniform("uLightDiffuse",this.diffuse.toArray()),t.setUniform("uLightSpecular",this.specular.toArray())},e.prototype.update=function(){this.isDirty=!0},e.prototype.destroy=function(){this.position.destroy(),this.ambient.destroy(),this.diffuse.destroy(),this.specular.destroy()},e}(),Py=function(e){z(t,e);function t(r,n,i,o,a,s,f){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=1),a===void 0&&(a=1),s===void 0&&(s=1),f===void 0&&(f=1);var u=this,h=Qt(null,0,0,0,0,1,2,1,-1,o,a,1,s,f),c=new ee(h);return u=e.call(this,r,n,i,c)||this,u}return t}(tr),Iy=function(e){z(t,e);function t(){var r=e.call(this)||this;r.type="RenderLayer",r.willRender=!0,r.willRenderChildren=!0,r.willCacheChildren=!0,r.setDirty(j.CHILD_CACHE);var n=We(),i=Ue(),o=ke(),a=new mt(null,n*o,i*o),s=new Pr(a);return a.binding=s,s.framebuffer=Ur(s.texture),s.depthbuffer=Cs(s.framebuffer,a.width,a.height),r.texture=a,r.framebuffer=s.framebuffer,r}return t.prototype.renderGL=function(r){this.numChildren>0&&(Tt(r),!this.willCacheChildren||this.isDirty(j.CHILD_CACHE)?(je(r,this.framebuffer,!0),this.clearDirty(j.CHILD_CACHE)):(je(r,this.framebuffer,!1),this.postRenderGL(r)))},t.prototype.postRenderGL=function(r){Tt(r),Vr(r),Je(r,this.texture),this.clearDirty(j.TRANSFORM)},t}(Zr);function zf(e,t,r,n,i,o,a){e===void 0&&(e=1),t===void 0&&(t=3),r===void 0&&(r=3),n===void 0&&(n=0),i===void 0&&(i=Math.PI*2),o===void 0&&(o=0),a===void 0&&(a=Math.PI),t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6);for(var s=Math.min(o+a,Math.PI),f=ge(),u=f.vertices,h=f.normals,c=f.uvs,m=f.indices,d=0,v=[],g=new B,p=new B,b=0;b<=r;b++){var C=[],S=b/r,R=0;b===0&&o===0?R=.5/t:b===r&&s==Math.PI&&(R=-.5/t);for(var E=0;E<=t;E++){var _=E/t;g.x=-e*Math.cos(n+_*i)*Math.sin(o+S*a),g.y=e*Math.cos(o+S*a),g.z=e*Math.sin(n+_*i)*Math.sin(o+S*a),u.push(g.x,g.y,g.z),Dt(g,p),h.push(p.x,p.y,p.z),c.push(_+R,1-S),C.push(d++)}v.push(C)}for(var b=0;b<r;b++)for(var E=0;E<t;E++){var G=v[b][E+1],V=v[b][E],P=v[b+1][E],O=v[b+1][E+1];(b!==0||o>0)&&m.push(G,V,O),(b!==r-1||s<Math.PI)&&m.push(V,P,O)}return f.numberOfVertices=u.length,f}var Ny=function(e){z(t,e);function t(r,n,i,o,a,s,f,u,h,c){r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=1),a===void 0&&(a=3),s===void 0&&(s=3),f===void 0&&(f=0),u===void 0&&(u=Math.PI*2),h===void 0&&(h=0),c===void 0&&(c=Math.PI);var m=this,d=zf(o,a,s,f,u,h,c),v=new ee(d);return m=e.call(this,r,n,i,v)||this,m}return t}(tr),Uy=Object.freeze({__proto__:null,Components:zy,Geometry:Ly,Box:Oy,Cone:By,Light:Af,Material:st,Mesh:tr,Plane:Py,RenderLayer3D:Iy,Sphere:Ny,GameObject3D:Wi});function Et(e,t,r){if(e.radius>0&&t>=e.left&&t<=e.right&&r>=e.top&&r<=e.bottom){var n=(e.x-t)*(e.x-t),i=(e.y-r)*(e.y-r);return n+i<=e.radius*e.radius}else return!1}var Ff=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.set(t,r,n)}return e.prototype.set=function(t,r,n){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=t,this.y=r,this.radius=n,this},e.prototype.contains=function(t,r){return Et(this,t,r)},Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=t*2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diameter",{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=t*.5},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius},enumerable:!1,configurable:!0}),e}();function ky(e,t){return Et(e,t.x,t.y)}function Wy(e,t){return Et(e,t.x,t.y)&&Et(e,t.right,t.y)&&Et(e,t.x,t.bottom)&&Et(e,t.right,t.bottom)}function jy(e,t){return e.x===t.x&&e.y===t.y&&e.radius===t.radius}function Hy(e){return new Ff(e.x,e.y,e.radius)}function Qy(e,t){return t.set(e.x,e.y,e.radius)}function Ky(e){return e.radius>0?Math.PI*e.radius*e.radius:0}function Xy(e,t){return t===void 0&&(t=new yt),t.set(e.left,e.top,e.diameter,e.diameter)}function _f(e){return 2*(Math.PI*e.radius)}function ji(e,t,r){return r===void 0&&(r=new D),r.set(e.x+e.radius*Math.cos(t),e.y+e.radius*Math.sin(t))}function $y(e,t,r){r===void 0&&(r=new D);var n=Ne(t,0,ct.PI2);return ji(e,n,r)}function Yy(e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=[]),r||(r=_f(e)/t);for(var i=0;i<r;i++){var o=Ne(i/r,0,ct.PI2);n.push(ji(e,o))}return n}function qy(e,t){t===void 0&&(t=new D);var r=2*Math.PI*Math.random(),n=Math.random()+Math.random(),i=n>1?2-n:n,o=i*Math.cos(r),a=i*Math.sin(r);return t.set(e.x+o*e.radius,e.y+a*e.radius)}function Zy(e,t,r){return e.x+=t,e.y+=r,e}function Jy(e,t){return e.x+=t.x,e.y+=t.y,e}var tx=Object.freeze({__proto__:null,Circle:Ff,CircleContains:Et,CircleContainsPoint:ky,CircleContainsRect:Wy,CircleEquals:jy,GetCircleRandomPoint:qy,CloneCircle:Hy,CopyCircleFrom:Qy,GetCircleArea:Ky,GetCircleBounds:Xy,GetCircleCircumference:_f,GetCircleCircumferencePoint:ji,GetCirclePoint:$y,GetCirclePoints:Yy,TranslateCircle:Zy,TranslateCirclePoint:Jy});function re(e,t,r){if(e.width<=0||e.height<=0)return!1;var n=(t-e.x)/e.width,i=(r-e.y)/e.height;return n*=n,i*=i,n+i<.25}var Df=function(){function e(t,r,n,i){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.set(t,r,n,i)}return e.prototype.set=function(t,r,n,i){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=t,this.y=r,this.width=n,this.height=i,this},e.prototype.contains=function(t,r){return re(this,t,r)},e.prototype.getMinorRadius=function(){return Math.min(this.width,this.height)/2},e.prototype.getMajorRadius=function(){return Math.max(this.width,this.height)/2},Object.defineProperty(e.prototype,"left",{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2},enumerable:!1,configurable:!0}),e}();function ex(e){return new Df(e.x,e.y,e.width,e.height)}function rx(e,t){return t.set(e.x,e.y,e.width,e.height)}function nx(e,t){return re(e,t.x,t.y)}function ix(e,t){return re(e,t.x,t.y)&&re(e,t.right,t.y)&&re(e,t.x,t.bottom)&&re(e,t.right,t.bottom)}function ox(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function ax(e){return e.width<=0||e.height<=0?0:e.getMajorRadius()*e.getMinorRadius()*Math.PI}function sx(e,t){return t===void 0&&(t=new yt),t.set(e.left,e.top,e.width,e.height)}function Gf(e){var t=e.width/2,r=e.height/2,n=Math.pow(t-r,2)/Math.pow(t+r,2);return Math.PI*(t+r)*(1+3*n/(10+Math.sqrt(4-3*n)))}function Hi(e,t,r){r===void 0&&(r=new D);var n=e.width/2,i=e.height/2;return r.set(e.x+n*Math.cos(t),e.y+i*Math.sin(t))}function fx(e,t,r){r===void 0&&(r=new D);var n=Ne(t,0,ct.PI2);return Hi(e,n,r)}function ux(e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=[]),r||(r=Gf(e)/t);for(var i=0;i<r;i++){var o=Ne(i/r,0,ct.PI2);n.push(Hi(e,o))}return n}function hx(e,t){t===void 0&&(t=new D);var r=Math.random()*Math.PI*2,n=Math.sqrt(Math.random());return t.x=e.x+n*Math.cos(r)*e.width/2,t.y=e.y+n*Math.sin(r)*e.height/2,t}function cx(e,t,r){return e.x+=t,e.y+=r,e}function lx(e,t){return e.x+=t.x,e.y+=t.y,e}var dx=Object.freeze({__proto__:null,CloneEllipse:ex,CopyEllipseFrom:rx,Ellipse:Df,EllipseContains:re,EllipseContainsPoint:nx,EllipseContainsRect:ix,EllipseEquals:ox,GetEllipseRandomPoint:hx,GetEllipseArea:ax,GetEllipseBounds:sx,GetEllipseCircumference:Gf,GetEllipseCircumferencePoint:Hi,GetEllipsePoint:fx,GetEllipsePoints:ux,TranslateEllipse:cx,TranslateEllipsePoint:lx});function Lf(e,t){return de(e,t)<=e.radius+t.radius}function Vf(e,t){var r=t.width/2,n=t.height/2,i=Math.abs(e.x-t.x-r),o=Math.abs(e.y-t.y-n),a=r+e.radius,s=n+e.radius;if(i>a||o>s)return!1;if(i<=r||o<=n)return!0;var f=i-r,u=o-n,h=f*f,c=u*u,m=e.radius*e.radius;return h+c<=m}function vx(e,t,r){if(r===void 0&&(r=[]),Lf(e,t)){var n=e.x,i=e.y,o=e.radius,a=t.x,s=t.y,f=t.radius,u=void 0,h=void 0,c=void 0,m=void 0,d=void 0;if(i===s)d=(f*f-o*o-a*a+n*n)/(2*(n-a)),u=1,h=-2*s,c=a*a+d*d-2*a*d+s*s-f*f,m=h*h-4*u*c,m===0?r.push(new D(d,-h/(2*u))):m>0&&(r.push(new D(d,(-h+Math.sqrt(m))/(2*u))),r.push(new D(d,(-h-Math.sqrt(m))/(2*u))));else{var v=(n-a)/(i-s),g=(f*f-o*o-a*a+n*n-s*s+i*i)/(2*(i-s));u=v*v+1,h=2*i*v-2*g*v-2*n,c=n*n+i*i+g*g-o*o-2*i*g,m=h*h-4*u*c,m===0?(d=-h/(2*u),r.push(new D(d,g-d*v))):m>0&&(d=(-h+Math.sqrt(m))/(2*u),r.push(new D(d,g-d*v)),d=(-h-Math.sqrt(m))/(2*u),r.push(new D(d,g-d*v)))}}return r}var mx=new D;function er(e,t,r){r||(r=mx);var n=e.x1,i=e.y1,o=e.x2,a=e.y2;if(Et(t,n,i))return r.set(n,i),!0;if(Et(t,o,a))return r.set(o,a),!0;var s=o-n,f=a-i,u=t.x-n,h=t.y-i,c=s*s+f*f,m=s,d=f;if(c>0){var v=(u*s+h*f)/c;m*=v,d*=v}r.set(n+m,i+d);var g=m*m+d*d;return g<=c&&m*s+d*f>=0&&Et(t,r.x,r.y)}function Kt(e,t,r){if(r===void 0&&(r=[]),er(e,t)){var n=e.x1,i=e.y1,o=e.x2,a=e.y2,s=t.radius,f=o-n,u=a-i,h=n-t.x,c=i-t.y,m=f*f+u*u,d=2*(f*h+u*c),v=h*h+c*c-s*s,g=d*d-4*m*v,p=void 0,b=void 0;if(g===0){var C=-d/(2*m);p=n+C*f,b=i+C*u,C>=0&&C<=1&&r.push(new D(p,b))}else if(g>0){var S=(-d-Math.sqrt(g))/(2*m);p=n+S*f,b=i+S*u,S>=0&&S<=1&&r.push(new D(p,b));var R=(-d+Math.sqrt(g))/(2*m);p=n+R*f,b=i+R*u,R>=0&&R<=1&&r.push(new D(p,b))}}return r}function px(e,t,r){if(r===void 0&&(r=[]),Vf(e,t)){var n=L(Ye(t),4),i=n[0],o=n[1],a=n[2],s=n[3];Kt(i,e,r),Kt(o,e,r),Kt(a,e,r),Kt(s,e,r)}return r}function et(e,t,r){var n=e.x1,i=e.y1,o=e.x2,a=e.y2,s=t.x1,f=t.y1,u=t.x2,h=t.y2,c=(u-s)*(i-f)-(h-f)*(n-s),m=(o-n)*(i-f)-(a-i)*(n-s),d=(h-f)*(o-n)-(u-s)*(a-i);if(d===0)return!1;var v=c/d,g=m/d;return v>=0&&v<=1&&g>=0&&g<=1?(r&&r.set(n+v*(o-n),i+v*(a-i)),!0):!1}function Of(e,t){var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=t.x,s=t.y,f=t.right,u=t.bottom,h=0;if(r>=a&&r<=f&&n>=s&&n<=u||i>=a&&i<=f&&o>=s&&o<=u)return!0;if(r<a&&i>=a){if(h=n+(o-n)*(a-r)/(i-r),h>s&&h<=u)return!0}else if(r>f&&i<=f&&(h=n+(o-n)*(f-r)/(i-r),h>=s&&h<=u))return!0;if(n<s&&o>=s){if(h=r+(i-r)*(s-n)/(o-n),h>=a&&h<=f)return!0}else if(n>u&&o<=u&&(h=r+(i-r)*(u-n)/(o-n),h>=a&&h<=f))return!0;return!1}function Xt(e,t,r){if(r===void 0&&(r=[]),Of(e,t))for(var n=L(Ye(t),4),i=n[0],o=n[1],a=n[2],s=n[3],f=[new D,new D,new D,new D],u=[et(i,e,f[0]),et(o,e,f[1]),et(a,e,f[2]),et(s,e,f[3])],h=0;h<u.length;h++)u[h]&&r.push(f[h]);return r}function yx(e,t,r){if(r===void 0&&(r=new yt),Qe(e,t)){var n=Math.max(e.x,t.x),i=Math.max(e.y,t.y);return r.set(n,i,Math.min(e.right,t.right)-n,Math.min(e.bottom,t.bottom)-i)}}function xx(e,t,r){if(r===void 0&&(r=[]),Qe(e,t)){var n=L(Ye(e),4),i=n[0],o=n[1],a=n[2],s=n[3];Xt(i,t,r),Xt(o,t,r),Xt(a,t,r),Xt(s,t,r)}return r}function bt(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2,o=e.x3,a=e.y3,s=new It(t,r,n,i),f=new It(n,i,o,a),u=new It(o,a,t,r);return[s,f,u]}function ne(e,t,r){var n=e.x1,i=e.y1,o=e.x2,a=e.y2,s=e.x3,f=e.y3,u=s-n,h=f-i,c=o-n,m=a-i,d=t-n,v=r-i,g=u*u+h*h,p=u*c+h*m,b=u*d+h*v,C=c*c+m*m,S=c*d+m*v,R=g*C-p*p,E=R===0?0:1/R,_=(C*b-p*S)*E,G=(g*S-p*b)*E;return _>=0&&G>=0&&_+G<1}function Jr(e,t,r,n){r===void 0&&(r=!1),n===void 0&&(n=[]);var i=!1;return t.forEach(function(o){if(!i){var a=o.x,s=o.y;ne(e,a,s)&&(n.push(new D(a,s)),r&&(i=!0))}}),n}function Bf(e,t){if(t.left>e.right||t.right<e.x||t.top>e.bottom||t.bottom<e.y)return!1;var r=L(bt(t),3),n=r[0],i=r[1],o=r[2];if(Ot(e,n.x1,n.y1)||Ot(e,n.x2,n.y2)||Ot(e,i.x1,i.y1)||Ot(e,i.x2,i.y2)||Ot(e,o.x1,o.y1)||Ot(e,o.x2,o.y2))return!0;var a=L(Ye(e),4),s=a[0],f=a[1],u=a[2],h=a[3];if(et(n,s)||et(n,f)||et(n,u)||et(n,h)||et(i,s)||et(i,f)||et(i,u)||et(i,h)||et(o,s)||et(o,f)||et(o,u)||et(o,h))return!0;var c=Jr(t,of(e),!0);return c.length>0}function Mx(e,t,r){if(r===void 0&&(r=[]),Bf(e,t)){var n=L(bt(t),3),i=n[0],o=n[1],a=n[2];Xt(i,e,r),Xt(o,e,r),Xt(a,e,r)}return r}function Pf(e,t){if(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)return!1;if(ne(e,t.x,t.y))return!0;var r=L(bt(e),3),n=r[0],i=r[1],o=r[2];return er(n,t)||er(i,t)||er(o,t)}function wx(e,t,r){if(r===void 0&&(r=[]),Pf(e,t)){var n=L(bt(e),3),i=n[0],o=n[1],a=n[2];Kt(i,t,r),Kt(o,t,r),Kt(a,t,r)}return r}function If(e,t){var r=t.x1,n=t.y1,i=t.x2,o=t.y2;if(ne(e,r,n)||ne(e,i,o))return!0;var a=L(bt(e),3),s=a[0],f=a[1],u=a[2];return et(s,t)||et(f,t)||et(u,t)}function tn(e,t,r){if(r===void 0&&(r=[]),If(e,t))for(var n=L(bt(e),3),i=n[0],o=n[1],a=n[2],s=[new D,new D,new D],f=[et(i,t,s[0]),et(o,t,s[1]),et(a,t,s[2])],u=0;u<f.length;u++)f[u]&&r.push(s[u]);return r}function Qi(e,t){t===void 0&&(t=[]);var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=e.x3,s=e.y3;return t.push(new D(r,n),new D(i,o),new D(a,s)),t}function Nf(e,t){if(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)return!1;var r=L(bt(e),3),n=r[0],i=r[1],o=r[2],a=L(bt(t),3),s=a[0],f=a[1],u=a[2];if(et(n,s)||et(n,f)||et(n,u)||et(i,s)||et(i,f)||et(i,u)||et(o,s)||et(o,f)||et(o,u))return!0;var h=Jr(t,Qi(e),!0);if(h.length>0)return!0;var c=Jr(e,Qi(t),!0);return c.length>0}function gx(e,t,r){if(r===void 0&&(r=[]),Nf(e,t)){var n=L(bt(t),3),i=n[0],o=n[1],a=n[2];tn(e,i,r),tn(e,o,r),tn(e,a,r)}return r}function Uf(e,t,r){r===void 0&&(r=1);var n=t.x1,i=t.y1,o=t.x2,a=t.y2,s=e.x,f=e.y,u=(o-n)*(o-n)+(a-i)*(a-i);if(u===0)return!1;var h=((s-n)*(o-n)+(f-i)*(a-i))/u;if(h<0)return Math.sqrt((n-s)*(n-s)+(i-f)*(i-f))<=r;if(h>=0&&h<=1){var c=((i-f)*(o-n)-(n-s)*(a-i))/u;return Math.abs(c)*Math.sqrt(u)<=r}else return Math.sqrt((o-s)*(o-s)+(a-f)*(a-f))<=r}function bx(e,t){if(!Uf(e,t))return!1;var r=t.x1,n=t.y1,i=t.x2,o=t.y2,a=e.x,s=e.y,f=Math.min(r,i),u=Math.max(r,i),h=Math.min(n,o),c=Math.max(n,o);return a>=f&&a<=u&&s>=h&&s<=c}var Cx=Object.freeze({__proto__:null,CircleToCircle:Lf,CircleToRectangle:Vf,GetCircleToCircle:vx,GetCircleToRectangle:px,GetLineToCircle:Kt,GetLineToRectangle:Xt,GetRectangleIntersection:yx,GetRectangleToRectangle:xx,GetRectangleToTriangle:Mx,GetTriangleToCircle:wx,GetTriangleToLine:tn,GetTriangleToTriangle:gx,LineToCircle:er,LineToLine:et,LineToRectangle:Of,PointToLine:Uf,PointToLineSegment:bx,RectangleToRectangle:Qe,RectangleToTriangle:Bf,TriangleToCircle:Pf,TriangleToLine:If,TriangleToTriangle:Nf});function Tx(e,t,r){var n=t-(e.x1+e.x2)/2,i=r-(e.y1+e.y2)/2;return e.x1+=n,e.y1+=i,e.x2+=n,e.y2+=i,e}function Sx(e){return new It(e.x1,e.y1,e.x2,e.y2)}function Rx(e,t){return t.set(e.x1,e.y1,e.x2,e.y2)}function St(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2;return Math.sqrt((n-t)*(n-t)+(i-r)*(i-r))}function Ex(e,t,r){r===void 0&&(r=t);var n=St(e),i=e.x2-e.x1,o=e.y2-e.y1;return t&&(e.x1=e.x1-i/n*t,e.y1=e.y1-o/n*t),r&&(e.x2=e.x2+i/n*r,e.y2=e.y2+o/n*r),e}function Te(e){return Math.atan2(e.y2-e.y1,e.x2-e.x1)}function Ax(e,t,r){t===void 0&&(t=1),r===void 0&&(r=[]);var n=Math.round(e.x1),i=Math.round(e.y1),o=Math.round(e.x2),a=Math.round(e.y2),s=Math.abs(o-n),f=Math.abs(a-i),u=n<o?1:-1,h=i<a?1:-1,c=s-f;r.push(new D(n,i));for(var m=1;!(n===o&&i===a);){var d=c<<1;d>-f&&(c-=f,n+=u),d<s&&(c+=s,i+=h),m%t==0&&r.push(new D(n,i)),m++}return r}function zx(e){return Math.abs(e.y1-e.y2)}function Fx(e,t){return t===void 0&&(t=new D),t.x=(e.x1+e.x2)/2,t.y=(e.y1+e.y2)/2,t}function _x(e,t,r){r===void 0&&(r=new D);var n=e.x1,i=e.y1,o=e.x2,a=e.y2,s=(o-n)*(o-n)+(a-i)*(a-i);if(s===0)return r;var f=((t.x-n)*(o-n)+(t.y-i)*(a-i))/s;return r.x=n+f*(o-n),r.y=i+f*(a-i),r}function Dx(e,t){t===void 0&&(t=new D);var r=Te(e)-ct.HALF_PI;return t.x=Math.cos(r),t.y=Math.sin(r),t}function kf(e){var t=Te(e)-ct.HALF_PI;return pr(t,-Math.PI,Math.PI)}function Gx(e){return Math.cos(Te(e)-ct.HALF_PI)}function Lx(e){return Math.sin(Te(e)-ct.HALF_PI)}function Vx(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2;return-((n-t)/(i-r))}function Ox(e,t,r){return r===void 0&&(r=new D),r.x=e.x1+(e.x2-e.x1)*t,r.y=e.y1+(e.y2-e.y1)*t,r}function Bx(e,t,r,n){r===void 0&&(r=0),n===void 0&&(n=[]),t||(t=St(e)/r);for(var i=e.x1,o=e.y1,a=e.x2,s=e.y2,f=0;f<t;f++){var u=f/t,h=i+(a-i)*u,c=o+(s-o)*u;n.push(new D(h,c))}return n}function Px(e,t){t===void 0&&(t=new D);var r=Math.random();return t.x=e.x1+r*(e.x2-e.x1),t.y=e.y1+r*(e.y2-e.y1),t}function Ix(e,t){return 2*kf(t)-Math.PI-Te(e)}function Nx(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2;return(i-r)/(n-t)}function Ux(e){return Math.abs(e.x1-e.x2)}function kx(e,t){var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=(i-r)*(i-r)+(o-n)*(o-n);if(a===0)return 0;var s=((n-t.y)*(i-r)-(r-t.x)*(o-n))/a;return Math.abs(s)*Math.sqrt(a)}function Wx(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}function jx(e,t,r,n,i){return e.x1=t,e.y1=r,e.x2=t+Math.cos(n)*i,e.y2=r+Math.sin(n)*i,e}function Ki(e,t,r,n){var i=Math.cos(n),o=Math.sin(n),a=e.x1-t,s=e.y1-r;return e.x1=a*i-s*o+t,e.y1=a*o+s*i+r,a=e.x2-t,s=e.y2-r,e.x2=a*i-s*o+t,e.y2=a*o+s*i+r,e}function Hx(e,t){var r=(e.x1+e.x2)/2,n=(e.y1+e.y2)/2;return Ki(e,r,n,t)}function Qx(e,t,r){return Ki(e,t.x,t.y,r)}function Wf(e,t,r){return e.x1+=t,e.y1+=r,e.x2+=t,e.y2+=r,e}function Kx(e,t){return Wf(e,t.x,t.y)}var Xx=Object.freeze({__proto__:null,CenterLineOn:Tx,CloneLine:Sx,CopyLineFrom:Rx,ExtendLine:Ex,GetLineAngle:Te,GetLineBresenhamPoints:Ax,GetLineHeight:zx,GetLineLength:St,GetLineMidPoint:Fx,GetLineNearestPoint:_x,GetLineNormal:Dx,GetLineNormalAngle:kf,GetLineNormalX:Gx,GetLineNormalY:Lx,GetLinePerpSlope:Vx,GetLinePoint:Ox,GetLinePoints:Bx,GetLineReflectAngle:Ix,GetLineSlope:Nx,GetLineWidth:Ux,GetLineRandomPoint:Px,GetShortestLineDistance:kx,Line:It,LineEquals:Wx,LineSetToAngle:jx,RotateLine:Hx,RotateLineAround:Ki,RotateLineAroundPoint:Qx,TranslateLine:Wf,TranslateLinePoint:Kx}),en=function(){function e(t,r,n,i,o,a){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),this.set(t,r,n,i,o,a)}return e.prototype.set=function(t,r,n,i,o,a){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0),a===void 0&&(a=0),this.x1=t,this.y1=r,this.x2=n,this.y2=i,this.x3=o,this.y3=a,this},e.prototype.contains=function(t,r){return ne(this,t,r)},Object.defineProperty(e.prototype,"left",{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var r=0;this.x1<=this.x2&&this.x1<=this.x3?r=this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?r=this.x2-t:r=this.x3-t,this.x1-=r,this.x2-=r,this.x3-=r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var r=0;this.x1>=this.x2&&this.x1>=this.x3?r=this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?r=this.x2-t:r=this.x3-t,this.x1-=r,this.x2-=r,this.x3-=r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var r=0;this.y1<=this.y2&&this.y1<=this.y3?r=this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?r=this.y2-t:r=this.y3-t,this.y1-=r,this.y2-=r,this.y3-=r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var r=0;this.y1>=this.y2&&this.y1>=this.y3?r=this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?r=this.y2-t:r=this.y3-t,this.y1-=r,this.y2-=r,this.y3-=r},enumerable:!1,configurable:!0}),e}();function $x(e,t,r){var n=r*(Math.sqrt(3)/2),i=e,o=t,a=e+r/2,s=t+n,f=e-r/2,u=t+n;return new en(i,o,a,s,f,u)}function Yx(e,t,r,n){n===void 0&&(n=r);var i=e,o=t,a=e,s=t-n,f=e+r,u=t;return new en(i,o,a,s,f,u)}function jf(e,t){return t===void 0&&(t=new D),t.set((e.x1+e.x2+e.x3)/3,(e.y1+e.y2+e.y3)/3)}function Hf(e,t,r){return e.x1+=t,e.y1+=r,e.x2+=t,e.y2+=r,e.x3+=t,e.y3+=r,e}function qx(e,t,r,n){n===void 0&&(n=jf);var i=n(e),o=t-i.x,a=r-i.y;return Hf(e,o,a)}function Zx(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2,o=e.x3,a=e.y3;return new en(t,r,n,i,o,a)}function Jx(e,t){var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=e.x3,s=e.y3;return t.set(r,n,i,o,a,s)}function t1(e){var t=e.x1,r=e.y1,n=e.x2,i=e.y2,o=e.x3,a=e.y3;return Math.abs(((o-t)*(i-r)-(n-t)*(a-r))/2)}function Xi(e,t,r,n){return e*n-t*r}function e1(e,t){t===void 0&&(t=new D);var r=e.x3,n=e.y3,i=e.x1-r,o=e.y1-n,a=e.x2-r,s=e.y2-n,f=2*Xi(i,o,a,s),u=Xi(o,i*i+o*o,s,a*a+s*s),h=Xi(i,i*i+o*o,a,a*a+s*s);return t.set(r-u/f,n+h/f)}var r1=function(){function e(t,r,n){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.set(t,r,n)}return e.prototype.set=function(t,r,n){return t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),this.x=t,this.y=r,this.radius=n,this},e.prototype.contains=function(t,r){return Et(this,t,r)},Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=t*2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diameter",{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=t*.5},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius},enumerable:!1,configurable:!0}),e}();function n1(e,t){t===void 0&&(t=new r1);var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=e.x3,s=e.y3,f=i-r,u=o-n,h=a-r,c=s-n,m=f*(r+i)+u*(n+o),d=h*(r+a)+c*(n+s),v=2*(f*(s-o)-u*(a-i));if(Math.abs(v)<1e-6){var g=Math.min(r,i,a),p=Math.min(n,o,s),b=(Math.max(r,i,a)-g)*.5,C=(Math.max(n,o,s)-p)*.5;return t.set(g+b,p+C,Math.sqrt(b*b+C*C))}else{var S=(c*m-u*d)/v,R=(f*d-h*m)/v,b=S-r,C=R-n;return t.set(S,R,Math.sqrt(b*b+C*C))}}function $i(e,t,r,n){var i=e-r,o=t-n;return Math.sqrt(i*i+o*o)}function Qf(e,t){t===void 0&&(t=new D);var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=e.x3,s=e.y3,f=$i(a,s,i,o),u=$i(r,n,a,s),h=$i(i,o,r,n),c=f+u+h;return t.set((r*f+i*u+a*h)/c,(n*f+o*u+s*h)/c)}function i1(e){var t=L(bt(e),3),r=t[0],n=t[1],i=t[2];return St(r)+St(n)+St(i)}function o1(e,t,r){r===void 0&&(r=new D);var n=L(bt(e),3),i=n[0],o=n[1],a=n[2];if(t<=0||t>=1)return r.set(i.x1,i.y1);var s=St(i),f=St(o),u=St(a),h=s+f+u,c=h*t,m=0;if(c<s){m=c/s;var d=i.x1,v=i.y1,g=i.x2,p=i.y2;return r.set(d+(g-d)*m,v+(p-v)*m)}else if(c>s+f){c-=s+f,m=c/u;var d=a.x1,v=a.y1,g=a.x2,p=a.y2;return r.set(d+(g-d)*m,v+(p-v)*m)}else{c-=s,m=c/f;var d=o.x1,v=o.y1,g=o.x2,p=o.y2;return r.set(d+(g-d)*m,v+(p-v)*m)}}function a1(e,t,r,n){n===void 0&&(n=[]);var i=L(bt(e),3),o=i[0],a=i[1],s=i[2],f=St(o),u=St(a),h=St(s),c=f+u+h;t||(t=c/r);for(var m=0;m<t;m++){var d=c*(m/t),v=0,g=void 0;if(d<f){v=d/f;var p=o.x1,b=o.y1,C=o.x2,S=o.y2;g=new D(p+(C-p)*v,b+(S-b)*v)}else if(d>f+u){d-=f+u,v=d/h;var p=s.x1,b=s.y1,C=s.x2,S=s.y2;g=new D(p+(C-p)*v,b+(S-b)*v)}else{d-=f,v=d/u;var p=a.x1,b=a.y1,C=a.x2,S=a.y2;g=new D(p+(C-p)*v,b+(S-b)*v)}n.push(g)}return n}function s1(e,t){t===void 0&&(t=new D);var r=e.x1,n=e.y1,i=e.x2,o=e.y2,a=e.x3,s=e.y3,f=i-r,u=o-n,h=a-r,c=s-n,m=Math.random(),d=Math.random();return m+d>=1&&(m=1-m,d=1-d),t.set(r+(f*m+h*d),n+(u*m+c*d))}function Yi(e,t,r,n){var i=e.x1,o=e.y1,a=e.x2,s=e.y2,f=e.x3,u=e.y3,h=Math.cos(n),c=Math.sin(n);return e.set((i-t)*h-(o-r)*c+t,(i-t)*c+(o-r)*h+r,(a-t)*h-(s-r)*c+t,(a-t)*c+(s-r)*h+r,(f-t)*h-(u-r)*c+t,(f-t)*c+(u-r)*h+r)}function f1(e,t){var r=Qf(e);return Yi(e,r.x,r.y,t)}function u1(e,t,r){return Yi(e,t.x,t.y,r)}function h1(e,t){return ne(e,t.x,t.y)}function c1(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2&&e.x3===t.x3&&e.y3===t.y3}var l1=Object.freeze({__proto__:null,BuildEquilateralTriangle:$x,BuildRightTriangle:Yx,CenterTriangleOn:qx,CloneTriangle:Zx,CopyTriangleFrom:Jx,DecomposeTriangle:Qi,GetTriangleArea:t1,GetTriangleCentroid:jf,GetTriangleCircumCenter:e1,GetTriangleCircumCircle:n1,GetTriangleEdges:bt,GetTriangleInCenter:Qf,GetTrianglePerimeter:i1,GetTrianglePoint:o1,GetTrianglePoints:a1,GetTriangleRandomPoint:s1,RotateTriangle:f1,RotateTriangleAround:Yi,RotateTriangleAroundPoint:u1,TranslateTriangle:Hf,Triangle:en,TriangleContains:ne,TriangleContainsPoint:h1,TriangleContainsPoints:Jr,TriangleEquals:c1}),d1=Object.freeze({__proto__:null,Circle:tx,Ellipse:dx,Intersects:Cx,Line:Xx,Rectangle:py,Triangle:l1});function v1(e,t,r,n,i){e===void 0&&(e=1),t===void 0&&(t=.4),r===void 0&&(r=8),n===void 0&&(n=6),i===void 0&&(i=Math.PI*2);for(var o=ge(),a=o.vertices,s=o.normals,f=o.uvs,u=o.indices,h=new B,c=new B,m=new B,d=0;d<=r;d++)for(var v=0;v<=n;v++){var g=v/n*i,p=d/r*Math.PI*2;c.x=(e+t*Math.cos(p))*Math.cos(g),c.y=(e+t*Math.cos(p))*Math.sin(g),c.z=t*Math.sin(p),a.push(c.x,c.y,c.z),h.x=e*Math.cos(g),h.y=e*Math.sin(g),br(c,h,m),Dt(m,m),s.push(m.x,m.y,m.z),f.push(v/n),f.push(d/r)}for(var d=1;d<=r;d++)for(var v=1;v<=n;v++){var b=(n+1)*d+v-1,C=(n+1)*(d-1)+v-1,S=(n+1)*(d-1)+v,R=(n+1)*d+v;u.push(b,C,R),u.push(C,S,R)}return o.numberOfVertices=a.length,o}var m1=Object.freeze({__proto__:null,BoxGeometry:Cf,ConeGeometry:Ef,CylinderGeometry:Rf,PlaneGeometry:Qt,SphereGeometry:zf,TorusGeometry:v1}),Q=function(){function e(t){this.capture=!0,this.isDown=!1,this.enabled=!0,this.repeatRate=0,this.canRepeat=!0,this.timeDown=0,this.timeUpdated=0,this.timeUp=0,this.value=t,this.events=new Map}return e.prototype.getValue=function(){return this.value},e.prototype.down=function(t){if(!!this.enabled)if(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&this.canRepeat){this.timeUpdated=t.timeStamp;var r=this.timeUpdated-this.timeDown;r>=this.repeatRate&&(H(this,"keydown",this),this.downCallback&&this.downCallback(this))}else this.isDown=!0,this.timeDown=t.timeStamp,this.timeUpdated=t.timeStamp,H(this,"keydown",this),this.downCallback&&this.downCallback(this)},e.prototype.up=function(t){!this.enabled||(this.capture&&t.preventDefault(),this.shiftKey=t.shiftKey,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.isDown&&(this.isDown=!1,this.timeUp=t.timeStamp,this.timeUpdated=t.timeStamp,H(this,"keyup",this),this.upCallback&&this.upCallback(this)))},e.prototype.reset=function(){this.isDown=!1,this.timeUpdated=this.timeDown,this.timeUp=this.timeDown},e.prototype.destroy=function(){this.downCallback=null,this.upCallback=null,this.events.clear()},e}(),p1=function(e){z(t,e);function t(){return e.call(this,"a")||this}return t}(Q),y1=function(){function e(t,r){var n=r.left,i=n===void 0?!0:n,o=r.right,a=o===void 0?!0:o,s=r.up,f=s===void 0?!0:s,u=r.down,h=u===void 0?!0:u,c=r.space,m=c===void 0?!0:c,d=t.keys;i&&(this.left=new Q("ArrowLeft"),d.set(this.left.value,this.left)),a&&(this.right=new Q("ArrowRight"),d.set(this.right.value,this.right)),f&&(this.up=new Q("ArrowUp"),d.set(this.up.value,this.up)),h&&(this.down=new Q("ArrowDown"),d.set(this.down.value,this.down)),m&&(this.space=new Q(" "),d.set(this.space.value,this.space))}return e}(),x1=function(e){z(t,e);function t(){return e.call(this,"b")||this}return t}(Q),M1=function(e){z(t,e);function t(){return e.call(this,"c")||this}return t}(Q),w1=function(e){z(t,e);function t(){return e.call(this,"d")||this}return t}(Q),g1=function(e){z(t,e);function t(){return e.call(this,"ArrowDown")||this}return t}(Q),b1=function(e){z(t,e);function t(){return e.call(this,"e")||this}return t}(Q),C1=function(e){z(t,e);function t(){return e.call(this,"f")||this}return t}(Q),T1=function(e){z(t,e);function t(){return e.call(this,"g")||this}return t}(Q),S1=function(e){z(t,e);function t(){return e.call(this,"h")||this}return t}(Q),R1=function(e){z(t,e);function t(){return e.call(this,"i")||this}return t}(Q),E1=function(e){z(t,e);function t(){return e.call(this,"j")||this}return t}(Q),A1=function(e){z(t,e);function t(){return e.call(this,"k")||this}return t}(Q),z1=function(e){z(t,e);function t(){return e.call(this,"l")||this}return t}(Q),F1=function(e){z(t,e);function t(){return e.call(this,"ArrowLeft")||this}return t}(Q),_1=function(e){z(t,e);function t(){return e.call(this,"m")||this}return t}(Q),D1=function(e){z(t,e);function t(){return e.call(this,"n")||this}return t}(Q),G1=function(e){z(t,e);function t(){return e.call(this,"o")||this}return t}(Q),L1=function(e){z(t,e);function t(){return e.call(this,"p")||this}return t}(Q),V1=function(e){z(t,e);function t(){return e.call(this,"q")||this}return t}(Q),O1=function(e){z(t,e);function t(){return e.call(this,"r")||this}return t}(Q),B1=function(e){z(t,e);function t(){return e.call(this,"ArrowRight")||this}return t}(Q),P1=function(e){z(t,e);function t(){return e.call(this,"s")||this}return t}(Q),I1=function(e){z(t,e);function t(){return e.call(this," ")||this}return t}(Q),N1=function(e){z(t,e);function t(){return e.call(this,"t")||this}return t}(Q),U1=function(e){z(t,e);function t(){return e.call(this,"u")||this}return t}(Q),k1=function(e){z(t,e);function t(){return e.call(this,"ArrowUp")||this}return t}(Q),W1=function(e){z(t,e);function t(){return e.call(this,"v")||this}return t}(Q),j1=function(){function e(t,r){var n=r.W,i=n===void 0?!0:n,o=r.A,a=o===void 0?!0:o,s=r.S,f=s===void 0?!0:s,u=r.D,h=u===void 0?!0:u,c=r.space,m=c===void 0?!0:c,d=t.keys;i&&(this.W=new Q("w"),d.set(this.W.value,this.W)),a&&(this.A=new Q("a"),d.set(this.A.value,this.A)),f&&(this.S=new Q("s"),d.set(this.S.value,this.S)),h&&(this.D=new Q("d"),d.set(this.D.value,this.D)),m&&(this.space=new Q(" "),d.set(this.space.value,this.space))}return e}(),H1=function(e){z(t,e);function t(){return e.call(this,"w")||this}return t}(Q),Q1=function(e){z(t,e);function t(){return e.call(this,"x")||this}return t}(Q),K1=function(e){z(t,e);function t(){return e.call(this,"y")||this}return t}(Q),X1=function(e){z(t,e);function t(){return e.call(this,"z")||this}return t}(Q),$1=Object.freeze({__proto__:null,AKey:p1,BKey:x1,CKey:M1,DKey:w1,EKey:b1,FKey:C1,GKey:T1,HKey:S1,IKey:R1,JKey:E1,KKey:A1,LKey:z1,MKey:_1,NKey:D1,OKey:G1,PKey:L1,QKey:V1,RKey:O1,SKey:P1,TKey:N1,UKey:U1,VKey:W1,WKey:H1,XKey:Q1,YKey:K1,ZKey:X1,ArrowKeys:y1,DownKey:g1,LeftKey:F1,RightKey:B1,SpaceKey:I1,UpKey:k1,WASDKeys:j1});function Y1(e){return e.isDown?e.timeUpdated-e.timeDown:e.timeUp-e.timeDown}var q1=function(e){z(t,e);function t(){var r=e.call(this)||this;return r.keyConversion={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Win:"Meta",Scroll:"ScrollLock",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Add:"+",Subtract:"-",Multiply:"*",Decimal:".",Divide:"/"},r.keydownHandler=function(n){return r.onKeyDown(n)},r.keyupHandler=function(n){return r.onKeyUp(n)},r.blurHandler=function(){return r.onBlur()},window.addEventListener("keydown",r.keydownHandler),window.addEventListener("keyup",r.keyupHandler),window.addEventListener("blur",r.blurHandler),r.keys=new Map,r}return t.prototype.addKeys=function(){for(var r=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];n.forEach(function(o){r.keys.set(o.getValue(),o)})},t.prototype.clearKeys=function(){this.keys.clear()},t.prototype.onBlur=function(){this.keys.forEach(function(r){r.reset()})},t.prototype.getKeyValue=function(r){return this.keyConversion.hasOwnProperty(r)?this.keyConversion[r]:r},t.prototype.onKeyDown=function(r){var n=this.getKeyValue(r.key);if(this.keys.has(n)){var i=this.keys.get(n);i.down(r)}H(this,"keydown-"+n,r),H(this,"keydown",r)},t.prototype.onKeyUp=function(r){var n=this.getKeyValue(r.key);if(this.keys.has(n)){var i=this.keys.get(n);i.up(r)}H(this,"keyup-"+n,r),H(this,"keyup",r)},t.prototype.destroy=function(){window.removeEventListener("keydown",this.keydownHandler),window.removeEventListener("keyup",this.keyupHandler),window.removeEventListener("blur",this.blurHandler),H(this,"destroy")},t}(Xe);function Z1(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.repeatRate=e}),t}var J1=Object.freeze({__proto__:null,GetKeyDownDuration:Y1,Key:Q,Keys:$1,Keyboard:q1,SetKeyRepeatRate:Z1}),t2=function(e){z(t,e);function t(r){var n=e.call(this)||this;return n.primaryDown=!1,n.auxDown=!1,n.secondaryDown=!1,n.blockContextMenu=!0,n.resolution=1,n.mousedownHandler=function(i){return n.onMouseDown(i)},n.mouseupHandler=function(i){return n.onMouseUp(i)},n.mousemoveHandler=function(i){return n.onMouseMove(i)},n.mousewheelHandler=function(i){return n.onMouseWheel(i)},n.contextmenuHandler=function(i){return n.onContextMenuEvent(i)},n.blurHandler=function(){return n.onBlur()},n.localPoint=new D,n.hitPoint=new D,n.transPoint=new D,r||(r=A.get().renderer.canvas),r.addEventListener("mousedown",n.mousedownHandler),r.addEventListener("mouseup",n.mouseupHandler),r.addEventListener("wheel",n.mousewheelHandler,{passive:!1}),r.addEventListener("contextmenu",n.contextmenuHandler),window.addEventListener("mouseup",n.mouseupHandler),window.addEventListener("mousemove",n.mousemoveHandler),window.addEventListener("blur",n.blurHandler),n.target=r,n}return t.prototype.onBlur=function(){},t.prototype.onMouseDown=function(r){this.positionToPoint(r),this.primaryDown=r.button===0,this.auxDown=r.button===1,this.secondaryDown=r.button===2,H(this,"pointerdown",this.localPoint.x,this.localPoint.y,r.button,r)},t.prototype.onMouseUp=function(r){this.positionToPoint(r),this.primaryDown=r.button!==0,this.auxDown=r.button!==1,this.secondaryDown=r.button!==2,H(this,"pointerup",this.localPoint.x,this.localPoint.y,r.button,r)},t.prototype.onMouseMove=function(r){this.positionToPoint(r),H(this,"pointermove",this.localPoint.x,this.localPoint.y,r)},t.prototype.onMouseWheel=function(r){H(this,"wheel",r.deltaX,r.deltaY,r.deltaZ,r)},t.prototype.onContextMenuEvent=function(r){this.blockContextMenu&&r.preventDefault(),H(this,"contextmenu",r)},t.prototype.positionToPoint=function(r){return this.localPoint.set(r.offsetX,r.offsetY)},t.prototype.getInteractiveChildren=function(r,n){for(var i=r.children,o=0;o<i.length;o++){var a=i[o];!a.visible||!a.input.enabled||(n.push(a),a.input.enabledChildren&&a.numChildren&&this.getInteractiveChildren(a,n))}},t.prototype.checkHitArea=function(r,n,i){if(r.input.hitArea){if(r.input.hitArea.contains(n,i))return!0}else return r.transform.extent.contains(n,i);return!1},t.prototype.hitTest=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];for(var i=this.localPoint.x,o=this.localPoint.y,a=this.transPoint,s=0;s<r.length;s++){var f=r[s];if(!!f.world){var u=Ha(f.world.camera.worldTransform,f.transform.world);if(Ya(u,i,o,a),this.checkHitArea(f,a.x,a.y))return this.hitPoint.set(a.x,a.y),!0}}return!1},t.prototype.hitTestChildren=function(r,n){n===void 0&&(n=!0);var i=[];if(!r.visible)return i;var o=[],a=r.input;a&&a.enabled&&o.push(r),a.enabledChildren&&r.numChildren&&this.getInteractiveChildren(r,o);for(var s=o.length-1;s>=0;s--){var f=o[s];if(this.hitTest(f)&&(i.push(f),n))break}return i},t.prototype.shutdown=function(){var r=this.target;r.removeEventListener("mousedown",this.mousedownHandler),r.removeEventListener("mouseup",this.mouseupHandler),r.removeEventListener("wheel",this.mousewheelHandler),r.removeEventListener("contextmenu",this.contextmenuHandler),window.removeEventListener("mouseup",this.mouseupHandler),window.removeEventListener("mousemove",this.mousemoveHandler),window.removeEventListener("blur",this.blurHandler)},t}(Xe),e2=Object.freeze({__proto__:null,Mouse:t2});function r2(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.forEach(function(r){r.input.enabled=!0}),e}var n2=Object.freeze({__proto__:null,Keyboard:J1,Mouse:e2,SetInteractive:r2});function Kf(e,t){var r;if(Array.isArray(t.textures)?r=t.textures[0].frames:Array.isArray(t.frames)?r=t.frames:t.hasOwnProperty("frames")?r=Object.values(t.frames):console.warn("Invalid Texture Atlas JSON"),r)for(var n=void 0,i=0;i<r.length;i++){var o=r[i];n=e.addFrame(o.filename,o.frame.x,o.frame.y,o.frame.w,o.frame.h),o.trimmed?n.setTrim(o.sourceSize.w,o.sourceSize.h,o.spriteSourceSize.x,o.spriteSourceSize.y,o.spriteSourceSize.w,o.spriteSourceSize.h):n.setSourceSize(o.sourceSize.w,o.sourceSize.h),o.rotated,o.anchor&&n.setPivot(o.anchor.x,o.anchor.y)}}var At=function(){function e(t,r,n){this.responseType="text",this.crossOrigin=void 0,this.skipCache=!1,this.hasLoaded=!1,this.key=t,this.url=r,this.config=n}return e}();function Rt(e,t,r,n){return t||(t=e+r),/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(t)?t:n?n.baseURL+n.path+t:t}function Xf(e){return e.data=new Image,e.crossOrigin&&(e.data.crossOrigin=e.crossOrigin),new Promise(function(t,r){e.data.onload=function(){e.data.onload&&(e.data.onload=null,e.data.onerror=null,t(e))},e.data.onerror=function(n){e.data.onload&&(e.data.onload=null,e.data.onerror=null,e.error=n,r(e))},e.data.src=e.url,e.data.complete&&e.data.width&&e.data.height&&(e.data.onload=null,e.data.onerror=null,t(e))})}function qi(e,t,r){var n=new At(e,t);return n.load=function(){return n.url=Rt(n.key,n.url,".png",n.loader),n.loader&&(n.crossOrigin=n.loader.crossOrigin),new Promise(function(i,o){var a=jt.get();a.has(n.key)?i(n):Xf(n).then(function(s){a.add(s.key,s.data,r),i(s)}).catch(function(s){o(s)})})},n}var rr=new Map,Se={get:function(e){return rr.has(e)||rr.set(e,new Map),rr.get(e)},getEntry:function(e,t){if(rr.has(e))return rr.get(e).get(t)}};function Re(e){var t=new XMLHttpRequest;return t.open("GET",e.url,!0),t.responseType=e.responseType,new Promise(function(r,n){t.onload=function(){e.data=t.responseText,e.hasLoaded=!0,r(e)},t.onerror=function(){e.hasLoaded=!0,n(e)},t.send()})}function $f(e,t){var r=new At(e,t);return r.load=function(){return r.url=Rt(r.key,r.url,".json",r.loader),new Promise(function(n,i){var o=Se.get("JSON");!r.skipCache&&o.has(r.key)?n(r):Re(r).then(function(a){a.data=JSON.parse(a.data),a.skipCache||o.set(a.key,a.data),n(a)}).catch(function(a){i(a)})})},r}function i2(e,t,r,n){var i=$f(e,r),o=qi(e,t,n),a=new At(e,"");return a.load=function(){return i.url=Rt(i.key,i.url,".json",a.loader),o.url=Rt(o.key,o.url,".png",a.loader),new Promise(function(s,f){i.skipCache=!0,i.load().then(function(){o.load().then(function(){Kf(jt.get().get(e),i.data),s(a)}).catch(function(){f(a)})}).catch(function(){f(a)})})},a}function Ct(e,t){return parseInt(e.getAttribute(t),10)}function Yf(e,t,r){for(var n=0,i=0,o=t.getElementsByTagName("info")[0],a=t.getElementsByTagName("common")[0],s={font:o.getAttribute("face"),size:Ct(o,"size"),lineHeight:Ct(a,"lineHeight")+i,chars:{}},f=t.getElementsByTagName("char"),u=0;u<f.length;u++){var h=f[u],c=Ct(h,"id"),m=Ct(h,"x"),d=Ct(h,"y"),v=Ct(h,"width"),g=Ct(h,"height");s.chars[c]={x:m,y:d,width:v,height:g,xOffset:Ct(h,"xoffset"),yOffset:Ct(h,"yoffset"),xAdvance:Ct(h,"xadvance")+n,kerning:{}},e.addFrame(c,m,d,v,g)}for(var p=t.getElementsByTagName("kerning"),u=0;u<p.length;u++){var b=p[u],C=Ct(b,"first"),S=Ct(b,"second"),R=Ct(b,"amount");s.chars[S].kerning[C]=R}return s}function qf(e,t){var r=new At(e,t);return r.load=function(){return r.url=Rt(r.key,r.url,".xml",r.loader),new Promise(function(n,i){var o=Se.get("XML");!r.skipCache&&o.has(r.key)?n(r):Re(r).then(function(a){var s=Ls(a.data);s!==null?(a.data=s,a.skipCache||o.set(a.key,s),n(a)):i(a)}).catch(function(a){i(a)})})},r}function o2(e,t,r,n){var i=qf(e,r),o=qi(e,t,n),a=new At(e,"");return a.load=function(){return i.url=Rt(i.key,i.url,".xml",a.loader),o.url=Rt(o.key,o.url,".png",a.loader),new Promise(function(s,f){i.skipCache=!0,i.load().then(function(){o.load().then(function(){var u=jt.get().get(e),h=Yf(u,i.data);u.data=h,s(a)}).catch(function(){f(a)})}).catch(function(){f(a)})})},a}function a2(e,t){var r=new At(e,t);return r.load=function(){return r.url=Rt(r.key,r.url,".csv",r.loader),new Promise(function(n,i){var o=Se.get("CSV");!r.skipCache&&o.has(r.key)?n(r):Re(r).then(function(a){a.skipCache||o.set(a.key,a.data),n(a)}).catch(function(a){i(a)})})},r}function s2(e,t,r){var n=new At(e,t),i=r.vertices,o=i===void 0?"verts":i,a=r.normals,s=a===void 0?"normals":a,f=r.uvs,u=f===void 0?"uvs":f,h=r.numberOfVertices,c=h===void 0?0:h;return n.load=function(){return n.url=Rt(n.key,n.url,".json",n.loader),new Promise(function(m,d){var v=Se.get("Geometry");!n.skipCache&&v.has(n.key)?m(n):Re(n).then(function(g){var p=JSON.parse(g.data),b=new ee({vertices:p[o],normals:p[s],uvs:p[u],numberOfVertices:c});g.data=b,g.skipCache||v.set(g.key,b),m(g)}).catch(function(g){d(g)})})},n}function f2(e,t){var r=new At(e,t);return r.load=function(){return r.url=Rt(r.key,r.url,".obj",r.loader),new Promise(function(n,i){var o=Se.get("Obj");!r.skipCache&&o.has(r.key)?n(r):Re(r).then(function(a){a.skipCache||o.set(a.key,a.data),n(a)}).catch(function(a){i(a)})})},r}function u2(e,t,r){r===void 0&&(r=!0);var n=new At(e,t);return n.load=function(){return n.url=Rt(n.key,n.url,".obj",n.loader),new Promise(function(i,o){var a=Se.get("Geometry");!n.skipCache&&a.has(n.key)?i(n):Re(n).then(function(s){var f=bf(s.data,r);if(s.data=f,!s.skipCache){var u=s.key;f.forEach(function(h,c){c>0&&(u=s.key+c.toString());var m=new ee(h.buffer);a.set(u,m)})}i(s)}).catch(function(s){o(s)})})},n}function Zf(e,t,r,n,i,o){var a=o.frameWidth,s=a===void 0?null:a,f=o.endFrame,u=f===void 0?-1:f,h=o.margin,c=h===void 0?0:h,m=o.spacing,d=m===void 0?0:m,v=o.frameHeight,g=v===void 0?null:v,p=o.startFrame,b=p===void 0?0:p;if(g||(g=s),s===null)throw new Error("SpriteSheetParser: Invalid frameWidth");var C=Math.floor((n-c+d)/(s+d)),S=Math.floor((i-c+d)/(g+d)),R=C*S;R===0&&console.warn("SpriteSheetParser: Frame config will result in zero frames"),(b>R||b<-R)&&(b=0),b<0&&(b=R+b),u!==-1&&(R=b+(u+1));for(var E=c,_=c,G=0,V=0,P=0;P<R;P++){G=0,V=0;var O=E+s,k=_+g;O>n&&(G=O-n),k>i&&(V=k-i),e.addFrame(P,t+E,r+_,s-G,g-V),E+=s+d,E+s>n&&(E=c,_+=g+d)}}function h2(e,t,r,n){var i=new At(e,t);return i.load=function(){return i.url=Rt(i.key,i.url,".png",i.loader),i.loader&&(i.crossOrigin=i.loader.crossOrigin),new Promise(function(o,a){var s=jt.get();s.has(i.key)?o(i):Xf(i).then(function(f){var u=s.add(f.key,f.data,n);u?(Zf(u,0,0,u.width,u.height,r),o(f)):a(f)}).catch(function(f){a(f)})})},i}var c2=Object.freeze({__proto__:null,AtlasFile:i2,BitmapTextFile:o2,CSVFile:a2,ImageFile:qi,JSONFile:$f,JSONGeometryFile:s2,OBJFile:f2,OBJGeometryFile:u2,SpriteSheetFile:h2,XMLFile:qf}),l2=function(e){z(t,e);function t(){var r=e.call(this)||this;return r.baseURL="",r.path="",r.crossOrigin="anonymous",r.maxParallelDownloads=-1,r.isLoading=!1,r.reset(),r}return t.prototype.reset=function(){this.isLoading=!1,this.queue=new Set,this.inflight=new Set,this.completed=new Set,this.progress=0},t.prototype.add=function(){for(var r=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach(function(o){o.loader=r,r.queue.add(o)}),this},t.prototype.start=function(){var r=this;return this.isLoading?null:new Promise(function(n,i){r.completed.clear(),r.progress=0,r.queue.size>0?(r.isLoading=!0,r.onComplete=n,r.onError=i,H(r,"start"),r.nextFile()):(r.progress=1,H(r,"complete"),n(r))})},t.prototype.nextFile=function(){var r=this,n=this.queue.size;if(this.maxParallelDownloads!==-1&&(n=Math.min(n,this.maxParallelDownloads)-this.inflight.size),n)for(var i=this.queue.values();n>0;){var o=i.next().value;this.inflight.add(o),this.queue.delete(o),o.load().then(function(a){return r.fileComplete(a)}).catch(function(a){return r.fileError(a)}),n--}else this.inflight.size===0&&this.stop()},t.prototype.stop=function(){!this.isLoading||(this.isLoading=!1,H(this,"complete",this.completed),this.onComplete(),this.completed.clear())},t.prototype.updateProgress=function(r){this.inflight.delete(r),this.completed.add(r);var n=this.completed.size,i=this.queue.size+this.inflight.size;n>0&&(this.progress=n/(n+i)),H(this,"progress",this.progress,n,i),this.nextFile()},t.prototype.fileComplete=function(r){H(this,"filecomplete",r),this.updateProgress(r)},t.prototype.fileError=function(r){H(this,"fileerror",r),this.updateProgress(r)},t.prototype.totalFilesToLoad=function(){return this.queue.size+this.inflight.size},t.prototype.setBaseURL=function(r){return r===void 0&&(r=""),r!==""&&r.substr(-1)!=="/"&&(r=r.concat("/")),this.baseURL=r,this},t.prototype.setPath=function(r){return r===void 0&&(r=""),r!==""&&r.substr(-1)!=="/"&&(r=r.concat("/")),this.path=r,this},t.prototype.setCORS=function(r){return this.crossOrigin=r,this},t.prototype.setMaxParallelDownloads=function(r){return this.maxParallelDownloads=r,this},t}(Xe),d2=Object.freeze({__proto__:null,File:At,Files:c2,Loader:l2}),v2=new st({ambient:[0,0,0],diffuse:[.01,.01,.01],specular:[.5,.5,.5],shine:.25}),m2=new st({ambient:[.02,.02,.02],diffuse:[.01,.01,.01],specular:[.4,.4,.4],shine:.078125}),p2=new st({ambient:[.329412,.223529,.027451],diffuse:[.780392,.568627,.113725],specular:[.992157,.941176,.807843],shine:.21794872}),y2=new st({ambient:[.2125,.1275,.054],diffuse:[.714,.4284,.18144],specular:[.393548,.271906,.166721],shine:.2}),x2=new st({ambient:[.25,.25,.25],diffuse:[.4,.4,.4],specular:[.774597,.774597,.774597],shine:.6}),M2=new st({ambient:[.19125,.0735,.0225],diffuse:[.7038,.27048,.0828],specular:[.256777,.137622,.086014],shine:.1}),w2=new st({ambient:[0,.1,.06],diffuse:[0,.50980392,.50980392],specular:[.50196078,.50196078,.50196078],shine:.25}),g2=new st({ambient:[0,.05,.05],diffuse:[.4,.5,.5],specular:[.04,.7,.7],shine:.078125}),b2=new st({ambient:[.0215,.1745,.0215],diffuse:[.07568,.61424,.07568],specular:[.633,.727811,.633],shine:.6}),C2=new st({ambient:[.24725,.1995,.0745],diffuse:[.75164,.60648,.22648],specular:[.628281,.555802,.366065],shine:.4}),T2=new st({ambient:[0,0,0],diffuse:[.1,.35,.1],specular:[.45,.55,.45],shine:.25}),S2=new st({ambient:[0,.05,0],diffuse:[.4,.5,.4],specular:[.04,.7,.04],shine:.078125}),R2=new st({ambient:[.135,.2225,.1575],diffuse:[.54,.89,.63],specular:[.316228,.316228,.316228],shine:.1}),E2=new st({ambient:[.05375,.05,.06625],diffuse:[.18275,.17,.22525],specular:[.332741,.328634,.346435],shine:.3}),A2=new st({ambient:[.25,.20725,.20725],diffuse:[1,.829,.829],specular:[.296648,.296648,.296648],shine:.088}),z2=new st({ambient:[0,0,0],diffuse:[.5,0,0],specular:[.7,.6,.6],shine:.25}),F2=new st({ambient:[.05,0,0],diffuse:[.5,.4,.4],specular:[.7,.04,.04],shine:.078125}),_2=new st({ambient:[.1745,.01175,.01175],diffuse:[.61424,.04136,.04136],specular:[.727811,.626959,.626959],shine:.6}),D2=new st({ambient:[.19225,.19225,.19225],diffuse:[.50754,.50754,.50754],specular:[.508273,.508273,.508273],shine:.4}),G2=new st({ambient:[.1,.18725,.1745],diffuse:[.396,.74151,.69102],specular:[.297254,.30829,.306678],shine:.1}),L2=new st({ambient:[0,0,0],diffuse:[.55,.55,.55],specular:[.7,.7,.7],shine:.25}),V2=new st({ambient:[.05,.05,.05],diffuse:[.5,.5,.5],specular:[.7,.7,.7],shine:.078125}),O2=new st({ambient:[0,0,0],diffuse:[.5,.5,0],specular:[.6,.6,.5],shine:.25}),B2=new st({ambient:[.05,.05,0],diffuse:[.5,.5,.4],specular:[.7,.7,.04],shine:.078125}),P2=Object.freeze({__proto__:null,BlackPlastic:v2,BlackRubber:m2,Brass:p2,Bronze:y2,Chrome:x2,Copper:M2,CyanPlastic:w2,CyanRubber:g2,Emerald:b2,Gold:C2,GreenPlastic:T2,GreenRubber:S2,Jade:R2,Obsidian:E2,Pearl:A2,RedPlastic:z2,RedRubber:F2,Ruby:_2,Silver:D2,Turquoise:G2,WhitePlastic:L2,WhiteRubber:V2,YellowPlastic:O2,YellowRubber:B2}),Jf=["#000","#9D9D9D","#FFF","#BE2633","#E06F8B","#493C2B","#A46422","#EB8931","#F7E26B","#2F484E","#44891A","#A3CE27","#1B2632","#005784","#31A2F2","#B2DCEF"],I2=["#000","#fff","#8b4131","#7bbdc5","#8b41ac","#6aac41","#3931a4","#d5de73","#945a20","#5a4100","#bd736a","#525252","#838383","#acee8b","#7b73de","#acacac"],N2=["#000","#2234d1","#0c7e45","#44aacc","#8a3622","#5c2e78","#aa5c3d","#b5b5b5","#5e606e","#4c81fb","#6cd947","#7be2f9","#eb8a60","#e23d69","#ffd93f","#fff"],U2=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#f5f4eb"],k2=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#fff"],W2=["#000","#1D2B53","#7E2553","#008751","#AB5236","#5F574F","#C2C3C7","#FFF1E8","#FF004D","#FFA300","#FFEC27","#00E436","#29ADFF","#83769C","#FF77A8","#FFCCAA"],j2=Object.freeze({__proto__:null,Arne16:Jf,C64:I2,CGA:N2,JMP:U2,MSX:k2,PICO8:W2}),H2=Object.freeze({__proto__:null,AtlasParser:Kf,BitmapTextParser:Yf,SpriteSheetParser:Zf});function Q2(e,t,r,n,i,o){r===void 0&&(r=32),n===void 0&&(n=32),i===void 0&&(i=2),o===void 0&&(o=2);var a=Ht(r,n),s=r/i,f=n/o;a.fillStyle=e,a.fillRect(0,0,r,n),a.fillStyle=t;for(var u=0;u<o;u++)for(var h=u%2;h<i;h+=2)a.fillRect(h*s,u*f,s,f);return new mt(a.canvas)}function K2(e){var t=e.data,r=t===void 0?[]:t,n=e.palette,i=n===void 0?Jf:n,o=e.pixelWidth,a=o===void 0?1:o,s=e.pixelHeight,f=s===void 0?a:s,u=e.preRender,h=u===void 0?null:u,c=e.postRender,m=c===void 0?null:c,d=e.canvas,v=d===void 0?null:d,g=e.resizeCanvas,p=g===void 0?!0:g,b=e.clearCanvas,C=b===void 0?!0:b,S=Math.floor(Math.abs(r[0].length*a)),R=Math.floor(Math.abs(r.length*f));v||(v=Ht(S,R).canvas,p=!1,C=!1),p&&(v.width=S,v.height=R);var E=v.getContext("2d");C&&E.clearRect(0,0,S,R),h&&h(v,E);for(var _=0;_<r.length;_++)for(var G=r[_],V=0;V<G.length;V++){var P=G[V];P!=="."&&P!==" "&&(E.fillStyle=i[parseInt("0x"+P.toUpperCase())],E.fillRect(V*a,_*f,a,f))}return m&&m(v,E),new mt(v)}var X2=function(e){z(t,e);function t(r,n,i){n===void 0&&(n=256),i===void 0&&(i=n);var o=e.call(this,null,n,i)||this;return o.renderer=r,o}return t.prototype.cls=function(){return this},t.prototype.batchStart=function(){return this},t.prototype.batchDraw=function(r){for(var n=0,i=r.length;n<i;n++);return this},t.prototype.batchEnd=function(){var r=this.renderer;return r.reset(),this},t.prototype.draw=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return this.batchStart(),this.batchDraw(r),this.batchEnd(),this},t}(mt);function $2(e,t,r){e===void 0&&(e="rgba(0,0,0,0)"),t===void 0&&(t=32),r===void 0&&(r=32);var n=Ht(t,r);return n.fillStyle=e,n.fillRect(0,0,t,r),new mt(n.canvas)}var Y2=Object.freeze({__proto__:null,CanvasTexture:yf,GridTexture:Q2,PixelTexture:K2,RenderTexture:X2,SolidColorTexture:$2});function q2(e,t){var r=[];return t.forEach(function(n){r.push(e.getFrame(n))}),r}function Z2(e,t){var r=t.prefix,n=r===void 0?"":r,i=t.start,o=i===void 0?0:i,a=t.zeroPad,s=a===void 0?0:a,f=t.suffix,u=f===void 0?"":f,h=t.end,c=[],m=o<h?1:-1;h+=m;for(var d=o;d!==h;d+=m){var v=n+d.toString().padStart(s,"0")+u;c.push(e.getFrame(v))}return c}function J2(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.forEach(function(n){n.binding&&n.binding.setFilter(e)}),t}var tu=function(){function e(){this.textures=new Map,this.createDefaultTextures(),jt.set(this)}return e.prototype.createDefaultTextures=function(){this.add("__BLANK",new mt(Ht(32,32).canvas));var t=Ht(32,32);t.strokeStyle="#0f0",t.moveTo(0,0),t.lineTo(32,32),t.stroke(),t.strokeRect(.5,.5,31,31),this.add("__MISSING",new mt(t.canvas));var r=Ht(32,32);r.fillStyle="#fff",r.fillRect(0,0,32,32),this.add("__WHITE",new mt(r.canvas))},e.prototype.get=function(t){var r=this.textures;return r.has(t)?r.get(t):r.get("__MISSING")},e.prototype.has=function(t){return this.textures.has(t)},e.prototype.add=function(t,r,n){var i,o=this.textures;return o.has(t)||(r instanceof mt?i=r:i=new mt(r,0,0,n),i.key=t,o.set(t,i)),i},e}(),tM=Object.freeze({__proto__:null,CreateCanvas:Ht,Frame:Qn,GetFrames:q2,GetFramesInRange:Z2,SetFilter:J2,Palettes:j2,Parsers:H2,Types:Y2,Texture:mt,TextureManager:tu});function nr(){}function eu(e,t){var r=t.duration,n=r===void 0?0:r,i=t.repeat,o=i===void 0?0:i,a=t.delay,s=a===void 0?-1:a,f=t.onStart,u=f===void 0?nr:f,h=t.onUpdate,c=h===void 0?nr:h,m=t.onRepeat,d=m===void 0?nr:m,v=t.onComplete,g=v===void 0?nr:v,p={elapsed:n,duration:n,repeat:o,delay:s,update:null,onStart:u,onUpdate:c,onRepeat:d,onComplete:g};p.update=function(b){if(p.delay>0)if(p.delay-=b,p.delay<0)p.delay=0;else return!1;return p.delay===0&&(p.onStart(),p.delay=-1),p.delay===-1&&(p.elapsed-=b,p.onUpdate(b,p.elapsed/p.duration),p.elapsed<=0&&(p.repeat>0?(p.repeat--,p.elapsed=p.duration,p.onRepeat(p.repeat)):(p.elapsed=0,p.onComplete()))),p.elapsed===0},e.events.add(p)}function eM(e,t,r){eu(e,{duration:0,delay:t,onComplete:r})}var rM=function(){function e(t){this.world=t,this.timeScale=1,this.events=new Set}return e.prototype.update=function(t,r){var n=this;this.now=r,t*=this.timeScale,this.events.forEach(function(i){i.update(t)&&n.events.delete(i)})},e}(),nM=Object.freeze({__proto__:null,AddDelayedCall:eM,AddTimer:eu,Clock:rM,NOOP:nr}),ru="worldrender",nu="worldshutdown",iM=Object.freeze({__proto__:null,WorldRenderEvent:ru,WorldShutdownEvent:nu});function Zi(e,t){t.numRendered++,t.numRenderable++,e.node.dirtyFrame>=t.gameFrame&&t.dirtyFrame++,e.children.forEach(function(r){r.children.length>0&&Zi(r,t)})}function iu(e){if(e.node.isDirty(j.CHILD_CACHE))return!0;for(var t=[e];t.length>0;){var r=t.pop();if(r.node.isDirty(j.TRANSFORM))return!0;var n=r.children.length;if(n>0)for(var i=0;i<n;i++)t.push(r.children[i])}return t.length=0,!1}function ou(e,t){e.forEach(function(r){t||iu(r)?r.node.setDirty(j.CHILD_CACHE):r.children.length=0})}function Ji(e,t,r){r===void 0&&(r=[]);for(var n=0;n<t.numChildren;n++){var i=t.children[n];if(i.isRenderable()){var o=[],a={node:i,children:o};r.push(a),i.willRenderChildren&&i.numChildren>0&&(i.willCacheChildren&&e.push(a),Ji(e,i,o))}}return r}function au(e){var t=[],r=[],n=Ji(t,e,r),i=e.renderData;t.length>0&&ou(t,e.camera.dirtyRender),n.forEach(function(o){o.children.length>0?Zi(o,i):(i.numRendered++,i.numRenderable++,o.node.dirtyFrame>=i.gameFrame&&i.dirtyFrame++)}),e.renderList=n,e.forceRefresh&&(i.dirtyFrame++,e.forceRefresh=!1)}function su(e,t){e.numDirtyFrames+=t.dirtyFrame,e.numTotalFrames+=t.numRendered,t.camera.dirtyRender&&e.numDirtyCameras++,e.worldData.push(t)}function rn(e,t){e.gameFrame=t,e.dirtyFrame=0,e.numRendered=0,e.numRenderable=0}var to=function(e){z(t,e);function t(r){var n=e.call(this)||this;return n.forceRefresh=!1,n.is3D=!1,n.type="BaseWorld",n.scene=r,n.world=n,n.events=new Map,n.renderList=[],n._updateListener=kt(r,"update",function(i,o){return n.update(i,o)}),n._renderListener=kt(r,"render",function(i){return n.render(i)}),n._shutdownListener=kt(r,"shutdown",function(){return n.shutdown()}),Yr(r,"destroy",function(){return n.destroy()}),n}return t.prototype.update=function(r,n){!this.willUpdate||(H(this,Ns,r,n,this),e.prototype.update.call(this,r,n))},t.prototype.postUpdate=function(r,n){H(this,Is,r,n,this)},t.prototype.render=function(r){var n=this.renderData;rn(n,r.gameFrame),!(!this.willRender||!this.visible)&&(au(this),H(this,ru,n,this),su(r,n),this.camera.dirtyRender=!1)},t.prototype.renderGL=function(r){var n=this,i=r.current2DCamera,o=this.camera;(!i||!Qa(o.worldTransform,i.worldTransform))&&Tt(r),nm(r,o),this.renderList.forEach(function(a){a.children.length>0?n.renderNode(a,r):a.node.renderGL(r)})},t.prototype.renderNode=function(r,n){var i=this;r.node.renderGL(n),r.children.forEach(function(o){o.children.length>0?i.renderNode(o,n):o.node.renderGL(n)}),r.node.postRenderGL(n)},t.prototype.postRenderGL=function(r){},t.prototype.shutdown=function(){var r=this.scene;te(r,"update",this._updateListener),te(r,"render",this._renderListener),te(r,"shutdown",this._shutdownListener),Qs(this),H(this,nu,this),rn(this.renderData,0),this.camera&&this.camera.reset()},t.prototype.destroy=function(r){e.prototype.destroy.call(this,r),H(this,Qr,this),rn(this.renderData,0),this.camera&&this.camera.destroy(),this.events.clear(),this.camera=null,this.renderData=null,this.events=null},t}(qr);function eo(e,t){return{world:e,camera:t,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var oM=function(e){z(t,e);function t(r){var n=e.call(this,r)||this;return n.type="StaticWorld",n.camera=new gn,n.renderData=eo(n,n.camera),n}return t}(to),aM=function(e){z(t,e);function t(r){var n=e.call(this,r)||this;return n.enableCameraCull=!0,n.type="World",n.camera=new ea,n.renderData=eo(n,n.camera),n}return t}(to),sM=Object.freeze({__proto__:null,BaseWorld:to,BuildRenderList:au,CalculateTotalRenderable:Zi,CreateWorldRenderData:eo,Events:iM,HasDirtyChildren:iu,MergeRenderData:su,ResetWorldRenderData:rn,StaticWorld:oM,UpdateCachedLayers:ou,World:aM,WorldDepthFirstSearch:Ji}),fu="worldrender",uu="worldshutdown",fM=Object.freeze({__proto__:null,World3DRenderEvent:fu,World3DShutdownEvent:uu});function ro(e,t){t.numRendered++,t.numRenderable++,e.node.dirtyFrame>=t.gameFrame&&t.dirtyFrame++,e.children.forEach(function(r){r.children.length>0&&ro(r,t)})}function hu(e){if(e.node.isDirty(j.CHILD_CACHE))return!0;for(var t=[e];t.length>0;){var r=t.pop();if(r.node.isDirty(j.TRANSFORM))return!0;var n=r.children.length;if(n>0)for(var i=0;i<n;i++)t.push(r.children[i])}return t.length=0,!1}function cu(e,t){e.forEach(function(r){t||hu(r)?r.node.setDirty(j.CHILD_CACHE):r.children.length=0})}function no(e,t,r){r===void 0&&(r=[]);for(var n=0;n<t.numChildren;n++){var i=t.children[n];if(i.isRenderable()){var o=[],a={node:i,children:o};r.push(a),i.willRenderChildren&&i.numChildren>0&&(i.willCacheChildren&&e.push(a),no(e,i,o))}}return r}function lu(e){var t=[],r=[],n=no(t,e,r),i=e.renderData;t.length>0&&cu(t,e.camera.dirtyRender),n.forEach(function(o){o.children.length>0?ro(o,i):(i.numRendered++,i.numRenderable++,o.node.dirtyFrame>=i.gameFrame&&i.dirtyFrame++)}),e.renderList=n,e.forceRefresh&&(i.dirtyFrame++,e.forceRefresh=!1)}function du(e,t){e.numDirtyFrames+=t.dirtyFrame,e.numTotalFrames+=t.numRendered,t.camera.dirtyRender&&e.numDirtyCameras++,e.worldData.push(t)}function nn(e,t){e.gameFrame=t,e.dirtyFrame=0,e.numRendered=0,e.numRenderable=0}var vu=function(e){z(t,e);function t(r){var n=e.call(this)||this;return n.forceRefresh=!1,n.is3D=!0,n.type="BaseWorld",n.scene=r,n.world=n,n.events=new Map,n.renderList=[],n._updateListener=kt(r,"update",function(i,o){return n.update(i,o)}),n._renderListener=kt(r,"render",function(i){return n.render(i)}),n._shutdownListener=kt(r,"shutdown",function(){return n.shutdown()}),Yr(r,"destroy",function(){return n.destroy()}),n}return t.prototype.update=function(r,n){!this.willUpdate||(H(this,Ns,r,n,this),e.prototype.update.call(this,r,n))},t.prototype.postUpdate=function(r,n){H(this,Is,r,n,this)},t.prototype.render=function(r){var n=this.renderData;nn(n,r.gameFrame),!(!this.willRender||!this.visible)&&(lu(this),H(this,fu,n,this),du(r,n))},t.prototype.renderNode=function(r,n){var i=this;r.node.renderGL(n),r.children.forEach(function(o){o.children.length>0?i.renderNode(o,n):o.node.renderGL(n)}),r.node.postRenderGL(n)},t.prototype.shutdown=function(){var r=this.scene;te(r,"update",this._updateListener),te(r,"render",this._renderListener),te(r,"shutdown",this._shutdownListener),tf(this),H(this,uu,this),nn(this.renderData,0)},t.prototype.destroy=function(r){e.prototype.destroy.call(this,r),H(this,Qr,this),nn(this.renderData,0),this.events.clear(),this.camera=null,this.renderData=null,this.events=null},t}(Wi);function mu(e,t){return{world:e,camera:t,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0}}var uM=`#define SHADER_NAME AMBIENT_LIGHT_FRAG

precision highp float;

uniform vec3 uLightPosition;
uniform vec3 uLightAmbient;
uniform vec3 uLightDiffuse;
uniform vec3 uLightSpecular;

uniform vec3 uMaterialAmbient;
uniform vec3 uMaterialDiffuse;
uniform vec3 uMaterialSpecular;
uniform float uMaterialShine;

uniform vec3 uCameraPosition;

uniform sampler2D uTexture;

varying vec2 vTextureCoord;
varying vec3 vNormal;
varying vec3 vPosition;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    vec3 ambient = uLightAmbient * uMaterialAmbient;

    vec3 norm = normalize(vNormal);
    vec3 lightDir = normalize(uLightPosition - vPosition);
    float diff = max(dot(norm, lightDir), 0.0);
    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);

    vec3 viewDir = normalize(uCameraPosition - vPosition);
    vec3 reflectDir = reflect(-lightDir, norm);
    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);
    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);

    vec3 result = (ambient + diffuse + specular) * color.rgb;

    gl_FragColor = vec4(result, color.a);
}`,hM=`
#define SHADER_NAME AMBIENT_LIGHT_VERT

precision highp float;

attribute vec3 aVertexPosition;
attribute vec3 aVertexNormal;
attribute vec2 aTextureCoord;

uniform mat4 uViewProjectionMatrix;
uniform mat4 uModelMatrix;
uniform mat4 uNormalMatrix;

varying vec2 vTextureCoord;
varying vec3 vNormal;
varying vec3 vPosition;

void main(void)
{
    vTextureCoord = aTextureCoord;

    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));

    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));

    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);
}
`,cM=function(e){z(t,e);function t(){var r=e.call(this)||this,n=new Float32Array(16).fill(0),i=[0,0,0],o={fragmentShader:uM,vertexShader:hM,attributes:{aVertexPosition:{size:3,type:ve,normalized:!1,offset:0},aVertexNormal:{size:3,type:ve,normalized:!1,offset:12},aTextureCoord:{size:2,type:ve,normalized:!1,offset:24}},uniforms:{uViewProjectionMatrix:n,uNormalMatrix:n,uModelMatrix:n,uCameraPosition:i,uTexture:0,uLightPosition:i,uLightAmbient:i,uLightDiffuse:i,uLightSpecular:i,uMaterialAmbient:i,uMaterialDiffuse:i,uMaterialSpecular:i,uMaterialShine:0}};return r.fromConfig(o),r}return t}(Ts),lM=function(){function e(t,r,n){var i=this;t===void 0&&(t=45),r===void 0&&(r=.1),n===void 0&&(n=1e3),this.isOrbit=!1,this.minDistance=0,this.maxDistance=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.dirtyRender=!0,this.panRate=5,this.zoomRate=200,this.rotateRate=-3,this._yaw=0,this._pitch=0,this._roll=0,this.type="Camera3D",this._fov=t,this._near=r,this._far=n,this.matrix=new I,this.viewMatrix=new I,this.projectionMatrix=new I,this.viewProjectionMatrix=new I,this.position=new Bt(function(){return i.update()}),this.rotation=new tt;var o=A.get(),a=o.renderer;this.viewport=new yt(0,0,a.width,a.height),this.renderer=a,this.forward=xr(),this.up=Be(),this.right=Mr(),this.start=new B,this.setAspectRatio()}return e.prototype.update=function(){var t=this.matrix,r=this.viewMatrix;return Ko(this.rotation,this.position,!this.isOrbit,t),Tr(fa,t,this.forward),Tr(Cn,t,this.up),Tr(sa,t,this.right),vr(t,r),he(this.projectionMatrix,r,this.viewProjectionMatrix),this},e.prototype.panX=function(t){var r=this.position;return this.isOrbit||Cr(r,this.right,t,r),this},e.prototype.panY=function(t){var r=this.position,n=this.up;return this.isOrbit?r.y+=n.y*t:Cr(r,n,t,r),this},e.prototype.panZ=function(t){var r=this.position;return this.isOrbit?r.z+=t:Cr(r,this.forward,t,r),this},e.prototype.begin=function(t,r){this.start.set(t,r)},e.prototype.pan=function(t,r){var n=t-this.start.x,i=r-this.start.y,o=this.viewport;this.panX(-n*(this.panRate/o.width)),this.panY(i*(this.panRate/o.height)),this.start.set(t,r)},e.prototype.rotate=function(t,r){var n=t-this.start.x,i=r-this.start.y,o=this.viewport;this.rotation.x+=i*(this.rotateRate/o.height),this.rotation.y+=n*(this.rotateRate/o.width),this.start.set(t,r),this.update()},e.prototype.zoom=function(t){this.panZ(at(t,-1,1)*(this.zoomRate/this.viewport.height))},e.prototype.setAspectRatio=function(t){if(!t){var r=this.renderer;t=r.width/r.height}return this.aspect=t,this.updateProjectionMatrix()},e.prototype.updateProjectionMatrix=function(){return mr(Ie(this._fov),this.aspect,this._near,this._far,this.projectionMatrix),this},Object.defineProperty(e.prototype,"fov",{get:function(){return this._fov},set:function(t){this._fov=at(t,0,180),this.updateProjectionMatrix()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(t){t>0&&(this._near=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(t){t>0&&(this._far=t,this.updateProjectionMatrix())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yaw",{get:function(){return this._yaw},set:function(t){this._yaw=t,ce(t,this._pitch,this._roll,this.rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t,ce(this._yaw,t,this._roll,this.rotation)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roll",{get:function(){return this._roll},set:function(t){this._roll=t,ce(this._yaw,this._pitch,t,this.rotation)},enumerable:!1,configurable:!0}),e}(),dM=function(e){z(t,e);function t(r,n,i,o,a){n===void 0&&(n=0),i===void 0&&(i=0),o===void 0&&(o=0);var s=e.call(this,r)||this;return s.enableCameraCull=!0,s.type="World3D",s.camera=new lM,s.camera.position.set(n,i,o),s.light=new Af(a),s.shader=new cM,s.renderData=mu(s,s.camera),s}return t.prototype.renderGL=function(r){var n=this;Tt(r);var i=this.shader,o=this.camera,a=r.renderer.gl;zs(r,i,0),i.setUniform("uViewProjectionMatrix",o.viewProjectionMatrix.data),i.setUniform("uCameraPosition",o.position.toArray()),this.light.setUniforms(i),a.enable(a.DEPTH_TEST),this.renderList.forEach(function(s){s.children.length>0?n.renderNode(s,r):s.node.renderGL(r)})},t.prototype.postRenderGL=function(r){var n=r.renderer.gl;n.disable(n.DEPTH_TEST),n.disable(n.CULL_FACE),As(r)},t}(vu),vM=Object.freeze({__proto__:null,BaseWorld3D:vu,BuildRenderList:lu,CalculateTotalRenderable:ro,CreateWorld3DRenderData:mu,Events:fM,HasDirtyChildren:hu,MergeRenderData:du,ResetWorld3DRenderData:nn,UpdateCachedLayers:cu,World3D:dM,WorldDepthFirstSearch:no});function mM(){var e=ut.get(ft.BANNER),t=e.title,r=e.version,n=e.url,i=e.color,o=e.background;if(t!==""){var a=r!==""?t+" "+r:t;console.log("%c"+a+"%c "+n,"padding: 4px 16px; color: "+i+"; background: "+o,"")}}function pM(){return ut.get(ft.PARENT)}function yM(){return ut.get(ft.RENDERER)}function xM(){return{gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]}}function MM(){return ut.get(ft.SCENES)}function wM(e,t){t===void 0&&(t=0),e.gameFrame=t,e.numTotalFrames=0,e.numDirtyFrames=0,e.numDirtyCameras=0,e.worldData.length=0}var pu,yu={get:function(){return pu},set:function(e){pu=e}},gM=function(){function e(){var t=this;this.scenes=new Map,this.sceneIndex=0,this.flush=!1,this.renderResult=xM(),this.game=A.get(),yu.set(this),Yr(this.game,"boot",function(){return t.boot()})}return e.prototype.boot=function(){MM().forEach(function(t){return new t})},e.prototype.update=function(t,r){var n,i;try{for(var o=U(this.scenes.values()),a=o.next();!a.done;a=o.next()){var s=a.value;H(s,"update",t,r)}}catch(f){n={error:f}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.render=function(t){var r,n,i=this.renderResult;wM(i,t);try{for(var o=U(this.scenes.values()),a=o.next();!a.done;a=o.next()){var s=a.value;H(s,"render",i)}}catch(f){r={error:f}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this.flush&&(i.numDirtyFrames++,this.flush=!1),i},e}();function bM(){us(0),cs(4096),hs("Phaser","4.0.0","https://phaser4.io"),Un(0),ms(.5,.5),ls(800,600,1)}var CM=function(e){z(t,e);function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.call(this)||this;return i.VERSION="4.0.0-beta1",i.isBooted=!1,i.isPaused=!1,i.willUpdate=!0,i.willRender=!0,i.lastTick=0,i.elapsed=0,i.frame=0,A.set(i),bM(),Gs(function(){return i.boot(r)}),i}return t.prototype.boot=function(r){r.forEach(function(o){return o()});var n=yM();this.renderer=new n,this.textureManager=new tu,this.sceneManager=new gM;var i=pM();i&&Ds(this.renderer.canvas,i),this.isBooted=!0,mM(),H(this,"boot"),this.lastTick=performance.now(),this.step(this.lastTick)},t.prototype.pause=function(){this.isPaused=!0},t.prototype.resume=function(){this.isPaused=!1,this.lastTick=performance.now()},t.prototype.step=function(r){var n=this,i=r-this.lastTick;this.lastTick=r,this.elapsed+=i,this.isPaused||(this.willUpdate&&(this.sceneManager.update(i,r),H(this,"update",i,r)),this.willRender&&this.renderer.render(this.sceneManager.render(this.frame))),this.frame++,A.setFrame(this.frame),A.setElapsed(this.elapsed),requestAnimationFrame(function(o){return n.step(o)})},t.prototype.destroy=function(){},t}(Xe);function TM(e,t,r){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:r}function SM(e,t){t===void 0&&(t={});var r=yu.get(),n=r.scenes.size,i=r.sceneIndex,o=n===0;typeof t=="string"?e.key=t:(t||!t&&o)&&(e.key=TM(t,"key","scene"+i.toString())),r.scenes.has(e.key)?console.warn("Scene key already in use: "+e.key):(r.scenes.set(e.key,e),r.flush=!0,r.sceneIndex++)}var RM=function(){function e(t){this.game=A.get(),this.events=new Map,SM(this,t)}return e}();y.Camera=Vh,y.Camera3D=u0,y.Config=lm,y.DOM=vm,y.Device=Mm,y.Display=up,y.Display3D=zp,y.Events=Vp,y.Game=CM,y.GameObjects=Ay,y.GameObjects3D=Uy,y.Geom=d1,y.Geom3D=m1,y.Input=n2,y.Loader=d2,y.Materials3D=P2,y.Math=s0,y.Scene=RM,y.Textures=tM,y.Time=nM,y.WebGL1=Fy,y.World=sM,y.World3D=vM})});var xt=KM(Mu());var nt={BACKGROUND_COLOR:"BackgroundColor",BATCH_SIZE:"BatchSize",DEFAULT_ORIGIN:"DefaultOrigin",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",SIZE:"Size",SCENES:"Scenes",RENDERER:"Renderer",AUTO:"Auto",WEBGL:"WebGL",CANVAS:"Canvas",WEBGL_CONTEXT:"WebGLContext",CANVAS_CONTEXT:"CanvasContext",BANNER:"Banner"};var it=new Map;function wu(y){it.set(nt.BACKGROUND_COLOR,y)}function oo(y){return()=>{wu(y)}}function Ee(){return it.get(nt.SIZE).height}function Ae(){return it.get(nt.SIZE).resolution}function ze(){return it.get(nt.SIZE).width}var ao=[],Fe={add:(y,l)=>{ao.push({texture:y,glConfig:l})},get:()=>ao,clear:()=>{ao.length=0}};function so(){return it.get(nt.BACKGROUND_COLOR)}function fo(y){it.set(nt.RENDERER,y)}function sn(y){it.set(nt.MAX_TEXTURES,y)}function gu(y){let l;return y&&(typeof y=="string"?l=document.getElementById(y):typeof y=="object"&&y.nodeType===1&&(l=y)),l||(l=document.body),l}function bu(y){y&&it.set(nt.PARENT,gu(y))}function uo(y){return()=>{bu(y)}}function Cu(y){it.set(nt.SCENES,[].concat(y))}function ho(y){return()=>{Cu(y)}}function Tu(y,l,x){return y.width<=0||y.height<=0?!1:y.x<=l&&y.x+y.width>=l&&y.y<=x&&y.y+y.height>=x}var $t=class{constructor(l=0,x=0,T=0,A=0){this.set(l,x,T,A)}set(l=0,x=0,T=0,A=0){return this.x=l,this.y=x,this.width=T,this.height=A,this}contains(l,x){return Tu(this,l,x)}set right(l){l<=this.x?this.width=0:this.width=l-this.x}get right(){return this.x+this.width}set bottom(l){l<=this.y?this.height=0:this.height=l-this.y}get bottom(){return this.y+this.height}};function co(y,l=0,x=0,T=0,A=0){let F=new $t(l,x,T,A);return y.viewportStack.push(F),F}var w,Su={get:()=>w,set:y=>{w=y}};function ae(y,l){if(!l&&(l=y.currentViewport,!l))return;let x=w.getParameter(w.VIEWPORT);(x[0]!==l.x||x[1]!==l.y||x[2]!==l.width||x[3]!==l.height)&&w.viewport(l.x,l.y,l.width,l.height)}function lo(y,l=0,x=0,T=0,A=0){let F=co(y,l,x,T,A);ae(y,F),y.currentViewport=F}function se(y,l=!0,x){x||(x=y.currentFramebuffer);let{framebuffer:T,viewport:A}=x;w.bindFramebuffer(w.FRAMEBUFFER,T),l&&(w.clearColor(0,0,0,0),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT)),A&&lo(y,A.x,A.y,A.width,A.height)}function vo(y){let l=y.viewportStack;l.length>1&&l.pop(),y.currentViewport=l[l.length-1],ae(y)}function mo(y){let l=y.framebufferStack;l.length>1&&(y.currentFramebuffer.viewport&&vo(y),l.pop()),y.currentFramebuffer=l[l.length-1],se(y,!1)}function po(y,l,x){let T={framebuffer:l,viewport:x};return y.framebufferStack.push(T),T}function yo(y,l,x=!0,T){let A=po(y,l,T);se(y,x,A),y.currentFramebuffer=A}function xo(y){let l=y.count;if(l===0)return;let x=y.currentVertexBuffer,T=y.currentShader,A=T.shader.renderToFramebuffer;if(A&&yo(y,T.shader.framebuffer,!0),l===x.batchSize){let F=x.isDynamic?w.DYNAMIC_DRAW:w.STATIC_DRAW;w.bufferData(w.ARRAY_BUFFER,x.data,F)}else{let F=x.indexed?l*x.entryElementSize:l*x.vertexElementSize,z=x.vertexViewF32.subarray(0,F);w.bufferSubData(w.ARRAY_BUFFER,0,z)}x.indexed?w.drawElements(w.TRIANGLES,l*x.entryIndexSize,w.UNSIGNED_SHORT,0):w.drawArrays(w.TRIANGLES,0,l),A&&mo(y)}function _e(y,l){l&&(y.count=l);let x=y.count;return x===0?!1:(xo(y),y.prevCount=x,y.count=0,y.flushTotal++,!0)}function Mo(y){_e(y)}function Ru(y,l=[]){let x=y>>16&255,T=y>>8&255,A=y&255,F=y>16777215?y>>>24:255;return l[0]=x/255,l[1]=T/255,l[2]=A/255,l[3]=F/255,l}function Eu(){return it.get(nt.WEBGL_CONTEXT)}function fn(y){let{parent:l,flipY:x,unpackPremultiplyAlpha:T,minFilter:A,magFilter:F,wrapS:z,wrapT:U,generateMipmap:L,isPOT:Y}=y,lt=l.image,pt=l.width,vt=l.height,Ft=w.createTexture();return w.activeTexture(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,Ft),w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,x),w.pixelStorei(w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T),lt?(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,lt),pt=lt.width,vt=lt.height):w.texImage2D(w.TEXTURE_2D,0,w.RGBA,pt,vt,0,w.RGBA,w.UNSIGNED_BYTE,null),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,A),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,F),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,z),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,U),L&&Y&&w.generateMipmap(w.TEXTURE_2D),y.texture=Ft,Ft}function un(y){w&&w.isFramebuffer(y)&&w.deleteFramebuffer(y)}function ir(y){w.isTexture(y)&&w.deleteTexture(y)}function Au(y,l){return y<1||l<1?!1:(y&y-1)==0&&(l&l-1)==0}function zu(y,l=!0){w.activeTexture(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,y);let x=l?w.LINEAR:w.NEAREST;w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,x),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,x)}function Fu(y){let l=y.parent.image,x=l.width,T=l.height;return x>0&&T>0&&(w.activeTexture(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,y.texture),w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,y.flipY),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,l)),y.texture}var or=class{constructor(l,x={}){this.index=0,this.indexCounter=-1,this.dirtyIndex=!0,this.unpackPremultiplyAlpha=!0,this.flipY=!1,this.isPOT=!1,this.generateMipmap=!1,this.parent=l,this.isPOT=Au(l.width,l.height);let{texture:T=null,framebuffer:A=null,depthbuffer:F=null,unpackPremultiplyAlpha:z=!0,minFilter:U=this.isPOT?w.LINEAR_MIPMAP_LINEAR:w.LINEAR,magFilter:L=w.LINEAR,wrapS:Y=w.CLAMP_TO_EDGE,wrapT:lt=w.CLAMP_TO_EDGE,generateMipmap:pt=this.isPOT,flipY:vt=!1}=x;this.minFilter=U,this.magFilter=L,this.wrapS=Y,this.wrapT=lt,this.generateMipmap=pt,this.flipY=vt,this.unpackPremultiplyAlpha=z,A&&(this.framebuffer=A),F&&(this.depthbuffer=F),T?this.texture=T:fn(this)}setFilter(l){this.texture&&zu(this.texture,l)}create(){let l=this.texture;return l&&ir(l),fn(this)}update(){return this.texture?Fu(this):fn(this)}setIndex(l){this.dirtyIndex=l!==this.index,this.index=l}destroy(){ir(this.texture),un(this.framebuffer),this.parent=null,this.texture=null,this.framebuffer=null}};function wo(){Fe.get().forEach(l=>{let{texture:x,glConfig:T}=l;x.binding||(x.binding=new or(x,T))}),Fe.clear()}function ar(){return it.get(nt.MAX_TEXTURES)}var qM=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ZM(y){let l="";for(let x=0;x<y;++x)x>0&&(l+=`
else `),x<y-1&&(l+=`if(test == ${x}.0){}`);return l}function go(y){let l=w.createShader(w.FRAGMENT_SHADER);for(;;){let x=qM.replace(/%forloop%/gi,ZM(y));if(w.shaderSource(l,x),w.compileShader(l),!w.getShaderParameter(l,w.COMPILE_STATUS))y=y/2|0;else break}return y}function bo(y){let l=go(w.getParameter(w.MAX_TEXTURE_IMAGE_UNITS)),x=ar();x===0||x>0&&x>l?sn(l):x>0&&x<l&&(l=Math.max(8,x));let T=y.tempTextures;T.length&&T.forEach(F=>{w.deleteTexture(F)});let A=[];for(let F=0;F<l;F++){let z=w.createTexture();w.activeTexture(w.TEXTURE0+F),w.bindTexture(w.TEXTURE_2D,z),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),T[F]=z,A.push(F)}y.maxTextures=l,y.textureIndex=A,y.currentActiveTexture=1}function _u(){return it.get(nt.BATCH_SIZE)}function sr(y){w.isBuffer(y)&&w.deleteBuffer(y)}var Co=class{constructor(l={}){this.indexed=!1,this.isDynamic=!1,this.count=0,this.offset=0;let{batchSize:x=1,dataSize:T=4,isDynamic:A=!0,elementsPerEntry:F=4,vertexElementSize:z=6}=l;this.batchSize=x,this.dataSize=T,this.vertexElementSize=z,this.isDynamic=A,this.elementsPerEntry=F,this.vertexByteSize=z*T,this.entryByteSize=this.vertexByteSize*F,this.bufferByteSize=x*this.entryByteSize,this.create()}resize(l){this.batchSize=l,this.bufferByteSize=l*this.entryByteSize,this.vertexBuffer&&sr(this.vertexBuffer),this.create()}create(){let l=new ArrayBuffer(this.bufferByteSize);this.data=l,this.vertexViewF32=new Float32Array(l),this.vertexViewU32=new Uint32Array(l),this.vertexBuffer=w.createBuffer(),w.bindBuffer(w.ARRAY_BUFFER,this.vertexBuffer);let x=this.isDynamic?w.DYNAMIC_DRAW:w.STATIC_DRAW;w.bufferData(w.ARRAY_BUFFER,l,x),w.bindBuffer(w.ARRAY_BUFFER,null)}add(l){this.count+=l,this.offset+=this.vertexElementSize*l}reset(){this.count=0,this.offset=0}canContain(l){return this.count+l<=this.batchSize}free(){return Math.max(0,1-this.count/this.batchSize)}bind(){w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,null),w.bindBuffer(w.ARRAY_BUFFER,this.vertexBuffer)}destroy(){sr(this.vertexBuffer),this.data=null,this.vertexViewF32=null,this.vertexViewU32=null,this.vertexBuffer=null}};var hn=class extends Co{constructor(l={}){super(l);let{indexSize:x=4,entryIndexSize:T=6,indexLayout:A=null}=l;this.indexed=!0,this.indexSize=x,this.entryIndexSize=T,this.entryElementSize=this.vertexElementSize*this.elementsPerEntry;let F=[];if(A){this.indexLayout=A;for(let z=0;z<this.batchSize*x;z+=x)for(let U=0;U<A.length;U++)F.push(z+A[U])}this.create(),this.createIndexBuffer(F)}createIndexBuffer(l){this.index=new Uint16Array(l),this.indexBuffer=w.createBuffer(),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,this.indexBuffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,this.index,w.STATIC_DRAW),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,null),l=[]}bind(){w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,this.indexBuffer),w.bindBuffer(w.ARRAY_BUFFER,this.vertexBuffer)}destroy(){super.destroy(),sr(this.indexBuffer),this.index=null,this.indexLayout=null,this.indexBuffer=null}};var Gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rw=new Uint8Array(256);for(let y=0;y<Gu.length;y++)rw[Gu.charCodeAt(y)]=y;function De(){}var $=class{constructor(l){let x=new Float32Array(16);this.data=x,this.onChange=De,l?Array.isArray(l)?this.fromArray(l):this.fromArray(l.data):(x[0]=1,x[5]=1,x[10]=1,x[15]=1)}set(l,x,T,A,F,z,U,L,Y,lt,pt,vt,Ft,Ve,ue,Vt){let I=this.data;return I[0]=l,I[1]=x,I[2]=T,I[3]=A,I[4]=F,I[5]=z,I[6]=U,I[7]=L,I[8]=Y,I[9]=lt,I[10]=pt,I[11]=vt,I[12]=Ft,I[13]=Ve,I[14]=ue,I[15]=Vt,this.onChange(this),this}toArray(l=[],x=0){let T=this.data;for(let A=0;A<16;A++)l[x+A]=T[A];return l}fromArray(l,x=0){let T=this.data;for(let A=0;A<16;A++)T[A]=l[x+A];return this.onChange(this),this}toString(){return"[ mat4="+this.data.join(", ")+" ]"}destroy(){this.onChange=De,this.data=null}};function So(y,l,x,T,A,F,z=new $){let U=1/(y-l),L=1/(x-T),Y=1/(A-F);return z.set(-2*U,0,0,0,0,-2*L,0,0,0,0,2*Y,0,(y+l)*U,(T+x)*L,(F+A)*Y,1)}function Ro(y,l){let x=new Map,T={size:1,type:w.FLOAT,normalized:!1,stride:0,offset:0},A=w.getProgramParameter(y,w.ACTIVE_ATTRIBUTES);for(let F=0;F<A;F++){let z=w.getActiveAttrib(y,F);if(!z)break;let U=z.name,L=w.getAttribLocation(y,U);w.enableVertexAttribArray(L);let Y=l.hasOwnProperty(U)?l[U]:{},{size:lt=T.size,type:pt=T.type,normalized:vt=T.normalized,stride:Ft=T.stride,offset:Ve=T.offset}=Y;x.set(U,{index:L,size:lt,type:pt,normalized:vt,stride:Ft,offset:Ve})}return x}function fr(...y){y.forEach(l=>{w.deleteShader(l)})}function Eo(...y){let l=w.createProgram();if(y.forEach(T=>{w.attachShader(l,T)}),w.linkProgram(l),!w.getProgramParameter(l,w.LINK_STATUS)){let T=w.getProgramInfoLog(l);return console.error(`Error linking program: ${T}`),w.deleteProgram(l),fr(...y),null}return l}function cn(y,l){let x=w.createShader(l);if(w.shaderSource(x,y),w.compileShader(x),!w.getShaderParameter(x,w.COMPILE_STATUS)){let A=w.getShaderInfoLog(x),F=y.split(`
`).map((z,U)=>`${U}: ${z}`);return console.error(`Error compiling shader: ${A}`,F.join(`
`)),w.deleteShader(x),null}return x}function Ao(y,l,x=!1){switch(y.type){case w.INT:case w.BOOL:return x?T=>{w.uniform1iv(l,T)}:T=>{w.uniform1i(l,T)};case w.INT_VEC2:case w.BOOL_VEC2:return T=>{w.uniform2iv(l,T)};case w.INT_VEC3:case w.BOOL_VEC3:return T=>{w.uniform3iv(l,T)};case w.INT_VEC4:case w.BOOL_VEC4:return T=>{w.uniform4iv(l,T)};case w.FLOAT:return x?T=>{w.uniform1fv(l,T)}:T=>{w.uniform1f(l,T)};case w.FLOAT_VEC2:return T=>{w.uniform2fv(l,T)};case w.FLOAT_VEC3:return T=>{w.uniform3fv(l,T)};case w.FLOAT_VEC4:return T=>{w.uniform4fv(l,T)};case w.FLOAT_MAT2:return T=>{w.uniformMatrix2fv(l,!1,T)};case w.FLOAT_MAT3:return T=>{w.uniformMatrix3fv(l,!1,T)};case w.FLOAT_MAT4:return T=>{w.uniformMatrix4fv(l,!1,T)};case w.SAMPLER_2D:case w.SAMPLER_CUBE:return y.size>1?T=>{w.uniform1iv(l,T)}:T=>{w.uniform1i(l,T)}}}function zo(y){let l=new Map,x=w.getProgramParameter(y,w.ACTIVE_UNIFORMS);for(let T=0;T<x;T++){let A=w.getActiveUniform(y,T),F=A.name;if(F.startsWith("gl_")||F.startsWith("webgl_"))continue;let z=w.getUniformLocation(y,A.name);if(z){let U=!1;F.substr(-3)==="[0]"&&(F=F.substr(0,F.length-3),U=A.size>1),l.set(F,Ao(A,z,U))}}return l}var Lu=5121;var ln=5126;var Ge={aVertexPosition:{size:2,type:ln,normalized:!1,offset:0},aTextureCoord:{size:2,type:ln,normalized:!1,offset:8},aTextureId:{size:1,type:ln,normalized:!1,offset:16},aTintColor:{size:4,type:Lu,normalized:!0,offset:20}};var Fo={uProjectionMatrix:new Float32Array,uCameraMatrix:new Float32Array,uTexture:0};function Vu(y,l,x){w.bindFramebuffer(w.FRAMEBUFFER,y);let T=w.createRenderbuffer();return w.bindRenderbuffer(w.RENDERBUFFER,T),w.renderbufferStorage(w.RENDERBUFFER,w.DEPTH_COMPONENT16,l,x),w.framebufferRenderbuffer(w.FRAMEBUFFER,w.DEPTH_ATTACHMENT,w.RENDERBUFFER,T),w.bindFramebuffer(w.FRAMEBUFFER,null),T}function Ou(y,l){l||(l=w.COLOR_ATTACHMENT0);let x=w.createFramebuffer();return w.bindFramebuffer(w.FRAMEBUFFER,x),w.framebufferTexture2D(w.FRAMEBUFFER,l,w.TEXTURE_2D,y,0),w.bindFramebuffer(w.FRAMEBUFFER,null),x}var Bu=`#define SHADER_NAME SINGLE_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture;

void main (void)
{
    vec4 color = texture2D(uTexture, vTextureCoord);

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var Pu=`#define SHADER_NAME SINGLE_QUAD_VERT

precision highp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute float aTextureId;
attribute vec4 aTintColor;

uniform mat4 uProjectionMatrix;
uniform mat4 uCameraMatrix;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

void main (void)
{
    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vTintColor = aTintColor;

    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);
}`;var dn=class{constructor(l,x,T,A,F,z){this.trimmed=!1,this.texture=l,this.key=x,this.x=T,this.y=A,this.width=F,this.height=z,this.sourceSizeWidth=F,this.sourceSizeHeight=z,this.updateUVs()}setPivot(l,x){this.pivot={x:l,y:x}}setSize(l,x){this.width=l,this.height=x,this.sourceSizeWidth=l,this.sourceSizeHeight=x,this.updateUVs()}setSourceSize(l,x){this.sourceSizeWidth=l,this.sourceSizeHeight=x}setTrim(l,x,T,A,F,z){this.trimmed=!0,this.sourceSizeWidth=l,this.sourceSizeHeight=x,this.spriteSourceSizeX=T,this.spriteSourceSizeY=A,this.spriteSourceSizeWidth=F,this.spriteSourceSizeHeight=z}getExtent(l,x){let T=this.sourceSizeWidth,A=this.sourceSizeHeight,F,z,U,L;return this.trimmed?(F=this.spriteSourceSizeX-l*T,z=F+this.spriteSourceSizeWidth,U=this.spriteSourceSizeY-x*A,L=U+this.spriteSourceSizeHeight):(F=-l*T,z=F+T,U=-x*A,L=U+A),{left:F,right:z,top:U,bottom:L}}setExtent(l){let x=l.transform,T=x.origin.x,A=x.origin.y,F=this.sourceSizeWidth,z=this.sourceSizeHeight,U,L,Y,lt;this.trimmed?(U=this.spriteSourceSizeX-T*F,L=this.spriteSourceSizeY-A*z,Y=this.spriteSourceSizeWidth,lt=this.spriteSourceSizeHeight):(U=-T*F,L=-A*z,Y=F,lt=z),x.setExtent(U,L,Y,lt)}updateUVs(){let{x:l,y:x,width:T,height:A}=this,F=this.texture.width,z=this.texture.height;this.u0=l/F,this.v0=x/z,this.u1=(l+T)/F,this.v1=(x+A)/z}};var _o=class{constructor(l,x,T,A){this.key="",l&&(x=l.width,T=l.height),this.image=l,this.width=x,this.height=T,this.frames=new Map,this.data={},this.addFrame("__BASE",0,0,x,T),Fe.add(this,A)}addFrame(l,x,T,A,F){if(this.frames.has(l))return null;let z=new dn(this,l,x,T,A,F);return this.frames.set(l,z),(!this.firstFrame||this.firstFrame.key==="__BASE")&&(this.firstFrame=z),z}getFrame(l){if(!l)return this.firstFrame;l instanceof dn&&(l=l.key);let x=this.frames.get(l);return x||(console.warn(`Frame missing: ${l}`),x=this.firstFrame),x}setSize(l,x){this.width=l,this.height=x,this.frames.get("__BASE").setSize(l,x)}destroy(){this.binding&&this.binding.destroy(),this.frames.clear(),this.data=null,this.image=null,this.firstFrame=null}};var vn=class{constructor(l){this.renderToFramebuffer=!1,this.renderToDepthbuffer=!1,l&&this.fromConfig(l)}fromConfig(l){let{attributes:x=Ge,fragmentShader:T=Bu,height:A=Ee(),renderToFramebuffer:F=!1,renderToDepthbuffer:z=!1,resolution:U=Ae(),vertexShader:L=Pu,width:Y=ze(),uniforms:lt=Fo}=l;if(this.create(T,L,lt,x),F){this.renderToFramebuffer=!0;let pt=new _o(null,Y*U,A*U),vt=new or(pt);pt.binding=vt,vt.framebuffer=Ou(vt.texture),z&&(this.renderToDepthbuffer=!0,vt.depthbuffer=Vu(vt.framebuffer,pt.width,pt.height)),this.texture=pt,this.framebuffer=vt.framebuffer}}create(l,x,T,A){let F=cn(l,w.FRAGMENT_SHADER),z=cn(x,w.VERTEX_SHADER);if(!F||!z)return;let U=Eo(F,z);if(!U)return;let L=w.getParameter(w.CURRENT_PROGRAM);w.useProgram(U),this.program=U,this.uniformSetters=zo(U),this.uniforms=new Map;for(let[Y,lt]of Object.entries(T))this.uniforms.set(Y,lt);this.attributes=Ro(U,A),w.useProgram(L)}updateUniforms(l){}bind(l){return this.updateUniforms(l),this.setUniforms(l)}setUniform(l,x){let T=this.uniforms;T.has(l)&&(T.set(l,x),this.uniformSetters.get(l)(x))}setUniforms(l){if(!this.program)return!1;w.useProgram(this.program);let x=this.uniforms;for(let[T,A]of this.uniformSetters.entries())A(x.get(T));return!0}setAttributes(l){if(this.program){let x=l.currentVertexBuffer.vertexByteSize;this.attributes.forEach(T=>{w.vertexAttribPointer(T.index,T.size,T.type,T.normalized,x,T.offset)})}}destroy(){fr(this.program),ir(this.texture),un(this.framebuffer),this.uniforms.clear(),this.uniformSetters.clear(),this.attributes.clear(),this.program=null,this.texture=null,this.framebuffer=null}};var fe=class extends vn{constructor(l={}){let x=l;x.attributes=x.attributes?x.attributes:Ge,super(x)}bind(l){let x=this.uniforms;return x.set("uProjectionMatrix",l.projectionMatrix.data),x.set("uCameraMatrix",l.cameraMatrix.data),super.bind(l)}};var Iu=`#define SHADER_NAME MULTI_QUAD_FRAG

precision highp float;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vTintColor;

uniform sampler2D uTexture[%count%];

void main (void)
{
    vec4 color;

    %forloop%

    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);
}`;var mn=class extends fe{constructor(l={}){l.fragmentShader||(l.fragmentShader=Iu),super(l)}create(l,x,T,A){let F=ar(),z="";for(let U=1;U<F;U++)U>1&&(z+=`
	else `),U<F-1&&(z+=`if (vTextureId < ${U}.5)`),z+=`
	{`,z+=`
		color = texture2D(uTexture[${U}], vTextureCoord);`,z+=`
	}`;l=l.replace(/%count%/gi,`${F}`),l=l.replace(/%forloop%/gi,z),super.create(l,x,T,A)}bind(l){return this.uniforms.set("uTexture",l.textureIndex),super.bind(l)}};function Do(y,l,x,T){let A={enable:l,sfactor:x,dfactor:T};y.blendModeStack[0]=A,y.currentBlendMode=A,y.defaultBlendMode=A}function Go(y,l=null,x){let T={framebuffer:l,viewport:x};y.framebufferStack[0]=T,y.currentFramebuffer=T,y.defaultFramebuffer=T}function Lo(y,l,x){let T={shader:l,textureID:x};y.shaderStack[0]=T,y.currentShader=T,y.defaultShader=T}function Vo(y,l){y.vertexBufferStack[0]=l,y.currentVertexBuffer=l,y.defaultVertexBuffer=l}function Oo(y,l=0,x=0,T=0,A=0){let F=new $t(l,x,T,A);y.viewportStack[0]=F,y.currentViewport=F,y.defaultViewport=F}var Nu,Uu=0,ku=0,ur={get:()=>Nu,set:y=>{Nu=y},getFrame:()=>Uu,setFrame:y=>{Uu=y},getElapsed:()=>ku,setElapsed:y=>{ku=y}};function hr(y=new $){return y.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}var pn=class{constructor(l=1,x=0,T=0,A=1,F=0,z=0){this.set(l,x,T,A,F,z)}set(l=1,x=0,T=0,A=1,F=0,z=0){return this.a=l,this.b=x,this.c=T,this.d=A,this.tx=F,this.ty=z,this}identity(){return this.set()}toArray(){let{a:l,b:x,c:T,d:A,tx:F,ty:z}=this;return[l,x,T,A,F,z]}fromArray(l){return this.set(l[0],l[1],l[2],l[3],l[4],l[5])}};var Bo={PI2:Math.PI*2,HALF_PI:Math.PI*.5,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};var yn=class{constructor(){this.type="StaticCamera",this.dirtyRender=!0;let l=ur.get();this.renderer=l.renderer,this.matrix=hr(),this.bounds=new $t,this.worldTransform=new pn,this.reset()}reset(){let l=this.renderer;if(l){let x=l.width,T=l.height;this.width=x,this.height=T}this.bounds.set(0,0,this.width,this.height)}destroy(){this.world=null,this.worldTransform=null,this.renderer=null,this.matrix=null,this.bounds=null}};var xn=class{constructor(l){this.count=0,this.prevCount=0,this.flushTotal=0,this.maxTextures=0,this.currentActiveTexture=0,this.startActiveTexture=0,this.tempTextures=[],this.textureIndex=[],this.framebufferStack=[],this.currentFramebuffer=null,this.defaultFramebuffer=null,this.vertexBufferStack=[],this.currentVertexBuffer=null,this.defaultVertexBuffer=null,this.shaderStack=[],this.currentShader=null,this.defaultShader=null,this.viewportStack=[],this.currentViewport=null,this.defaultViewport=null,this.blendModeStack=[],this.currentBlendMode=null,this.defaultBlendMode=null,this.renderer=l,this.projectionMatrix=new $,this.reset()}reset(){let l=this.renderer.gl,x=[0,1,2,2,3,0];this.quadShader=new fe,this.quadBuffer=new hn({isDynamic:!1,indexLayout:x}),this.quadCamera=new yn,bo(this),Go(this),Do(this,!0,l.ONE,l.ONE_MINUS_SRC_ALPHA),Vo(this,new hn({batchSize:_u(),indexLayout:x})),Lo(this,new mn)}resize(l,x){So(0,l,x,0,-1e3,1e3,this.projectionMatrix),this.quadCamera.reset(),Oo(this,0,0,l,x)}};function cr(y,l){l||(l=y.currentBlendMode),l.enable?(w.enable(w.BLEND),w.blendFunc(l.sfactor,l.dfactor)):w.disable(w.BLEND)}function lr(y,l){l||(l=y.currentVertexBuffer);let x=l.indexed?l.indexBuffer:null;w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,x),w.bindBuffer(w.ARRAY_BUFFER,l.vertexBuffer)}function Io(y){y.current2DCamera=y.quadCamera,y.cameraMatrix=y.quadCamera.matrix,y.count=0,y.flushTotal=0,se(y,!1,y.defaultFramebuffer),cr(y,y.defaultBlendMode),ae(y,y.defaultViewport),lr(y,y.defaultVertexBuffer)}var Wu,No={get:()=>Wu,set:y=>{Wu=y}};var Uo=class{constructor(){this.clearColor=[0,0,0,1],this.clearBeforeRender=!0,this.optimizeRedraw=!1,this.autoResize=!0,this.contextLost=!1,this.width=ze(),this.height=Ee(),this.resolution=Ae(),this.setBackgroundColor(so());let l=document.createElement("canvas");l.addEventListener("webglcontextlost",x=>this.onContextLost(x),!1),l.addEventListener("webglcontextrestored",()=>this.onContextRestored(),!1),this.canvas=l,this.initContext(),No.set(this),this.renderPass=new xn(this),this.resize(this.width,this.height,this.resolution)}initContext(){let l=this.canvas.getContext("webgl",Eu());Su.set(l),this.gl=l,l.disable(l.DEPTH_TEST),l.disable(l.CULL_FACE)}resize(l,x,T=1){let A=l*T,F=x*T;this.width=A,this.height=F,this.resolution=T;let z=this.canvas;z.width=A,z.height=F,this.autoResize&&(z.style.width=l.toString()+"px",z.style.height=x.toString()+"px"),this.renderPass.resize(A,F)}onContextLost(l){l.preventDefault(),this.contextLost=!0}onContextRestored(){this.contextLost=!1,this.initContext()}setBackgroundColor(l){return Ru(l,this.clearColor),this}reset(){}render(l){if(this.contextLost)return;let x=this.gl,T=this.renderPass;if(wo(),this.optimizeRedraw&&l.numDirtyFrames===0&&l.numDirtyCameras===0)return;if(this.clearBeforeRender){let F=this.clearColor;x.clearColor(F[0],F[1],F[2],F[3]),x.clear(x.COLOR_BUFFER_BIT)}let A=l.worldData;Io(T);for(let F=0;F<A.length;F++){let{world:z}=A[F];z.renderGL(T),z.postRenderGL(T)}Mo(T)}destroy(){No.set(void 0)}};function ko(){return()=>{fo(Uo)}}var Le=class{constructor(l,x,T=!1){this.callback=l,this.context=x,this.once=T}};function Wo(y,l,x,T,A){let F=y.events,z=F.get(l);if(!x)F.delete(l);else if(x instanceof Le)z.delete(x);else{let U=!T,L=A!==void 0;for(let Y of z)Y.callback===x&&U&&Y.context===T&&L&&Y.once===A&&z.delete(Y)}return z.size===0&&F.delete(l),y}function Mn(y,l,x,T=y,A=!1){if(typeof x!="function")throw new TypeError("Listener not a function");let F=new Le(x,T,A),z=y.events.get(l);return z?z.add(F):y.events.set(l,new Set([F])),F}function ju(y){return y}var jo=class{constructor(l,x){this.name=l,typeof x=="string"?(this.modifier=x.substr(0,1),this.end=parseFloat(x.substring(1))):this.end=x}getEnd(l){let x=this.modifier,T=this.end;return x==="+"?l+T:x==="-"?l-T:T}to(l){let x=l[this.name],T=this.getEnd(x);this.start=x,this.end=T}from(l){let x=l[this.name],T=this.getEnd(x);this.start=T,this.end=x,l[this.name]=T}update(l,x){l[this.name]=this.start+(this.end-this.start)*x}};var wn="update";var Ho=class{constructor(l,x,T=!0){this.state={running:!1,repeat:!1,hold:!1,delay:!1,yoyo:!1,yoyoing:!1,autoStart:!0,reversed:!1},this.init={duration:0,repeat:0,repeatDelay:0,hold:0,delay:0},this.counters={repeat:0,delay:0,progress:0,elapsed:0},this.ease=ju,this.properties=[],x||(x=ur.get()),this.target=l,this.state.autoStart=T,this.emitter=x}to(l,x=null){return this.add(l,x,!1)}from(l,x=null){return this.add(l,x,!0)}add(l,x,T){let A=this.state,F=this.init;if(A.running)return this;let z=this.properties;for(let[U,L]of Object.entries(x))z.push(new jo(U,L));return F.duration=l,A.reversed=T,A.autoStart&&this.start(),this}start(){let l=this.state;if(l.running)return this;let x=this.target;return this.properties.forEach(A=>{l.reversed?A.from(x):A.to(x)}),l.running=!0,this.listener=Mn(this.emitter,wn,A=>this.update(A)),this}restart(){let l=this.state,x=this.init,T=this.counters;if(!l)throw"Cannot restart destroyed tween";return T.delay=x.delay,T.elapsed=0,T.progress=0,T.repeat=x.repeat,l.yoyoing=!1,l.running=!0,this}update(l){let x=this.state,T=this.init,A=this.counters;if(!x.running)return!1;if(A.delay>0)if(A.delay-=l,A.delay<=0)A.elapsed=Math.abs(A.delay)-l,A.delay=0;else return!1;A.elapsed+=l;let F=Math.min(A.elapsed/T.duration,1);A.progress=F;let z=x.yoyoing?this.ease(1-F):this.ease(F),U=this.target;if(this.properties.forEach(lt=>{lt.update(U,z)}),F<1)return!1;let Y=A.elapsed-T.duration;return x.yoyo&&!x.yoyoing?(A.elapsed=Y,A.delay=T.hold-Y,x.yoyoing=!0,!1):A.repeat>0?(A.repeat--,A.elapsed=Y,A.delay=T.repeatDelay-Y,x.yoyoing=!1,!1):(this.destroy(),!0)}delay(l){let x=l;return this.init.delay=x,this.counters.delay=x,this}hold(l){return this.init.hold=l,this}yoyo(l=!0){return this.state.yoyo=l,this}repeat(l=1,x=0){let T=this.init;return this.state.repeat=l>0,this.counters.repeat=l,T.repeat=l,T.repeatDelay=x,this}easing(l){return this.ease=l,this}destroy(){Wo(this.emitter,wn,this.listener),this.properties.length=0,this.target=null,this.ease=null,this.emitter=null,this.state=null,this.init=null,this.counters=null}};function Hu(y,l=null,x=!0){return new Ho(y,l,x)}var Qu=class extends xt.Scene{constructor(){super();let l=new xt.World.StaticWorld(this),x=new xt.Loader.Loader;x.add(xt.Loader.Files.ImageFile("logo","assets/logo.png")),x.start().then(()=>{let T=new xt.GameObjects.Sprite(400,100,"logo").setRotation(.3);Hu(T).to(3e3,{y:400,rotation:0}).easing(xt.Math.Easing.Bounce.Out),xt.Display.AddChildren(l,T)})}};new xt.Game(ko(),uo("gameParent"),oo(2960685),ho(Qu));})();
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
/**
 * @author       Niklas von Hertzen (https://github.com/niklasvh/base64-arraybuffer)
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
/**
 * @author       Richard Davey <rich@photonstorm.com>
 * @copyright    2020 Photon Storm Ltd.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
